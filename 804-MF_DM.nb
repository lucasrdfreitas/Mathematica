(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    677969,      16008]
NotebookOptionsPosition[    662362,      15788]
NotebookOutlinePosition[    662793,      15805]
CellTagsIndexPosition[    662750,      15802]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions ", "Section",
 CellChangeTimes->{{3.870756830253976*^9, 3.870756834033395*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"415c9f61-a31b-4391-823c-f2870c74e1aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NbName", " ", "=", " ", "\"\<804\>\""}], ";", 
  RowBox[{"Needs", "[", "\"\<MaTeX`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ls", " ", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"40", ",", "40", ",", "2"}], "]"}]}], ";", " \t    ", 
  RowBox[{"tV", "=", 
   RowBox[{"{", "0", "}"}]}], ";", "\t   ", 
  RowBox[{"hV", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0.2", ",", "0", ",", "0"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"steps", "=", "600"}], ";", "                                     ", 
  RowBox[{"acuracy", "=", "3"}], ";", "    ", 
  RowBox[{"\[CapitalDelta]eV", "=", "0.099999"}], ";", " ", 
  RowBox[{"eVs", "=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"1700", " ", "\[Xi]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Xi]", ",", "0", ",", "0", ",", "\[CapitalDelta]eV"}], 
      "}"}]}], " ", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Js", "=", 
   RowBox[{"{", "0.", "}"}]}], ";", " ", 
  RowBox[{"Ks", "=", 
   RowBox[{"{", 
    RowBox[{"-", "1."}], "}"}]}], ";", " ", 
  RowBox[{"\[CapitalGamma]s", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"\[Gamma]", ",", 
     RowBox[{"{", 
      RowBox[{"\[Gamma]", ",", "0.", ",", ".0", ",", ".2"}], "}"}]}], "]"}]}],
   ";", " ", 
  RowBox[{"hV", "=", 
   RowBox[{"{", "  ", 
    RowBox[{"{", 
     RowBox[{"0.10", ",", "0", ",", "0"}], "}"}], "  ", "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.902507042162265*^9, 3.902507101695835*^9}, {
  3.9025079579684677`*^9, 3.9025079589810476`*^9}, {3.9029945884475546`*^9, 
  3.9029945914623423`*^9}, {3.903421241058358*^9, 3.9034212436236095`*^9}, {
  3.903424355922397*^9, 3.903424358141776*^9}, {3.9034244214145474`*^9, 
  3.903424423183173*^9}, {3.90342448339882*^9, 3.903424485945702*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6f9fb1b5-b826-4b31-9132-604e4661e681"],

Cell[CellGroupData[{

Cell["Constants", "Subsubsection",
 CellChangeTimes->{{3.861809041310557*^9, 3.861809045921008*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"2bab245a-01fa-44c7-b751-d57ae960babf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"one", "[", 
    RowBox[{"i_", ",", "j_", ",", "N_"}], "]"}], ":=", " ", 
   RowBox[{"SparseArray", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], " ", "->", " ", "1"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"N", ",", "N"}], "}"}]}], "]"}]}], ";", "  ", 
  RowBox[{
   RowBox[{"block", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
   RowBox[{"one", "[", 
    RowBox[{"i", ",", "j", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hc", "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["3"]], 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], ";", 
  RowBox[{"hb", "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ";", 
  RowBox[{"ha", "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["6"]], 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "2"}]}], "}"}]}]}], ";", 
  RowBox[{"hx", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"hAngle", "[", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ha", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}]}], "+", 
     RowBox[{"hb", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}]}], "+", " ", 
     RowBox[{"hc", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}]}]}]}], " ", ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Magnetic", " ", "field", " ", "directions", " ", "a"}], ",", " ",
     "b", ",", " ", "c"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nx", "=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "2"], ",", 
      FractionBox[
       SqrtBox["3"], "2"]}], "}"}]}], ";", "  ", 
   RowBox[{"ny", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], ",", 
      FractionBox[
       SqrtBox["3"], "2"]}], "}"}]}], ";"}], 
  "                                                                           \
                ", 
  RowBox[{"(*", " ", 
   RowBox[{"Honeycomb", " ", "Bravais", " ", "basis"}], "  ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]x", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SqrtBox["3"]}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "/", 
     SqrtBox["3"]}]}], ";", "      ", 
   RowBox[{"\[Delta]y", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SqrtBox["3"], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "/", 
     SqrtBox["3"]}]}], ";", "        ", 
   RowBox[{"\[Delta]z", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "/", 
     SqrtBox["3"]}]}], ";"}], "   "}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.852875554334752*^9, 3.8528756416630793`*^9}, {
   3.852875707963123*^9, 3.8528757293829327`*^9}, {3.8528838103795214`*^9, 
   3.8528838199064527`*^9}, {3.852891095679292*^9, 3.852891101317895*^9}, 
   3.85291623528564*^9, {3.8530724478837347`*^9, 3.853072467383951*^9}, {
   3.853223823970704*^9, 3.853223825094236*^9}, {3.8532525067709403`*^9, 
   3.8532525210040092`*^9}, {3.8532623077558775`*^9, 3.853262326616273*^9}, 
   3.8618090181133766`*^9, {3.861809058521018*^9, 3.8618093034580317`*^9}, {
   3.8684474692027063`*^9, 3.868447503152372*^9}, {3.8756388207891245`*^9, 
   3.8756388214349976`*^9}, {3.8756388621420355`*^9, 
   3.8756389093536043`*^9}, {3.8774129521164646`*^9, 
   3.8774129645832286`*^9}, {3.877413300921214*^9, 3.877413302630044*^9}, {
   3.877514698765851*^9, 3.8775147145600615`*^9}, {3.877514752094112*^9, 
   3.877514765792674*^9}, {3.877514804203418*^9, 3.8775148687992797`*^9}, {
   3.9025086257772474`*^9, 3.9025086393454986`*^9}, {3.902994582663866*^9, 
   3.902994583879021*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[5]:=",ExpressionUUID->"f0184288-61fc-41cb-a7d0-a5916251704c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"asites", "[", 
    RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"m", " ", "nx"}], "+", 
    RowBox[{"n", " ", "ny"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bsites", "[", 
    RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"m", " ", "nx"}], "+", 
    RowBox[{"n", " ", "ny"}], "-", "\[Delta]z"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]sites", "[", 
    RowBox[{"m_", ",", "n_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"m", " ", "nx"}], "+", 
    RowBox[{"n", " ", "ny"}], "-", 
    RowBox[{"\[Sigma]", " ", "\[Delta]z"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8866569972777066`*^9, 3.886657020522487*^9}, {
  3.9025072828234053`*^9, 3.9025072841056433`*^9}, {3.902944568684369*^9, 
  3.9029445698528204`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[10]:=",ExpressionUUID->"8fec6e4d-3d1c-490b-9399-dea6587b946c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Gmat", "=", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], " ", "]"}], ",", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", "\[ImaginaryI]"}], " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", 
       RowBox[{"PauliMatrix", "[", "3", "]"}]}], " ", "]"}], ",", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", "  ", 
       RowBox[{"PauliMatrix", "[", "1", "]"}]}], " ", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mmat", "=", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "3", "]"}], ",", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], " ", "]"}], ",", 
     RowBox[{"KroneckerProduct", "[", " ", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", 
       RowBox[{"PauliMatrix", "[", "0", "]"}]}], " ", "]"}], ",", 
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "1", "]"}], ",", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], " ", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nmat", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Mmat", "-", "Gmat"}], ")"}], "/", "2"}]}], ";"}]}], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"06a805d6-3f79-43b4-80ea-7075d6508823"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"to\[Lambda]", "[", 
    RowBox[{"h_", ",", 
     RowBox[{"\[CapitalDelta]v_", ":", "0.262"}]}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], ",", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], ",", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "}"}], "/", 
    "\[CapitalDelta]v"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"toKappa", "[", 
    RowBox[{"h_", ",", 
     RowBox[{"\[CapitalDelta]v_", ":", "0.262"}]}], "]"}], ":=", 
   RowBox[{"8", 
    RowBox[{"h", "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{"h", "[", 
     RowBox[{"[", "2", "]"}], "]"}], 
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/", 
     RowBox[{"(", "  ", 
      RowBox[{"3", " ", 
       RowBox[{"\[CapitalDelta]v", "^", "2"}]}], " ", ")"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KappaToH", "[", 
    RowBox[{"\[Kappa]_", ",", "d_", ",", 
     RowBox[{"\[CapitalDelta]v_", ":", "0.262"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"C", "=", 
       RowBox[{
        RowBox[{"d", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"d", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"d", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"C", "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "  ", 
       RowBox[{"d", " ", 
        RowBox[{"CubeRoot", "[", 
         RowBox[{"3", "  ", 
          RowBox[{"\[CapitalDelta]v", "^", "2"}], " ", 
          RowBox[{"\[Kappa]", "/", 
           RowBox[{"(", 
            RowBox[{"8", "C"}], ")"}]}]}], "]"}]}]}], "   ", "]"}]}], "]"}]}],
   " ", ";"}]}], "Input",
 CellChangeTimes->{3.9025074785789137`*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"21eac056-e5f8-4675-b39a-f805e39b0180"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Chi]Gx", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5249", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"\[Chi]Gy", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5249", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"\[Chi]Gz", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5249", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]GA", " ", "=", " ", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Mmat", "[", 
         RowBox[{"[", "\[Gamma]", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]GB", " ", "=", " ", "\[Omega]GA"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Uguess", "=", 
   RowBox[{"-", 
    RowBox[{"{", 
     RowBox[{"\[Chi]Gx", ",", "\[Chi]Gy", ",", "\[Chi]Gz"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vguess", "=", 
   RowBox[{"{", 
    RowBox[{"\[Omega]GA", ",", "\[Omega]GB"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8756389250988274`*^9, 3.8756389252703004`*^9}, {
   3.8866758705491185`*^9, 3.8866758792792473`*^9}, {3.902944517715661*^9, 
   3.902944564543311*^9}, {3.9030110420516634`*^9, 3.9030110529613433`*^9}, {
   3.903011117691017*^9, 3.9030111492883167`*^9}, {3.9030112577853947`*^9, 
   3.903011289845411*^9}, {3.903011670263913*^9, 3.9030116858347235`*^9}, 
   3.903355826831578*^9, 3.903367648748721*^9, 3.9034244147730446`*^9},
 FontFamily->"Consolas",
 CellLabel->"In[19]:=",ExpressionUUID->"196a36d5-1e02-49b5-b928-189dde5ba8b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"to3digits", "[", "list0_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list", "=", "list0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "list"}], ">=", "3"}], ",", " ", "list", ",", 
        " ", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "0", "}"}], ",", "list"}], "}"}], ",", "1"}], 
           "]"}]}], ";", " ", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "list"}], ">=", "3"}], ",", " ", "list", 
           ",", "  ", 
           RowBox[{"list", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "0", "}"}], ",", "list"}], "}"}], ",", "1"}], 
             "]"}]}]}], " ", "]"}]}]}], " ", "]"}], ";", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"ToString", "/@", "list"}], "]"}]}]}], "     ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"round", "[", "x_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"1000000", 
       RowBox[{"(", "x", ")"}]}], "]"}], "/", "1000000"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.88667315304346*^9, 3.8866733181688857`*^9}, {
  3.8866733576133575`*^9, 3.8866733752979927`*^9}, {3.886673930696776*^9, 
  3.8866739736944337`*^9}, {3.9032109302878695`*^9, 3.903210949570772*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"4213a20f-5ad4-4360-b9e0-617c213800cb"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"V", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "  ", "}"}], 
    ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        SuperscriptBox["V", "\[Transpose]"], ".", 
        RowBox[{"Nmat", "[", 
         RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], " ",
   "*)"}]], "Input",
 CellChangeTimes->{{3.9029974694522905`*^9, 3.902997470047105*^9}, {
  3.9029975364226475`*^9, 3.9029975962812414`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"21eb335b-74c5-44fa-a565-e51d1d1ddd5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sumtraceG", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"v", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"traceG", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"v", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "+", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"v", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], "+", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"v", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sumtraceM", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"traceM", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], "+", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sumtraceN", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "+", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
    RowBox[{"v", "\[LeftDoubleBracket]", 
     RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"traceN", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "-", 
      RowBox[{"v", "\[LeftDoubleBracket]", 
       RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"traceUNUN", "[", "u_", "]"}], ":=", 
   RowBox[{"2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}]}]}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}]}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}]}]}]}], "}"}]}], 
     "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9029974844381*^9, 3.902997599336898*^9}, {
   3.9029993204958963`*^9, 3.902999333821406*^9}, 3.9029994165439353`*^9, {
   3.9029995477277527`*^9, 3.902999548326128*^9}, 3.903355782235559*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"f80c03e2-74d5-4097-b8cb-f17bedf7607f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"V", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "  ", "}"}], 
    ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{
         SuperscriptBox["V", "\[Transpose]"], ".", 
         RowBox[{"Nmat", "[", 
          RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", "V", ".", 
         RowBox[{"Nmat", "[", 
          RowBox[{"[", "\[Beta]", "]"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9029993444462724`*^9, 3.90299938863912*^9}, {
   3.902999434381673*^9, 3.902999464009845*^9}, {3.902999520116164*^9, 
   3.9029995371870875`*^9}, 3.902999582552652*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"7a09828d-f575-4237-b329-52ea9ead9bca"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"UpperLeft8x8", "[", "matrice_", "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}]}], " ", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UpperRight8x8", "[", "matrice_", "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
        "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
        "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
        "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
        "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LowerLeft8x8", "[", "matrice_", "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
        "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
        "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
        "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
        "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LowerRight8x8", "[", "matrice_", "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"matrice", "\[LeftDoubleBracket]", 
         RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
     "}"}]}], ";"}], "*)"}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"46817649-1e32-4948-a463-af7375515378"]
}, Closed]],

Cell[CellGroupData[{

Cell["Pure Kitaev model definitions", "Subsection",
 CellChangeTimes->{{3.8707569815383644`*^9, 3.8707569829934263`*^9}, {
  3.9029446078075714`*^9, 3.902944616787716*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"66e2a912-661e-4de4-8c26-c6934170dce4"],

Cell[CellGroupData[{

Cell["file", "Subsubsection",
 CellChangeTimes->{{3.87742012187215*^9, 3.877420123272871*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"aa989c96-8c74-4b4a-9719-0a256d70b608"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"dataToFilePure", "[", " ", 
     RowBox[{
     "parameters_", ",", "L_", ",", "acuracy_", ",", "gauge_", ",", "data_"}],
      "]"}], " ", ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"path", ",", "f"}], "}"}], ",", "\t\t", 
      RowBox[{
       RowBox[{"createDir", "@", 
        RowBox[{"FileNameJoin", "[", "  ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<Files\>\"",
            ",", "\"\<pure\>\"", ",", " ", "gauge"}], "}"}], "]"}]}], " ", 
       ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"path", " ", "=", " ", 
        RowBox[{"toPathPure", "[", 
         RowBox[{"parameters", ",", "L", ",", "acuracy", ",", "gauge"}], 
         "]"}]}], ";", "\t\t", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"OpenWrite", "[", "path", "]"}]}], ";", "\[IndentingNewLine]",
        "\t\t ", 
       RowBox[{"Write", "[", " ", 
        RowBox[{"f", ",", " ", "data"}], "]"}], ";", "\[IndentingNewLine]", 
       "\t\t ", 
       RowBox[{"Close", "[", "f", "]"}], ";"}]}], "                ", "]"}]}],
    ";", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"toPathPure", "[", 
       RowBox[{"\[Kappa]_", ",", "L_", ",", "K_", ",", "gauge_"}], "]"}], ":=",
       "  ", "\[IndentingNewLine]", 
      RowBox[{"FileNameJoin", "[", "  ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<Files\>\"", 
         ",", "\"\<pure\>\"", ",", " ", "gauge", ",", "\"\<data\>\"", ",", 
         " ", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"\"\<K=Z-L=Y-kappa=M.txt\>\"", ",", "     ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Y\>\"", "\[Rule]", " ", 
              RowBox[{"ToString", "[", "L", "]"}]}], ",", " ", 
             RowBox[{"\"\<M\>\"", "->", "  ", 
              RowBox[{"ToString", "@", 
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{"Round", "[", 
                  RowBox[{"10000", "\[Kappa]"}], "]"}], "/", "10000"}], 
                "]"}]}]}], "  ", ",", " ", 
             RowBox[{"\"\<Z\>\"", "\[Rule]", " ", 
              RowBox[{"ToString", "[", "K", "]"}]}]}], "}"}]}], "   ", 
          "]"}]}], " ", "}"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toPathPure", "[", 
     RowBox[{"parameters0_", ",", "L_", ",", "acuracy_", ",", "gauge_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h", " ", ",", "hS", ",", 
        RowBox[{"parameters", "=", "parameters0"}], ",", " ", "r", ",", 
        "\[Phi]", ",", "\[Theta]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"h", "=", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], " ", ";", 
       RowBox[{"hS", "=", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], ";", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "=", "hS"}], 
       ";", "   ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", "       ", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "   ", ",", " ", 
          "\"\<Files\>\"", " ", ",", "\"\<pure\>\"", ",", "gauge", ",", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<X1\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X2\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "10", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X3\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "3"}], "]"}], "]"}], "  ", "]"}]}], ",", 
              RowBox[{"\"\<X4\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ";;", "7"}], "]"}], "]"}], "]"}]}]}], "   ", 
             "}"}]}], "]"}], " ", ",", " ", "\"\<data\>\"", "  ", ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"\"\<h=(M,N,T)_L=Y_A=Z.txt\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Y\>\"", "\[Rule]", " ", 
               RowBox[{"ToString", "[", "L", "]"}]}], ",", " ", 
              RowBox[{"\"\<Z\>\"", "\[Rule]", " ", 
               RowBox[{"ToString", "[", "acuracy", "]"}]}], ",", 
              RowBox[{"\"\<M\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"r", ",", "InputForm"}], "]"}]}], " ", ",", 
              RowBox[{"\"\<N\>\"", "->", 
               RowBox[{"ToString", "@", "\[Phi]"}]}], ",", 
              RowBox[{"\"\<T\>\"", "->", 
               RowBox[{"ToString", "@", "\[Theta]"}]}]}], "}"}]}], "   ", 
           "]"}]}], " ", "\[IndentingNewLine]", "   ", "}"}], "]"}]}]}], 
     "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"loadDataPure", "[", " ", "path_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"(*", 
        RowBox[{"path", ","}], "*)"}], 
       RowBox[{"f", ",", "data"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"path", "=", " ", 
         RowBox[{"toPathPure", "[", 
          RowBox[{"\[Kappa]", ",", "L", ",", "K", ",", "gauge"}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"ReadList", "[", " ", "f", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Close", "[", "f", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}]}], "  ", "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8254288065377936`*^9, 3.825428841713072*^9}, {
   3.8254288747294965`*^9, 3.8254289327034874`*^9}, {3.8254290690244417`*^9, 
   3.825429086830716*^9}, {3.8254292125632935`*^9, 3.8254292153062105`*^9}, 
   3.825432723019988*^9, {3.8254327912552967`*^9, 3.8254327941640835`*^9}, {
   3.825440990645873*^9, 3.825440994901019*^9}, {3.825441345260458*^9, 
   3.8254413466537695`*^9}, {3.8254506418782215`*^9, 3.825450650290518*^9}, {
   3.8529094705191126`*^9, 3.8529094720186415`*^9}, {3.8529095483702064`*^9, 
   3.852909565665416*^9}, {3.8529100872088737`*^9, 3.8529101044886456`*^9}, {
   3.8529101826546993`*^9, 3.852910202458308*^9}, {3.8529102358757887`*^9, 
   3.852910254145278*^9}, {3.8529102940457497`*^9, 3.8529103018660717`*^9}, {
   3.8529104251789255`*^9, 3.8529104549253473`*^9}, {3.852910494328519*^9, 
   3.8529105245381174`*^9}, {3.8529106309948378`*^9, 3.852910651544997*^9}, {
   3.8529107284973173`*^9, 3.852910740886837*^9}, {3.8529107809069815`*^9, 
   3.8529108119113445`*^9}, {3.8529108541822195`*^9, 3.852910856718191*^9}, {
   3.852911119263612*^9, 3.8529111230151443`*^9}, {3.852916225986535*^9, 
   3.852916233148164*^9}, {3.852979650926306*^9, 3.8529796519995484`*^9}, {
   3.8532414494729376`*^9, 3.8532414537045374`*^9}, {3.853260268042261*^9, 
   3.8532602690024405`*^9}, {3.8532603499747133`*^9, 
   3.8532603678235893`*^9}, {3.853349821217956*^9, 3.8533498376884365`*^9}, 
   3.8547828543456783`*^9, 3.854783320313581*^9, {3.8547845534831142`*^9, 
   3.8547845750219774`*^9}, {3.854784619736085*^9, 3.854784626696515*^9}, {
   3.854784725426998*^9, 3.854784780462199*^9}, {3.8547852446459894`*^9, 
   3.854785251104698*^9}, {3.8547854491808615`*^9, 3.8547854526048017`*^9}, {
   3.8547910057811832`*^9, 3.854791009081539*^9}, {3.8547910548772345`*^9, 
   3.854791056931079*^9}, {3.8558411929567842`*^9, 3.855841196611833*^9}, {
   3.861193020602044*^9, 3.861193030883548*^9}, {3.8611930900547967`*^9, 
   3.861193205795993*^9}, 3.8611932648361797`*^9, {3.861193315349481*^9, 
   3.8611933398511276`*^9}, {3.8612000529305067`*^9, 3.861200068056779*^9}, {
   3.8617845376579056`*^9, 3.8617846931129293`*^9}, {3.861990537785631*^9, 
   3.8619905742347116`*^9}, 3.8619912018233023`*^9, {3.861991891824879*^9, 
   3.8619919036598415`*^9}, {3.8619920045658207`*^9, 3.8619920571249347`*^9}, 
   3.8619921109610553`*^9, {3.8619922627760134`*^9, 3.8619922639319153`*^9}, {
   3.8707570031663084`*^9, 3.870757003838168*^9}, {3.8707577719901476`*^9, 
   3.870757814650009*^9}, {3.87075793121721*^9, 3.8707579356736717`*^9}, {
   3.8707704850725055`*^9, 3.87077048522886*^9}, {3.8707705281715193`*^9, 
   3.870770571436262*^9}, 3.870776445075299*^9, {3.870776903341896*^9, 
   3.870776923748447*^9}, {3.8829597232317047`*^9, 3.88295974596167*^9}, 
   3.883733848765046*^9, {3.8933180048306646`*^9, 3.8933180152257133`*^9}, {
   3.8933180942233677`*^9, 3.8933180989522038`*^9}, {3.8933181808053684`*^9, 
   3.8933181882741013`*^9}, {3.8933182229931817`*^9, 3.893318223486579*^9}, 
   3.8933182630526695`*^9, {3.8933182993574038`*^9, 3.8933183407805524`*^9}, {
   3.8933183931911516`*^9, 3.8933184015744143`*^9}, {3.8933187046974554`*^9, 
   3.8933187198398533`*^9}, {3.893387496319642*^9, 3.8933875006442747`*^9}, {
   3.893835697803788*^9, 3.893835697807776*^9}, 3.8938361474724445`*^9, 
   3.8944372476955523`*^9},
 FontFamily->"Consolas",
 CellLabel->"In[36]:=",ExpressionUUID->"0b1d8c6c-3246-4947-8bc0-288b138d209d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dataToFilePure", "[", " ", 
     RowBox[{
     "parameters0_", ",", "L_", ",", "acuracy_", ",", "gauge_", ",", 
      "data_"}], "]"}], " ", ":=", "\n", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"path", ",", 
        RowBox[{"parameters", "=", "parameters0"}], ",", "f"}], "}"}], ",", 
      "\t\t", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"createDir", "@", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Files\>\"", 
            ",", "\"\<pure\>\"", ",", " ", "gauge"}], "}"}], "]"}]}], " ", 
        ";"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "=", "0"}], ";", "\n", 
       RowBox[{"createDir", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Files\>\"", 
           ",", "\"\<pure\>\"", ",", "gauge", ",", " ", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\"", ",", "\n", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<X1\>\"", "->", "  ", 
                RowBox[{"ToString", "[", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", "9", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<X2\>\"", "->", "  ", 
                RowBox[{"ToString", "[", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", "10", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<X3\>\"", "->", "  ", 
                RowBox[{"ToString", "[", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "3"}], "]"}], "]"}], "  ", "]"}]}], ",", 
               RowBox[{"\"\<X4\>\"", "->", "  ", 
                RowBox[{"ToString", "[", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"5", ";;", "7"}], "]"}], "]"}], "]"}]}]}], "   ", 
              "}"}]}], "]"}]}], "\n", "           ", "}"}], "]"}]}], " ", ";",
        "\n", "\t\t", 
       RowBox[{"path", " ", "=", " ", 
        RowBox[{"toPathPure", "[", 
         RowBox[{"parameters", ",", "L", ",", "acuracy", ",", "gauge"}], 
         "]"}]}], ";", "\t\t", "\n", "\t\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Pure path=\>\"", ",", "path"}], "]"}], ";", 
       RowBox[{"Print", "[", "]"}], ";", "\n", "\t\t", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"OpenWrite", "[", "path", "]"}]}], ";", "\n", "\t\t ", 
       RowBox[{"Write", "[", " ", 
        RowBox[{"f", ",", " ", "data"}], "]"}], ";", "\n", "\t\t ", 
       RowBox[{"Close", "[", "f", "]"}], ";"}]}], "                ", "]"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"toPathPure", "[", 
     RowBox[{"parameters0_", ",", "L_", ",", "acuracy_", ",", "gauge_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h", " ", ",", "hS", ",", 
        RowBox[{"parameters", "=", "parameters0"}], ",", " ", "r", ",", 
        "\[Phi]", ",", "\[Theta]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"h", "=", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], " ", ";", 
       RowBox[{"hS", "=", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], ";", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "=", "hS"}], 
       ";", "   ", "\n", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "=", "0"}], ";", "\n", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<Files\>\"", 
          " ", ",", "\"\<pure\>\"", ",", "gauge", ",", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\"", ",", "\n", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<X1\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X2\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "10", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X3\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "3"}], "]"}], "]"}], "  ", "]"}]}], ",", 
              "\n", 
              RowBox[{"\"\<X4\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ";;", "7"}], "]"}], "]"}], "]"}]}]}], "   ", 
             "}"}]}], "]"}], " ", ",", " ", "\"\<data\>\"", "  ", ",", " ", 
          "\n", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"\"\<h=(M,N,T)_L=Y_A=Z.txt\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Y\>\"", "->", " ", 
               RowBox[{"ToString", "[", "L", "]"}]}], ",", " ", 
              RowBox[{"\"\<Z\>\"", "->", " ", 
               RowBox[{"ToString", "[", "acuracy", "]"}]}], ",", 
              RowBox[{"\"\<M\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"r", ",", "InputForm"}], "]"}]}], " ", ",", 
              RowBox[{"\"\<N\>\"", "->", 
               RowBox[{"ToString", "@", "\[Phi]"}]}], ",", 
              RowBox[{"\"\<T\>\"", "->", 
               RowBox[{"ToString", "@", "\[Theta]"}]}]}], "}"}]}], "   ", 
           "]"}]}], " ", "\n", "   ", "}"}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"loadDataPure", "[", "path_", "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "data"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"f", "==", "$Failed"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Failed to OpenRead file at: \>\"", "]"}], 
         ";", " ", 
         RowBox[{"Print", "[", " ", "path", " ", "]"}], ";", " ", 
         RowBox[{"Abort", "[", "]"}]}]}], " ", "]"}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{"ReadList", "[", "f", "]"}]}], ";", "\n", 
      RowBox[{"Close", "[", "f", "]"}], ";", "\t\t\t", "\n", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"createDir", "[", "path_", "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"FileNames", "[", "path", "]"}]}]}], "}"}], ",", "\t\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"l", "\[Equal]", "0"}], ",", "  ", 
       RowBox[{
        RowBox[{"CreateDirectory", "@", 
         RowBox[{"File", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", "\"\<data\>\""}], " ", "}"}], "]"}]}]}], ";",
         " ", 
        RowBox[{"CreateDirectory", "@", 
         RowBox[{"File", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", " ", ",", "\"\<graph\>\""}], " ", "}"}], 
           "]"}]}]}], ";"}], " ", "\[IndentingNewLine]", ",", "Null"}], 
      "]"}]}], "  ", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.8933922359595656`*^9, 3.8933922918200893`*^9}, {
   3.893393019868514*^9, 3.8933930203215427`*^9}, {3.8933930561733446`*^9, 
   3.8933930881579976`*^9}, {3.8933931954297695`*^9, 
   3.8933933091509676`*^9}, {3.893835519728897*^9, 3.8938355783647785`*^9}, {
   3.893835697841716*^9, 3.8938356978477345`*^9}, {3.8944373442244453`*^9, 
   3.8944373573383036`*^9}, {3.894437408394402*^9, 3.8944374113641896`*^9}, 
   3.894437546900584*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"544e050b-fff5-4e7c-b801-a70379cac8d6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auxiliary matrices for the Hamiltonian  [2x2 matrices]", "Subsubsection",
 CellChangeTimes->{{3.85287578110361*^9, 3.8528758327496805`*^9}, {
  3.864820309629444*^9, 3.8648203109406557`*^9}},
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Bold",ExpressionUUID->"481ccb27-4efa-4a1b-b0a1-433a3d45e603"],

Cell[TextData[{
 "we define Z2 gauge field u[r] for each unit cell r as a three component \
vector which each component correspond \[Alpha] to the gauge field in the \
\[Alpha] bond for the",
 StyleBox[" A site",
  FontWeight->"Bold"],
 " in the unit cell r."
}], "Text",
 CellChangeTimes->{{3.855728826948078*^9, 3.8557289259519978`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"bda26fb8-b683-40a3-91c8-d47e91676755"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toR", "[", 
    RowBox[{"m0_", ",", "n0_", ",", "L_", ",", "M_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]n", "=", 
        RowBox[{"\[LeftFloor]", 
         FractionBox["n0", "L"], "\[RightFloor]"}]}], ",", "n", ",", "m"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{"n0", " ", ",", "L"}], "]"}]}], ";", " ", 
      RowBox[{"m", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"m0", "+", 
          RowBox[{"M", " ", "\[CapitalDelta]n"}]}], ",", "L"}], "]"}]}], ";", 
      " ", 
      RowBox[{"m", " ", "+", " ", 
       RowBox[{"n", " ", "L"}], "+", "1"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8557274589179*^9, 3.85572747382506*^9}, {
   3.8557275064828796`*^9, 3.855727515632272*^9}, {3.8557299396143484`*^9, 
   3.855729941186406*^9}, {3.855732405649863*^9, 3.855732522469389*^9}, {
   3.855732567906459*^9, 3.8557325868336535`*^9}, {3.8557330023839936`*^9, 
   3.855733129420061*^9}, {3.8557332510251293`*^9, 3.8557332554621067`*^9}, {
   3.855751327260338*^9, 3.855751360666909*^9}, {3.85575140193087*^9, 
   3.8557514068373327`*^9}, {3.8557514409604826`*^9, 3.855751471890725*^9}, 
   3.8557559153753133`*^9, {3.861790114478228*^9, 3.861790126289379*^9}, {
   3.8709477736359825`*^9, 3.8709477788211184`*^9}, {3.8774137290539703`*^9, 
   3.8774137295918627`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[41]:=",ExpressionUUID->"ea9fb8b5-cc52-4ef5-bb6f-3d99c940eda0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HNN", "[", 
     RowBox[{
     "K_", ",", "\[Kappa]_", ",", "\[Lambda]_", ",", "u_", ",", "m_", ",", 
      "n_", ",", "L_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", "=", 
        RowBox[{"toR", "[", 
         RowBox[{"m", ",", "n", " ", ",", "L", ",", "M"}], "]"}]}], "}"}], 
      ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"K", "\[LeftDoubleBracket]", 
                 RowBox[{"r", ",", "\[Alpha]"}], "\[RightDoubleBracket]"}]}], 
               "+", 
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], ")"}], " ", 
             RowBox[{"u", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "\[Alpha]"}], "\[RightDoubleBracket]"}]}]}], 
           " ", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HNNNA", "[", 
    RowBox[{
    "K_", ",", "\[Kappa]_", ",", "\[Lambda]_", ",", "u_", ",", "m_", ",", 
     "n_", ",", "L_", ",", "M_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"toR", "[", 
           RowBox[{"m", ",", "n", " ", ",", "L", ",", "M"}], "]"}], ",", 
          RowBox[{"toR", "[", 
           RowBox[{"m", ",", "n", " ", ",", "L", ",", "M"}], "]"}], ",", 
          RowBox[{"toR", "[", 
           RowBox[{"m", ",", "n", ",", "L", ",", "M"}], "]"}]}], "}"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"r2", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"toR", "[", 
           RowBox[{
            RowBox[{"m", "+", "1"}], ",", 
            RowBox[{"n", "-", "1"}], " ", ",", "L", ",", "M"}], "]"}], ",", 
          RowBox[{"toR", "[", 
           RowBox[{"m", ",", 
            RowBox[{"n", "+", "1"}], " ", ",", "L", ",", "M"}], "]"}], ",", 
          RowBox[{"toR", "[", 
           RowBox[{
            RowBox[{"m", "-", "1"}], ",", "n", ",", "L", ",", "M"}], "]"}]}], 
         "}"}]}]}], "        ", "}"}], "      ", ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Kappa]", " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"r1", "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "\[Alpha]"}], 
              "]"}], "]"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"r2", "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", "1"}], ",", "3", ",", "1"}], 
                "]"}]}], " ", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], " ", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HNNNB", "[", 
     RowBox[{
     "K_", ",", "\[Kappa]_", ",", "\[Lambda]_", ",", "u_", ",", "m_", ",", 
      "n_", ",", "L_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"toR", "[", 
            RowBox[{
             RowBox[{"m", "-", "1"}], ",", "n", " ", ",", "L", ",", "M"}], 
            "]"}], ",", 
           RowBox[{"toR", "[", 
            RowBox[{"m", ",", 
             RowBox[{"n", " ", "-", "1"}], ",", "L", ",", "M"}], "]"}], ",", 
           RowBox[{"toR", "[", 
            RowBox[{"m", ",", "n", ",", "L", ",", "M"}], "]"}]}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"r2", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"toR", "[", 
            RowBox[{
             RowBox[{"m", "-", "1"}], ",", "n", " ", ",", "L", ",", "M"}], 
            "]"}], ",", 
           RowBox[{"toR", "[", 
            RowBox[{"m", ",", 
             RowBox[{"n", "-", "1"}], " ", ",", "L", ",", "M"}], "]"}], ",", 
           RowBox[{"toR", "[", 
            RowBox[{"m", ",", "n", ",", "L", ",", "M"}], "]"}]}], "}"}]}]}], 
       "        ", "}"}], "      ", ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"\[Kappa]", " ", 
             RowBox[{"u", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"r1", "[", 
                 RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "\[Alpha]"}], 
               "]"}], "]"}], " ", 
             RowBox[{"u", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"r2", "[", 
                 RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"\[Alpha]", "+", "1"}], ",", "3", ",", "1"}], 
                 "]"}]}], " ", "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\t\t\t\t\t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Hreal", "[", 
     RowBox[{
     "K_", ",", "\[Kappa]_", ",", "\[Lambda]_", ",", "u_", ",", "L_", ",", 
      "M_", ",", "\[Delta]k_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nc", "=", 
         SuperscriptBox["L", "2"]}], ",", "H"}], " ", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"H", "=", " ", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Hnn", ",", "HnnnA", ",", "HnnnB", ",", " ", 
               RowBox[{"\[CurlyPhi]", "=", 
                RowBox[{"\[Delta]k", ".", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"m", " ", "nx"}], "+", 
                   RowBox[{"n", " ", "ny"}]}], ")"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"r", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n", " ", ",", "L", ",", 
                    "M"}], "]"}], ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{"m", ",", "n", " ", ",", "L", ",", "M"}], "]"}]}], 
                 "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"RA", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", 
                    RowBox[{"n", "-", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "-", "1"}], ",", "n", ",", "L", ",", "M"}], 
                   "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"RB", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "-", "1"}], ",", 
                    RowBox[{"n", "+", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "-", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n", ",", "L", ",", "M"}], 
                   "]"}]}], "}"}]}]}], "    ", "}"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Hnn", "=", 
               RowBox[{"HNN", "[", 
                RowBox[{
                "K", ",", "\[Kappa]", ",", "\[Lambda]", ",", "u", ",", "m", 
                 ",", "n", ",", "L", ",", "M"}], "]"}]}], " ", ";", 
              RowBox[{"HnnnA", "=", 
               RowBox[{"HNNNA", "[", 
                RowBox[{
                "K", ",", "\[Kappa]", ",", "\[Lambda]", ",", "u", ",", "m", 
                 ",", "n", ",", "L", ",", "M"}], "]"}]}], " ", ";", 
              RowBox[{"HnnnB", "=", 
               RowBox[{"HNNNB", "[", 
                RowBox[{
                "K", ",", "\[Kappa]", ",", "\[Lambda]", ",", "u", ",", "m", 
                 ",", "n", ",", "L", ",", "M"}], "]"}]}], " ", ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Sum", "[", "       ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KroneckerProduct", "[", " ", 
                   RowBox[{
                    RowBox[{"one", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "Nc"}], "]"}],
                     ",", 
                    RowBox[{"Hnn", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "   ", 
                  "+", "\[IndentingNewLine]", 
                  RowBox[{"KroneckerProduct", "[", " ", 
                   RowBox[{
                    RowBox[{"one", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"RA", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "Nc"}], "]"}],
                     ",", 
                    RowBox[{"HnnnA", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "   ", 
                  "+", "\[IndentingNewLine]", 
                  RowBox[{"KroneckerProduct", "[", " ", 
                   RowBox[{
                    RowBox[{"one", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"RB", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "Nc"}], "]"}],
                     ",", 
                    RowBox[{"HnnnB", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}]}], "   ", 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}], 
               " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}], "]"}]}]}]}], 
            "      ", "]"}], " ", "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
       RowBox[{"H", "+", 
        RowBox[{"H", "\[ConjugateTranspose]"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TmatPure", "[", "L_", "]"}], " ", ":=", 
   RowBox[{"KroneckerProduct", "[", "   ", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", 
      SuperscriptBox["L", "2"], "]"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[ImaginaryI]", ",", 
         RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}], "}"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UmatPure", "[", "H_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{"Eigensystem", "@", 
         RowBox[{"N", "[", "H", "]"}]}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ReverseSort", "[", 
         RowBox[{"R", "\[Transpose]"}], "]"}], "\[Transpose]"}], 
       "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "\[Transpose]"}]}], " ", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EandUPure", "[", "H_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"ReverseSort", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Quiet", "@", 
           RowBox[{"Eigensystem", "@", 
            RowBox[{"N", "[", "H", "]"}]}]}]}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"R", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Transpose]"}]}], " ", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[DoubleStruckCapitalU]occupiedPure", "[", 
     RowBox[{"TU_", ",", "Nc_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{
         RowBox[{"TU", "\[Transpose]"}], ",", 
         RowBox[{
          RowBox[{"-", "Nc"}], "-", "1"}]}], "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Transpose]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"correlations", "[", 
     RowBox[{"U_", ",", "u_", ",", "L_", ",", "M_"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", "  ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Nc", "=", 
         SuperscriptBox["L", "2"]}], ",", "\[DoubleStruckCapitalU]", ",", 
        "\[DoubleStruckCapitalU]h", ",", "icc", ",", "SS"}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[DoubleStruckCapitalU]", "=", 
        RowBox[{
         RowBox[{"TmatPure", "[", "L", "]"}], ".", "U"}]}], ";", 
       RowBox[{"\[DoubleStruckCapitalU]h", "=", 
        RowBox[{"\[DoubleStruckCapitalU]", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", 
           RowBox[{
            RowBox[{"-", "Nc"}], ";;", 
            RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", 
       RowBox[{"icc", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{"\[ImaginaryI]", "  ", 
          RowBox[{"\[DoubleStruckCapitalU]h", ".", 
           RowBox[{"\[DoubleStruckCapitalU]h", "\[ConjugateTranspose]"}]}]}], 
         " ", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SS", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"2", "rz"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", " ", "+", 
                  RowBox[{"2", "rz"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], " ", 
               RowBox[{"icc", "[", 
                RowBox[{"[", 
                 RowBox[{"J", ",", "Io"}], "]"}], "]"}]}]}]}], "    ", "]"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", "L"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "L"}], "}"}], ",", " ", " ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SS", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "rx", ",", "mx", ",", "Io", ",", "J"}], 
              "}"}], ",", 
             RowBox[{
              RowBox[{"mx", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ",", "L", ",", "1"}], "]"}]}], ";", 
              " ", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              RowBox[{"rx", "=", 
               RowBox[{"mx", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"2", "rz"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"2", "rx"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"icc", "[", 
               RowBox[{"[", 
                RowBox[{"J", ",", "Io"}], "]"}], "]"}]}]}], "  ", "    ", 
            "]"}], "   ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", "L"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "L"}], "}"}], ",", " ", " ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SS", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
              "rz", ",", "ry", ",", "my", ",", "ny", ",", "Io", ",", "J"}], 
              "}"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ny", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ",", "L", ",", "1"}], "]"}]}], ";", 
              RowBox[{"my", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"ny", "==", "1"}], ",", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"m", "-", "M"}], ",", "L", ",", "1"}], "]"}], " ", 
                 ",", " ", "m"}], "]"}]}], ";", "  ", 
              RowBox[{"ry", "=", 
               RowBox[{"my", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ny", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"2", "rz"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"2", "ry"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"icc", "[", 
               RowBox[{"[", 
                RowBox[{"J", ",", "Io"}], "]"}], "]"}]}]}], "  ", "  ", "]"}],
            "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", "L"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "L"}], "}"}], ",", " ", " ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", "SS"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8528758449600377`*^9, 3.852875851317932*^9}, {
   3.852875904853912*^9, 3.852875915503503*^9}, {3.8528761464601192`*^9, 
   3.8528761497601175`*^9}, {3.8528762152352686`*^9, 3.852876486873237*^9}, {
   3.852876517382826*^9, 3.8528765488237467`*^9}, {3.852876617691535*^9, 
   3.852876630773582*^9}, {3.852876681275669*^9, 3.852876683033943*^9}, {
   3.852876752290346*^9, 3.8528768321083784`*^9}, {3.852877583739396*^9, 
   3.8528776297643785`*^9}, 3.852878485471594*^9, {3.8528786358334894`*^9, 
   3.8528787210650144`*^9}, {3.852878759192633*^9, 3.852878768598241*^9}, 
   3.8528790483123007`*^9, {3.8528791363713408`*^9, 3.8528791461974735`*^9}, {
   3.8528816239160953`*^9, 3.852881729212538*^9}, {3.852881882837495*^9, 
   3.8528819263157663`*^9}, {3.8528822816250267`*^9, 3.852882326210932*^9}, {
   3.85288309701149*^9, 3.852883119871728*^9}, {3.852883434648644*^9, 
   3.852883436345559*^9}, {3.852883636444565*^9, 3.8528836619774866`*^9}, {
   3.852883732505681*^9, 3.852883791490629*^9}, 3.852883866665865*^9, {
   3.852884274145113*^9, 3.852884274640607*^9}, {3.8528849750242677`*^9, 
   3.852885003583339*^9}, {3.852885726364476*^9, 3.852885729336274*^9}, {
   3.852885985896722*^9, 3.8528859869295225`*^9}, {3.8528863866837935`*^9, 
   3.852886387274601*^9}, {3.8528868590918474`*^9, 3.852886862581946*^9}, {
   3.8528880737000465`*^9, 3.852888202804117*^9}, {3.8528901767144485`*^9, 
   3.852890184256923*^9}, {3.8528910619601126`*^9, 3.8528910673569593`*^9}, {
   3.8528911862507696`*^9, 3.852891188182824*^9}, {3.852923886080432*^9, 
   3.852923890271291*^9}, {3.852925801914589*^9, 3.8529258035812016`*^9}, {
   3.8530724404028645`*^9, 3.853072440655604*^9}, {3.853072477405422*^9, 
   3.853072494372284*^9}, {3.853072576917039*^9, 3.8530725802889585`*^9}, {
   3.853076926184968*^9, 3.8530769266382856`*^9}, {3.8530780636922255`*^9, 
   3.8530780700651655`*^9}, 3.8530781028725114`*^9, {3.8530782971242743`*^9, 
   3.853078340788065*^9}, 3.853078378753234*^9, {3.853078428795388*^9, 
   3.853078495453339*^9}, {3.853078531723461*^9, 3.85307866677022*^9}, {
   3.8530787191062756`*^9, 3.853078737601467*^9}, {3.8530791415812216`*^9, 
   3.8530791475541053`*^9}, {3.85307945238385*^9, 3.853079468494498*^9}, {
   3.85308055640246*^9, 3.853080561337586*^9}, {3.8530971425072594`*^9, 
   3.853097145604178*^9}, {3.8531415868139057`*^9, 3.8531416025694733`*^9}, {
   3.8531416870211706`*^9, 3.8531417227669353`*^9}, {3.853143708650571*^9, 
   3.8531437141748314`*^9}, {3.853144193392844*^9, 3.8531442238434987`*^9}, {
   3.853144268092826*^9, 3.853144270822891*^9}, {3.8531450336257677`*^9, 
   3.853145083877353*^9}, 3.8531451154202566`*^9, 3.8531452841420984`*^9, {
   3.8531486180825777`*^9, 3.853148627055408*^9}, {3.853223677930112*^9, 
   3.8532237646175203`*^9}, 3.8532238455749087`*^9, {3.853243460670273*^9, 
   3.853243464495823*^9}, {3.8532436975202584`*^9, 3.853243712101506*^9}, {
   3.853243747139862*^9, 3.8532437514909477`*^9}, {3.853243888726163*^9, 
   3.8532438937947392`*^9}, {3.853245278795165*^9, 3.853245282558984*^9}, {
   3.8532453949863462`*^9, 3.8532454024552493`*^9}, {3.853247276397146*^9, 
   3.8532472853377967`*^9}, {3.8532600359333797`*^9, 3.85326018260196*^9}, {
   3.853260961714988*^9, 3.8532609635717797`*^9}, {3.8532609971748533`*^9, 
   3.8532610070121326`*^9}, {3.8532611752260156`*^9, 
   3.8532612442596474`*^9}, {3.853310277441637*^9, 3.853310347228627*^9}, {
   3.8533106746503196`*^9, 3.853310674905801*^9}, {3.853310796841713*^9, 
   3.853310801416527*^9}, {3.8533112015235786`*^9, 3.8533112776992483`*^9}, {
   3.8533113847401357`*^9, 3.8533114181155763`*^9}, {3.8533114953673553`*^9, 
   3.853311532373185*^9}, {3.8533116240812445`*^9, 3.853311640341432*^9}, 
   3.8533117420422497`*^9, {3.853315421239539*^9, 3.853315438053417*^9}, {
   3.8533154915893583`*^9, 3.853315519459155*^9}, {3.8533168513733253`*^9, 
   3.8533168604336987`*^9}, {3.8533196752849383`*^9, 3.85331978595446*^9}, {
   3.8533203282983627`*^9, 3.853320358086738*^9}, {3.8533262578399696`*^9, 
   3.8533262772945127`*^9}, 3.8533499437574263`*^9, {3.8536082712806854`*^9, 
   3.8536083712295647`*^9}, {3.8536106320320024`*^9, 
   3.8536106342209206`*^9}, {3.853610715955882*^9, 3.8536107573404007`*^9}, {
   3.8536111255464272`*^9, 3.8536111408185387`*^9}, {3.853611675853198*^9, 
   3.8536116916029596`*^9}, {3.8536119114008026`*^9, 3.853611928020993*^9}, {
   3.8536120984219313`*^9, 3.8536121113802576`*^9}, {3.8536135117562547`*^9, 
   3.8536135173662744`*^9}, {3.8536135660560923`*^9, 
   3.8536135949459777`*^9}, {3.8536142062125597`*^9, 3.853614210247241*^9}, 
   3.8536148282202673`*^9, {3.8536148718387394`*^9, 3.853614911454711*^9}, {
   3.8536156471973243`*^9, 3.8536157434622383`*^9}, {3.8536157974475203`*^9, 
   3.853615804124118*^9}, {3.8536158491983356`*^9, 3.8536158511320553`*^9}, {
   3.8536163747420654`*^9, 3.8536163767060027`*^9}, {3.8544484272733793`*^9, 
   3.8544484454237475`*^9}, {3.854448639692511*^9, 3.8544486430773993`*^9}, {
   3.8544487868867416`*^9, 3.8544487932276707`*^9}, {3.8544496767480435`*^9, 
   3.8544498081796846`*^9}, 3.8545155505665965`*^9, {3.8545163302189655`*^9, 
   3.854516372584405*^9}, 3.8545260811447535`*^9, {3.8545267891556215`*^9, 
   3.854526800523856*^9}, {3.854526854326292*^9, 3.8545268603395433`*^9}, {
   3.854791157073604*^9, 3.854791237469392*^9}, {3.8547915849928074`*^9, 
   3.854791773020918*^9}, {3.854805553117719*^9, 3.854805820402554*^9}, {
   3.8548058508539715`*^9, 3.8548061038594112`*^9}, {3.8548063786944485`*^9, 
   3.854806426695154*^9}, {3.8548080939663086`*^9, 3.8548081677669125`*^9}, {
   3.8548081983664722`*^9, 3.854808537433962*^9}, {3.854869287024946*^9, 
   3.8548693173192434`*^9}, {3.8548694113351603`*^9, 3.854869413317813*^9}, 
   3.854869453816128*^9, {3.854873268317705*^9, 3.85487326926128*^9}, 
   3.855492722611916*^9, {3.855496767119727*^9, 3.855496867621081*^9}, {
   3.8554969289407053`*^9, 3.8554970131338167`*^9}, {3.855497357655508*^9, 
   3.8554974082517815`*^9}, {3.855726089402378*^9, 3.8557261773450117`*^9}, {
   3.855726280545883*^9, 3.855726393079608*^9}, {3.8557267779669547`*^9, 
   3.85572678240956*^9}, {3.8557269298934193`*^9, 3.8557269982319884`*^9}, {
   3.855727068060168*^9, 3.855727094112295*^9}, {3.8557272006619787`*^9, 
   3.855727226761417*^9}, {3.8557272883380117`*^9, 3.8557272908420153`*^9}, 
   3.855727329180155*^9, {3.8557274196183577`*^9, 3.855727455720439*^9}, {
   3.8557275240201054`*^9, 3.855727543834139*^9}, {3.855727593278549*^9, 
   3.855727751786045*^9}, {3.855727784185049*^9, 3.85572781914747*^9}, {
   3.8557278956347613`*^9, 3.8557279523934946`*^9}, {3.85572803222721*^9, 
   3.8557280343580017`*^9}, {3.8557280838258805`*^9, 3.855728168293166*^9}, {
   3.8557282883409643`*^9, 3.855728306717916*^9}, {3.855728351807845*^9, 
   3.855728384313888*^9}, {3.8557284214965277`*^9, 3.855728421766863*^9}, {
   3.855728532755906*^9, 3.8557285368346615`*^9}, {3.855728569055975*^9, 
   3.8557286032384768`*^9}, {3.8557286578088694`*^9, 
   3.8557287178416405`*^9}, {3.855729147180728*^9, 3.855729203041545*^9}, {
   3.8557294802207375`*^9, 3.855729603367707*^9}, {3.8557299234607573`*^9, 
   3.855729980733724*^9}, {3.8557300253874655`*^9, 3.8557300673309755`*^9}, {
   3.8557315364422207`*^9, 3.8557315380481052`*^9}, {3.855732779829007*^9, 
   3.8557328122966075`*^9}, {3.855733340308092*^9, 3.8557333872423*^9}, {
   3.8557509008442984`*^9, 3.855750911913181*^9}, {3.855751627448631*^9, 
   3.855751643796854*^9}, {3.855753148079071*^9, 3.8557532019313245`*^9}, {
   3.855755375484496*^9, 3.8557555471270475`*^9}, {3.8557556700513773`*^9, 
   3.855755724455683*^9}, {3.8557560037741895`*^9, 3.855756004376707*^9}, {
   3.8557560529602757`*^9, 3.8557561224266615`*^9}, {3.8557561999173203`*^9, 
   3.855756201294737*^9}, {3.8557563471422462`*^9, 3.855756348295101*^9}, 
   3.85575667321168*^9, {3.8557568468126864`*^9, 3.855756909328105*^9}, {
   3.8557570106107273`*^9, 3.8557570787549953`*^9}, {3.855757170148386*^9, 
   3.8557571995801396`*^9}, {3.8557572643042603`*^9, 
   3.8557574019617014`*^9}, {3.855757572326028*^9, 3.8557575762151814`*^9}, {
   3.8557578357467976`*^9, 3.8557578584722786`*^9}, {3.8557579192527246`*^9, 
   3.8557579812620935`*^9}, {3.8557581255035133`*^9, 
   3.8557581420339108`*^9}, {3.8557583741287575`*^9, 
   3.8557583988218994`*^9}, {3.855758536313141*^9, 3.855758643140071*^9}, {
   3.855758684212161*^9, 3.855758686461157*^9}, {3.8557587338471384`*^9, 
   3.855758775471654*^9}, {3.8557589354346504`*^9, 3.855758969046561*^9}, 
   3.855759042142415*^9, {3.8557592138021197`*^9, 3.855759222395499*^9}, {
   3.8557592765920677`*^9, 3.855759308107052*^9}, {3.855759365045355*^9, 
   3.855759366664935*^9}, {3.855759682837141*^9, 3.85575974756188*^9}, {
   3.855759780666892*^9, 3.855759807742917*^9}, {3.855759848857659*^9, 
   3.8557598968748546`*^9}, {3.8557603267908945`*^9, 3.855760328427106*^9}, {
   3.855760361664936*^9, 3.855760380731134*^9}, 3.855760489511751*^9, 
   3.8557605492570825`*^9, {3.855761644937914*^9, 3.8557616535908546`*^9}, {
   3.8557620585952926`*^9, 3.855762069483996*^9}, {3.8557631701741657`*^9, 
   3.8557631734884653`*^9}, {3.8557693004330764`*^9, 3.855769312237853*^9}, {
   3.861182458480302*^9, 3.8611825918601675`*^9}, {3.861182639855942*^9, 
   3.8611827003579526`*^9}, {3.861183162621685*^9, 3.8611831634342365`*^9}, {
   3.8611851664009857`*^9, 3.8611851671659327`*^9}, {3.8611851996759024`*^9, 
   3.8611852144823637`*^9}, {3.8611852580621195`*^9, 3.861185346789046*^9}, {
   3.8611853850319743`*^9, 3.8611853863825407`*^9}, {3.861186044171493*^9, 
   3.861186046397727*^9}, {3.861186948381232*^9, 3.86118694967027*^9}, {
   3.8611873577076735`*^9, 3.861187360381447*^9}, {3.861187404669917*^9, 
   3.8611874161382866`*^9}, {3.8611877409275723`*^9, 
   3.8611878252366333`*^9}, {3.861187884501717*^9, 3.861187919693507*^9}, {
   3.861187964963818*^9, 3.8611879759209213`*^9}, {3.8611882589470177`*^9, 
   3.8611882628670435`*^9}, {3.8611883371373034`*^9, 3.861188373607299*^9}, {
   3.8611886381176524`*^9, 3.8611886387469697`*^9}, {3.861189071987913*^9, 
   3.8611890839132247`*^9}, {3.861189115326182*^9, 3.861189120430971*^9}, {
   3.861189255342099*^9, 3.86118928700307*^9}, {3.8611928626530457`*^9, 
   3.861192874103575*^9}, {3.8617871103770833`*^9, 3.8617871109391007`*^9}, {
   3.86178718831822*^9, 3.8617871891947803`*^9}, {3.8617874566341743`*^9, 
   3.8617876167022963`*^9}, {3.8617884260755596`*^9, 
   3.8617884833155518`*^9}, {3.861788729466521*^9, 3.8617887329076047`*^9}, {
   3.8617889088790627`*^9, 3.8617889091937447`*^9}, {3.8617889966968484`*^9, 
   3.8617889970359497`*^9}, {3.8617890704539914`*^9, 
   3.8617890992575116`*^9}, {3.861789140744379*^9, 3.8617891578421555`*^9}, {
   3.861789229197182*^9, 3.8617892460443764`*^9}, {3.8617893629334316`*^9, 
   3.8617893798504667`*^9}, {3.861789492869958*^9, 3.861789493970908*^9}, {
   3.8617902731047697`*^9, 3.8617903156528425`*^9}, {3.8617903926303277`*^9, 
   3.8617903933225203`*^9}, {3.8617908978248315`*^9, 3.861790905248172*^9}, {
   3.861791017886675*^9, 3.8617910382265587`*^9}, {3.861791095802981*^9, 
   3.8617911090091047`*^9}, 3.861792287025064*^9, {3.861792333915367*^9, 
   3.861792360355414*^9}, {3.8617925475487537`*^9, 3.86179255108071*^9}, 
   3.861989772138296*^9, {3.8685297418237967`*^9, 3.8685297541300707`*^9}, 
   3.868529787490057*^9, {3.870773784975574*^9, 3.870773810346074*^9}, {
   3.8707744346649723`*^9, 3.870774447209771*^9}, {3.870947771334036*^9, 
   3.87094779374683*^9}, {3.8709478332674356`*^9, 3.870947896206917*^9}, {
   3.8709480545854483`*^9, 3.870948076870053*^9}, {3.8709486630946693`*^9, 
   3.8709487204458914`*^9}, 3.870951826645936*^9, 3.8709519905063725`*^9, {
   3.8709522020005245`*^9, 3.870952240875334*^9}, {3.870952350455531*^9, 
   3.8709523542858553`*^9}, {3.872588984471874*^9, 3.8725890430175934`*^9}, 
   3.876563562792527*^9, {3.877413709544568*^9, 3.877413732433918*^9}, {
   3.877420084938509*^9, 3.877420091124686*^9}, 3.8818319490401535`*^9},
 FontFamily->"Consolas",
 FontSize->12,
 CellLabel->"In[42]:=",ExpressionUUID->"f2915dff-fb33-4ed6-9988-91bfa27f058b"]
}, Closed]],

Cell[CellGroupData[{

Cell["to MF pure + gauge", "Subsubsection",
 CellChangeTimes->{{3.8818319546363163`*^9, 3.8818319571784873`*^9}, {
  3.9025075997447543`*^9, 3.9025076016772747`*^9}},
 FontWeight->"Bold",ExpressionUUID->"34dac328-f6f0-43f0-aee3-cb143d586447"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toMFparametersPure", "[", 
    RowBox[{"U_", ",", "u_", ",", "L_", ",", "M_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", "  ", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"Nc", "=", 
        SuperscriptBox["L", "2"]}], ",", "\[DoubleStruckCapitalU]", ",", 
       "\[DoubleStruckCapitalU]h", ",", "icc", ",", 
       RowBox[{"SS", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"Null", ",", "3"}], "]"}]}]}], "  ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[DoubleStruckCapitalU]", "=", 
       RowBox[{
        RowBox[{"TmatPure", "[", "L", "]"}], ".", "U"}]}], ";", 
      RowBox[{"\[DoubleStruckCapitalU]h", "=", 
       RowBox[{"\[DoubleStruckCapitalU]", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", 
          RowBox[{
           RowBox[{"-", "Nc"}], ";;", 
           RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", 
      RowBox[{"icc", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"\[ImaginaryI]", "  ", 
         RowBox[{"\[DoubleStruckCapitalU]h", ".", 
          RowBox[{"\[DoubleStruckCapitalU]h", "\[ConjugateTranspose]"}]}]}], 
        " ", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SS", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayFlatten", "[", " ", 
          RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
        RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", " ", 
             RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
            RowBox[{
             RowBox[{"rz", "=", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", "L"}]}]}], ";", " ", 
             RowBox[{"Io", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"2", "rz"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"J", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", " ", "+", " ", "1", " ", "+", 
                 RowBox[{"2", "rz"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "   ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"u", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], ",", "3"}], "]"}], "]"}]}], " ",
                   " ", 
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], "-", 
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}], 
                 ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", 
                 RowBox[{"-", "1"}]}], " ", "}"}]}], "}"}]}]}], "    ", "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}], " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SS", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayFlatten", "[", " ", 
          RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", " ", 
             RowBox[{"rz", ",", "rx", ",", "mx", ",", "Io", ",", "J"}], "}"}],
             ",", 
            RowBox[{
             RowBox[{"mx", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "L"}], "]"}]}], ";", " ", 
             RowBox[{"rz", "=", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", "L"}]}]}], ";", 
             RowBox[{"rx", "=", " ", 
              RowBox[{"mx", "+", 
               RowBox[{"n", " ", "L"}]}]}], " ", ";", 
             RowBox[{"Io", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"2", "rz"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"J", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", " ", "+", " ", "1", "+", 
                 RowBox[{"2", "rx"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"u", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], " ", ",", "1"}], "]"}], "]"}]}],
                   "  ", 
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], "-", 
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}], 
                 " ", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], " ", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
              "}"}]}]}], "     ", "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}], " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SS", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayFlatten", "[", " ", 
          RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", " ", 
             RowBox[{
             "rz", ",", "ry", ",", "my", ",", "ny", ",", "Io", ",", "J"}], 
             "}"}], ",", " ", 
            RowBox[{
             RowBox[{"ny", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L"}], "]"}]}], ";", 
             RowBox[{"my", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ny", "==", "0"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "-", "M"}], ",", "L"}], "]"}], " ", ",", " ", 
                "m"}], "]"}]}], ";", "  ", 
             RowBox[{"ry", "=", " ", 
              RowBox[{"my", "+", 
               RowBox[{"ny", " ", "L"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"rz", "=", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", "L"}]}]}], ";", 
             RowBox[{"Io", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"2", "rz"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"J", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", " ", "1", "+", 
                 RowBox[{"2", "ry"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "   ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"u", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], ",", "2"}], "]"}], "]"}]}], "  ", 
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], "-", 
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}], 
                 ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "1"}], " ", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
              "}"}]}]}], "        ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}], " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "SS"}]}], "        ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8818322636999674`*^9, 3.8818322963920617`*^9}, {
  3.881834529682357*^9, 3.881834546377516*^9}, {3.902507587122853*^9, 
  3.902507590590311*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"27341382-f257-4496-9dc9-e70392e55115"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gaugeConfigUPure", "[", 
     RowBox[{"\[Sigma]_", ",", "L1_", ",", "L2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bonds", ",", 
        RowBox[{"linethick", "=", 
         RowBox[{".012", " ", 
          RowBox[{"(", 
           FractionBox[
            RowBox[{"Log", "[", "49", "]"}], 
            RowBox[{"Log", "[", 
             RowBox[{"L1", " ", "L2"}], "]"}]], ")"}]}]}], ",", "lattice", 
        ",", "size"}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"size", " ", "=", " ", 
        RowBox[{"0.01", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"Log", "[", "49", "]"}], 
            RowBox[{"Log", "[", 
             RowBox[{"L1", " ", "L2"}], "]"}]], ")"}], "2"]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lattice", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "  ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", 
                 RowBox[{"4", " ", "size"}], "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"asites", "[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", 
                 RowBox[{"4", " ", "size"}], "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"bsites", "[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], "  ", ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"Gray", ",", 
                RowBox[{"PointSize", "[", 
                 RowBox[{"2", "  ", "size"}], " ", "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"asites", "[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"White", ",", 
                RowBox[{"PointSize", "[", 
                 RowBox[{"2", "  ", "size"}], "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"bsites", "[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}]}], "     ", 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "0", ",", 
              RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", 
              RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", 
          "2"}], "    ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bonds", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "    ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}], ",", "3"}], "]"}], 
                    "]"}], ">=", " ", "0"}], ",", " ", "Cyan", " ", ",", 
                  RowBox[{"Darker", "@", "Blue"}]}], "]"}], ",", 
                RowBox[{"Thickness", "[", "linethick", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"asites", "[", 
                    RowBox[{"m", ",", "n"}], "]"}], ",", 
                   RowBox[{"bsites", "[", 
                    RowBox[{"m", ",", "n"}], "]"}]}], "}"}], "]"}]}], "}"}], 
              ",", "                   ", 
              RowBox[{"(*", 
               RowBox[{"z", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}], ",", "1"}], "]"}], 
                    "]"}], ">=", " ", "0"}], ",", " ", "Magenta", " ", ",", 
                  RowBox[{"Darker", "@", "Red"}]}], "]"}], ",", 
                RowBox[{"Thickness", "[", "linethick", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"asites", "[", 
                    RowBox[{"m", ",", "n"}], "]"}], ",", 
                   RowBox[{"bsites", "[", 
                    RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n"}], "]"}]}], "}"}], 
                 "]"}]}], "}"}], ",", "             ", 
              RowBox[{"(*", 
               RowBox[{"x", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}], ",", "2"}], "]"}], 
                    "]"}], ">=", " ", "0"}], ",", " ", 
                  RowBox[{"Darker", "@", "Yellow"}], " ", ",", 
                  RowBox[{"Darker", "@", "Green"}]}], "]"}], ",", 
                RowBox[{"Thickness", "[", "linethick", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"asites", "[", 
                    RowBox[{"m", ",", "n"}], "]"}], ",", 
                   RowBox[{"bsites", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}]}], "}"}], "]"}]}], 
               "}"}]}], "              ", 
             RowBox[{"(*", 
              RowBox[{"y", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "0", ",", 
              RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", 
              RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", 
          "2"}], "    ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bonds", ",", "lattice"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}]}], "            ",
      "]"}]}], ";"}], "  ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uniformU", "[", 
    RowBox[{"u_", ",", "L1_", ",", "L2_"}], "]"}], ":=", 
   RowBox[{"Table", "[", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "u", ",", "u"}], "}"}], "     ", ",", 
     RowBox[{"L1", " ", "L2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"flipUoneZbond", "[", 
    RowBox[{"u0_", ",", "L1_", ",", "L2_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R1", ",", 
       RowBox[{"u", "=", "u0"}], ",", 
       RowBox[{"m0", "=", 
        RowBox[{
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L1", "2"], "\[RightCeiling]"}], " ", "-", "1"}]}], ",", 
       RowBox[{"n0", "=", 
        RowBox[{
         RowBox[{"\[LeftCeiling]", 
          FractionBox[
           RowBox[{"L2", "+", "1"}], "2"], "\[RightCeiling]"}], "-", 
         "1"}]}]}], " ", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"R1", "=", " ", 
       RowBox[{"{", " ", 
        RowBox[{"m0", ",", "n0"}], "}"}]}], ";", "\[IndentingNewLine]", "  ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"m", " ", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"R1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "L1"}], "]"}]}], " ", ";", 
         " ", 
         RowBox[{"n", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"R1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "L2"}], "]"}]}], " ", ";", 
         " ", 
         RowBox[{"r", " ", "=", " ", 
          RowBox[{"m", "+", 
           RowBox[{"n", " ", "L1"}], "+", "1"}]}], ";", "    ", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", 
            RowBox[{"r", ",", " ", "3"}], " ", "]"}], "]"}], " ", "=", 
          RowBox[{"-", 
           RowBox[{"u0", "[", 
            RowBox[{"[", 
             RowBox[{"r", ",", "3"}], " ", "]"}], "]"}]}]}], ";"}]}], 
       "      ", "]"}], "   ", ";", "  ", "u"}]}], "           ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"flipUZMaxSpaced", "[", 
    RowBox[{"u0_", ",", "L1_", ",", "L2_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R1", ",", "d", ",", 
       RowBox[{"u", "=", "u0"}], ",", 
       RowBox[{"m0", "=", 
        RowBox[{
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L1", "2"], "\[RightCeiling]"}], " ", "-", "1"}]}], ",", 
       RowBox[{"n0", "=", 
        RowBox[{
         RowBox[{"\[LeftCeiling]", 
          FractionBox[
           RowBox[{"L2", "+", "1"}], "2"], "\[RightCeiling]"}], "-", 
         "1"}]}]}], " ", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"\[LeftFloor]", 
        FractionBox[
         RowBox[{"L1", "-", "1"}], "2"], "\[RightFloor]"}]}], ";", " ", 
      RowBox[{"R1", "=", " ", 
       RowBox[{"{", " ", 
        RowBox[{"m0", ",", "n0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"R1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", "i"}], ",", "L1"}], 
             "]"}]}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"R1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", "i"}], ",", "L2"}], 
             "]"}]}], " ", ";", " ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L1"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", " ", "3"}], " ", "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{"u0", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "3"}], " ", "]"}], "]"}]}]}], ";"}]}], 
         "      ", "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", "  ", "u"}]}], 
    "           ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8774201644067698`*^9, {3.8774202813124714`*^9, 3.8774203178342075`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[52]:=",ExpressionUUID->"75dc91b6-2ba5-4b71-8e56-db4d9d758f83"],

Cell["\t\tconsider other gauge configurations: ", "Text",
 CellChangeTimes->{{3.8774138005392923`*^9, 3.877413819817518*^9}, 
   3.877420284641838*^9},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"3a7c1260-9853-40df-823e-7ac0bad83222"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uniformU", "[", 
    RowBox[{"u_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "u", ",", "u"}], "}"}], ",", 
     SuperscriptBox["L", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gauge4v", "[", 
    RowBox[{"u0_", ",", "L_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d1", ",", "d2", ",", 
       RowBox[{"u", "=", "u0"}], ",", "mS", ",", "nS", ",", "mN", ",", "nN", 
       ",", "r2"}], " ", "}"}], ",", "   ", 
     RowBox[{
      RowBox[{"r2", "=", " ", 
       RowBox[{"\[LeftFloor]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L", "2"], "\[RightCeiling]"}]}], "\[RightFloor]"}]}], 
      ";", " ", 
      RowBox[{"d2", "=", 
       RowBox[{"2", "r2"}]}], ";", 
      RowBox[{"d1", "=", 
       RowBox[{"L", "-", "d2"}]}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"mS", "=", 
       RowBox[{"r2", "-", "1"}]}], ";", 
      RowBox[{"nS", "=", 
       RowBox[{"r2", "-", "1"}]}], ";", 
      RowBox[{"mN", "=", 
       RowBox[{"L", "-", "r2", "-", "1"}]}], ";", 
      RowBox[{"nN", "=", 
       RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", "mS"}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"nS", "+", "i"}]}], " ", ";", "       ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "1"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{"u0", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], "      ", 
         "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", "   ", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", "mN"}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"nN", "-", "i", "+", "1"}]}], ";", " ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "1"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{"u0", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], "      ", 
         "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", "   ", 
      "            ", "u"}]}], "           ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877413757328269*^9, 3.877413768202237*^9}, {
   3.8774138231010857`*^9, 3.877413848300172*^9}, {3.877413879685502*^9, 
   3.877413949262847*^9}, {3.8774139852355285`*^9, 3.877414080256706*^9}, {
   3.8774141169548974`*^9, 3.8774141377700357`*^9}, {3.877414267779165*^9, 
   3.877414341260338*^9}, {3.877419149820367*^9, 3.877419195698786*^9}, {
   3.8774192277606983`*^9, 3.8774192942256985`*^9}, {3.877419347957699*^9, 
   3.877419351444234*^9}, {3.877419500326869*^9, 3.877419553115043*^9}, {
   3.8774196619030886`*^9, 3.8774198021925917`*^9}, {3.87741988196052*^9, 
   3.8774199064128284`*^9}, {3.877419981025444*^9, 3.8774199826907544`*^9}, {
   3.877420328994586*^9, 3.8774203312385015`*^9}, 3.887361778186434*^9, 
   3.9025074927316213`*^9},
 FontFamily->"Consolas",
 CellLabel->"In[56]:=",ExpressionUUID->"7803c2ce-e2f3-4054-9a4c-cfd424ad2e64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"positionVortex", "[", 
   RowBox[{"v_", ",", "L_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "d1", ",", "d2", ",", "r2", ",", "mS", ",", "nS", ",", "mW", ",", "nW", 
      ",", "mE", ",", "nE", ",", "mN", ",", "nN"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t\t ", 
    RowBox[{
     RowBox[{"r2", "=", " ", 
      RowBox[{"\[LeftFloor]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"\[LeftCeiling]", 
         FractionBox["L", "2"], "\[RightCeiling]"}]}], "\[RightFloor]"}]}], 
     ";", " ", 
     RowBox[{"d2", "=", 
      RowBox[{"2", "r2"}]}], ";", 
     RowBox[{"d1", "=", 
      RowBox[{"L", "-", "d2"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t ", 
     RowBox[{"mS", "=", 
      RowBox[{"r2", "-", "1"}]}], ";", "           ", 
     RowBox[{"nS", "=", 
      RowBox[{"r2", "-", "1"}]}], ";", "\[IndentingNewLine]", "\t\t ", 
     RowBox[{"mW", "=", 
      RowBox[{"r2", "-", "1"}]}], ";", "           ", 
     RowBox[{"nW", "=", 
      RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     "\t\t ", 
     RowBox[{"mE", "=", 
      RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "     ", 
     RowBox[{"nE", "=", 
      RowBox[{"r2", "-", "1"}]}], ";", "\[IndentingNewLine]", "\t\t ", 
     RowBox[{"mN", "=", 
      RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "     ", 
     RowBox[{"nN", "=", 
      RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mS", ",", "nS"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mW", ",", "nW"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mE", ",", "nE"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mN", ",", "nN"}], "}"}]}], "}"}], "[", 
      RowBox[{"[", "v", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.877422181703511*^9, 3.8774223167524166`*^9}, {
  3.8774223936121354`*^9, 3.877422504063735*^9}, {3.8774247710594387`*^9, 
  3.8774247740989656`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[58]:=",ExpressionUUID->"32a12fd4-6b04-4fa8-8921-0e1b06ab9778"],

Cell["v=1  South, v=2 West, v=3 East, v=4 North", "Text",
 CellChangeTimes->{{3.877424777947485*^9, 3.8774248031912775`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"9f3ab0b7-e36b-4339-a786-cd32ae12473b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gauge2v", "[", 
    RowBox[{"u0_", ",", "L_", ",", "\[Alpha]_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d1", ",", "d2", ",", 
       RowBox[{"u", "=", "u0"}], ",", "m0", ",", "n0", ",", "r2", " ", ",", 
       "v"}], "}"}], ",", "   ", 
     RowBox[{
      RowBox[{"r2", "=", " ", 
       RowBox[{"\[LeftFloor]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L", "2"], "\[RightCeiling]"}]}], "\[RightFloor]"}]}], 
      ";", "   ", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", 
          "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"m", "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r2", "-", "1"}], ",", "             ", 
               RowBox[{"r2", "-", "1", "+", "i"}], ",", "              ", 
               RowBox[{"r2", "-", "1", "+", "i"}]}], "   ", "}"}], 
             "\[LeftDoubleBracket]", "\[Alpha]", "\[RightDoubleBracket]"}]}], 
           ";", " ", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
           RowBox[{"n", "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r2", "-", "1", "+", "i"}], ",", "       ", 
               RowBox[{"L", "-", "r2", "-", "1"}], ",", "             ", 
               RowBox[{"L", "-", "r2", "-", "i"}]}], "   ", "}"}], 
             "\[LeftDoubleBracket]", "\[Alpha]", "\[RightDoubleBracket]"}]}], 
           ";", "\[IndentingNewLine]", " ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "\[Alpha]"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{"u0", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "\[Alpha]"}], "]"}], "]"}]}]}], ";"}]}], 
         "      ", "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", 
      "                ", "u"}]}], "           ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877422782257123*^9, 3.877422803474776*^9}, {
  3.877422889070754*^9, 3.877422950159266*^9}, {3.8774234770945377`*^9, 
  3.8774235757615786`*^9}, {3.877423614257307*^9, 3.8774236572791567`*^9}, {
  3.8774237055398655`*^9, 3.8774237075241146`*^9}, {3.8774238082793474`*^9, 
  3.8774238100344543`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[59]:=",ExpressionUUID->"492db9da-0a1f-48f8-b014-291e7eb1ec50"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaugeConfig", "[", 
    RowBox[{"\[Chi]_", ",", "L1_", ",", "L2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bonds", ",", 
       RowBox[{"linethick", "=", 
        RowBox[{".012", " ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "49", "]"}], 
           RowBox[{"Log", "[", 
            RowBox[{"L1", " ", "L2"}], "]"}]], ")"}]}]}], ",", "lattice", ",",
        "size"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"size", " ", "=", " ", 
       RowBox[{"0.01", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "49", "]"}], 
           RowBox[{"Log", "[", 
            RowBox[{"L1", " ", "L2"}], "]"}]], ")"}], "2"]}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lattice", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"4", " ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"asites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"4", " ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"bsites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], "  ", ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"2", "  ", "size"}], " ", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"asites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"White", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"2", "  ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"bsites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}]}], "     ", 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", "2"}],
         "    ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bonds", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "    ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"4", ",", "4"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", " ", 
                 RowBox[{"Darker", "@", "Yellow"}], " ", ",", 
                 RowBox[{"Darker", "@", "Blue"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"4", ",", "4"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", "  ", 
                 RowBox[{"Thickness", "[", 
                  RowBox[{"1.5", "linethick"}], "]"}], " ", ",", 
                 RowBox[{"Thickness", "[", "linethick", "]"}]}], " ", "]"}], 
               " ", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}]}], "}"}], "]"}]}], "}"}], 
             ",", "                   ", 
             RowBox[{"(*", 
              RowBox[{"z", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", " ", "Cyan", ",", 
                 RowBox[{"Darker", "@", "Red"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", 
                 RowBox[{"Thickness", "[", 
                  RowBox[{"1.5", " ", "linethick"}], "]"}], " ", ",", 
                 RowBox[{"Thickness", "[", "linethick", "]"}]}], " ", "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n"}], "]"}]}], "}"}], 
                "]"}]}], "}"}], ",", "             ", 
             RowBox[{"(*", 
              RowBox[{"x", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", " ", "Magenta", " ", ",", 
                 RowBox[{"Darker", "@", "Green"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", " ", 
                 RowBox[{"Thickness", "[", 
                  RowBox[{"1.5", "linethick"}], "]"}], " ", ",", 
                 RowBox[{"Thickness", "[", "linethick", "]"}]}], " ", "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}]}], "}"}], "]"}]}], 
              "}"}]}], "              ", 
            RowBox[{"(*", 
             RowBox[{"y", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", "2"}],
         "    ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bonds", ",", "lattice"}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}]}], "             ",
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8770681627949257`*^9, 3.8770682147921047`*^9}, {
   3.877072738637565*^9, 3.8770727399904113`*^9}, 3.8774136111284676`*^9, {
   3.877413642604847*^9, 3.8774136699916964`*^9}, {3.9025071995514545`*^9, 
   3.9025072008403997`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[60]:=",ExpressionUUID->"0e06b428-50bb-4179-a10e-15a5549a6dff"]
}, Closed]],

Cell[CellGroupData[{

Cell["electric field", "Subsubsection",
 CellChangeTimes->{{3.877420233679596*^9, 3.877420236990667*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"082b1853-69cb-4515-a15e-ba6582944cba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uniform", "[", 
     RowBox[{"K_", ",", "L1_", ",", "L2_"}], "]"}], ":=", 
    RowBox[{"Table", "[", "   ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"K", ",", "K", ",", "K"}], "}"}], "     ", ",", 
      RowBox[{"L1", " ", "L2"}]}], "]"}]}], ";"}], "  ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addVortex", "[", " ", 
     RowBox[{"Ko_", ",", "K0_", ",", " ", "R_", ",", "L1_", ",", "L2_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"R", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"K", "=", "Ko"}], ",", 
        RowBox[{"r", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", "6"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{"m", "+", 
            RowBox[{"n", " ", "L1"}], " ", "+", "1"}], ",", "3"}], "    ", 
          "]"}], "]"}], "=", "K0"}], ";", "  ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "-", "1"}], ",", "L2"}], "]"}], " ", "L1"}], " ", 
            "+", "1"}], "  ", ",", "2"}], "    ", "]"}], "]"}], "=", "K0"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}], "+", 
            RowBox[{"n", " ", "L1"}], " ", "+", "1"}], ",", "1"}], "    ", 
          "]"}], "]"}], "=", "K0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}], " ", "L1"}], " ", 
            "+", "1"}], "  ", ",", "3"}], "   ", "]"}], "]"}], "=", "K0"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{"m", "+", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}], " ", "L1"}], "+", 
            "1"}], "   ", ",", "2"}], "    ", "]"}], "]"}], "=", "K0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"m", "-", "1"}], ",", "L1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}], " ", "L1"}], " ", 
            "+", "1"}], "  ", ",", "1"}], "   ", "]"}], "]"}], "=", "K0"}], 
       ";", "\[IndentingNewLine]", "K"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"add2Vortices", "[", " ", 
    RowBox[{
    "Ko_", ",", "K1_", ",", "K2_", ",", " ", "R1_", ",", "R2_", ",", "L1_", 
     ",", "L2_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "K", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"addVortex", "[", " ", 
        RowBox[{"Ko", ",", "K1", ",", " ", "R1", ",", "L1", ",", "L2"}], 
        "]"}]}], ";", " ", 
      RowBox[{"addVortex", "[", " ", 
       RowBox[{"K", ",", "K2", ",", " ", "R2", ",", "L1", ",", "L2"}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"add4Vortices", "[", " ", 
    RowBox[{
    "K0_", ",", "Kmod_", ",", " ", "R1_", ",", "R2_", ",", " ", "R3_", ",", 
     "R4_", ",", "L_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "K", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"addVortex", "[", " ", 
        RowBox[{"K0", ",", "Kmod", ",", " ", "R1", ",", "L", ",", "L"}], 
        "]"}]}], ";", " ", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"addVortex", "[", " ", 
        RowBox[{"K", ",", "Kmod", ",", " ", "R2", ",", "L", ",", "L"}], 
        "]"}]}], ";", " ", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"addVortex", "[", " ", 
        RowBox[{"K", ",", "Kmod", ",", " ", "R3", ",", "L", ",", "L"}], 
        "]"}]}], ";", " ", 
      RowBox[{"addVortex", "[", " ", 
       RowBox[{"K", ",", "Kmod", ",", " ", "R4", ",", "L", ",", "L"}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"add2VorticesMaxSpaced", "[", " ", 
    RowBox[{"Ko_", ",", "K1_", ",", "K2_", ",", "L1_", ",", "L2_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R1", ",", "R2", ",", "d"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"\[LeftFloor]", 
        FractionBox[
         RowBox[{"L1", "-", "1"}], "2"], "\[RightFloor]"}]}], ";", " ", 
      RowBox[{"R1", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[LeftFloor]", 
          FractionBox["L1", "2"], "\[RightFloor]"}], " ", ",", 
         RowBox[{"\[LeftFloor]", 
          FractionBox[
           RowBox[{"L2", "+", "1"}], "2"], "\[RightFloor]"}]}], " ", "}"}]}], 
      ";", 
      RowBox[{"R2", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[LeftFloor]", 
           FractionBox["L1", "2"], "\[RightFloor]"}], "   ", "+", "d"}], ",", 
         RowBox[{
          RowBox[{"\[LeftFloor]", 
           FractionBox[
            RowBox[{"L2", "+", "1"}], "2"], "\[RightFloor]"}], " ", "-", 
          "d"}]}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"add2Vortices", "[", " ", 
       RowBox[{
       "Ko", ",", "K1", ",", "K2", ",", " ", "R1", ",", "R2", ",", "L1", ",", 
        "L2"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"add4VorticesMaxSpaced", "[", " ", 
    RowBox[{"K0_", ",", "Kmod_", ",", "L_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"RS", ",", "RE", ",", "RW", ",", "RN", ",", "r2"}], "}"}], ",", 
     "   ", 
     RowBox[{
      RowBox[{"r2", "=", " ", 
       RowBox[{"\[LeftFloor]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L", "2"], "\[RightCeiling]"}]}], "\[RightFloor]"}]}], 
      ";", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"RS", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "-", "1"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"RW", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "-", "1"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"L", "-", "r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"RE", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "r2", "-", "1"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"RN", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "r2", "-", "1"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"L", "-", "r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"add4Vortices", "[", " ", 
       RowBox[{
       "K0", ",", "Kmod", ",", " ", "RS", ",", "RW", ",", " ", "RE", ",", 
        "RN", ",", "L"}], "]"}]}]}], " ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8774201825463543`*^9, 3.8774201826093636`*^9}, {
   3.8774202274947453`*^9, 3.8774202735734367`*^9}, {3.8837280670530324`*^9, 
   3.883728249212535*^9}, {3.8837282947134576`*^9, 3.883728377375498*^9}, {
   3.883728643549054*^9, 3.883728707133957*^9}, {3.883729140365653*^9, 
   3.8837291663613977`*^9}, {3.883729201619478*^9, 3.8837292319061832`*^9}, {
   3.883729278548962*^9, 3.883729406214078*^9}, {3.8866548585169263`*^9, 
   3.886654861283292*^9}, 3.887362028713689*^9, {3.887363211834648*^9, 
   3.887363243764592*^9}, {3.8873649187913427`*^9, 3.8873649407067575`*^9}, {
   3.887365033541148*^9, 3.887365053722599*^9}, {3.8873656177368665`*^9, 
   3.887365621493929*^9}, {3.8873659326750774`*^9, 3.8873659335741405`*^9}, {
   3.8873661782887497`*^9, 3.887366182518972*^9}, 3.8873675363125753`*^9, {
   3.9025072095402822`*^9, 3.9025072257868547`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[61]:=",ExpressionUUID->"605b6fbc-7e7e-420c-b030-1c5336e2167d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Momentum", "Subsection",
 CellChangeTimes->{{3.9033565664174185`*^9, 
  3.903356569680101*^9}},ExpressionUUID->"790d9ca7-ba57-4940-b054-\
cfceed329436"],

Cell[CellGroupData[{

Cell["consts", "Subsubsection",
 CellChangeTimes->{{3.9034218977730417`*^9, 
  3.9034219163571625`*^9}},ExpressionUUID->"ac9c80e0-ac50-4e27-b393-\
99a0190e06d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mx", "=", " ", 
    RowBox[{"2", "\[Pi]", " ", 
     RowBox[{"{", 
      RowBox[{"1", " ", ",", " ", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "3", "]"}]}]}], "}"}]}]}], ";", " ", 
   RowBox[{"my", "=", " ", 
    RowBox[{"2", "\[Pi]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], " ", ",", " ", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "3", "]"}]}]}], "}"}]}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"toMomentum", "[", 
      RowBox[{"n_", ",", "Nb_"}], "]"}], ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FractionalPart", "[", 
         RowBox[{"Sqrt", "@", "Nb"}], "]"}], " ", "\[NotEqual]", " ", "0"}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Nb=\>\"", ",", "Nb", ",", 
          "\"\<, is not a perfect square.\>\""}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ",", "\n", "\t\t\t\t", 
       RowBox[{"Module", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"L", " ", "=", " ", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{"Sqrt", "@", "Nb"}], "]"}]}], ",", "p1", ",", "p2"}], 
          "}"}], ",", "  ", 
         RowBox[{
          RowBox[{"p1", " ", "=", "  ", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"n", "-", "1"}], ",", "L"}], "]"}], "+", "1"}]}], ";", 
          " ", 
          RowBox[{"p2", " ", "=", "   ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "p1"}], ")"}], "/", "L"}], "+", "1"}]}], ";", 
          "   ", 
          RowBox[{
           RowBox[{"mxp1", "/", "L"}], " ", "+", 
           RowBox[{"myp2", "/", "L"}]}]}]}], "]"}]}], "      ", "]"}]}], 
    ";"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"toMomentum", "[", 
    RowBox[{"n_", ",", "Nb_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", " ", "=", " ", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"Sqrt", "@", "Nb"}], "]"}]}], ",", "p1", ",", "p2"}], "}"}], 
     ",", "  ", 
     RowBox[{
      RowBox[{"p1", " ", "=", "  ", 
       RowBox[{"Mod", "[", 
        RowBox[{"n", ",", "L", ",", "1"}], "]"}]}], ";", " ", 
      RowBox[{"p2", " ", "=", "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "p1"}], ")"}], "/", "L"}], "+", "1"}]}], ";", 
      "   ", 
      RowBox[{
       RowBox[{"mx", " ", 
        RowBox[{"p1", "/", "L"}]}], " ", "+", 
       RowBox[{"my", " ", 
        RowBox[{"p2", "/", "L"}]}]}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"toMomentumTable", "[", "L_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"p1", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{"n", ",", "L", ",", "1"}], "]"}]}], ";", 
        RowBox[{"p2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "p1"}], ")"}], "/", "L"}], "+", "1"}]}], ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"p1", "-", "p2"}], ")"}], "\[Pi]"}], ")"}], "/", "L"}], 
          ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"p1", "+", "p2"}], ")"}], " ", "\[Pi]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sqrt", "[", "3", "]"}], " ", "L"}], ")"}]}]}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", 
       RowBox[{"L", "^", "2"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"toMomentumTable", "[", "L_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "n"}], "}"}], ",", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"r", "-", "1"}], ",", "L"}], "]"}]}], ";", 
        RowBox[{"n", "=", 
         RowBox[{"\[LeftFloor]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r", "-", "1"}], ")"}], "/", "L"}], "\[RightFloor]"}]}], 
        ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]", 
             RowBox[{"(", 
              RowBox[{"m", "-", "n"}], ")"}]}], ")"}], "/", "L"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", "n"}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sqrt", "[", "3", "]"}], " ", "L"}], ")"}]}]}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "1", ",", 
       RowBox[{"L", "^", "2"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"toMomentumInverse", "[", 
    RowBox[{"k_", ",", "Nb_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FractionalPart", "[", 
       RowBox[{"Sqrt", "@", "Nb"}], "]"}], " ", "!=", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Nb=\>\"", ",", "Nb", ",", "\"\<, is not a perfect square.\>\""}], 
       "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ",", "    ", "\n", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"M", " ", "=", " ", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"Sqrt", "@", "Nb"}], "]"}]}], ",", "p1", ",", "p2"}], 
        "}"}], ",", "   ", 
       RowBox[{
        RowBox[{"p1", "=", 
         RowBox[{
          RowBox[{"k", " ", ".", " ", "nx"}], " ", 
          RowBox[{"M", "/", 
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]"}], ")"}]}]}]}], ";", " ", 
        RowBox[{"p2", "=", 
         RowBox[{
          RowBox[{"k", " ", ".", " ", "ny"}], " ", 
          RowBox[{"M", "/", 
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]"}], ")"}]}]}]}], ";", "  ", 
        RowBox[{"Round", "[", 
         RowBox[{"p1", " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p2", "-", "1"}], ")"}], "M"}]}], " ", "]"}]}]}], "  ", 
      "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kD2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "3"}], " ", "mx"}], "+", 
    RowBox[{
     RowBox[{"2", "/", "3"}], " ", "my"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kD1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "/", "3"}], " ", "mx"}], "+", 
    RowBox[{
     RowBox[{"1", "/", "3"}], " ", "my"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[CapitalGamma]point", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kpoint", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "/", "3"}], " ", "mx"}], "+", 
    RowBox[{
     RowBox[{"1", "/", "3"}], " ", "my"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KPpoint", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "3"}], " ", "mx"}], "+", 
    RowBox[{
     RowBox[{"2", "/", "3"}], " ", "my"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mpoint", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"Kpoint", "+", "KPpoint"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MPpoint", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"Kpoint", "-", "mx", "+", "KPpoint"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MPPpoint", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"Kpoint", "+", "KPpoint", "-", "my"}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8961742791892085`*^9, 3.896174283163271*^9}, {
  3.8961758013071012`*^9, 3.8961758155536113`*^9}, {3.8961781428487453`*^9, 
  3.8961781719423437`*^9}, {3.896178900616929*^9, 3.8961789021911745`*^9}, {
  3.8961789965352488`*^9, 3.8961790398941565`*^9}, {3.896179078484042*^9, 
  3.8961790974720507`*^9}, {3.9033582692205515`*^9, 3.9033582730937247`*^9}, {
  3.903421601017394*^9, 3.9034216782415*^9}, {3.903421785655006*^9, 
  3.9034218037005367`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"26ba2ee8-5396-4639-b2b6-80e5e5c943d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"toLine\[CapitalGamma]KK\[CapitalGamma]0", "[", "M_", "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ki", "=", "my"}], ",", 
       RowBox[{"kf", "=", "mx"}]}], "}"}], ",", "  ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"ki", "+", 
        RowBox[{"t", 
         RowBox[{"(", 
          RowBox[{"kf", "-", "ki"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "1", ",", 
         FractionBox["1", "M"]}], "}"}]}], "]"}]}], "    ", "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toLine\[CapitalGamma]KM\[CapitalGamma]", "[", "M_", "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ks", ",", "Ne", ",", "\[CapitalDelta]t"}], "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"1", ":", " ", "\[CapitalGamma]"}], "=", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"2", ":", " ", "K"}], "=", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "3"], ",", 
          FractionBox["2", "3"]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"3", ":", " ", 
         RowBox[{"K", "'"}]}], "=", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["2", "3"], ",", 
          FractionBox["3", "3"]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"4", ":", " ", "\[CapitalGamma]"}], "=", "0"}], ","}], " ", 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ks", "=", 
       RowBox[{"{", " ", 
        RowBox[{
        "\[CapitalGamma]point", ",", "Kpoint", ",", "MPpoint", ",", 
         "\[CapitalGamma]point"}], " ", "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Ne", "=", 
       RowBox[{
        RowBox[{"Length", "[", "ks", "]"}], "-", "1"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "of", " ", "edges", " ", "making", " ", "the", " ", 
        "path", " ", "in", " ", "the", " ", "BZ"}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"t", 
              RowBox[{"(", "  ", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"ks", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "  ", ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"1", "-", 
               RowBox[{
                FractionBox["Ne", "M"], 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"KroneckerDelta", "[", 
                   RowBox[{"i", ",", "Ne"}], "]"}]}], ")"}]}]}], ",", 
              FractionBox["Ne", "M"]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Ne"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}]}], "       ", "]"}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.89617349947895*^9, 3.8961737300623446`*^9}, {
   3.896173815924117*^9, 3.8961739128772187`*^9}, {3.8961739568196287`*^9, 
   3.896174116056989*^9}, {3.8961741523264723`*^9, 3.8961742557609763`*^9}, {
   3.896174383245166*^9, 3.8961744701449957`*^9}, {3.896174937451521*^9, 
   3.8961749662326355`*^9}, {3.8961751128134985`*^9, 3.896175143601034*^9}, {
   3.8961751746516953`*^9, 3.896175174830862*^9}, {3.896175745956812*^9, 
   3.8961757513347626`*^9}, {3.896175830535299*^9, 3.896175840839613*^9}, 
   3.8961781480261793`*^9, {3.896185199854703*^9, 3.896185213177372*^9}, {
   3.896185843285593*^9, 3.8961858506521435`*^9}, 3.9033566037013187`*^9, {
   3.9033582500009108`*^9, 3.9033582778835316`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"d0ce5796-00d2-44df-8119-56473c029967"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toLine\[CapitalGamma]KM\[CapitalGamma]", "[", "M_", "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ks", ",", "Ne", ",", "\[CapitalDelta]t"}], "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"1", ":", " ", "\[CapitalGamma]"}], "=", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"2", ":", " ", "K"}], "=", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "3"], ",", 
          FractionBox["2", "3"]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"3", ":", " ", 
         RowBox[{"K", "'"}]}], "=", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["2", "3"], ",", 
          FractionBox["3", "3"]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"4", ":", " ", "\[CapitalGamma]"}], "=", "0"}], ","}], " ", 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ks", "=", 
       RowBox[{"{", " ", 
        RowBox[{
        "\[CapitalGamma]point", ",", "Kpoint", ",", "MPpoint", ",", 
         "\[CapitalGamma]point"}], " ", "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Ne", "=", 
       RowBox[{
        RowBox[{"Length", "[", "ks", "]"}], "-", "1"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "of", " ", "edges", " ", "making", " ", "the", " ", 
        "path", " ", "in", " ", "the", " ", "BZ"}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"t", 
              RowBox[{"(", "  ", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"ks", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "  ", ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{
               FractionBox["Ne", "M"], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"KroneckerDelta", "[", 
                  RowBox[{"i", ",", "1"}], "]"}]}], ")"}]}], ",", "1", ",", 
              FractionBox["Ne", "M"]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Ne"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}]}], "      ", "]"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.8961813951555586`*^9, 3.896181436217743*^9}, 
   3.896185335914139*^9, {3.89618585298882*^9, 3.8961858969128885`*^9}, {
   3.903358250997777*^9, 3.9033582795258265`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"e3a3bb23-1ed7-4858-bfcf-d3abc667a4a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toLine\[CapitalGamma]KM\[CapitalGamma]KMM", "[", "M_", "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ks", ",", "Ne", ",", "\[CapitalDelta]t"}], "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"1", ":", " ", "\[CapitalGamma]"}], "=", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"2", ":", " ", "K"}], "=", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "3"], ",", 
          FractionBox["2", "3"]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"3", ":", " ", 
         RowBox[{"K", "'"}]}], "=", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["2", "3"], ",", 
          FractionBox["3", "3"]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"4", ":", " ", "\[CapitalGamma]"}], "=", "0"}], ","}], " ", 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ks", "=", 
       RowBox[{"{", " ", 
        RowBox[{
        "\[CapitalGamma]point", ",", "KPpoint", ",", "MPpoint", ",", 
         "\[CapitalGamma]point", ",", "Kpoint", ",", "Mpoint", ",", 
         "MPPpoint"}], " ", "}"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Ne", "=", 
       RowBox[{
        RowBox[{"Length", "[", "ks", "]"}], "-", "1"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "of", " ", "edges", " ", "making", " ", "the", " ", 
        "path", " ", "in", " ", "the", " ", "BZ"}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"t", 
              RowBox[{"(", "  ", 
               RowBox[{
                RowBox[{"ks", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"ks", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "  ", ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{
               FractionBox["Ne", "M"], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"KroneckerDelta", "[", 
                  RowBox[{"i", ",", "1"}], "]"}]}], ")"}]}], ",", "1", ",", 
              FractionBox["Ne", "M"]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Ne"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}]}], "\[IndentingNewLine]", "    ", "]"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.896175855781474*^9, 3.896175920853256*^9}, {
   3.896176398420482*^9, 3.896176417612297*^9}, {3.896176448236721*^9, 
   3.8961764687562895`*^9}, {3.8961765124998436`*^9, 
   3.8961765130627613`*^9}, {3.8961766122398043`*^9, 3.896176741480756*^9}, {
   3.8961767747365494`*^9, 3.8961770882087326`*^9}, {3.896177119419978*^9, 
   3.8961771882437544`*^9}, {3.89617749166405*^9, 3.896177542541065*^9}, {
   3.896177906731778*^9, 3.896177967437743*^9}, {3.8961780299425473`*^9, 
   3.8961781196275845`*^9}, {3.896178181954277*^9, 3.896178201100795*^9}, {
   3.8961791211680007`*^9, 3.8961791762917075`*^9}, {3.896179223893255*^9, 
   3.8961793674064016`*^9}, {3.896179660900493*^9, 3.8961797710150237`*^9}, {
   3.896181006640379*^9, 3.896181075604403*^9}, {3.896181111264586*^9, 
   3.8961811134240026`*^9}, {3.8961811435521812`*^9, 
   3.8961811614845247`*^9}, {3.896181244965867*^9, 3.896181246268532*^9}, {
   3.896181442541219*^9, 3.8961814454212255`*^9}, 3.8961857619767165`*^9, {
   3.896185924585245*^9, 3.896185988733985*^9}, 3.896186034272643*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"54777c5c-751e-40be-a208-23b4cf7f1781"]
}, Closed]],

Cell[CellGroupData[{

Cell["ham", "Subsubsection",
 CellChangeTimes->{{3.9034219052693157`*^9, 
  3.9034219066337147`*^9}},ExpressionUUID->"1f5afdfa-dc4c-4a00-8688-\
f42b5073b989"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Tmom", "[", "k_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kx", "=", 
          RowBox[{"k", ".", "mx"}]}], ",", 
         RowBox[{"ky", "=", 
          RowBox[{"k", ".", "my"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
           ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[ImaginaryI]", ",", "0", ",", "0", ",", "0", ",", 
           RowBox[{"-", "\[ImaginaryI]"}], ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "kx"}]]}], ",", "0", ",", "0", ",",
            "0", ",", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "kx"}]]}], ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "ky"}]]}], ",", "0", ",", "0", ",",
            "0", ",", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "ky"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "\[ImaginaryI]", ",", "0", ",", "0", 
           ",", "0", ",", 
           RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}], "}"}]}], "]"}]}], ";"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Tkmom", "=", 
    RowBox[{"KroneckerProduct", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"I", ",", 
          RowBox[{"-", "I"}]}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Band", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], " ", "]"}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{3.903356648233433*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"d8bc274c-06a5-4ae6-a5f5-488893b0ea80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AMFmom", "[", 
    RowBox[{"Jm_", ",", "U_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"AMF", ",", 
       RowBox[{"N", "=", "Nmat"}]}], "}"}], ",", "  ", 
     RowBox[{
      RowBox[{"AMF", "=", 
       RowBox[{"Table", "[", "    ", 
        RowBox[{
         RowBox[{"Sum", "[", "   ", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{
             RowBox[{"Jm", "[", 
              RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
             RowBox[{"U", "[", 
              RowBox[{"[", "\[Gamma]", "]"}], "]"}], ".", 
             RowBox[{"N", "[", 
              RowBox[{"[", "\[Beta]", "]"}], "]"}]}]}], " ", ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], "    ", 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "   ", 
      RowBox[{
       RowBox[{
        RowBox[{"KroneckerProduct", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "#"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"Re", "@", "AMF"}]}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BMFmom", "[", 
     RowBox[{"Jm_", ",", "h_", ",", "\[Lambda]_", ",", "V_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ba", ",", "Bb", ",", 
        RowBox[{"M", "=", "Mmat"}], ",", 
        RowBox[{"N", "=", "Nmat"}], ",", 
        RowBox[{"G", "=", "Gmat"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ba", "=", 
        RowBox[{"Sum", "[", "    ", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", "    ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Jm", "[", 
                RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"traceN", "[", " ", 
                RowBox[{"V", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", 
           "-", 
           RowBox[{"2", " ", 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"N", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"G", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], "        ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bb", "=", 
        RowBox[{"Sum", "[", "    ", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", "    ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Jm", "[", 
                RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"traceN", "[", " ", 
                RowBox[{"V", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", 
           "-", 
           RowBox[{"2", " ", 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"N", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"G", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], "         ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"Re", "@", "Ba"}]}], "]"}], ",", 
         RowBox[{"KroneckerProduct", "[", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
           RowBox[{"Re", "@", "Bb"}]}], "]"}]}], " ", "}"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cMFmom", "[", 
    RowBox[{"Jm_", ",", "U_", ",", "V_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"N", "=", "Nmat"}], "}"}], ",", " ", 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "8"}], "  ", 
        RowBox[{
         RowBox[{"Jm", "[", 
          RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"traceN", "[", " ", 
             RowBox[{"V", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "[", 
            RowBox[{"[", "\[Alpha]", "]"}], "]"}], "  ", 
           RowBox[{
            RowBox[{"traceN", "[", " ", 
             RowBox[{"V", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "[", 
            RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "+", 
          RowBox[{"2", "  ", 
           RowBox[{"Tr", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"U", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}], "\[Transpose]"}], ".", 
             RowBox[{"N", "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
             RowBox[{"U", "[", 
              RowBox[{"[", "\[Gamma]", "]"}], "]"}], ".", 
             RowBox[{"N", "[", 
              RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}]}], "   ", 
         ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
    "          ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"enMFmom", "[", 
    RowBox[{"Jm_", ",", "U_", ",", "V_", ",", "h_", ",", 
     RowBox[{"\[Eta]_", ":", "1"}]}], "]"}], "   ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "=", "Mmat"}], ",", 
       RowBox[{"N", "=", "Nmat"}], ",", 
       RowBox[{"G", "=", "Gmat"}], ",", "\[Lambda]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"\[Eta]", " ", 
        RowBox[{"\[Lambda]effmom", "[", 
         RowBox[{"Jm", ",", "h", ",", "V"}], "]"}]}]}], ";", "  ", 
      RowBox[{
       RowBox[{"cMFmom", "[", 
        RowBox[{"Jm", ",", "U", ",", "V"}], "]"}], "+", 
       RowBox[{
        RowBox[{"1", "/", "4"}], "  ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{
             RowBox[{"traceN", "[", " ", 
              RowBox[{"V", "[", 
               RowBox[{"[", "\[Sigma]", "]"}], "]"}], " ", "]"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", 
              RowBox[{"\[Sigma]", ",", "\[Gamma]"}], "]"}], "]"}], " ", 
            RowBox[{
             RowBox[{"traceG", "[", " ", 
              RowBox[{"V", "[", 
               RowBox[{"[", "\[Sigma]", "]"}], "]"}], " ", "]"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], "\[IndentingNewLine]",
           ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}]}]}], 
    "        ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"enSUMmom", "[", 
     RowBox[{"Jm_", ",", "U_", ",", "V_", ",", "h_", ",", 
      RowBox[{"L_", ":", "30"}], ",", 
      RowBox[{"\[Eta]_", ":", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]", ",", 
        RowBox[{"mT", "=", 
         RowBox[{"toMomentumTable", "[", "L", "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"\[Eta]", " ", 
         RowBox[{"\[Lambda]effmom", "[", 
          RowBox[{"Jm", ",", "h", ",", "V"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"cMFmom", "[", 
          RowBox[{"Jm", ",", "U", ",", "V"}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"2", 
           SuperscriptBox["L", "2"]}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Total", "@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Eigenvalues", "@", 
               RowBox[{"N", "@", 
                RowBox[{"HmfMomentum", "[", 
                 RowBox[{"Jm", ",", "h", ",", "U", ",", "V", ",", 
                  RowBox[{"mT", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "  ", "]"}]}]}], " ", 
              ",", 
              RowBox[{
               RowBox[{"#", "<=", "0"}], "&"}]}], " ", "]"}]}], " ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             SuperscriptBox["L", "2"]}], "}"}]}], "]"}]}]}]}]}], " ", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HmfMomentum", "[", 
    RowBox[{"Jmatrice_", ",", "h_", ",", "U_", ",", "V_", ",", " ", "k_", ",", 
     RowBox[{"\[Eta]_", ":", "1"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Ax", ",", "Ay", ",", "Az", ",", "BA", ",", "BB", ",", " ", "hx", ",", 
       "hy", ",", "hz", ",", " ", "kx", ",", "ky", ",", "ha", ",", "HA", ",", 
       "HB", ",", "\[Lambda]"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"kx", "=", 
       RowBox[{"k", " ", ".", " ", "nx"}]}], ";", 
      RowBox[{"ky", "=", 
       RowBox[{"k", " ", ".", " ", "ny"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"\[Eta]", " ", 
        RowBox[{"\[Lambda]effmom", "[", 
         RowBox[{"Jmatrice", ",", "h", ",", "V"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ax", ",", "Ay", ",", "Az"}], "}"}], "=", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"AMFmom", "[", 
         RowBox[{"Jmatrice", ",", "U"}], "]"}]}]}], ";", "  ", 
      RowBox[{"ha", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", " ", 
          RowBox[{"\[ImaginaryI]", " ", "kx"}], "]"}], "  ", "Ax"}], " ", "+",
         " ", 
        RowBox[{
         RowBox[{"Exp", "[", " ", 
          RowBox[{"\[ImaginaryI]", " ", "ky"}], "]"}], " ", "Ay"}], " ", "+", 
        " ", "Az"}]}], ";", "   ", "\[IndentingNewLine]", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ha", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"k", ".", "\[Delta]x"}]}], "]"}], " ", "Ax"}], " ", "+", 
          " ", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"k", ".", "\[Delta]y"}]}], "]"}], " ", "Ay"}], " ", "+", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"k", ".", "\[Delta]z"}]}], "]"}], " ", "Az"}]}]}], ";"}],
        "*)"}], "   ", 
      RowBox[{"HA", "=", 
       RowBox[{"N", "@", 
        RowBox[{"(", " ", 
         RowBox[{"ha", "+", 
          RowBox[{"ConjugateTranspose", "@", "ha"}]}], " ", ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"BA", ",", "BB"}], "}"}], "=", " ", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"BMFmom", "[", 
         RowBox[{"Jmatrice", ",", "h", ",", "\[Lambda]", ",", "V"}], 
         "]"}]}]}], ";", "   ", 
      RowBox[{"HB", "=", 
       RowBox[{"BA", "+", "BB"}]}], " ", ";", " ", 
      RowBox[{"(*", "  ", 
       RowBox[{
        RowBox[{"HB", "=", 
         RowBox[{"N", "[", "   ", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{"HB", "+", 
             RowBox[{"ConjugateTranspose", "@", "HB"}]}], " ", ")"}], "/", 
           "2"}], " ", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"HA", "+", "HB"}], ")"}]}]}]}], "   ", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.896957067030449*^9, 3.8969571734976125`*^9}, {
   3.8969572235844946`*^9, 3.8969573492019963`*^9}, 3.896957839547307*^9, {
   3.896957902231938*^9, 3.8969579088718977`*^9}, 3.8969579581042333`*^9, {
   3.8969581778128457`*^9, 3.8969582159752016`*^9}, {3.896964689963834*^9, 
   3.8969646901844873`*^9}, {3.8969650994841833`*^9, 3.896965116585857*^9}, {
   3.8969651484449224`*^9, 3.8969651718667316`*^9}, {3.896965262047638*^9, 
   3.8969652629749055`*^9}, {3.8970276490188055`*^9, 3.8970276495805693`*^9}, 
   3.8970478743256817`*^9, {3.897048596758007*^9, 3.897048602000779*^9}, 
   3.8970671543870316`*^9, {3.8970680694801207`*^9, 3.8970680825786543`*^9}, {
   3.8971046466048517`*^9, 3.8971046611833797`*^9}, {3.8973667689696636`*^9, 
   3.897366776851818*^9}, {3.897368652942794*^9, 3.897368699589823*^9}, {
   3.897373565283861*^9, 3.897373577188141*^9}, {3.8973737327149*^9, 
   3.8973737370553026`*^9}, {3.897378548371936*^9, 3.8973785935136857`*^9}, 
   3.8973806675975485`*^9, {3.8974073364843235`*^9, 3.897407347036397*^9}, {
   3.897407389288932*^9, 3.8974073940557003`*^9}, {3.89805564784818*^9, 
   3.8980556787862062`*^9}, {3.8980560357354136`*^9, 
   3.8980560441279297`*^9}, {3.898167202978882*^9, 3.8981672179322977`*^9}, {
   3.898167336988139*^9, 3.898167337438593*^9}, {3.898169238971969*^9, 
   3.8981692502697697`*^9}, {3.901189646087511*^9, 3.901189698557485*^9}, {
   3.9011897326763287`*^9, 3.9011897603139515`*^9}, {3.9011928011468115`*^9, 
   3.901192829292116*^9}, {3.9011931359950075`*^9, 3.901193158686654*^9}, 
   3.901193232074653*^9, {3.901193486880364*^9, 3.9011935223243628`*^9}, {
   3.9023959610456657`*^9, 3.9023959623053865`*^9}, {3.9023973509369164`*^9, 
   3.9023973665483866`*^9}, {3.9023976607867928`*^9, 3.902397661508959*^9}, 
   3.9024207234145765`*^9, {3.9024228606324224`*^9, 3.902422862724327*^9}, {
   3.9033566703260765`*^9, 3.903356672395317*^9}, {3.90335678615499*^9, 
   3.90335685883444*^9}, {3.9033569279329243`*^9, 3.903356988974802*^9}, {
   3.903357037417398*^9, 3.903357073396484*^9}, {3.9033571487479906`*^9, 
   3.903357201462759*^9}, {3.9033574063537135`*^9, 3.90335742185581*^9}, {
   3.90335752508827*^9, 3.9033575348343115`*^9}, {3.9033575696172905`*^9, 
   3.9033576317883177`*^9}, {3.9033578303104153`*^9, 3.903358044982362*^9}, {
   3.9033581741377735`*^9, 3.90335817721896*^9}, {3.903363343217567*^9, 
   3.9033633825485706`*^9}, {3.903363412813736*^9, 3.9033634960402164`*^9}, {
   3.9033635777172375`*^9, 3.903363658630978*^9}, {3.9033636902842503`*^9, 
   3.903363723024948*^9}, {3.903363850618492*^9, 3.9033638537738276`*^9}, {
   3.9033639143443704`*^9, 3.903363918124401*^9}, {3.9034186574263835`*^9, 
   3.9034186765036077`*^9}, {3.903420661167946*^9, 3.9034206669191427`*^9}, {
   3.9034207894640093`*^9, 3.9034208137414904`*^9}, {3.903421376184189*^9, 
   3.903421493284954*^9}, {3.903422925346438*^9, 3.903422948276123*^9}, {
   3.9034229831253147`*^9, 3.903422987331298*^9}, {3.90342675899924*^9, 
   3.90342678923999*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"8f0586f9-c1a9-4b87-9063-b4bb29bf9443"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UmatK", "[", "H_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R", "=", 
       RowBox[{"Eigensystem", "@", 
        RowBox[{"N", "[", "H", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ReverseSort", "[", " ", 
         RowBox[{"R", "\[Transpose]"}], " ", "]"}], "\[Transpose]"}], "[", 
       RowBox[{"[", " ", "2", " ", "]"}], "]"}], "\[Transpose]"}]}], " ", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9033572237855735`*^9, 3.9033572298840485`*^9}, {
  3.903357641233355*^9, 3.9033576425168033`*^9}, {3.9034202361280956`*^9, 
  3.9034202365999393`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"f702e762-ce77-41ce-ad62-abe90276804a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]effmom", "[", 
    RowBox[{"Jmat_", ",", "h_", ",", "V_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "M", "}"}], ",", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"traceN", "[", 
           RowBox[{"V", "[", 
            RowBox[{"[", "\[Sigma]", "]"}], "]"}], " ", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], " ", "]"}]}], 
      ";", "  ", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"h", "-", " ", 
         RowBox[{"Sum", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Jmat", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], ".", 
            RowBox[{"M", "\[LeftDoubleBracket]", "  ", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"\[Sigma]", "+", "1"}], ",", "2", ",", "1"}], "]"}], 
             "  ", "\[RightDoubleBracket]"}]}], "  ", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
        "    ", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}], 
    "     ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9025102120971794`*^9, 3.9025102709820414`*^9}, {
   3.9025139204260073`*^9, 3.902514012764992*^9}, {3.9025140437481017`*^9, 
   3.9025141017741847`*^9}, {3.9025146389479337`*^9, 3.902514745216813*^9}, {
   3.9025147836964645`*^9, 3.902514784123452*^9}, {3.902514887601636*^9, 
   3.9025150478268223`*^9}, {3.9025151037826395`*^9, 3.902515105425405*^9}, {
   3.902515193445398*^9, 3.902515212368495*^9}, {3.9025157190082474`*^9, 
   3.902515741956709*^9}, 3.9025158981792884`*^9, {3.9025159569920483`*^9, 
   3.9025159633835125`*^9}, 3.902516008051693*^9, {3.9025160985200043`*^9, 
   3.902516204181082*^9}, {3.9025162364923077`*^9, 3.9025162516813183`*^9}, {
   3.9029983535644464`*^9, 3.9029984098341055`*^9}, {3.902998568449911*^9, 
   3.9029985851430025`*^9}, {3.903007220601178*^9, 3.903007223774622*^9}, {
   3.9033563555911417`*^9, 3.9033563610350666`*^9}, {3.9033572418798704`*^9, 
   3.9033573156541977`*^9}, {3.903357363084797*^9, 3.903357364933298*^9}, 
   3.903357399445195*^9, {3.9033575644190435`*^9, 3.9033575651602173`*^9}, {
   3.9033576564417562`*^9, 3.9033576647244663`*^9}, 3.903368114530181*^9},
 CellLabel->"In[92]:=",ExpressionUUID->"3eb0eb9b-d65d-43c2-9842-cacc20c6e560"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HmfMomentumVec", "[", 
    RowBox[{
    "Jmatrice_", ",", "h_", ",", "U_", ",", "V_", ",", " ", "kTable_", ",", 
     RowBox[{"\[Eta]_", ":", "1"}]}], "]"}], " ", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"HmfMomentum", "[", 
      RowBox[{"Jmatrice", ",", "h", ",", "U", ",", "V", ",", " ", 
       RowBox[{"kTable", "[", 
        RowBox[{"[", "l", "]"}], "]"}], ",", "\[Eta]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", 
       RowBox[{"Length", "@", "kTable"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.903420308353682*^9, 3.903420326577715*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"5e55b3bb-8126-46b8-a50b-77090867de2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UmatVec", "[", 
    RowBox[{
    "Jmatrice_", ",", "h_", ",", "U_", ",", "V_", ",", " ", "kTable_", ",", 
     "Tk_", ",", 
     RowBox[{"\[Eta]_", ":", "1"}]}], "]"}], " ", ":=", 
   RowBox[{"UmatK", "/@", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Tk", "\[ConjugateTranspose]"}], " ", ".", 
       RowBox[{"HmfMomentum", "[", 
        RowBox[{"Jmatrice", ",", "h", ",", "U", ",", "V", ",", " ", 
         RowBox[{"kTable", "[", 
          RowBox[{"[", "l", "]"}], "]"}], ",", "\[Eta]"}], "]"}], ".", "Tk"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", 
        RowBox[{"Length", "@", "kTable"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9033658962235055`*^9, 3.9033658989495945`*^9}, {
  3.9034198015809035`*^9, 3.903419857294053*^9}, {3.903419906500049*^9, 
  3.903419958883788*^9}, {3.903420007659096*^9, 3.9034200087206917`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"56b5f417-052a-4d40-ae63-c8fb9cc08094"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MF model definitions", "Subsection",
 CellChangeTimes->{{3.87077371823326*^9, 3.8707737241148777`*^9}, {
  3.902944620994293*^9, 3.90294462287626*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"0318476a-00b2-4dfc-9b63-3a22ad5f203f"],

Cell[CellGroupData[{

Cell["Saving and Loading data", "Subsubsection",
 CellChangeTimes->{{3.825426408557412*^9, 3.825426432409486*^9}, {
   3.8529094592650013`*^9, 3.8529094611880875`*^9}, {3.853005908308914*^9, 
   3.853005909153577*^9}, {3.85322366934897*^9, 3.8532236708509216`*^9}, {
   3.8536110407913527`*^9, 3.853611041586192*^9}, {3.8618090265261803`*^9, 
   3.8618090351881347`*^9}, {3.8618090685118675`*^9, 3.8618090699964824`*^9}, 
   3.8684476950768623`*^9},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"b71d4571-a688-41a0-930c-9da7a14bca46"],

Cell[TextData[StyleBox["To create a given NotebookDirectory  \
\[OpenCurlyDoubleQuote]path\[CloseCurlyDoubleQuote] if it does not exist:",
 FontSize->10]], "Text",
 CellChangeTimes->{{3.8618093666644535`*^9, 3.8618093681452913`*^9}, {
   3.861809496262456*^9, 3.8618095726055417`*^9}, {3.861809716496188*^9, 
   3.8618097310756235`*^9}, {3.861809820018787*^9, 3.8618098375466695`*^9}, 
   3.8938356979390116`*^9},
 FontFamily->"Consolas",
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"fb7b3641-96cb-4bed-b03c-c6cf44a4b764"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "@", 
    RowBox[{"fromJmat", "[", 
     RowBox[{"Jmat", "[", 
      RowBox[{
       RowBox[{"J", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"K", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"\[CapitalGamma]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"\[CapitalGamma]p", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"DM", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], " ", "]"}], " ", 
     "]"}]}], "\n", 
   RowBox[{
    RowBox[{"Jm", "=", 
     RowBox[{"Jmat", "[", 
      RowBox[{
       RowBox[{"J", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"K", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"\[CapitalGamma]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"\[CapitalGamma]p", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"DM", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], " ", "]"}]}], " ", ";",
     " ", 
    RowBox[{"MatrixForm", "/@", "jm"}]}], "\n", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", "    ", 
      RowBox[{
       RowBox[{"cyclicPermutation", "[", 
        RowBox[{
         RowBox[{"Jm", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", ",", "2"}], "]"}], " ", "+", 
       " ", 
       RowBox[{"cyclicPermutation", "[", 
        RowBox[{
         RowBox[{"Jm", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", ",", "1"}], "]"}], " ", "+", 
       " ", 
       RowBox[{"Jm", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], " ", ")"}], "/", "3"}], ")"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "@", 
    RowBox[{"(", "    ", 
     RowBox[{
      RowBox[{"cyclicPermutation", "[", 
       RowBox[{
        RowBox[{"jm", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", ",", "2"}], "]"}], " ", "+", 
      " ", 
      RowBox[{"cyclicPermutation", "[", 
       RowBox[{
        RowBox[{"jm", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", ",", "1"}], "]"}], " ", "+", 
      " ", 
      RowBox[{"jm", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], " ", ")"}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{
  3.9034257331469493`*^9, {3.9034260191053114`*^9, 3.9034260238035917`*^9}, {
   3.9034260814543095`*^9, 3.9034260976036887`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"f0c5c4d8-8323-43b3-9e5b-95b9cc6de7f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyclicPermutation", "[", 
    RowBox[{"A_", ",", 
     RowBox[{"s_", ":", "1"}]}], "]"}], ":=", " ", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "A", "]"}], "==", "3"}], " ", "\[And]", " ", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"A", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "3"}]}], ",", " ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"i", "-", "s"}], ",", "3", ",", "1"}], "]"}], ",", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"j", "-", "s"}], ",", "3", ",", "1"}], "]"}]}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "  ", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.903425371368273*^9, 3.903425480696786*^9}, {
  3.903425512333193*^9, 3.9034255252685533`*^9}, {3.9034255792499094`*^9, 
  3.9034255876648855`*^9}, {3.9034258790626707`*^9, 3.9034259019005957`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"118d0bed-1fc6-47ff-8769-9499c4878a08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fromJmat", "[", "Jm_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "J", ",", "K", ",", "\[CapitalGamma]", ",", "\[CapitalGamma]p", ",", 
       "DM", ",", "jm"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"jm", "=", 
       RowBox[{
        RowBox[{"(", "  ", 
         RowBox[{
          RowBox[{"cyclicPermutation", "[", 
           RowBox[{
            RowBox[{"Jm", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", ",", "2"}], "]"}], " ", "+",
           " ", 
          RowBox[{"cyclicPermutation", "[", 
           RowBox[{
            RowBox[{"Jm", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", ",", "1"}], "]"}], " ", "+",
           " ", 
          RowBox[{"Jm", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], " ", ")"}], "/", "3"}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalGamma]p", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"jm", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}], "+", 
          RowBox[{"jm", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "3"}], "]"}], "]"}], "+", 
          RowBox[{"jm", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"jm", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ")"}], "/", "4"}]}], ";",
       " ", "\[IndentingNewLine]", 
      RowBox[{"K", "=", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"jm", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"jm", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "+", 
            RowBox[{"jm", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", ")"}], "/", 
          "2"}]}], ")"}]}], ";", " ", 
      RowBox[{"J", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"jm", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "-", "K"}], ")"}]}], ";", 
      RowBox[{"DM", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"jm", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
          RowBox[{"jm", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}]}], ";", 
      RowBox[{"\[CapitalGamma]", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"jm", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{"jm", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "J", ",", "K", ",", "\[CapitalGamma]", ",", "\[CapitalGamma]p", ",", 
        "DM"}], "}"}]}]}], "    ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9034248359120393`*^9, 3.903424850559181*^9}, {
   3.9034249237978306`*^9, 3.9034249574758935`*^9}, {3.903425128540161*^9, 
   3.9034251311336365`*^9}, {3.9034251647267456`*^9, 
   3.9034253106180754`*^9}, {3.9034256415049477`*^9, 3.903425708173698*^9}, {
   3.9034257491231394`*^9, 3.9034257553336787`*^9}, {3.9034258367850604`*^9, 
   3.90342584648155*^9}, 3.903425930641471*^9, {3.903425969197525*^9, 
   3.9034260059839516`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"209ca2b2-3b1d-40a7-842f-983acfb24eff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"createDir", "[", "path_", "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"FileNames", "[", "path", "]"}]}]}], "}"}], ",", "\t\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"l", "\[Equal]", "0"}], ",", "  ", 
       RowBox[{
        RowBox[{"CreateDirectory", "@", 
         RowBox[{"File", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", "\"\<data\>\""}], " ", "}"}], "]"}]}]}], ";",
         " ", 
        RowBox[{"CreateDirectory", "@", 
         RowBox[{"File", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", " ", ",", "\"\<graph\>\""}], " ", "}"}], 
           "]"}]}]}], ";"}], " ", "\[IndentingNewLine]", ",", "Null"}], 
      "]"}]}], "  ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8618095638310165`*^9, 3.8618095694119525`*^9}, {
  3.8618096143228226`*^9, 3.861809620194528*^9}, {3.861809705133501*^9, 
  3.8618097094986787`*^9}, {3.861809968970943*^9, 3.8618099701175966`*^9}, {
  3.8707707754220266`*^9, 3.8707707795036244`*^9}, {3.8707714803304873`*^9, 
  3.870771490870921*^9}, {3.8938356980287085`*^9, 3.893835698032206*^9}, {
  3.8944375325214396`*^9, 3.894437535830594*^9}, {3.9025076376323586`*^9, 
  3.902507646455291*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[98]:=",ExpressionUUID->"fc4d5d20-75bd-4656-ab10-830001170971"],

Cell[TextData[StyleBox["to read the data at \[OpenCurlyDoubleQuote]pathData\
\[CloseCurlyDoubleQuote] : ",
 FontSize->10]], "Text",
 CellChangeTimes->{{3.8618093666644535`*^9, 3.8618093681452913`*^9}, {
  3.861809496262456*^9, 3.8618095726055417`*^9}, {3.861809716496188*^9, 
  3.8618097310756235`*^9}, {3.8618097795183105`*^9, 3.8618098147100163`*^9}},
 FontFamily->"Consolas",
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"e22cadd4-91eb-4583-8e63-ad2fd266acad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadData", "[", "pathData_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
     "\t\t        ", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"OpenRead", "[", "pathData", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"f", "==", "$Failed"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Failed to OpenRead file at: \>\"", "]"}], 
         ";", " ", 
         RowBox[{"Print", "[", " ", "pathData", " ", "]"}], ";", " ", 
         RowBox[{"Abort", "[", "]"}]}]}], " ", "]"}], ";", 
      "\[IndentingNewLine]", "\t\t        ", 
      RowBox[{"data", "=", 
       RowBox[{"ReadList", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t        ", 
      RowBox[{"Close", "[", "f", "]"}], ";", "\t\t\t", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8618097941897097`*^9, 3.861809795066695*^9}, {
  3.8707707932947135`*^9, 3.870770803870585*^9}, {3.8707708935789065`*^9, 
  3.87077089811934*^9}, {3.8866751090973635`*^9, 3.8866751192438755`*^9}, {
  3.8866753274385633`*^9, 3.8866754074060183`*^9}, {3.8866754429355125`*^9, 
  3.886675452764537*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[99]:=",ExpressionUUID->"4a8d010b-8cad-41cb-8c62-196ec1a1893b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toPath800", " ", "[", 
    RowBox[{
    "parameters0_", ",", "L_", ",", "acuracy_", ",", "gauge_", ",", 
     "NbName_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", " ", ",", "hS", ",", 
       RowBox[{"parameters", "=", "parameters0"}], ",", " ", "filename", ",", 
       "r", ",", "\[Phi]", ",", "\[Theta]", ","}], "}"}], ",", 
     RowBox[{
      RowBox[{"h", "=", 
       RowBox[{"parameters", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], " ", ";", 
      RowBox[{"hS", "=", 
       RowBox[{"parameters", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "=", "hS"}], 
      ";", "   ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gauge", "==", "\"\<free\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", 
          RowBox[{"parameters0", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "=", "0"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"filename", "=", "\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gauge", "==", "\"\<free_lambda\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", 
          RowBox[{"parameters0", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"filename", "=", "\"\<lambda_X2_JKG=X3\>\""}], ";"}]}], " ", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", "       ", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "   ", ",", " ", 
         "\"\<Files\>\"", " ", ",", "NbName", ",", "gauge", ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"filename", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<X1\>\"", "\[Rule]", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{"parameters", "[", 
                RowBox[{"[", "5", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"\"\<X2\>\"", "\[Rule]", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{"parameters", "[", 
                RowBox[{"[", "6", "]"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<X3\>\"", "\[Rule]", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "&"}], "/@", 
                RowBox[{"fromJmat", "@", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "  ", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<X4\>\"", "\[Rule]", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "&"}], "/@", 
                RowBox[{"fromJmat", "@", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], "   ", 
            "}"}]}], "]"}], " ", ",", " ", "\"\<data\>\"", "  ", ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"\"\<h=(M,N,T)_L=Y_A=Z.txt\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Y\>\"", "\[Rule]", " ", 
              RowBox[{"ToString", "[", "L", "]"}]}], ",", " ", 
             RowBox[{"\"\<Z\>\"", "\[Rule]", " ", 
              RowBox[{"ToString", "[", "acuracy", "]"}]}], ",", 
             RowBox[{"\"\<M\>\"", "->", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{"r", ",", "InputForm"}], "]"}]}], " ", ",", 
             RowBox[{"\"\<N\>\"", "->", 
              RowBox[{"ToString", "@", "\[Theta]"}]}], ",", 
             RowBox[{"\"\<T\>\"", "->", 
              RowBox[{"ToString", "@", "\[Phi]"}]}]}], "}"}]}], "   ", 
          "]"}]}], " ", "\[IndentingNewLine]", "   ", "}"}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8837297245896273`*^9, 3.883729842715426*^9}, {
   3.883729878467956*^9, 3.8837299877278028`*^9}, {3.8837301471639495`*^9, 
   3.8837301791854925`*^9}, {3.8837302422957497`*^9, 
   3.8837302584996448`*^9}, {3.883731474627163*^9, 3.8837315229124055`*^9}, 
   3.893387502402667*^9, 3.893835698039189*^9, {3.8967710490434704`*^9, 
   3.896771182847247*^9}, {3.896771476452685*^9, 3.8967714796981735`*^9}, {
   3.9029998427011423`*^9, 3.902999851408074*^9}, {3.90342471902389*^9, 
   3.9034247283370514`*^9}, {3.9034247735398345`*^9, 3.9034247955224457`*^9}, 
   3.9034261235711946`*^9, {3.9034262749323435`*^9, 3.903426315476803*^9}, {
   3.9034263485319867`*^9, 3.9034263509847846`*^9}, 
   3.903426661841999*^9},ExpressionUUID->"575eb2a2-01d7-4d66-8c20-\
b4aea72abfd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataToFile800", "[", " ", 
    RowBox[{
    "parameters0_", ",", "L_", ",", "acuracy_", ",", "data_", ",", "gauge_", 
     ",", "NbName_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"path", ",", "f", ",", "filename", ",", 
       RowBox[{"parameters", "=", "parameters0"}]}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gauge", "==", "\"\<free\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", 
          RowBox[{"parameters0", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "=", "0"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"filename", "=", "\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gauge", "==", "\"\<free_lambda\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", 
          RowBox[{"parameters0", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"filename", "=", "\"\<lambda_X2_JKG=X3\>\""}], ";"}]}], " ", 
       "]"}], ";", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"createDir", "@", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], " ", ",", "\"\<Files\>\"", 
          ",", "  ", "NbName", ",", "gauge", ",", " ", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"filename", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<X1\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X2\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X3\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "&"}], "/@", 
                 RowBox[{"fromJmat", "@", 
                  RowBox[{"parameters", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], "  ", "]"}]}], ",", 
              RowBox[{"\"\<X4\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "&"}], "/@", 
                 RowBox[{"fromJmat", "@", 
                  RowBox[{"parameters", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]}]}], "   ", 
             "}"}]}], "]"}]}], " ", "    ", "}"}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"path", " ", "=", " ", 
       RowBox[{"toPath800", "[", " ", 
        RowBox[{
        "parameters", ",", "L", ",", "acuracy", ",", "gauge", ",", "NbName"}],
         "]"}]}], ";", "\t\t", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"OpenAppend", "[", "path", "]"}]}], ";", "\[IndentingNewLine]",
       "\t\t ", 
      RowBox[{"Write", "[", " ", 
       RowBox[{"f", ",", " ", "data"}], "]"}], ";", "\[IndentingNewLine]", 
      "\t\t ", 
      RowBox[{"Close", "[", "f", "]"}], ";"}]}], "                ", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8707712817983246`*^9, 3.8707713306544037`*^9}, {
   3.870771423627341*^9, 3.870771423806079*^9}, {3.870772180366624*^9, 
   3.8707721999571996`*^9}, {3.8707766845051775`*^9, 3.870776686806966*^9}, {
   3.883730295598323*^9, 3.883730305116412*^9}, {3.8837313882037907`*^9, 
   3.883731462746214*^9}, 3.8933875037014513`*^9, 3.893835698045164*^9, {
   3.8967715074256697`*^9, 3.8967715516265264`*^9}, {3.903424735582168*^9, 
   3.903424754886239*^9}, {3.903426582979761*^9, 3.9034266429453154`*^9}, {
   3.9034266873834553`*^9, 3.9034266874948444`*^9}},
 FontFamily->"Consolas",
 CellLabel->
  "In[156]:=",ExpressionUUID->"807f3ba5-2aef-4049-aea3-8f660cac15f9"],

Cell[TextData[StyleBox["create a function that automatically creates a path \
name given a set of values [  parameters = { J, K, \[CapitalGamma], \
{hx,hy,hz} }  ]",
 FontSize->10]], "Text",
 CellChangeTimes->{{3.8618093666644535`*^9, 3.8618093681452913`*^9}, {
   3.861809496262456*^9, 3.8618095726055417`*^9}, {3.861809716496188*^9, 
   3.8618097310756235`*^9}, 3.8618097795183105`*^9, {3.861809858894718*^9, 
   3.8618099376722355`*^9}},
 FontFamily->"Consolas",
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"297c7722-7294-4b07-a549-c0fa4766203d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadDataTry", "[", "pathData_", "]"}], ":=", "\n", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "data", ",", 
       RowBox[{"path", "=", 
        RowBox[{"FindFile", "[", "pathData", "]"}]}]}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"path", "==", "$Failed"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<New entry at:\>\"", ",", "pathData"}], "]"}], ";"}], 
         "*)"}], 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", "\n", 
      "\t\t        ", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"OpenRead", "[", "pathData", "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"f", "==", "$Failed"}], ",", " ", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Failed to OpenRead file at: \>\"", ",", " ", "pathData"}], 
            " ", "]"}], ";", " ", 
           RowBox[{"Abort", "[", "]"}]}]}], " ", "]"}], ";"}], "*)"}], "\n", 
      "\t\t        ", 
      RowBox[{"data", "=", 
       RowBox[{"ReadList", "[", "f", "]"}]}], ";", "\n", "\t\t        ", 
      RowBox[{"Close", "[", "f", "]"}], ";", "\t\t\t", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\n", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.902507651875539*^9},
 CellLabel->
  "In[102]:=",ExpressionUUID->"09917604-5614-4d44-b9d5-9d21d5a7d8a7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Hamiltonian  matrices", "Subsubsection",
 CellChangeTimes->{{3.85287578110361*^9, 3.8528758327496805`*^9}, {
  3.868447724572776*^9, 3.868447729906935*^9}},
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Bold",ExpressionUUID->"89758110-0a30-4fa0-ad94-8c6848b529b0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"FullSimplify", "@", 
   RowBox[{"Det", "[", "   ", 
    RowBox[{"Total", "@", 
     RowBox[{"Jmat", "[", 
      RowBox[{
       RowBox[{"J", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"K", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"\[CapitalGamma]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"0", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
       RowBox[{"DM", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], " ", "]"}]}], "  ", 
    "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.90336033337401*^9, 3.9033603993892097`*^9}, {
  3.9033604427581873`*^9, 3.9033604493190117`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"e9ec061e-8742-4cb4-8771-20e212d3983a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Jmat", "[", 
    RowBox[{"J_", ",", "K_", ",", "G_", ",", "Gp_", ",", "D_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"J", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"K", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Gp", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"J", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Gp", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"J", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"J", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Gp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"J", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"K", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"J", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"J", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"J", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Gp", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"J", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", 
          RowBox[{"K", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}]}], "   ", 
    "\[IndentingNewLine]", " ", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9030101534698668`*^9, 3.9030101587120204`*^9}, {
  3.903425562102536*^9, 3.9034255623041625`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"7b6e2af4-effe-4e1c-8193-f82a0e2a47b7"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AMF", "[", 
     RowBox[{"Jm_", ",", "U_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"AMF", ",", 
        RowBox[{"N", "=", "Nmat"}]}], "}"}], ",", "  ", 
      RowBox[{
       RowBox[{"AMF", "=", 
        RowBox[{"Table", "[", "    ", 
         RowBox[{
          RowBox[{"Sum", "[", "   ", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"Jm", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
              RowBox[{"U", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}]}], " ", ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], "    ", 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"KroneckerProduct", "[", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "#"}], "]"}], 
         "&"}], "/@", 
        RowBox[{"Re", "@", "AMF"}]}]}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"BMF", "[", 
     RowBox[{"Jm_", ",", "h_", ",", "\[Lambda]_", ",", "W_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ba", ",", "Bb", ",", 
        RowBox[{"M", "=", "Mmat"}], ",", 
        RowBox[{"N", "=", "Nmat"}], ",", 
        RowBox[{"G", "=", "Gmat"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ba", "=", 
        RowBox[{"Sum", "[", "    ", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", "    ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Jm", "[", 
                RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
              RowBox[{"Tr", "[", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"W", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[Transpose]"], ".", 
                RowBox[{"N", "[", 
                 RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", 
           "-", 
           RowBox[{"2", " ", 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"N", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"G", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], "        ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bb", "=", 
        RowBox[{"Sum", "[", "    ", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", "    ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Jm", "[", 
                RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
              RowBox[{"Tr", "[", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"W", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Transpose]"], ".", 
                RowBox[{"N", "[", 
                 RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", 
           "-", 
           RowBox[{"2", " ", 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"N", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"G", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], "         ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"Re", "@", "Ba"}]}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"Re", "@", "Bb"}]}], "]"}]}]}]}], " ", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"cMF", "[", 
     RowBox[{"Jm_", ",", "U_", ",", "W_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"N", "=", "Nmat"}], "}"}], ",", " ", 
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "8"}], "  ", 
         RowBox[{
          RowBox[{"Jm", "[", 
           RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], " ", "]"}], " ", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}]}], "+", 
           RowBox[{"2", "  ", 
            RowBox[{"Tr", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"U", "[", 
                RowBox[{"[", "\[Gamma]", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
              RowBox[{"U", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}]}], "   ", 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
     "          ", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"enMF", "[", 
     RowBox[{"Jm_", ",", "U_", ",", "W_", ",", "h_", ",", "\[Lambda]_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"M", "=", "Mmat"}], ",", 
        RowBox[{"N", "=", "Nmat"}], ",", 
        RowBox[{"G", "=", "Gmat"}]}], "}"}], ",", "    ", 
      RowBox[{
       RowBox[{"cMF", "[", 
        RowBox[{"Jm", ",", "U", ",", "W"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{"1", "/", "4"}], "  ", 
        RowBox[{"Sum", "[", "   ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", "\[Sigma]", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "]"}]}], " ", 
           "+", "    ", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", 
              RowBox[{"\[Sigma]", ",", "\[Gamma]"}], "]"}], "]"}], " ", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", "\[Sigma]", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"G", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "]"}]}]}], 
          "       ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}]}], 
     "        ", "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.9025091654690228`*^9, 3.9025091755303926`*^9}, 
   3.90251031710708*^9, 3.9025103833038435`*^9, {3.9025133214905095`*^9, 
   3.9025133400093775`*^9}, 3.9026591380290966`*^9},
 CellLabel->
  "In[105]:=",ExpressionUUID->"6607212d-ab68-4a3c-9feb-c2c50dbddbb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Hmf", "[", 
    RowBox[{"Jmat_", ",", "h_", ",", "U_", ",", "V_", ",", "L_", ",", 
     RowBox[{"\[Eta]_", ":", "1"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Nc", "=", 
        SuperscriptBox["L", "2"]}], ",", "H", ",", "Hmat", ",", "\[Lambda]"}],
       "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"\[Eta]", " ", 
        RowBox[{"\[Lambda]eff", "[", 
         RowBox[{"Jmat", ",", "h", ",", "V", ",", "L"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Hmat", "=", 
       RowBox[{"Haux", "[", 
        RowBox[{
        "Jmat", ",", "h", ",", "U", ",", "V", ",", "\[Lambda]", ",", "L"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"H", "=", " ", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rx", ",", "ry", ",", "rz", ",", "mx", ",", "ny"}], 
             "}"}], ",", " ", 
            RowBox[{
             RowBox[{"mx", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "L"}], "]"}]}], ";", 
             RowBox[{"ny", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L"}], "]"}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"rx", "=", 
              RowBox[{"mx", "+", 
               RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", 
             RowBox[{"ry", "=", 
              RowBox[{"m", "+", 
               RowBox[{"ny", " ", "L"}], "+", "1"}]}], ";", 
             RowBox[{"rz", "=", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", 
             "\[IndentingNewLine]", "  ", 
             RowBox[{
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"one", "[", 
                 RowBox[{"rz", ",", "rx", ",", "Nc"}], "]"}], ",", 
                RowBox[{"Hmat", "[", 
                 RowBox[{"[", 
                  RowBox[{"rz", ",", "1"}], "]"}], "]"}]}], "      ", "]"}], 
              "+", " ", "\[IndentingNewLine]", 
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"one", "[", 
                 RowBox[{"rz", ",", "ry", ",", "Nc"}], "]"}], ",", 
                RowBox[{"Hmat", "[", 
                 RowBox[{"[", 
                  RowBox[{"rz", ",", "2"}], "]"}], "]"}]}], "    ", "]"}], 
              "+", " ", "\[IndentingNewLine]", 
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"one", "[", 
                 RowBox[{"rz", ",", "rz", ",", "Nc"}], "]"}], ",", 
                RowBox[{"Hmat", "[", 
                 RowBox[{"[", 
                  RowBox[{"rz", ",", "3"}], "]"}], "]"}]}], "    ", 
               "]"}]}]}]}], "\[IndentingNewLine]", "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", "  ", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"H", "+", 
         RowBox[{"H", "\[ConjugateTranspose]"}]}], ")"}]}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.882957814291709*^9, 3.8829578181393504`*^9}, {
   3.8829580740550365`*^9, 3.8829581001830273`*^9}, 3.8829582795039988`*^9, {
   3.902507683557411*^9, 3.9025077652299805`*^9}, {3.902507827533038*^9, 
   3.9025078285684214`*^9}, {3.9025078597786555`*^9, 3.902507879037114*^9}, {
   3.902508533614656*^9, 3.9025085675012665`*^9}, {3.902508721494076*^9, 
   3.902508726219141*^9}, {3.9025087594972258`*^9, 3.9025088386511073`*^9}, {
   3.902508915108306*^9, 3.902508915352504*^9}, {3.902514813640723*^9, 
   3.902514825767732*^9}, {3.9025163542755394`*^9, 3.902516378623106*^9}, {
   3.902942914290815*^9, 3.902942915472452*^9}, {3.903009736430647*^9, 
   3.9030097395534134`*^9}, {3.903010038740455*^9, 3.9030100569209433`*^9}, {
   3.903010176241294*^9, 3.903010203670555*^9}, {3.903010251169075*^9, 
   3.9030102554867325`*^9}, {3.9030103349822116`*^9, 3.903010335811739*^9}, {
   3.903010439154776*^9, 3.9030104664920497`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"f1470e9b-3fe3-4e66-94d3-615e42f9fb46"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Haux", "[", 
    RowBox[{
    "Jmat_", ",", "h_", ",", "U_", ",", "V_", ",", "\[Lambda]_", ",", "L_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "=", "Mmat"}], ",", 
       RowBox[{"Nm", "=", "Nmat"}], ",", 
       RowBox[{"G", "=", "Gmat"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"Ax", ",", "Ay", ",", "Az", ",", "BA", ",", "BB"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Ax", ",", "Ay", ",", "Az"}], "}"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "#"}], 
               "]"}]}], "&"}], "/@", 
            RowBox[{"Re", "@", 
             RowBox[{"Table", "[", "    ", 
              RowBox[{
               RowBox[{"Sum", "[", "   ", 
                RowBox[{
                 RowBox[{"2", "  ", 
                  RowBox[{
                   RowBox[{"Jmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
                  RowBox[{
                   RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
                   RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], ".", 
                   RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Beta]", "]"}], "]"}]}]}], " ", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], 
               ",", " ", 
               RowBox[{"{", 
                RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], 
              "]"}]}]}]}], "   ", ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"BA", ",", "BB"}], "}"}], "        ", "=", 
           RowBox[{"\[ImaginaryI]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
                RowBox[{"Re", "@", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sum", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Jmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
                    RowBox[{"Tr", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "\[Transpose]"], 
                    ".", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], 
                    " ", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"h", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Lambda]", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
                    RowBox[{"G", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], 
                  "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
                RowBox[{"Re", "@", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sum", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Jmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
                    RowBox[{"Tr", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "\[Transpose]"], 
                    ".", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], 
                    " ", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"h", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Lambda]", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
                    RowBox[{"G", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], 
                  "]"}]}]}], "]"}]}], "   ", "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Ax", ",", "Ay", ",", 
            RowBox[{"Az", "+", "BA", "+", "BB"}]}], "}"}]}]}], " ", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1", ",", 
         SuperscriptBox["L", "2"]}], "}"}]}], "]"}]}], "                  ", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9025088498778496`*^9, 3.9025089298882294`*^9}, {
  3.902509285971363*^9, 3.9025093227265406`*^9}, {3.9025093696372375`*^9, 
  3.9025093854549227`*^9}, {3.9025094171353865`*^9, 3.902509432097284*^9}, {
  3.9025095286924124`*^9, 3.9025095310096292`*^9}, {3.902509687859318*^9, 
  3.902509719158452*^9}, {3.902509972042452*^9, 3.9025099908098965`*^9}, {
  3.9025135731164737`*^9, 3.90251361375003*^9}, {3.9025136649801493`*^9, 
  3.9025138543861732`*^9}, {3.902513895786209*^9, 3.902513897159852*^9}, {
  3.9025151146503754`*^9, 3.902515141875595*^9}, {3.903009741625659*^9, 
  3.903009746419783*^9}, {3.9030103985446324`*^9, 3.903010406488474*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"a04abf83-75ac-4fe3-a3fa-1dc9618af95e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UmatK", "[", "H_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R", "=", 
       RowBox[{"Eigensystem", "@", 
        RowBox[{"N", "[", "H", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ReverseSort", "[", 
         RowBox[{"R", "\[Transpose]"}], "]"}], "\[Transpose]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[Transpose]"}]}], " ", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"8cbf734c-61e8-4a65-b32f-a9aca70998d8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Heff", "[", 
     RowBox[{"Jmat_", ",", "h_", ",", "W_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nm", "=", "Nmat"}], ",", "M"}], "}"}], ",", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"Tr", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"W", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "\[Sigma]"}], "]"}], "]"}], "\[Transpose]"],
              ".", 
             RowBox[{"Nm", "[", 
              RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            SuperscriptBox["L", "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], " ", "]"}]}], 
       " ", ";", "\[IndentingNewLine]", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"h", "-", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"Sum", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Jmat", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], ".", 
              "\[IndentingNewLine]", 
              RowBox[{"M", "\[LeftDoubleBracket]", "   ", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"r", "+", 
                   RowBox[{
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"r", ",", "L"}], "]"}], "-", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"r", "-", 
                    RowBox[{"1", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "\[Sigma]"}], "-", "3"}], ")"}]}]}], ",", 
                    "L"}], "]"}]}], " ", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[LeftFloor]", 
                    FractionBox[
                    RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "+", 
                    RowBox[{"1", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "\[Sigma]"}], "-", "3"}], ")"}]}]}], ",", 
                    "L"}], "]"}], "-", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[LeftFloor]", 
                    FractionBox[
                    RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], ",", 
                    "L"}], "]"}]}], ")"}], " ", " ", "L"}], ",", "0"}], " ", 
                    "}"}], "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "  ", ",", 
                  SuperscriptBox["L", "2"], ",", "1"}], "]"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"\[Sigma]", "+", "1"}], ",", "2", ",", "1"}], 
                 "]"}]}], "\[RightDoubleBracket]"}]}], "  ", ",", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           SuperscriptBox["L", "2"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}], 
     "    ", "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9025102120971794`*^9, 3.9025102709820414`*^9}, {
   3.9025139204260073`*^9, 3.902514012764992*^9}, {3.9025140437481017`*^9, 
   3.9025141017741847`*^9}, {3.9025146389479337`*^9, 3.902514745216813*^9}, {
   3.9025147836964645`*^9, 3.902514784123452*^9}, {3.902514887601636*^9, 
   3.9025150478268223`*^9}, {3.9025151037826395`*^9, 3.902515105425405*^9}, {
   3.902515193445398*^9, 3.902515212368495*^9}, {3.9025157190082474`*^9, 
   3.902515741956709*^9}, 3.9025158981792884`*^9, {3.9025159569920483`*^9, 
   3.9025159633835125`*^9}, 3.902516008051693*^9, {3.9025160985200043`*^9, 
   3.902516204181082*^9}, {3.9025162364923077`*^9, 3.9025162516813183`*^9}, {
   3.9029983535644464`*^9, 3.902998354608704*^9}, {3.9030075090884132`*^9, 
   3.903007516298764*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"4e63a703-f141-47f3-b08e-338c25c5f323"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"r", "-", "1", "-", 
      RowBox[{
       RowBox[{"\[LeftFloor]", 
        FractionBox[
         RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "L"}]}]}], ";", 
    "  ", 
    RowBox[{"n", "=", 
     RowBox[{"\[LeftFloor]", 
      FractionBox[
       RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}]}], ";", "       ", 
    RowBox[{"\[Delta]", "=", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"r", "-", "1", "-", 
            RowBox[{
             RowBox[{"\[LeftFloor]", 
              FractionBox[
               RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "L"}], "+", 
            "1"}], ",", "L"}], "]"}], "-", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"r", "-", "1", "-", 
            RowBox[{
             RowBox[{"\[LeftFloor]", 
              FractionBox[
               RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "L"}]}], ",",
            "L"}], "]"}]}], "        ", ")"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[LeftFloor]", 
              FractionBox[
               RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "+", "1"}], 
            ",", "L"}], "]"}], "-", 
          RowBox[{"\[LeftFloor]", 
           FractionBox[
            RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}]}], ")"}], " ", 
        "L"}], ",", "0"}], " ", "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9025152146181574`*^9, 3.9025152656708097`*^9}, {
  3.9025155114411435`*^9, 3.9025155190158577`*^9}, {3.902516253567867*^9, 
  3.9025162602373214`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"ab3a2d95-6d51-476a-8e52-93ec3f131b36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]eff", "[", 
    RowBox[{"Jmat_", ",", "h_", ",", "V_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "M", "}"}], ",", "  ", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"traceN", "[", 
           RowBox[{"V", "[", 
            RowBox[{"[", 
             RowBox[{"r", ",", "\[Sigma]"}], "]"}], "]"}], " ", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           SuperscriptBox["L", "2"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], " ", "]"}]}], 
      " ", ";", " ", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"h", "-", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"Sum", "[", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Jmat", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], ".", 
             RowBox[{"M", "\[LeftDoubleBracket]", "   ", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"r", "+", 
                  RowBox[{
                   RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"r", ",", "L"}], "]"}], "-", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"r", "-", 
                    RowBox[{"1", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "\[Sigma]"}], "-", "3"}], ")"}]}]}], ",", 
                    "L"}], "]"}]}], " ", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[LeftFloor]", 
                    FractionBox[
                    RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "+", 
                    RowBox[{"1", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "\[Sigma]"}], "-", "3"}], ")"}]}]}], ",", 
                    "L"}], "]"}], "-", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[LeftFloor]", 
                    FractionBox[
                    RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], ",", 
                    "L"}], "]"}]}], ")"}], " ", " ", "L"}], ",", "0"}], " ", 
                    "}"}], "[", 
                   RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "  ", ",", 
                 SuperscriptBox["L", "2"], ",", "1"}], "]"}], ",", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Sigma]", "+", "1"}], ",", "2", ",", "1"}], 
                "]"}]}], "\[RightDoubleBracket]"}]}], "  ", ",", 
            RowBox[{"{", 
             RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", 
          SuperscriptBox["L", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}], "    ",
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9025102120971794`*^9, 3.9025102709820414`*^9}, {
   3.9025139204260073`*^9, 3.902514012764992*^9}, {3.9025140437481017`*^9, 
   3.9025141017741847`*^9}, {3.9025146389479337`*^9, 3.902514745216813*^9}, {
   3.9025147836964645`*^9, 3.902514784123452*^9}, {3.902514887601636*^9, 
   3.9025150478268223`*^9}, {3.9025151037826395`*^9, 3.902515105425405*^9}, {
   3.902515193445398*^9, 3.902515212368495*^9}, {3.9025157190082474`*^9, 
   3.902515741956709*^9}, 3.9025158981792884`*^9, {3.9025159569920483`*^9, 
   3.9025159633835125`*^9}, 3.902516008051693*^9, {3.9025160985200043`*^9, 
   3.902516204181082*^9}, {3.9025162364923077`*^9, 3.9025162516813183`*^9}, {
   3.9029983535644464`*^9, 3.9029984098341055`*^9}, {3.902998568449911*^9, 
   3.9029985851430025`*^9}, {3.903007220601178*^9, 3.903007223774622*^9}, {
   3.9033563555911417`*^9, 3.9033563610350666`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"eff4ad7b-99d2-4cb6-8aee-329a987e753c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Mean field parameters ", "Subsubsection",
 CellChangeTimes->{{3.8684480451770086`*^9, 3.8684480477902627`*^9}, {
  3.902944628617072*^9, 3.9029446303535547`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"b3e77d08-352b-4a7f-aa6e-6655b45d73f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tx", " ", "=", " ", 
    RowBox[{"KroneckerProduct", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[ImaginaryI]", ",", 
          RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Band", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "  ", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ty", " ", "=", " ", 
   RowBox[{"KroneckerProduct", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[ImaginaryI]", ",", 
         RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}], "}"}], ",", " ", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "  ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tz", " ", "=", " ", 
    RowBox[{"KroneckerProduct", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[ImaginaryI]", ",", 
          RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Band", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "  ", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tmat", "[", 
    RowBox[{"L1_", ",", "L2_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Nc", "=", 
        RowBox[{"L1", " ", "L2"}]}], ",", "T"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rx", ",", "ry", ",", "rz", ",", "mx", ",", "ny"}], "}"}],
            ",", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"mx", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "+", "1"}], ",", "L1", ",", "1"}], "]"}]}], ";", 
            RowBox[{"ny", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L2", ",", "1"}], "]"}]}], ";", 
            " ", 
            RowBox[{"rx", "=", 
             RowBox[{"mx", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}], "L1"}]}]}], ";", 
            RowBox[{"ry", "=", 
             RowBox[{"m", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ny", "-", "1"}], ")"}], "L1"}]}]}], ";", 
            RowBox[{"rz", "=", 
             RowBox[{"m", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}], "L1"}]}]}], ";", 
            "\[IndentingNewLine]", " ", 
            RowBox[{
             RowBox[{"KroneckerProduct", "[", " ", 
              RowBox[{
               RowBox[{"one", "[", 
                RowBox[{"rz", ",", "rx", ",", "Nc"}], "]"}], ",", "Tx"}], 
              "]"}], "+", "  ", 
             RowBox[{"KroneckerProduct", "[", " ", 
              RowBox[{
               RowBox[{"one", "[", 
                RowBox[{"rz", ",", "ry", ",", "Nc"}], "]"}], ",", "Ty"}], 
              "]"}], "+", " ", 
             RowBox[{"KroneckerProduct", "[", " ", 
              RowBox[{
               RowBox[{"one", "[", 
                RowBox[{"rz", ",", "rz", ",", "Nc"}], "]"}], ",", "Tz"}], " ",
               "]"}]}]}]}], "]"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "L1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "L2"}], "}"}]}], "]"}]}], ";", "T"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.868448425163019*^9},
 FontFamily->"Consolas",
 CellLabel->
  "In[112]:=",ExpressionUUID->"d37ec3c5-abcc-4e5d-b6a4-5e9c0d44f4b4"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bilinears", "[", 
     RowBox[{"U_", ",", "L_"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", "  ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Nc", "=", 
         SuperscriptBox["L", "2"]}], ",", "TU", ",", "TUh", ",", "u", ",", 
        RowBox[{"\[Chi]", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"Null", ",", "3"}], "]"}]}], ",", 
        RowBox[{"\[Omega]", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"Null", ",", "2"}], "]"}]}], ",", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"Null", ",", "6"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TU", "=", 
        RowBox[{
         RowBox[{"Tmat", "[", 
          RowBox[{"L", ",", "L"}], "]"}], ".", "U"}]}], ";", 
       RowBox[{"TUh", "=", 
        RowBox[{"TU", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], "Nc"}], ";;", 
            RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", 
       RowBox[{"u", "=", 
        RowBox[{"\[ImaginaryI]", "  ", 
         RowBox[{"TUh", ".", 
          RowBox[{"TUh", "\[ConjugateTranspose]"}]}]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", " ", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}]}]}],
             "   ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "rx", ",", "mx", ",", "Io", ",", "J"}], 
              "}"}], ",", 
             RowBox[{
              RowBox[{"mx", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ",", "L"}], " ", "]"}]}], ";", " ", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"rx", "=", 
               RowBox[{"mx", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"8", "rx"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}]}]}],
             "    ", "]"}], "   ", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "ry", ",", "ny", ",", "Io", ",", "J"}], 
              "}"}], ",", " ", 
             RowBox[{
              RowBox[{"ny", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ",", "L"}], "]"}]}], ";", "  ", 
              RowBox[{"ry", "=", 
               RowBox[{"m", "+", 
                RowBox[{"ny", " ", "L"}]}]}], ";", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"8", "ry"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "  ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", " ", 
                TemplateBox[{
                  RowBox[{"Io", ",", "J"}]},
                 "KroneckerDeltaSeq"]}], "  ", "+", " ", 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"u", "[", 
                   RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                  RowBox[{"u", "[", 
                   RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
            " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"+", " ", 
               FractionBox["1", "2"]}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}], "  ", 
              RowBox[{"u", "[", 
               RowBox[{"[", 
                RowBox[{"J", ",", "Io"}], "]"}], "]"}]}], "  ", "*)"}], "   ",
             "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", " ", 
                TemplateBox[{
                  RowBox[{"Io", ",", "J"}]},
                 "KroneckerDeltaSeq"]}], " ", "+", 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"u", "[", 
                   RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                  RowBox[{"u", "[", 
                   RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
            " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"+", " ", 
               FractionBox["1", "2"]}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}], "  ", 
              RowBox[{"u", "[", 
               RowBox[{"[", 
                RowBox[{"J", ",", "Io"}], "]"}], "]"}]}], "  ", "*)"}], " ", 
            " ", "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", " ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"r", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "+", "1"}], ",", "L"}], " ", "]"}], " ", 
                 "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "         ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", " ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"r", "=", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "-", "1"}], ",", "L"}], " ", "]"}], "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "       ", "    ", "]"}], "   ", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", " ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", "  ", 
              RowBox[{"r", "=", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "+", "1"}], ",", "L"}], " ", "]"}], "+", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "-", "1"}], ",", "L"}], "]"}], " ", "L"}]}]}],
               ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "            ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", "  ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"r", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "-", "1"}], ",", "L"}], " ", "]"}], " ", 
                 "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", " ", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "            ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", "  ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"r", "=", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "+", "1"}], ",", "L"}], " ", "]"}], "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", " ", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "            ", "]"}], "   ", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
              "rz", ",", "r", ",", "mx", ",", "ny", ",", "Io", ",", "J"}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"r", "=", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "-", "1"}], ",", "L"}], " ", "]"}], "+", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}]}]}],
               ";", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", "+", "4", " ", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "           ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Chi]", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"\[Chi]", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"\[Chi]", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], " ", ",", "u"}], " ", 
          "}"}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "16"}]]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"4f595269-c9d5-4b8e-9be1-753434b1bc87"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]gauge4v", "[", 
    RowBox[{"\[Chi]0_", ",", "L_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d1", ",", "d2", ",", 
       RowBox[{"\[Chi]", "=", "\[Chi]0"}], ",", "mS", ",", "nS", ",", "mN", 
       ",", "nN", ",", "r2"}], " ", "}"}], ",", "   ", 
     RowBox[{
      RowBox[{"r2", "=", " ", 
       RowBox[{"\[LeftFloor]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"\[LeftCeiling]", 
          RowBox[{"L", "/", "2"}], "\[RightCeiling]"}]}], "\[RightFloor]"}]}],
       ";", " ", 
      RowBox[{"d2", "=", 
       RowBox[{"2", "r2"}]}], ";", 
      RowBox[{"d1", "=", 
       RowBox[{"L", "-", "d2"}]}], ";", "  ", 
      RowBox[{"mS", "=", 
       RowBox[{"r2", "-", "1"}]}], ";", 
      RowBox[{"nS", "=", 
       RowBox[{"r2", "-", "1"}]}], ";", 
      RowBox[{"mN", "=", 
       RowBox[{"L", "-", "r2", "-", "1"}]}], ";", 
      RowBox[{"nN", "=", 
       RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "\n", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", "mS"}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"nS", "+", "i"}]}], " ", ";", "       ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}]}], "      ", 
         "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", "   ", "\n", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", "mN"}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"nN", "-", "i", "+", "1"}]}], ";", " ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}]}], "       ", 
         "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", "       ", 
      "\[Chi]"}]}], " ", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[117]:=",ExpressionUUID->"46979265-40c0-4da5-81d2-778e1f7d8218"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]fixgauge", "[", 
    RowBox[{"\[Chi]0_", ",", "u0_", ",", "L_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]", "=", "\[Chi]0"}], " ", "}"}], ",", " ", "\n", 
     RowBox[{
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Chi]", "[", 
            RowBox[{"[", 
             RowBox[{"\[Alpha]", ",", "r"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"\[Alpha]", "+", "1"}], ",", 
             RowBox[{"\[Alpha]", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"u0", "[", 
            RowBox[{"[", 
             RowBox[{"r", ",", "\[Alpha]"}], "]"}], "]"}], 
           RowBox[{"Abs", "@", 
            RowBox[{
             RowBox[{"\[Chi]0", "[", 
              RowBox[{"[", 
               RowBox[{"\[Alpha]", ",", "r"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"\[Alpha]", "+", "1"}], ",", 
               RowBox[{"\[Alpha]", "+", "1"}]}], "]"}], "]"}]}]}]}], ";"}], 
        "      ", ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], " ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", 
          RowBox[{"L", "^", "2"}]}], "}"}]}], "]"}], ";", "   ", 
      "\[IndentingNewLine]", "   ", "\[Chi]"}]}], " ", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[118]:=",ExpressionUUID->"247d95a1-bf8f-431b-847d-f99a4a26dc9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"icc", "[", 
    RowBox[{"U_", ",", "L_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "  ", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"Nc", "=", 
        RowBox[{"L", "^", "2"}]}], ",", "TUh", ",", "icc"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"TUh", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"T", " ", ".", " ", "U"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "Nc"}], ";;", 
             RowBox[{"-", "1"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"10", "^", 
          RowBox[{"-", "12"}]}]}], "]"}]}], ";", 
      RowBox[{"icc", "=", " ", 
       RowBox[{"I", " ", 
        RowBox[{"TUh", " ", ".", " ", 
         RowBox[{"TUh", "\[ConjugateTranspose]"}]}]}]}], " ", ";", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"icc", "-", 
         RowBox[{"ConjugateTranspose", "[", "icc", "]"}]}], " ", ")"}], "/", 
       "2"}]}]}], " ", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[119]:=",ExpressionUUID->"3340ea2e-3efa-4880-b0e0-1592b4901db7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy MF", "Subsubsection",
 CellChangeTimes->{{3.871463671236149*^9, 3.8714636725835357`*^9}, {
  3.8951314360002074`*^9, 3.8951314365585756`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"c8642423-6c54-4e5b-bbfc-31fe829d8430"],

Cell["Define energy ", "Text",
 CellChangeTimes->{{3.902943663087566*^9, 
  3.902943669564706*^9}},ExpressionUUID->"cab4f53f-a9ed-41c8-a8fe-\
51dab0829624"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"cMF", "[", 
     RowBox[{"Jm_", ",", "U_", ",", "V_", ",", "L_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"N", "=", "Nmat"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"8", 
         SuperscriptBox["L", "2"]}]], 
       RowBox[{"Sum", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Jm", "[", 
            RowBox[{"[", 
             RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Tr", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"V", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "1"}], "]"}], "]"}], "\[Transpose]"}], 
               ".", 
               RowBox[{"N", "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], " ", "]"}], " ", 
             RowBox[{"Tr", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"V", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "2"}], "]"}], "]"}], "\[Transpose]"}], 
               ".", 
               RowBox[{"N", "[", 
                RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{"2", "  ", 
             RowBox[{"Tr", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"U", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], 
                "\[Transpose]"}], ".", 
               RowBox[{"N", "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
               RowBox[{"U", "[", 
                RowBox[{"[", 
                 RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], ".", 
               RowBox[{"N", "[", 
                RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}]}], "   ",
            ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           SuperscriptBox["L", "2"]}], "}"}]}], "]"}]}]}], " ", "]"}]}], ";", 
   "\n", 
   RowBox[{
    RowBox[{"enMF", "[", 
     RowBox[{
     "Jm_", ",", "U_", ",", "V_", ",", "h_", ",", "\[Lambda]_", ",", "L_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"M", "=", "Mmat"}], ",", 
        RowBox[{"N", "=", "Nmat"}], ",", 
        RowBox[{"G", "=", "Gmat"}]}], "}"}], ",", "    ", 
      RowBox[{
       RowBox[{"cMF", "[", 
        RowBox[{"Jm", ",", "U", ",", "V", ",", "L"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{"(", 
         FractionBox["1", 
          RowBox[{"4", 
           SuperscriptBox["L", "2"]}]], ")"}], " ", " ", 
        RowBox[{"Sum", "[", "   ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"V", "[", 
                RowBox[{"[", 
                 RowBox[{"r", ",", "\[Sigma]"}], "]"}], "]"}], 
               "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "]"}]}], " ", 
           "+", "  ", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "\[Sigma]", ",", "\[Gamma]"}], "]"}], "]"}], 
            " ", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"V", "[", 
                RowBox[{"[", 
                 RowBox[{"r", ",", "\[Sigma]"}], "]"}], "]"}], 
               "\[Transpose]"}], ".", 
              RowBox[{"G", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", 
            SuperscriptBox["L", "2"]}], "}"}]}], "]"}]}]}]}], "        ", 
     "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9025103193342323`*^9, 3.9025103272773685`*^9}, {
  3.9025103859588904`*^9, 3.9025105223766904`*^9}, {3.902510600677963*^9, 
  3.902510727876316*^9}, {3.902510761240363*^9, 3.902510801582918*^9}, {
  3.9025130806922216`*^9, 3.9025132554314413`*^9}, {3.902513346842637*^9, 
  3.9025133519363637`*^9}, {3.9025133853069897`*^9, 3.902513387618909*^9}, {
  3.902513867235485*^9, 3.902513867615872*^9}, {3.9030074876783314`*^9, 
  3.9030075007283945`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"e724c950-8902-4fbc-8d21-d9cd41715e69"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"constantMF", "[", 
    RowBox[{"Jmat_", ",", "U_", ",", "V_", ",", "L_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Nc", "=", 
        SuperscriptBox["L", "2"]}], ",", "C"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "r", ",", "rA", ",", "rB", ",", "mx", ",", "ny", ",", "N", ",", 
             "G"}], "}"}], ",", " \t", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mx", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "+", "1"}], ",", "L"}], "]"}]}], ";", 
            RowBox[{"ny", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"r", "=", 
             RowBox[{"m", "+", 
              RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "   ", 
            "\[IndentingNewLine]", 
            RowBox[{"rA", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mx", "+", 
                RowBox[{"n", " ", "L"}], "+", "1"}], ",", 
               RowBox[{"m", "+", 
                RowBox[{"ny", " ", "L"}], "+", "1"}], ",", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}], "+", "1"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"mx", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "-", "1"}], ",", "L"}], "]"}]}], ";", 
            RowBox[{"ny", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "-", "1"}], ",", "L"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"rB", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mx", "+", 
                RowBox[{"n", " ", "L"}], "+", "1"}], ",", 
               RowBox[{"m", "+", 
                RowBox[{"ny", " ", "L"}], "+", "1"}], ",", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}], "+", "1"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", " ", 
            RowBox[{
             RowBox[{
              FractionBox["1", "8"], 
              RowBox[{"Sum", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"traceN", "[", 
                   RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"rA", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], ".", 
                  RowBox[{"Jmat", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"rA", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                   "\[RightDoubleBracket]"}], ".", 
                  RowBox[{"traceN", "[", 
                   RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"rA", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"traceN", "[", 
                   RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"rB", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "]"}], ".", 
                  RowBox[{"Jmat", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"rB", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], ",", "\[Gamma]"}], 
                   "\[RightDoubleBracket]"}], ".", 
                  RowBox[{"traceN", "[", 
                   RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"rB", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{
              FractionBox["1", "4"], 
              RowBox[{"Sum", "[", "    ", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"Tr", "[", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Jmat", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "\[Gamma]"}], "\[RightDoubleBracket]"}],
                     "\[Transpose]"], ".", 
                   RowBox[{"traceUNUN", "[", " ", 
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], " ", 
                    "]"}]}], "]"}]}], "  ", ",", 
                RowBox[{"{", 
                 RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], 
               "]"}]}]}]}]}], " ", "\[IndentingNewLine]", "    ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{"L", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", 
           RowBox[{"L", "-", "1"}]}], "}"}]}], " ", "]"}]}], ";", "   ", 
      RowBox[{"Re", "@", 
       FractionBox["C", 
        RowBox[{" ", "Nc", " "}]]}]}]}], "  ", " ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9029952018267145`*^9, 3.902995202704543*^9}, {
   3.9029952331707754`*^9, 3.902995252522606*^9}, {3.902995285978188*^9, 
   3.9029953598902264`*^9}, {3.9029966046064405`*^9, 
   3.9029966046773443`*^9}, {3.9029967092878804`*^9, 
   3.9029967285611873`*^9}, {3.9029976609176607`*^9, 
   3.9029977107766857`*^9}, {3.9029977419526925`*^9, 3.902997743894538*^9}, {
   3.9029981547875404`*^9, 3.902998212751047*^9}, {3.902998263467655*^9, 
   3.9029983476187124`*^9}, {3.9029986496374288`*^9, 
   3.9029986878233476`*^9}, {3.9029987562889824`*^9, 3.902998983027419*^9}, {
   3.902999045817569*^9, 3.9029991344644237`*^9}, 3.902999275500065*^9, 
   3.9029993074836893`*^9, {3.902999700569556*^9, 3.902999799411972*^9}, {
   3.902999920080247*^9, 3.902999925682847*^9}, {3.9029999705522404`*^9, 
   3.9029999911389065`*^9}, {3.9030000227494802`*^9, 3.903000023114191*^9}, {
   3.9030001935722184`*^9, 3.903000202035033*^9}, {3.9030002809853888`*^9, 
   3.9030002883662167`*^9}, {3.903000508958843*^9, 3.9030005112305803`*^9}, {
   3.903000680231143*^9, 3.90300068619516*^9}, {3.9030007214839535`*^9, 
   3.903000822769285*^9}, {3.90300713989533*^9, 3.9030071400746326`*^9}, {
   3.903007339132989*^9, 3.9030074109078503`*^9}, 3.903010301454831*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"5c48473e-6e4d-477b-8c19-11e85689f659"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EnMF", "[", 
    RowBox[{"Jmat_", ",", "h_", ",", "U_", ",", "V_", ",", "L_", ",", 
     RowBox[{"\[Eta]_", ":", "1"}]}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Nc", "=", 
        SuperscriptBox["L", "2"]}], ",", "E", ",", "\[Lambda]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Eta]", "==", "1"}], ",", 
        RowBox[{"\[Lambda]", "=", 
         RowBox[{"\[Lambda]eff", "[", 
          RowBox[{"Jmat", ",", "h", ",", "V", ",", "L"}], "]"}]}], ",", 
        RowBox[{"\[Lambda]", "=", 
         RowBox[{"\[Eta]", " ", 
          RowBox[{"\[Lambda]eff", "[", 
           RowBox[{"Jmat", ",", "h", ",", "V", ",", "L"}], "]"}]}]}]}], "  ", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"E", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "r", ",", "rA", ",", "rB", ",", "mx", ",", "ny", ",", "N", ",", 
             "G"}], "}"}], ",", " \t", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mx", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "+", "1"}], ",", "L"}], "]"}]}], ";", 
            RowBox[{"ny", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"r", "=", 
             RowBox[{"m", "+", 
              RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "   ", 
            "\[IndentingNewLine]", 
            RowBox[{"rA", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mx", "+", 
                RowBox[{"n", " ", "L"}], "+", "1"}], ",", 
               RowBox[{"m", "+", 
                RowBox[{"ny", " ", "L"}], "+", "1"}], ",", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}], "+", "1"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"mx", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "-", "1"}], ",", "L"}], "]"}]}], ";", 
            RowBox[{"ny", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "-", "1"}], ",", "L"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"rB", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mx", "+", 
                RowBox[{"n", " ", "L"}], "+", "1"}], ",", 
               RowBox[{"m", "+", 
                RowBox[{"ny", " ", "L"}], "+", "1"}], ",", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}], "+", "1"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              FractionBox["1", "4"], 
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
                 RowBox[{"traceN", "[", 
                  RowBox[{"V", "\[LeftDoubleBracket]", 
                   RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], 
                  "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Lambda]", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ".", 
                 RowBox[{"traceN", "[", 
                  RowBox[{"V", "\[LeftDoubleBracket]", 
                   RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], 
                  "]"}]}]}], "  ", ")"}]}], " ", "\[IndentingNewLine]", "-", 
             RowBox[{
              FractionBox["1", "2"], 
              RowBox[{"h", ".", 
               RowBox[{"(", "   ", 
                RowBox[{
                 RowBox[{"traceN", "[", 
                  RowBox[{"V", "\[LeftDoubleBracket]", 
                   RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
                 "+", 
                 RowBox[{"traceN", "[", 
                  RowBox[{"V", "\[LeftDoubleBracket]", 
                   RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], 
                  "]"}]}], "  ", ")"}]}]}], "         ", 
             "\[IndentingNewLine]", "+", " ", 
             RowBox[{
              FractionBox["1", "8"], 
              RowBox[{"Sum", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"traceN", "[", 
                   RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"rA", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], ".", 
                  RowBox[{"Jmat", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"rA", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                   "\[RightDoubleBracket]"}], ".", 
                  RowBox[{"traceN", "[", 
                   RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"rA", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"traceN", "[", 
                   RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"rB", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "]"}], ".", 
                  RowBox[{"Jmat", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"rB", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], ",", "\[Gamma]"}], 
                   "\[RightDoubleBracket]"}], ".", 
                  RowBox[{"traceN", "[", 
                   RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"rB", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "+", 
             RowBox[{
              FractionBox["1", "4"], 
              RowBox[{"Sum", "[", "    ", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"Tr", "[", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Jmat", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "\[Gamma]"}], "\[RightDoubleBracket]"}],
                     "\[Transpose]"], ".", 
                   RowBox[{"traceUNUN", "[", " ", 
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], " ", 
                    "]"}]}], "]"}]}], "  ", ",", 
                RowBox[{"{", 
                 RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], 
               "]"}]}]}]}]}], " ", "\[IndentingNewLine]", "    ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{"L", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", 
           RowBox[{"L", "-", "1"}]}], "}"}]}], " ", "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Re", "@", 
       FractionBox["E", 
        RowBox[{" ", "Nc", " "}]]}]}]}], "   ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9029952018267145`*^9, 3.902995202704543*^9}, {
   3.9029952331707754`*^9, 3.902995252522606*^9}, {3.902995285978188*^9, 
   3.9029953598902264`*^9}, {3.9029966046064405`*^9, 
   3.9029966046773443`*^9}, {3.9029967092878804`*^9, 
   3.9029967285611873`*^9}, {3.9029976609176607`*^9, 
   3.9029977107766857`*^9}, {3.9029977419526925`*^9, 3.902997743894538*^9}, {
   3.9029981547875404`*^9, 3.902998212751047*^9}, {3.902998263467655*^9, 
   3.9029983476187124`*^9}, {3.9029986496374288`*^9, 
   3.9029986878233476`*^9}, {3.9029987562889824`*^9, 3.902998983027419*^9}, {
   3.902999045817569*^9, 3.9029991344644237`*^9}, 3.902999275500065*^9, 
   3.9029993074836893`*^9, {3.902999700569556*^9, 3.902999799411972*^9}, {
   3.902999920080247*^9, 3.902999925682847*^9}, {3.9029999705522404`*^9, 
   3.9029999911389065`*^9}, {3.9030000227494802`*^9, 3.903000023114191*^9}, {
   3.9030001935722184`*^9, 3.903000202035033*^9}, {3.9030002809853888`*^9, 
   3.9030002883662167`*^9}, {3.903000508958843*^9, 3.9030005112305803`*^9}, {
   3.903000680231143*^9, 3.90300068619516*^9}, {3.9030007214839535`*^9, 
   3.903000822769285*^9}, {3.90300713989533*^9, 3.9030071400746326`*^9}, {
   3.903007339132989*^9, 3.9030073413378973`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"740095b0-2b72-4889-bdf9-861fb4f61bbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eigenvaluesEmf", "[", 
    RowBox[{
    "Jmat_", ",", "h_", ",", "U_", ",", "V_", ",", "L_", ",", "\[Lambda]_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"constantMF", "[", 
      RowBox[{"Jmat", ",", "U", ",", "V", ",", "L"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", 
       SuperscriptBox["L", "2"]}]], 
     RowBox[{"Total", "@", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"Eigenvalues", "@", 
          RowBox[{"N", "@", 
           RowBox[{"Hmf", "[", 
            RowBox[{
            "Jmat", ",", "h", ",", "U", ",", "V", ",", "L", ",", 
             "\[Lambda]"}], "]"}]}]}]}], " ", ",", 
        RowBox[{
         RowBox[{"#", "<=", "0"}], "&"}]}], " ", "]"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.90300984613253*^9, 3.903009965613895*^9}, {
   3.903010606353046*^9, 3.9030106201912775`*^9}, {3.9030106629189672`*^9, 
   3.9030106695322475`*^9}, 3.9030109801301484`*^9, 3.903363293357646*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"98434258-7224-4c9a-a9e3-674f75fe72d2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L", ",", "\[IndentingNewLine]", 
      RowBox[{"AbsoluteTiming", "@", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "Nc", "}"}], ",", 
         RowBox[{
          RowBox[{"Nc", "=", 
           SuperscriptBox["L", "2"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Jarray", "=", 
           RowBox[{"Table", "[", " ", 
            RowBox[{
             RowBox[{"Jmat", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"-", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
             "Nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"EnMF", "[", " ", 
           RowBox[{"Jarray", ",", 
            RowBox[{"0", "hc"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"Uguess", ",", "Nc"}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"Vguess", ",", "Nc"}], "]"}], ",", " ", "L", ",", "1"}], 
           "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"AbsoluteTiming", "@", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "Nc", "}"}], ",", 
         RowBox[{
          RowBox[{"Nc", "=", 
           SuperscriptBox["L", "2"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Jarray", "=", 
           RowBox[{"Table", "[", " ", 
            RowBox[{
             RowBox[{"Jmat", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"-", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
             "Nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"eigenvaluesEmf", "[", " ", 
           RowBox[{"Jarray", ",", 
            RowBox[{"0", "hc"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"Uguess", ",", "Nc"}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"Vguess", ",", "Nc"}], "]"}], ",", " ", "L", ",", "1"}], 
           "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"L", ",", "20", ",", "22"}], "}"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9030003008306403`*^9, 3.9030005156169224`*^9}, {
  3.9030072318765254`*^9, 3.903007287718116*^9}, {3.9030074179722233`*^9, 
  3.903007422742299*^9}, {3.9030099807120504`*^9, 3.9030100175024557`*^9}, {
  3.9030107263955746`*^9, 3.903010807483952*^9}, {3.903010952993935*^9, 
  3.9030109542318397`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"97fb0b7f-4b9a-4f3e-9ad8-60103ac70714"],

Cell["\<\
the factor of   2 in the U-term is due to change the sum over i,j -> sum over \
bonds 
(the same is accounted for the V term, but it is not symmetric ij->ji so I \
wrote it explicitly)\
\>", "Text",
 CellChangeTimes->{{3.9030000304206276`*^9, 
  3.903000113648221*^9}},ExpressionUUID->"13d8065b-58d8-4ebe-a7cc-\
39eba5cb54de"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"EnMF", "[", 
     RowBox[{
     "J_", ",", "K_", ",", "\[CapitalGamma]_", ",", "h_", ",", "\[Chi]_", ",",
       "\[Omega]_", ",", "L1_", ",", "L2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nc", "=", 
         RowBox[{"L1", " ", "L2"}]}], ",", "E"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"E", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r", ",", "mx", ",", "ny", ",", 
              RowBox[{"\[CurlyEpsilon]", "=", 
               RowBox[{"Abs", "@", 
                RowBox[{"LeviCivitaTensor", "[", "3", "]"}]}]}]}], "}"}], ",",
             " \t", 
            RowBox[{
             RowBox[{"mx", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}]}], ";", 
             RowBox[{"ny", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}]}], ";", "   ", 
             RowBox[{"r", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"mx", "+", 
                 RowBox[{"n", " ", "L1"}], "+", "1"}], ",", 
                RowBox[{"m", "+", 
                 RowBox[{"ny", " ", "L1"}], "+", "1"}], ",", 
                RowBox[{"m", "+", 
                 RowBox[{"n", " ", "L1"}], "+", "1"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"h", "[", 
                 RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}]}], " ", 
               RowBox[{"(", "   ", 
                RowBox[{
                 RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", 
                   RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                   RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                  "\[RightDoubleBracket]"}], "+", 
                 RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", 
                   RowBox[{"r", "[", 
                    RowBox[{"[", " ", "3", "]"}], "]"}], " ", ",", " ", 
                   RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                  "\[RightDoubleBracket]"}]}], "    ", ")"}]}], "         ", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"J", " ", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                "\[RightDoubleBracket]"}], "  ", 
               RowBox[{"Sum", "[", "    ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                  RowBox[{
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "+", 
                  RowBox[{
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", "\[Beta]"}]}], 
                    "\[RightDoubleBracket]"}]}]}], "      ", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
              " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"K", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", " ", "\[Gamma]"}], 
                 "]"}], "]"}], " ", 
               RowBox[{"(", "  ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                 RowBox[{
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}]}], 
                   "\[RightDoubleBracket]"}], "   ", 
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                   "\[RightDoubleBracket]"}]}], "  ", "+", 
                 RowBox[{
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "   ", 
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", " ", "\[Gamma]"}]}], 
                   "\[RightDoubleBracket]"}]}]}], "    ", ")"}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{"Sum", "[", "    ", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                  "\[RightDoubleBracket]"}], "  ", 
                 RowBox[{"\[CurlyEpsilon]", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
                   "]"}], "]"}], " ", 
                 RowBox[{"(", "  ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                   RowBox[{
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", " ", 
                    RowBox[{"\[Beta]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}], "   ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "+", 
                   RowBox[{
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "   ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", " ", "\[Beta]"}]}], 
                    "\[RightDoubleBracket]"}]}]}], "    ", ")"}]}], 
                "\[IndentingNewLine]", ",", "     ", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", "  ", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], 
               "]"}]}]}]}], "    ", "]"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", "     ", 
          RowBox[{"{", " ", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}]}], ";", " ", 
       RowBox[{"Re", "@", 
        FractionBox["E", 
         RowBox[{" ", "Nc", " "}]]}]}]}], "   ", "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EnLagMF", "[", 
     RowBox[{
     "J_", ",", "K_", ",", "\[CapitalGamma]_", ",", "h_", ",", "\[Chi]_", ",",
       "\[Omega]_", ",", "L1_", ",", "L2_", ",", 
      RowBox[{"\[Lambda]_", ":", "\[Lambda]0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nc", "=", 
         RowBox[{"L1", " ", "L2"}]}], ",", "E"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"E", "=", " ", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"r", ",", "mx", ",", "ny"}], "}"}], ",", " \t", 
             RowBox[{
              RowBox[{"mx", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}]}], ";", 
              RowBox[{"ny", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}]}], ";", "   ", 
              RowBox[{"r", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mx", "+", 
                  RowBox[{"n", " ", "L1"}], "+", "1"}], ",", 
                 RowBox[{"m", "+", 
                  RowBox[{"ny", " ", "L1"}], "+", "1"}], ",", 
                 RowBox[{"m", "+", 
                  RowBox[{"n", " ", "L1"}], "+", "1"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", "      ", 
              RowBox[{
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", 
                RowBox[{"(", "   ", 
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"1", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "+", 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"2", "+", "1"}], ",", 
                    RowBox[{"3", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
                 "    ", ")"}]}], "  ", "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{"(", "   ", 
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"2", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "+", 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"3", "+", "1"}], ",", 
                    RowBox[{"1", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
                 "    ", ")"}]}], "  ", "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], " ", 
                RowBox[{"(", "   ", 
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"3", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "+", 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"1", "+", "1"}], ",", 
                    RowBox[{"2", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
                 "    ", ")"}]}]}]}]}], "         ", "\[IndentingNewLine]", 
            "  ", "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}], ",", "   ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}]}]}], ";", " ", 
       FractionBox["E", 
        RowBox[{" ", "Nc", " "}]]}]}], "   ", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"EnMF0", "[", 
     RowBox[{
     "J_", ",", "K_", ",", "\[CapitalGamma]_", ",", "h_", ",", "\[Chi]_", ",",
       "\[Omega]_", ",", "L1_", ",", "L2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nc", "=", 
         RowBox[{"L1", " ", "L2"}]}], ",", "E"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"E", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r", ",", "mx", ",", "ny", ",", 
              RowBox[{"\[CurlyEpsilon]", "=", 
               RowBox[{"Abs", "@", 
                RowBox[{"LeviCivitaTensor", "[", "3", "]"}]}]}]}], "}"}], ",",
             " \t", 
            RowBox[{
             RowBox[{"mx", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}]}], ";", 
             RowBox[{"ny", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}]}], ";", "   ", 
             RowBox[{"r", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"mx", "+", 
                 RowBox[{"n", " ", "L1"}], "+", "1"}], ",", 
                RowBox[{"m", "+", 
                 RowBox[{"ny", " ", "L1"}], "+", "1"}], ",", 
                RowBox[{"m", "+", 
                 RowBox[{"n", " ", "L1"}], "+", "1"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               RowBox[{"h", "[", 
                RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", 
               RowBox[{"(", "   ", 
                RowBox[{
                 RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", 
                   RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                   RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                  "\[RightDoubleBracket]"}], "+", 
                 RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", 
                   RowBox[{"r", "[", 
                    RowBox[{"[", " ", "3", "]"}], "]"}], " ", ",", " ", 
                   RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                  "\[RightDoubleBracket]"}]}], "    ", ")"}]}], "         ", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"J", " ", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                "\[RightDoubleBracket]"}], "  ", 
               RowBox[{"Sum", "[", "    ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                  RowBox[{
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "    ", "+", 
                  RowBox[{
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", "\[Beta]"}]}], 
                    "\[RightDoubleBracket]"}]}]}], "      ", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
              " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"K", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", " ", "\[Gamma]"}], 
                 "]"}], "]"}], " ", 
               RowBox[{"(", "  ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}]}], " ", "+", 
                 RowBox[{"Abs", "[", " ", 
                  RowBox[{
                   RowBox[{"-", " ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}]}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], " ", "]"}], " ", "+", 
                 RowBox[{
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "   ", 
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", " ", "\[Gamma]"}]}], 
                   "\[RightDoubleBracket]"}]}]}], "    ", ")"}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{"Sum", "[", "    ", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                  "\[RightDoubleBracket]"}], "  ", 
                 RowBox[{"\[CurlyEpsilon]", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
                   "]"}], "]"}], " ", 
                 RowBox[{"(", "  ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                   RowBox[{
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", " ", 
                    RowBox[{"\[Beta]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}], "   ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "+", 
                   RowBox[{
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "   ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", " ", "\[Beta]"}]}], 
                    "\[RightDoubleBracket]"}]}]}], "    ", ")"}]}], 
                "\[IndentingNewLine]", ",", "     ", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", "  ", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], 
               "]"}]}]}]}], "    ", "]"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", "     ", 
          RowBox[{"{", " ", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}]}], ";", " ", 
       RowBox[{"Re", "@", 
        FractionBox["E", 
         RowBox[{" ", "Nc", " "}]]}]}]}], "   ", "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.871472256995206*^9, 3.8714723852678127`*^9}, {
   3.871472425928979*^9, 3.8714725783063393`*^9}, {3.8714726258096247`*^9, 
   3.8714729588880634`*^9}, {3.8714730232256002`*^9, 3.871473036406559*^9}, {
   3.8714730727212043`*^9, 3.871473079531608*^9}, {3.8714731109367337`*^9, 
   3.8714732607115307`*^9}, {3.871473326384891*^9, 3.8714733809568787`*^9}, {
   3.8714734159388523`*^9, 3.8714734178723702`*^9}, {3.871473822646452*^9, 
   3.8714738333651667`*^9}, 3.8714740941826563`*^9, {3.8715311759553733`*^9, 
   3.8715311870612297`*^9}, {3.871531251313411*^9, 3.8715313041178064`*^9}, {
   3.8715313532868347`*^9, 3.871531372330895*^9}, {3.8715314084527965`*^9, 
   3.8715314226007547`*^9}, 3.871531473179598*^9, {3.8715450768704815`*^9, 
   3.8715450777302523`*^9}, {3.871548008531889*^9, 3.8715480115428467`*^9}, {
   3.8715493861292086`*^9, 3.8715493920209494`*^9}, 3.871550039784697*^9, {
   3.871550097746545*^9, 3.871550098182736*^9}, {3.871550159726452*^9, 
   3.871550356235974*^9}, {3.8715568724544907`*^9, 3.871556874014618*^9}, {
   3.8715570949736185`*^9, 3.871557095355794*^9}, {3.8780325726062584`*^9, 
   3.878032573386405*^9}, {3.878037804366704*^9, 3.878037808348261*^9}, 
   3.882352269680444*^9, {3.8944400048612423`*^9, 3.8944400118352566`*^9}, 
   3.895046602320809*^9, 3.9029436576170673`*^9},
 FontFamily->"Consolas",
 CellLabel->
  "In[125]:=",ExpressionUUID->"3f4bae56-6c1d-4a7f-acad-165d3de18001"]
}, Closed]],

Cell[CellGroupData[{

Cell["Wilson loop", "Subsubsection",
 CellChangeTimes->{{3.8866550978543205`*^9, 3.8866551044908752`*^9}, {
  3.8866562240394773`*^9, 3.8866562278844843`*^9}, {3.9029442087699633`*^9, 
  3.902944210842572*^9}},ExpressionUUID->"1f33cda0-a6a0-4bff-91bf-\
11e7d8dd3cb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WilsonLoop", "[", 
    RowBox[{"U_", ",", "V_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cyc", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"cyc", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n", ",", "R", ",", 
            RowBox[{"Wilson", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
          ",", "  ", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{"\[LeftFloor]", 
             RowBox[{"p", "/", "L"}], "\[RightFloor]"}]}], ";", 
           RowBox[{"m", "=", 
            RowBox[{"p", "-", 
             RowBox[{"n", " ", "L"}]}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"R", "=", 
            RowBox[{"{", "    ", 
             RowBox[{"(*", "  ", 
              RowBox[{"r", ",", "\[Sigma]", ",", 
               RowBox[{"\[Gamma]", " ", "->", " ", "ext"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "+", 
                 RowBox[{"n", " ", "L"}], " ", "+", "1"}], ",", "0", ",", 
                "3"}], "  ", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"n", ",", "L"}], "]"}], " ", "L"}], " ", "+", 
                 "1"}], "  ", ",", "1", ",", "2"}], " ", "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                 RowBox[{"n", " ", "L"}], " ", "+", "1"}], ",", "0", ",", 
                "1"}], "    ", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                 " ", "+", "1"}], "  ", ",", "1", ",", "3"}], "  ", "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"m", "+", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                 "+", "1"}], "   ", ",", "0", ",", "2"}], "   ", "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"m", ",", "L"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                 " ", "+", "1"}], "  ", ",", "1", ",", "1"}], " ", "}"}]}], 
             "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Wilson", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
            RowBox[{"Product", "[", "   ", 
             RowBox[{
              RowBox[{"Extract", "[", "    ", 
               RowBox[{
                RowBox[{"V", "[", 
                 RowBox[{"[", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", "1"}]}], "  ",
                   "]"}], "]"}], ",", 
                RowBox[{"cyc", "[", 
                 RowBox[{"[", "  ", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "  ", "]"}], 
                 "]"}]}], "    ", "]"}], "  ", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Wilson", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
            RowBox[{"Product", "[", "   ", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\[Gamma]", "=", 
                  RowBox[{
                   RowBox[{"cyc", "[", 
                    RowBox[{"[", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}], " ", 
                   "\[LeftDoubleBracket]", "g", "\[RightDoubleBracket]"}]}], 
                 "         ", "}"}], ",", "           ", 
                RowBox[{
                 RowBox[{"U", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Gamma]", "-", "1"}]}], "  ", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Gamma]", ",", "\[Gamma]"}], "]"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "  ", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "3", ",", "5"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"g", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Wilson", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"Wilson", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", 
          RowBox[{
           RowBox[{"L", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}]}]}], "  ", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.886577297929345*^9, 3.8865774163443823`*^9}, {
   3.886577486094192*^9, 3.886577573260448*^9}, {3.886577604737681*^9, 
   3.886577688754797*^9}, {3.8865777785953984`*^9, 3.886577859080839*^9}, {
   3.886655190801131*^9, 3.886655260441708*^9}, {3.886655405185495*^9, 
   3.8866554294595222`*^9}, {3.886655514893617*^9, 3.886655515142964*^9}, 
   3.8866558223211565`*^9, {3.886655928048565*^9, 3.8866560367925*^9}, {
   3.886656068944904*^9, 3.8866561152531104`*^9}, {3.8866625161085405`*^9, 
   3.886662540364295*^9}, {3.886667132145313*^9, 3.8866671713303165`*^9}, 
   3.8866672030290933`*^9, 3.886668045441769*^9, {3.886668082846902*^9, 
   3.88666808590635*^9}, {3.8866877202335267`*^9, 3.8866877259689994`*^9}, 
   3.8866881720628347`*^9, {3.8873613558774967`*^9, 3.8873613687487946`*^9}, 
   3.8873666845333247`*^9, {3.9030118571078215`*^9, 3.903011859918048*^9}, {
   3.903011922244248*^9, 3.9030119734796095`*^9}, {3.903012010177145*^9, 
   3.9030120306296625`*^9}, {3.9030122084507055`*^9, 3.903012212725993*^9}, {
   3.9030127029004493`*^9, 3.9030127097879753`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"629fd037-c3e2-4a7e-90b0-4492629474f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"setP", "[", 
    RowBox[{"x_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"10", "^", "p"}], " ", "x"}], "]"}], "/", 
     RowBox[{"10", "^", "p"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setP1", "[", "x_", "]"}], ":=", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"10", " ", "x"}], "]"}], "/", "10"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8866876583274527`*^9, 3.8866877022308736`*^9}, {
  3.8866881207567883`*^9, 3.8866881219393177`*^9}, {3.8866881926094*^9, 
  3.886688193379299*^9}, {3.8866883322398443`*^9, 3.886688333149808*^9}, {
  3.8866885812246127`*^9, 3.886688595000948*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"f85dc0d5-82a0-43e5-9241-9d68e8519105"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyHueP", "[", 
   RowBox[{"x_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Hue", "@@", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"setP", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "n", "]"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8866884106151743`*^9, 3.8866885032164965`*^9}, {
  3.886688744616431*^9, 3.8866888575412292`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"22e72a6a-b20a-4975-ae94-b9fee4928764"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WilsonLoopGraphicsZoom", "[", 
    RowBox[{"U_", ",", "V_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cyc", ",", 
       RowBox[{"linethick", "=", 
        RowBox[{".01", " ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "7", "]"}], 
           RowBox[{"Log", "[", "L", "]"}]], ")"}]}]}]}], " ", "}"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"cyc", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], ";"}], "*)"}], 
     RowBox[{
      RowBox[{"cyc", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"R", ",", 
             RowBox[{"Wilson", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
           ",", "  ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"R", "=", 
             RowBox[{"{", "    ", 
              RowBox[{"(*", "  ", 
               RowBox[{"r", ",", "\[Sigma]", ",", 
                RowBox[{"\[Gamma]", " ", "->", " ", "ext"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"m", "+", 
                  RowBox[{"n", " ", "L"}], " ", "+", "1"}], ",", "0", ",", 
                 "3"}], "  ", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                  RowBox[{"n", " ", "L"}], " ", "+", "1"}], "  ", ",", "1", 
                 ",", "2"}], " ", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                  RowBox[{"n", " ", "L"}], " ", "+", "1"}], ",", "0", ",", 
                 "1"}], "    ", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                  " ", "+", "1"}], "  ", ",", "1", ",", "3"}], "  ", "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"m", "+", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                  "+", "1"}], "   ", ",", "0", ",", "2"}], "   ", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"m", "+", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                  " ", "+", "1"}], "  ", ",", "1", ",", "1"}], " ", "}"}]}], 
              "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Wilson", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
             RowBox[{"Product", "[", "   ", 
              RowBox[{
               RowBox[{"Extract", "[", "    ", 
                RowBox[{
                 RowBox[{"V", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", "1"}]}], "  ",
                    "]"}], "]"}], ",", 
                 RowBox[{"cyc", "[", 
                  RowBox[{"[", "  ", 
                   RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "  ", "]"}], 
                  "]"}]}], "    ", "]"}], "  ", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Wilson", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
             RowBox[{"Product", "[", "   ", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]", "=", 
                   RowBox[{
                    RowBox[{"cyc", "[", 
                    RowBox[{"[", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}], " ", 
                    "\[LeftDoubleBracket]", "g", "\[RightDoubleBracket]"}]}], 
                  "         ", "}"}], ",", "           ", 
                 RowBox[{
                  RowBox[{"U", "[", 
                   RowBox[{"[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Gamma]", "-", "1"}]}], "  ", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Gamma]", ",", "\[Gamma]"}], "]"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "  ", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "3", ",", "5"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"g", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"applyHueP", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "1", ",", "3", ",", "1"}], "}"}]}], 
                 "]"}], " ", "&"}], " ", "@", " ", 
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{
                   RowBox[{"Hue", "[", 
                    RowBox[{"0.97", ",", "0.3", ",", "0.96"}], "]"}], ",", 
                   " ", 
                   RowBox[{"Hue", "[", 
                    RowBox[{"0.5", ",", "0", ",", "0.5", ",", "0.7"}], "]"}], 
                   " ", ",", 
                   RowBox[{"Hue", "[", 
                    RowBox[{"0.65", ",", "1", ",", "1", ",", "0.4"}], "]"}]}],
                   "}"}], ",", 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", "2"], "+", 
                   RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"Wilson", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", ")"}]}]}], " ", 
                  ")"}]}], "  ", "]"}]}], "   ", ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "[", 
                  RowBox[{"5", "linethick"}], "]"}], ",", 
                 RowBox[{"Hue", "[", 
                  RowBox[{"0.5", ",", "0.0", ",", "1", ",", "0.9"}], "]"}]}], 
                "}"}], "  ", "]"}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"Polygon", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "n", ",", "0"}], "]"}], ",", 
                 "   ", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", 
                   RowBox[{"n", "+", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{"m", ",", 
                   RowBox[{"n", "+", "1"}], ",", "0"}], "]"}], ",", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{"m", ",", 
                   RowBox[{"n", "+", "1"}], ",", "1"}], "]"}], " ", ",", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{"m", ",", "n", ",", "0"}], "]"}], ",", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
                "}"}], "  ", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "  ", 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{
            RowBox[{"L", "/", "2"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"L", "/", "2"}], ",", 
           RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}]}], "  ", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8866568189244237`*^9, 3.8866568210135384`*^9}, {
   3.8866568744456973`*^9, 3.8866569467021303`*^9}, {3.8866570342948256`*^9, 
   3.8866570457892637`*^9}, {3.8866572089668126`*^9, 
   3.8866572257357535`*^9}, {3.8866572615234184`*^9, 
   3.8866572641346474`*^9}, {3.8866573343592267`*^9, 
   3.8866574444983244`*^9}, {3.886657505944301*^9, 3.8866575522971716`*^9}, 
   3.886657686422468*^9, {3.886657738057664*^9, 3.8866577512923994`*^9}, {
   3.886662473471694*^9, 3.8866624828733897`*^9}, {3.886662574270269*^9, 
   3.8866625901990314`*^9}, {3.8866627238953094`*^9, 3.8866627294517055`*^9}, 
   3.8866629632546062`*^9, {3.8866630032165675`*^9, 3.8866630278966837`*^9}, {
   3.886663531497528*^9, 3.886663621996422*^9}, {3.8866637919392395`*^9, 
   3.886663820516225*^9}, {3.8866638667541623`*^9, 3.8866639041954174`*^9}, {
   3.8866640389496183`*^9, 3.88666407490174*^9}, {3.8866641400430403`*^9, 
   3.886664154169366*^9}, {3.886664238323161*^9, 3.8866642386140375`*^9}, {
   3.886664287483392*^9, 3.8866642928836074`*^9}, {3.886664381854021*^9, 
   3.8866644280878906`*^9}, {3.886664466944436*^9, 3.886664554450766*^9}, {
   3.886665099883546*^9, 3.8866651202478323`*^9}, {3.8866651586282682`*^9, 
   3.8866652248723803`*^9}, {3.88666525504259*^9, 3.886665256281698*^9}, {
   3.886665386688386*^9, 3.8866653869139795`*^9}, {3.8866654513531656`*^9, 
   3.88666549653339*^9}, {3.8866657554878583`*^9, 3.886665815517968*^9}, {
   3.886665849358279*^9, 3.886665907834586*^9}, {3.8866664634405975`*^9, 
   3.8866665717318087`*^9}, {3.8866666105219545`*^9, 
   3.8866666687957587`*^9}, {3.886666722640232*^9, 3.8866667963971176`*^9}, {
   3.8866669128802805`*^9, 3.886666990683054*^9}, 3.8866681060216007`*^9, {
   3.8866686156960526`*^9, 3.8866686157631545`*^9}, {3.8866688471664424`*^9, 
   3.8866689578772416`*^9}, {3.8866870101407623`*^9, 3.886687014838278*^9}, {
   3.886687056947236*^9, 3.886687062139759*^9}, {3.8866872076719646`*^9, 
   3.886687217602276*^9}, {3.886687302600501*^9, 3.8866873359150896`*^9}, {
   3.8866875630460877`*^9, 3.886687564733532*^9}, {3.8866876495090303`*^9, 
   3.8866876507019677`*^9}, {3.886687707678115*^9, 3.8866877096264877`*^9}, {
   3.8866878329493113`*^9, 3.886687861982074*^9}, {3.8866879750103116`*^9, 
   3.8866879851685123`*^9}, {3.886688033834028*^9, 3.886688065205904*^9}, {
   3.8866881163846493`*^9, 3.8866881174810524`*^9}, {3.88668833648405*^9, 
   3.8866883366986237`*^9}, {3.8866885172334814`*^9, 
   3.8866885520814695`*^9}, {3.8866885999961386`*^9, 
   3.8866886235248985`*^9}, {3.8866886862238865`*^9, 3.886688703759144*^9}, {
   3.8866888746013746`*^9, 3.8866889179542065`*^9}, {3.886688956525893*^9, 
   3.8866889643246317`*^9}, {3.886689008036938*^9, 3.886689038226878*^9}, {
   3.8866890892898026`*^9, 3.8866890924114494`*^9}, 3.8872624714157*^9, {
   3.887349351124804*^9, 3.887349351754312*^9}, {3.887349432688151*^9, 
   3.887349483785801*^9}, {3.887349514232171*^9, 3.887349518976432*^9}, 
   3.8873667007123766`*^9, {3.887366755715024*^9, 3.8873667720494356`*^9}, {
   3.8873668260730705`*^9, 3.887366829718055*^9}, {3.9030143427074466`*^9, 
   3.9030143914260807`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"1c6a9ee3-0ca7-4512-9668-41dbee4fa656"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MFgaugeConfigZoom", "[", 
    RowBox[{"U0_", ",", "V_", ",", "L_", ",", 
     RowBox[{"title_", ":", "\"\<\>\""}], ",", 
     RowBox[{"comment_", ":", 
      RowBox[{"{", 
       RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bonds", ",", 
       RowBox[{"linethick", "=", 
        RowBox[{".012", " ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "7", "]"}], 
           RowBox[{"Log", "[", "L", "]"}]], ")"}]}]}], ",", "lattice", ",", 
       "size", ",", "U", ",", 
       RowBox[{"rt", "=", "0.8"}], ",", "max", ",", "plaquettes"}], "}"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"size", " ", "=", " ", 
       RowBox[{"0.01", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "7", "]"}], 
           RowBox[{"Log", "[", "L", "]"}]], ")"}], "2"]}]}], " ", ";", " ", 
      RowBox[{"max", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"Abs", "@", "U0"}]}]}], ";", " ", 
      RowBox[{"U", "=", 
       RowBox[{"U0", "/", "max"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lattice", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"4", " ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"asites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"4", " ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"bsites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], "  ", ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"2", "  ", "size"}], " ", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"asites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"White", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"2", "  ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"bsites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}]}], "     ", 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{
              RowBox[{"L", "/", "2"}], "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"L", "/", "2"}], ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", "2"}], 
        "    ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bonds", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{"Cyan", ",", " ", "Gray", " ", ",", 
                   RowBox[{"Darker", "@", "Magenta"}]}], "}"}], ",", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}], ",", "3"}], "]"}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ")"}]}]}], "  ", 
                "]"}], ",", 
               RowBox[{"Thickness", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"0.5", "+", 
                    RowBox[{"0.5", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}]}], "&"}], "@", 
                   RowBox[{"Abs", "@", 
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}], ",", "3"}], "]"}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "4"}], "]"}], "]"}]}]}], ")"}], 
                 "linethick"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}]}], "}"}], "]"}]}], "}"}], 
             ",", "                   ", 
             RowBox[{"(*", 
              RowBox[{"z", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{"Cyan", ",", " ", "Gray", " ", ",", 
                   RowBox[{"Darker", "@", "Magenta"}]}], "}"}], ",", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}], ",", "1"}], "]"}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}]}]}], "  ", 
                "]"}], ",", 
               RowBox[{"Thickness", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"0.5", "+", 
                    RowBox[{"0.5", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}]}], "&"}], "@", 
                   RowBox[{"Abs", "@", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
                 "linethick"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n"}], "]"}]}], "}"}], 
                "]"}]}], "}"}], ",", "             ", 
             RowBox[{"(*", 
              RowBox[{"x", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{"Cyan", ",", " ", "Gray", " ", ",", 
                   RowBox[{"Darker", "@", "Magenta"}]}], "}"}], ",", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}], ",", "2"}], "]"}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], "  ", 
                "]"}], ",", 
               RowBox[{"Thickness", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"0.5", "+", 
                    RowBox[{"0.5", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}]}], "&"}], "@", 
                   RowBox[{"Abs", "@", 
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}], ",", "2"}], "]"}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}], 
                 "linethick"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}]}], "}"}], "]"}]}], 
              "}"}]}], "              ", 
            RowBox[{"(*", 
             RowBox[{"y", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{
              RowBox[{"L", "/", "2"}], "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"L", "/", "2"}], ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", "2"}], 
        "    ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plaquettes", "=", 
       RowBox[{"WilsonLoopGraphicsZoom", "[", 
        RowBox[{"U", ",", "V", ",", "L"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"plaquettes", ",", "bonds", ",", "lattice"}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
        RowBox[{"ContentSelectable", "\[Rule]", "True"}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Inset", "[", " ", 
            RowBox[{
             RowBox[{"MaTeX", "[", 
              RowBox[{"title", ",", 
               RowBox[{"Magnification", "\[Rule]", "1.8"}]}], "]"}], " ", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.95"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Left", ",", "Center"}], "}"}]}], "]"}], ",", 
           RowBox[{"Inset", "[", " ", 
            RowBox[{
             RowBox[{"MaTeX", "[", 
              RowBox[{
               RowBox[{"comment", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"Magnification", "\[Rule]", "1.5"}]}], "]"}], " ", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"1.0", ",", "0.95"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Right", ",", "Center"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Inset", "[", " ", 
            RowBox[{
             RowBox[{"MaTeX", "[", 
              RowBox[{
               RowBox[{"comment", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"Magnification", "\[Rule]", "1.35"}]}], "]"}], " ", 
             ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"1.0", ",", "0.88"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Right", ",", "Center"}], "}"}]}], "]"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "  ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8867434944218855`*^9, 3.886743550245146*^9}, {
   3.886745267428046*^9, 3.8867452717540464`*^9}, 3.887349356907258*^9, {
   3.8873495388223543`*^9, 3.8873495559671035`*^9}, 3.903014418836547*^9, {
   3.9030148962937136`*^9, 3.903014993226515*^9}, {3.903209432826728*^9, 
   3.9032094343338137`*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"6b2aa10b-6863-4d41-8279-aaa4bda5a264"]
}, Closed]],

Cell[CellGroupData[{

Cell["Couplings  ", "Subsubsection",
 CellChangeTimes->{{3.8731938843894205`*^9, 3.873193891728099*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"fb707ad5-d51c-41d2-af20-83e7f8e31aac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Jc", "[", 
    RowBox[{"eV0_", ",", "JH_", ",", "U_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "54"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"t", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "2"]}], 
       RowBox[{"eV0", "-", "JH", "+", "U"}]], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"t", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "2"]}], 
       RowBox[{"eV0", "+", "JH", "-", "U"}]], "-", 
      FractionBox[
       RowBox[{"6", " ", 
        RowBox[{"t", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"t", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}]}], 
       RowBox[{"eV0", "+", 
        RowBox[{"3", " ", "JH"}], "-", "U"}]], "+", 
      FractionBox[
       RowBox[{"6", " ", 
        RowBox[{"t", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"t", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}]}], 
       RowBox[{"eV0", "-", 
        RowBox[{"3", " ", "JH"}], "+", "U"}]], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"t", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{"t", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "2"], 
       RowBox[{
        RowBox[{"-", "eV0"}], "+", 
        RowBox[{"2", " ", "JH"}], "+", "U"}]], "+", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"t", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{"t", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "2"], 
       RowBox[{"eV0", "+", 
        RowBox[{"2", " ", "JH"}], "+", "U"}]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Kc", "[", 
    RowBox[{"eV0_", ",", "JH_", ",", "U_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", "JH", " "}], "9"], 
    RowBox[{"(", " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"t", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"t", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "2"], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox[
        RowBox[{"t", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "2"]}]}], " ", ")"}], " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["eV0", "2"], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["JH", "2"]}], "-", 
       RowBox[{"4", " ", "JH", " ", "U"}], "+", 
       SuperscriptBox["U", "2"]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"eV0", "+", "JH", "-", "U"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"eV0", "+", 
        RowBox[{"3", " ", "JH"}], "-", "U"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"eV0", "-", 
        RowBox[{"3", " ", "JH"}], "+", "U"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"eV0", "-", "JH", "+", "U"}], ")"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]c", "[", 
    RowBox[{"eV0_", ",", "JH_", ",", "U_", ",", "t_"}], "]"}], ":=", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"4", " ", "JH", " ", 
      RowBox[{"t", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"t", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"t", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ")"}], " "}], 
     RowBox[{"9", " "}]], 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["eV0", "2"], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["JH", "2"]}], "-", 
       RowBox[{"4", " ", "JH", " ", "U"}], "+", 
       SuperscriptBox["U", "2"]}], ")"}], 
     RowBox[{" ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"eV0", "+", "JH", "-", "U"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eV0", "+", 
         RowBox[{"3", " ", "JH"}], "-", "U"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eV0", "-", 
         RowBox[{"3", " ", "JH"}], "+", "U"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eV0", "-", "JH", "+", "U"}], ")"}]}]}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.873193895328764*^9, 3.8731939932242427`*^9}, {
  3.8731940296513343`*^9, 3.8731941153815117`*^9}, {3.873194204187463*^9, 
  3.8731942866737194`*^9}},
 FontFamily->"Consolas",
 CellLabel->
  "In[132]:=",ExpressionUUID->"600637bf-5f6c-43c2-9da3-a1bbbdae2672"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Jr", "[", 
    RowBox[{"eV0_", ",", "JH_", ",", "U_", ",", "t_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"Jc", "[", 
     RowBox[{"eV0", ",", "JH", ",", "U", ",", "t"}], "]"}], 
    RowBox[{"Abs", "[", 
     RowBox[{"Kc", "[", 
      RowBox[{"0", ",", "JH", ",", "U", ",", "t"}], "]"}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Kr", "[", 
    RowBox[{"eV0_", ",", "JH_", ",", "U_", ",", "t_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"Kc", "[", 
     RowBox[{"eV0", ",", "JH", ",", "U", ",", "t"}], "]"}], 
    RowBox[{"Abs", "[", 
     RowBox[{"Kc", "[", 
      RowBox[{"0", ",", "JH", ",", "U", ",", "t"}], "]"}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]r", "[", 
    RowBox[{"eV0_", ",", "JH_", ",", "U_", ",", "t_"}], "]"}], ":=", " ", 
   FractionBox[
    RowBox[{"\[CapitalGamma]c", "[", 
     RowBox[{"eV0", ",", "JH", ",", "U", ",", "t"}], "]"}], 
    RowBox[{"Abs", "[", 
     RowBox[{"Kc", "[", 
      RowBox[{"0", ",", "JH", ",", "U", ",", "t"}], "]"}], "]"}]]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8731946862155886`*^9, 3.873194691704748*^9}, {
  3.873194729189893*^9, 3.8731947881641417`*^9}, {3.8745743323219347`*^9, 
  3.8745743751400795`*^9}},
 FontFamily->"Consolas",
 CellLabel->
  "In[135]:=",ExpressionUUID->"4a25d347-b1d0-4ff4-82f8-033288d5e68f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DMr", "[", 
    RowBox[{"eV0_", ",", "JH_", ",", "U_", ",", "t_", ",", "Dmax_", ",", 
     RowBox[{"s_", ":", ".8"}]}], "]"}], ":=", 
   RowBox[{"Dmax", 
    FractionBox["eV0", 
     RowBox[{" ", 
      RowBox[{"Abs", "[", 
       RowBox[{"s", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "JH"}], "-", "U"}], ")"}]}], "]"}], " "}]], " ", 
    FractionBox[
     RowBox[{"Kc", "[", 
      RowBox[{"eV0", ",", "JH", ",", "U", ",", "t"}], "]"}], 
     RowBox[{"Abs", "[", 
      RowBox[{"Kc", "[", 
       RowBox[{
        RowBox[{"s", " ", "eV0"}], ",", "JH", ",", "U", ",", "t"}], "]"}], 
      "]"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.902994697417652*^9, 3.902994722614287*^9}, {
  3.902994891750348*^9, 3.902994931372505*^9}, {3.9029949636181097`*^9, 
  3.9029950164709177`*^9}, {3.9029950493000865`*^9, 3.9029950599399242`*^9}, {
  3.903011723117386*^9, 3.9030117505209455`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"3b847d4e-4356-4bc0-883e-210d5ddbb2fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JmatMicro", "[", 
    RowBox[{"eV0_", ",", "JH_", ",", "U_", ",", "t_", ",", 
     RowBox[{"Dmax_", ":", ".5"}], ",", 
     RowBox[{"s_", ":", ".8"}]}], "]"}], ":=", 
   RowBox[{"Jmat", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Jr", "[", 
       RowBox[{"eV0", ",", "JH", ",", "U", ",", "t"}], "]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"Kr", "[", 
       RowBox[{"eV0", ",", "JH", ",", "U", ",", "t"}], "]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"\[CapitalGamma]r", "[", 
       RowBox[{"eV0", ",", "JH", ",", "U", ",", "t"}], "]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"DMr", "[", 
       RowBox[{"eV0", ",", "JH", ",", "U", ",", "t", ",", "Dmax", ",", "s"}], 
       "]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.903015047575375*^9, 3.903015058182932*^9}, {
  3.9030151154241*^9, 3.903015149489685*^9}, {3.9030151901222186`*^9, 
  3.9030151916293097`*^9}, {3.903015292724102*^9, 3.903015393933646*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"5c5949c5-1125-4374-aff4-f4d575819c46"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"addVortex", "[", " ", 
      RowBox[{"Ko_", ",", "K0_", ",", " ", "R_", ",", "L1_", ",", "L2_"}], 
      "]"}], ":=", " ", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"n", "=", 
          RowBox[{"R", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"K", "=", "Ko"}], ",", 
         RowBox[{"r", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", "6"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"K", "[", 
          RowBox[{"[", " ", 
           RowBox[{
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L1"}], " ", "+", "1"}], ",", "3"}], "    ", 
           "]"}], "]"}], "=", "K0"}], ";", "  ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"K", "[", 
          RowBox[{"[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}], "+", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "-", "1"}], ",", "L2"}], "]"}], " ", "L1"}], " ",
              "+", "1"}], "  ", ",", "2"}], "    ", "]"}], "]"}], "=", "K0"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"K", "[", 
          RowBox[{"[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}], "+", 
             RowBox[{"n", " ", "L1"}], " ", "+", "1"}], ",", "1"}], "    ", 
           "]"}], "]"}], "=", "K0"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"K", "[", 
          RowBox[{"[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}], "+", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}], " ", "L1"}], " ",
              "+", "1"}], "  ", ",", "3"}], "   ", "]"}], "]"}], "=", "K0"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"K", "[", 
          RowBox[{"[", " ", 
           RowBox[{
            RowBox[{"m", "+", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}], " ", "L1"}], "+",
              "1"}], "   ", ",", "2"}], "    ", "]"}], "]"}], "=", "K0"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"K", "[", 
          RowBox[{"[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "-", "1"}], ",", "L1"}], "]"}], "+", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}], " ", "L1"}], " ",
              "+", "1"}], "  ", ",", "1"}], "   ", "]"}], "]"}], "=", "K0"}], 
        ";", "\[IndentingNewLine]", "K"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"add4Vortices", "[", " ", 
      RowBox[{
      "K0_", ",", "Kmod_", ",", " ", "R1_", ",", "R2_", ",", " ", "R3_", ",", 
       "R4_", ",", "L_"}], "]"}], " ", ":=", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", "K", "}"}], ",", " ", 
       RowBox[{
        RowBox[{"K", " ", "=", " ", 
         RowBox[{"addVortex", "[", " ", 
          RowBox[{"K0", ",", "Kmod", ",", " ", "R1", ",", "L", ",", "L"}], 
          "]"}]}], ";", " ", 
        RowBox[{"K", " ", "=", " ", 
         RowBox[{"addVortex", "[", " ", 
          RowBox[{"K", ",", "Kmod", ",", " ", "R2", ",", "L", ",", "L"}], 
          "]"}]}], ";", " ", 
        RowBox[{"K", " ", "=", " ", 
         RowBox[{"addVortex", "[", " ", 
          RowBox[{"K", ",", "Kmod", ",", " ", "R3", ",", "L", ",", "L"}], 
          "]"}]}], ";", " ", 
        RowBox[{"addVortex", "[", " ", 
         RowBox[{"K", ",", "Kmod", ",", " ", "R4", ",", "L", ",", "L"}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Jarray4v", "[", 
      RowBox[{"Jarray_", ",", "JmatMicro_", ",", "L_"}], "]"}], ":=", 
     RowBox[{"Module", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"RS", ",", "RE", ",", "RW", ",", "RN", ",", "r2"}], "}"}], 
       ",", "   ", 
       RowBox[{
        RowBox[{"r2", "=", " ", 
         RowBox[{"\[LeftFloor]", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"\[LeftCeiling]", 
            FractionBox["L", "2"], "\[RightCeiling]"}]}], "\[RightFloor]"}]}],
         ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"RS", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r2", "-", "1"}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{"r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"RW", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r2", "-", "1"}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{"L", "-", "r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"RE", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "r2", "-", "1"}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{"r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"RN", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "-", "r2", "-", "1"}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{"L", "-", "r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"add4Vortices", "[", " ", 
         RowBox[{
         "Jarray", ",", "JmatMicro", ",", " ", "RS", ",", "RW", ",", " ", 
          "RE", ",", "RN", ",", "L"}], "]"}]}]}], " ", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9032093073650475`*^9, 3.903209336161983*^9}, {
  3.903209573205613*^9, 3.903209640366805*^9}, {3.903209677379547*^9, 
  3.9032096989807377`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"c5a5ca6f-b4ef-4a94-b744-cdbd67da976c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"legends", ",", "plots", ",", "K05", ",", "Kc05"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"legends", "=", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{
         "(*", "\"\<J=Y1,\\\\;\\\\Gamma=Y2,\\\\; \
t_1=X1,\\\\;t_2=X2,\\\\;t_3=X3\>\"", "*)"}], 
         RowBox[{"\"\<J(0)=Y1,\\\\;\\\\Gamma(0)=Y2\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Y1\>\"", "->", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{"N", "@", 
               FractionBox[
                RowBox[{"Round", "[", 
                 RowBox[{"100", 
                  RowBox[{"Jr", "[", 
                   RowBox[{"0", ",", "JH", ",", "U", ",", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}]}], "]"}], 
                "100"]}], "]"}]}], ",", 
            RowBox[{"\"\<Y2\>\"", "->", 
             RowBox[{"ToString", "[", 
              RowBox[{"N", "@", 
               FractionBox[
                RowBox[{"Round", "[", 
                 RowBox[{"100", 
                  RowBox[{"\[CapitalGamma]r", "[", 
                   RowBox[{"0", ",", "JH", ",", "U", ",", 
                    RowBox[{"ts", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}]}], "]"}], 
                "100"]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<X1\>\"", "->", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{"ts", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"\"\<X2\>\"", "->", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{"ts", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"\"\<X3\>\"", "->", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{"ts", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}]}]}], "    ", 
           "}"}]}], "    ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "ts"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K05", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"Kr", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"U", "-", 
               RowBox[{"3", "JH"}]}], ")"}], "0.5"}], ",", "JH", ",", "U", 
            ",", 
            RowBox[{"ts", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "    ", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "ts"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Kc05", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"Kc", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"U", "-", 
               RowBox[{"3", "JH"}]}], ")"}], "0.5"}], ",", "JH", ",", "U", 
            ",", 
            RowBox[{"ts", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "    ", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "ts"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plots", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Plot", "[", "  ", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Jr", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"U", "-", 
                  RowBox[{"3", "JH"}]}], ")"}], "\[Xi]"}], ",", "JH", ",", 
               "U", ",", 
               RowBox[{"ts", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "ts"}]}], "}"}]}], "]"}]}], "  ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}], ",", "  ", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MaTeX", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Magnification", "\[Rule]", "2.2"}]}], "]"}], "&"}], 
             ")"}], "/@", 
            RowBox[{"{", 
             RowBox[{
             "\"\< \\\\xi=eV_0/(U-3J_H) \\\\; \>\"", ",", " ", 
              "\"\<J(V_0)/K(0) \>\""}], "}"}]}]}], ",", " ", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "20"}], "]"}]}], ",", "\[IndentingNewLine]",
           "  ", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"MaTeX", "[", 
            RowBox[{
            "\"\<\\\\text{Heisenberg coupling dependence on electrical \
potential}\>\"", ",", 
             RowBox[{"Magnification", "\[Rule]", "1.42"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Orange", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Red", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Blue", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}]}], "   ", 
            "}"}]}], " ", ",", 
          RowBox[{"PlotLegends", "\[Rule]", " ", 
           RowBox[{"Placed", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"MaTeX", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Magnification", "\[Rule]", "1.2"}]}], "]"}], "&"}], 
              "/@", "legends"}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.04", ",", ".05"}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], " ", "}"}]}], " ", 
            "]"}]}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", "  ", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Kr", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"U", "-", 
                  RowBox[{"3", "JH"}]}], ")"}], "\[Xi]"}], ",", "JH", ",", 
               "U", ",", 
               RowBox[{"ts", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "ts"}]}], "}"}]}], "]"}]}], "  ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"Epilog", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Inset", "[", 
              RowBox[{
               RowBox[{"MaTeX", "[", " ", 
                RowBox[{
                 RowBox[{"StringReplace", "[", 
                  RowBox[{"\"\<K(\\\\xi=0.5)=Z1 \\\\, K(0)\>\"", ",", 
                   RowBox[{"\"\<Z1\>\"", "->", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"N", "@", 
                    FractionBox[
                    RowBox[{"Round", "[", 
                    RowBox[{"100", 
                    RowBox[{"K05", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "    ", "]"}], 
                    "100"]}], "]"}]}]}], "    ", "]"}], "  ", ",", 
                 RowBox[{"Magnification", "\[Rule]", "1.2"}]}], " ", "]"}], 
               ",", 
               RowBox[{"K05", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.1"}], ",", 
                  RowBox[{"-", "0.15"}]}], "}"}], "]"}]}], "  ", "]"}], " ", 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "Large", "]"}], ",", 
               RowBox[{"Point", "[", "K05", "]"}]}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", "  ", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MaTeX", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Magnification", "\[Rule]", "2.2"}]}], "]"}], "&"}], 
             ")"}], "/@", 
            RowBox[{"{", 
             RowBox[{
             "\"\< \\\\xi=eV_0/(U-3J_H) \\\\; \>\"", ",", " ", 
              "\"\<K(V_0)/K(0) \>\""}], "}"}]}]}], ",", " ", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "20"}], "]"}]}], ",", "\[IndentingNewLine]",
           "  ", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"MaTeX", "[", 
            RowBox[{
            "\"\<\\\\text{Kitaev coupling dependence on electrical potential}\
\>\"", ",", 
             RowBox[{"Magnification", "\[Rule]", "1.42"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Orange", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Red", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Blue", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}]}], "   ", 
            "}"}]}], " ", ",", 
          RowBox[{"PlotLegends", "\[Rule]", " ", 
           RowBox[{"Placed", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"MaTeX", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Magnification", "\[Rule]", "1.2"}]}], "]"}], "&"}], 
              "/@", "legends"}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.04", ",", ".05"}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], " ", "}"}]}], " ", 
            "]"}]}]}], " ", "]"}], ",", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", "  ", 
           RowBox[{
            RowBox[{"Evaluate", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Kc", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"U", "-", 
                    RowBox[{"3", "JH"}]}], ")"}], "\[Xi]"}], ",", "JH", ",", 
                 "U", ",", 
                 RowBox[{"ts", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "@", "ts"}]}], "}"}]}], "]"}]}], "  ", ",", 
            RowBox[{"{", 
             RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"Epilog", "->", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Inset", "[", 
                RowBox[{
                 RowBox[{"MaTeX", "[", " ", 
                  RowBox[{
                   RowBox[{"StringReplace", "[", 
                    RowBox[{"\"\<K(\\\\xi=0.5)=Z1\>\"", ",", 
                    RowBox[{"\"\<Z1\>\"", "->", " ", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"N", "@", 
                    FractionBox[
                    RowBox[{"Round", "[", 
                    RowBox[{"100", 
                    RowBox[{"Kc05", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "    ", "]"}], 
                    "100"]}], "]"}]}]}], "    ", "]"}], "  ", ",", 
                   RowBox[{"Magnification", "\[Rule]", "1.2"}]}], " ", "]"}], 
                 ",", 
                 RowBox[{"Kc05", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"Scaled", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "0.1"}], ",", 
                    RowBox[{"-", "0.15"}]}], "}"}], "]"}]}], "  ", "]"}], " ",
                ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "[", "Large", "]"}], ",", 
                 RowBox[{"Point", "[", "Kc05", "]"}]}], "}"}]}], "}"}]}], ",",
             "\[IndentingNewLine]", "  ", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MaTeX", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Magnification", "\[Rule]", "2.2"}]}], "]"}], "&"}],
                ")"}], "/@", 
              RowBox[{"{", 
               RowBox[{
               "\"\< \\\\xi=eV_0/(U-3J_H) \\\\; \>\"", ",", " ", 
                "\"\<K(V_0)/K(0) \>\""}], "}"}]}]}], ",", " ", 
            RowBox[{"FrameStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", "20"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "  ", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"MaTeX", "[", 
              RowBox[{
              "\"\<\\\\text{Kitaev coupling dependence on electrical \
potential}\>\"", ",", 
               RowBox[{"Magnification", "\[Rule]", "1.42"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Darker", "[", "Orange", "]"}], ",", 
                 RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
                 RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Darker", "[", "Red", "]"}], ",", 
                 RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
                 RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Darker", "[", "Green", "]"}], ",", 
                 RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
                 RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Darker", "[", "Blue", "]"}], ",", 
                 RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
                 RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}]}], "   ", 
              "}"}]}], " ", ",", 
            RowBox[{"PlotLegends", "\[Rule]", " ", 
             RowBox[{"Placed", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"MaTeX", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Magnification", "\[Rule]", "1.2"}]}], "]"}], 
                 "&"}], "/@", "legends"}], " ", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Scaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.04", ",", ".05"}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], " ", "}"}]}], " ", 
              "]"}]}]}], " ", "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", "  ", 
         RowBox[{
          RowBox[{"Evaluate", "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"\[CapitalGamma]r", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"U", "-", 
                  RowBox[{"3", "JH"}]}], ")"}], "\[Xi]"}], ",", "JH", ",", 
               "U", ",", 
               RowBox[{"ts", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "ts"}]}], "}"}]}], "]"}]}], "  ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}], ",", "  ", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MaTeX", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Magnification", "\[Rule]", "2.2"}]}], "]"}], "&"}], 
             ")"}], "/@", 
            RowBox[{"{", 
             RowBox[{
             "\"\< \\\\xi=eV_0/(U-3J_H) \\\\; \>\"", ",", " ", 
              "\"\<\\\\Gamma(V_0)/K(0) \>\""}], "}"}]}]}], ",", " ", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "20"}], "]"}]}], ",", "\[IndentingNewLine]",
           "  ", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"MaTeX", "[", 
            RowBox[{
            "\"\<\\\\Gamma\\\\text{ coupling dependence on electrical \
potential}\>\"", ",", 
             RowBox[{"Magnification", "\[Rule]", "1.42"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Orange", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Red", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Blue", "]"}], ",", 
               RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
               RowBox[{"Thickness", "[", "0.0023", "]"}]}], "}"}]}], "   ", 
            "}"}]}], " ", ",", 
          RowBox[{"PlotLegends", "\[Rule]", " ", 
           RowBox[{"Placed", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"MaTeX", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Magnification", "\[Rule]", "1.2"}]}], "]"}], "&"}], 
              "/@", "legends"}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Scaled", "[", 
                RowBox[{"{", 
                 RowBox[{"0.04", ",", ".95"}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], " ", "}"}]}], " ", 
            "]"}]}]}], " ", "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "    ", "plots"}]}], "    ", "]"}], "*)"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/au/njOL+a1jWttEfhBdlKsgAqLVN62UAtEnDkoo
gOiOlxOUQDQDj5MWiPb7zOYEon+4ryoC0Rx89ZUgWiByYweI3vkodz6IDvkU
sRhEs3OyHAXR9SXbToLo1787L4DoPdZGV0F0XdvkOyC6ZvmCxyB6mWfzMxC9
onn7GxDNNDv8E4iWTfL9AaJ52d+yZgPpS8fjuEH0rBAfIRD9xV1dBkQvMHGU
BdGHde4pg+hdiSmaIJopwUkXRHNUf7UB0U8e6TmC6PyHu5xAdJ+AlAeIVpj2
0h8sv7MnAkQ/Nl0Apit+98aB6BA+4WQQve9jagaIdljFmw2i19X+m8rOAvTP
ytvTQfTxo9fL0kXeOq45GVoOogGAFqJF
  "],
 CellLabel->
  "In[143]:=",ExpressionUUID->"450104ff-c0e4-4961-8842-e1410ab8bc09"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["    Loop ", "Section",
 CellChangeTimes->{{3.902944289274684*^9, 3.9029443015336604`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"65386cf6-13ec-4e69-bf3a-0864eae5c417"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NbName", " ", "=", " ", "\"\<804\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ls", " ", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"19", ",", "19", ",", "2"}], "]"}]}], ";", " \t    ", 
  RowBox[{"tV", "=", 
   RowBox[{"{", "0", "}"}]}], ";", "\t   ", 
  RowBox[{"hV", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0", ",", "0"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"steps", "=", "600"}], ";", 
   "                                     ", 
   RowBox[{"acuracy", "=", "6"}], ";", "    ", 
   RowBox[{"\[CapitalDelta]eV", "=", "0.099999"}], ";", " ", 
   RowBox[{"eVs", "=", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{"1700", " ", "\[Xi]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Xi]", ",", "0", ",", "0", ",", "\[CapitalDelta]eV"}], 
       "}"}]}], " ", "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ts", " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"5", "x"}], ",", "160", ",", 
       RowBox[{
        RowBox[{"-", "12"}], "x"}], ",", "0", ",", 
       RowBox[{"-", "60"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "tV"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"hs", " ", "=", 
    RowBox[{"Table", "[", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "  ", 
       RowBox[{"hAngle", "[", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"h", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], " ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"h", ",", "hV"}], "}"}]}], "]"}]}], ";"}], "  "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eV0", "=", "0"}], ";", 
   RowBox[{"U", "=", "2600"}], ";", 
   RowBox[{"JH", "=", "300"}], ";", " ", 
   RowBox[{"dmax", "=", ".5"}], ";", " ", 
   RowBox[{"s0", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parametersMat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"JmatMicro", "[", "     ", 
            RowBox[{"0", ",", "JH", ",", "U", ",", 
             RowBox[{"ts", "[", 
              RowBox[{"[", "t", "]"}], "]"}], ",", "dmax", ",", "s0"}], "]"}],
            ",", 
           RowBox[{"hs", "[", 
            RowBox[{"[", "h", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"JmatMicro", "[", 
            RowBox[{"eV0", ",", "JH", ",", "U", ",", 
             RowBox[{"ts", "[", 
              RowBox[{"[", "t", "]"}], "]"}], ",", "dmax", ",", "s0"}], "]"}],
            ",", 
           RowBox[{"hV", "[", 
            RowBox[{"[", "h", "]"}], "]"}], ",", 
           RowBox[{"tV", "[", 
            RowBox[{"[", "t", "]"}], "]"}], ",", 
           RowBox[{"eVs", "[", 
            RowBox[{"[", "ev", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
         " ", ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", "1", ",", 
           RowBox[{"Length", "@", "tV"}]}], "}"}], ",", "  ", 
         RowBox[{"{", 
          RowBox[{"h", ",", "1", ",", 
           RowBox[{"Length", "@", "hV"}]}], "}"}]}], "]"}], ",", "1"}], "]"}],
      " ", ",", "  ", 
     RowBox[{"{", 
      RowBox[{"ev", ",", "1", ",", 
       RowBox[{"Length", "@", "eVs"}]}], "}"}]}], " ", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.902944455255044*^9, 3.9029444570996265`*^9}, {
   3.9029950846914587`*^9, 3.902995090201496*^9}, {3.903015408174095*^9, 
   3.9030154578088207`*^9}, {3.9030158095142965`*^9, 3.903015899491808*^9}, {
   3.9030161469756293`*^9, 3.903016224669248*^9}, {3.9030163165143275`*^9, 
   3.903016384871928*^9}, {3.903209343092739*^9, 3.9032093444683046`*^9}, {
   3.903366389612628*^9, 3.9033663917483807`*^9}, {3.903366713774154*^9, 
   3.903366714964212*^9}, {3.903367539397851*^9, 3.9033675410849037`*^9}, 
   3.90342084577246*^9, 3.9034208833055477`*^9, {3.903421250889243*^9, 
   3.9034212527795277`*^9}, {3.9034222668020506`*^9, 
   3.9034222690750685`*^9}, {3.9034244917915335`*^9, 3.903424537894137*^9}, {
   3.9034278166952944`*^9, 3.9034278176619444`*^9}, {3.9034299893903613`*^9, 
   3.903429991258221*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"ea4ba569-ecd9-46a1-8d24-6107708ff42b"],

Cell[CellGroupData[{

Cell["lagrange multiplier", "Subsubsection",
 CellChangeTimes->{{3.9034278061803265`*^9, 
  3.9034278099654818`*^9}},ExpressionUUID->"518e5963-48fb-4611-9a4f-\
2d9efd8b8a9c"],

Cell[BoxData["Squar"], "Input",
 CellChangeTimes->{{3.9034303827417684`*^9, 
  3.9034303866771708`*^9}},ExpressionUUID->"adfb33b3-6a78-4ee0-8624-\
0b7219aea1b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]V\[Lambda]", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"\[CapitalDelta]en\[Lambda]", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"\[CapitalDelta]enSum\[Lambda]", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",ExpressionUUID->"7888595a-9394-40b0-\
bcdc-a5e9fb80488c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Eta]s", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.1"}], ",", 
     RowBox[{"-", ".9"}], ",", 
     RowBox[{"-", ".8"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9034283032018833`*^9, 3.903428313020252*^9}, {
  3.9034298923025284`*^9, 3.9034298939209256`*^9}, {3.903429968983227*^9, 
  3.9034299710298796`*^9}, {3.9034301339912643`*^9, 3.9034301434070735`*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"88864d89-6cbc-45ba-accf-039b77e8c46b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
        "L", ",", "Jmat", ",", "Nc", ",", "h", ",", "\[CapitalLambda]", ",", 
         "T", ",", "H", ",", "\[Xi]", ",", "EnG0", ",", "En", ",", 
         RowBox[{"EnList", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", "u", ",", "u2", ",", "U", ",",
          "V", ",", "j", ",", 
         RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
         RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", "ES", ",", "gap", ",", 
         "\[CapitalDelta]t", ",", "\[CapitalDelta]tHours", ",", 
         "\[CapitalDelta]tMin", ",", "\[CapitalDelta]tSec", ",", "kTable", 
         ",", "\[CapitalDelta]V", ",", 
         RowBox[{"\[CapitalDelta]Vseq", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\[CapitalDelta]seq", "=", 
          RowBox[{"{", "}"}]}], ",", "EMF", ",", "Esum", ",", "cMF", ",", 
         "\[Eta]", ",", "hp", " ", ",", 
         RowBox[{"Tk", "=", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["2"]], "Tkmom"}]}], ",", "Umatvec", ",", 
         RowBox[{"l", "=", "1"}], ",", 
         RowBox[{"p", "=", "1"}]}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{"L", "=", 
         RowBox[{"Ls", "[", 
          RowBox[{"[", "l", "]"}], "]"}]}], ";", " ", 
        RowBox[{"hp", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{"p", ",", 
           RowBox[{"Length", "@", "hV"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]", "=", 
         RowBox[{"\[Eta]s", "[", 
          RowBox[{"[", "\[Eta]0", "]"}], "]"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Jmat", ",", "h"}], "}"}], "=", 
         RowBox[{
          RowBox[{"parametersMat", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
        RowBox[{"Nc", "=", 
         SuperscriptBox["L", "2"]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{"p", "==", "1"}], ",", " ", 
            RowBox[{
             RowBox[{"UG", "=", "Uguess"}], ";", " ", 
             RowBox[{"VG", "=", "Vguess"}], ";"}]}], " ", "]"}], ";"}], 
         "*)"}], "  ", "\[IndentingNewLine]", 
        RowBox[{"UG", "=", "Uguess"}], ";", " ", 
        RowBox[{"VG", "=", "Vguess"}], ";", "  ", 
        RowBox[{"U", "=", "UG"}], ";", " ", 
        RowBox[{"V", "=", "VG"}], ";", "   ", 
        RowBox[{"kTable", "=", 
         RowBox[{"toMomentumTable", "[", "L", "]"}]}], ";", "\n", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"j", "<", 
              RowBox[{"(", "steps", ")"}]}], ")"}], "\[And]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Chop", "[", " ", 
               RowBox[{"\[CapitalDelta]1", ",", 
                RowBox[{"10", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "acuracy"}], ")"}]}]}], " ", "]"}], "!=", " ", 
              "0"}], ")"}]}], " ", ")"}], ",", " ", 
          RowBox[{"j", "++"}], ",", "  ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Umatvec", "=", 
            RowBox[{"UmatVec", "[", 
             RowBox[{
             "Jmat", ",", "h", ",", "U", ",", "V", ",", " ", "kTable", ",", 
              "Tk", ",", "\[Eta]"}], "]"}]}], " ", ";", "\n", 
           RowBox[{"u", "=", 
            RowBox[{"Chop", "@", 
             RowBox[{"Sum", " ", "[", "  ", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "k", ",", "\[DoubleStruckCapitalU]", ",", 
                   "\[DoubleStruckCapitalU]less", ",", 
                   "\[DoubleStruckCapitalU]gtr"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"k", "=", 
                   RowBox[{"kTable", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ";", 
                  RowBox[{"\[DoubleStruckCapitalU]", "=", 
                   RowBox[{"Tk", " ", ".", " ", 
                    RowBox[{"Umatvec", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}]}], ";", 
                  RowBox[{"\[DoubleStruckCapitalU]less", "=", 
                   RowBox[{"\[DoubleStruckCapitalU]", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], ";", " ", 
                  RowBox[{"\[DoubleStruckCapitalU]gtr", "=", 
                   RowBox[{"\[DoubleStruckCapitalU]", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", "\n", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", "/", "Nc"}], ")"}], 
                   RowBox[{"Conjugate", "@", 
                    RowBox[{"Chop", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Conjugate]"], " ", ".", " ", 
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Transpose]"]}], " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"k", " ", ".", " ", "nx"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[DoubleStruckCapitalU]less", " ", ".", " ", 
                    RowBox[{
                    "\[DoubleStruckCapitalU]less", 
                    "\[ConjugateTranspose]"}]}], " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"k", " ", ".", " ", "nx"}]}], "]"}]}]}], ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Conjugate]"], " ", ".", " ", 
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Transpose]"]}], " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"k", " ", ".", " ", "ny"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[DoubleStruckCapitalU]less", " ", ".", " ", 
                    RowBox[{
                    "\[DoubleStruckCapitalU]less", 
                    "\[ConjugateTranspose]"}]}], " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"k", " ", ".", " ", "ny"}]}], "]"}]}]}], ",", " ", 
                    RowBox[{
                    RowBox[{
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Conjugate]"], " ", ".", " ", 
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Transpose]"]}], "+", " ", 
                    RowBox[{"\[DoubleStruckCapitalU]less", " ", ".", " ", 
                    RowBox[{
                    "\[DoubleStruckCapitalU]less", 
                    "\[ConjugateTranspose]"}]}]}]}], "}"}]}]}]}]}]}], " ", 
                "\n", "  ", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}]}], 
           ";", " ", "\[IndentingNewLine]", "\n", 
           RowBox[{
            RowBox[{"U", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "4"}], ",", 
               RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], " ", ";", 
           RowBox[{
            RowBox[{"U", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "4"}], ",", 
               RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"U", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "4"}], ",", 
               RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "4"}], ",", 
               RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"5", ";;", "8"}], ",", 
               RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], ";", "\n", 
           RowBox[{"\[CapitalDelta]V", "=", 
            RowBox[{
             RowBox[{"1", "/", "12"}], " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"Sqrt", "@", " ", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Power", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
                  RowBox[{"traceG", "[", 
                   RowBox[{"V", "[", 
                    RowBox[{"[", "\[Sigma]", "]"}], "]"}], "]"}]}], "  ", 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}], 
           ";", " ", 
           RowBox[{"\[CapitalDelta]Vseq", "=", 
            RowBox[{"{", 
             RowBox[{"\[CapitalDelta]Vseq", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "\[CapitalDelta]V"}], "}"}]}], "}"}]}], " ", 
           ";", "   ", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", ">=", "2"}], ",", 
             RowBox[{
              RowBox[{"\[CapitalDelta]2", "=", "\[CapitalDelta]1"}], ";", " ", 
              RowBox[{"\[CapitalDelta]1", "=", 
               RowBox[{"Max", "[", " ", 
                RowBox[{"Abs", "@", 
                 RowBox[{"(", 
                  RowBox[{"u", "-", "u2"}], ")"}]}], " ", "]"}]}], ";", 
              RowBox[{"\[CapitalDelta]seq", "=", 
               RowBox[{"{", 
                RowBox[{"\[CapitalDelta]seq", ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "\[CapitalDelta]1"}], "}"}]}], "}"}]}], 
              "  ", ";"}]}], "   ", "]"}], ";", " ", 
           RowBox[{"u2", "=", "u"}], ";", "                    ", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<j=\>\"", ",", "j", ",", "\"\<; \[CapitalDelta]V=\>\"", ",", 
             "\[CapitalDelta]V", ",", "\"\<; \[CapitalDelta]=\>\"", ",", 
             "\[CapitalDelta]1"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
         "                             ", "]"}], ";", "\n", 
        RowBox[{"t1", "=", 
         RowBox[{"AbsoluteTime", "[", "]"}]}], ";", " ", 
        RowBox[{"\[CapitalDelta]t", "=", 
         RowBox[{"UnitConvert", "[", " ", 
          RowBox[{
           RowBox[{"Quantity", "[", 
            RowBox[{
             RowBox[{"t1", " ", "-", "t0"}], ",", " ", "\"\<Seconds\>\""}], 
            " ", "]"}], ",", " ", "\"\<Minutes\>\""}], " ", "]"}]}], ";", " ", 
        RowBox[{"t0", "=", "t1"}], ";", "\n", 
        RowBox[{"\[CapitalDelta]seq", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "\[CapitalDelta]seq", "]"}], ",", "2"}], 
          "]"}]}], ";", " ", 
        RowBox[{"\[CapitalDelta]Vseq", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "\[CapitalDelta]Vseq", "]"}], ",", "2"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"EMF", "    ", "=", " ", 
         RowBox[{"enMFmom", "[", 
          RowBox[{"Jmat", ",", "U", ",", "V", ",", "h"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Esum", " ", "=", 
         RowBox[{"enSUMmom", "[", 
          RowBox[{"Jmat", ",", "U", ",", "V", ",", "h", ",", "L"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"cMF", "   ", "=", 
         RowBox[{"cMFmom", "[", 
          RowBox[{"Jmat", ",", "U", ",", "V"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\n", "\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"dataToFile800", "[", 
           RowBox[{
            RowBox[{"parametersMat", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", "acuracy",
             ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "L", ",", "U", ",", "V", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "EMF", "}"}], ",", 
                RowBox[{"{", "Esum", "}"}], ",", 
                RowBox[{"{", "cMF", "}"}], ",", "\[CapitalDelta]seq", ",", 
                "\[CapitalDelta]Vseq"}], "}"}]}], "}"}], ",", "\"\<free\>\"", 
            ",", "NbName"}], "]"}], ";", " ", "\n", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Max Step = \>\"", ",", " ", "j", ",", "\"\<; Delta=\>\"", ",", 
            RowBox[{"round", "@", "\[CapitalDelta]1"}], ",", 
            RowBox[{"(*", 
             RowBox[{",", "\"\<; \[CapitalDelta]t = \>\"", ",", 
              RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}], ",", 
              RowBox[{"IntegerPart", "@", 
               RowBox[{"UnitConvert", "[", 
                RowBox[{
                 RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], 
                 ",", " ", "\"\<Seconds\>\""}], " ", "]"}]}]}], "*)"}], 
            "\"\<; E=\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"EMF", ",", "Esum", ",", "cMF"}], "}"}], ",", 
            "\[IndentingNewLine]", "\"\<;  p=\>\"", ",", "p", ",", 
            "\"\</\>\"", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"parametersMat", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "jG", ",", "LG", ",", "\[Chi]G", ",", "\[Omega]G", ",", "\[Xi]G", 
             ",", "EnG"}], "}"}], "=", " ", 
           RowBox[{"loadData", "[", 
            RowBox[{"toPath800", "[", 
             RowBox[{
              RowBox[{"parametersMat", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
              "acuracy", ",", "\"\<free\>\"", ",", "NbName"}], " ", "]"}], 
            "  ", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"\[CapitalDelta]V\[Lambda]", ",", 
          RowBox[{"{", 
           RowBox[{"\[Eta]", ",", "\[CapitalDelta]V"}], "}"}]}], "]"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"\[CapitalDelta]en\[Lambda]", ",", 
          RowBox[{"{", 
           RowBox[{"\[Eta]", ",", "EMF"}], "}"}]}], "]"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"\[CapitalDelta]enSum\[Lambda]", ",", 
          RowBox[{"{", 
           RowBox[{"\[Eta]", ",", "Esum"}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\n", " ", "]"}], ";"}], "  ", ",", " ", 
    RowBox[{"{", 
     RowBox[{"\[Eta]0", ",", "1", ",", 
      RowBox[{"Length", "@", "\[Eta]s"}]}], "}"}]}], "]"}], " ", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9033652043689866`*^9, 3.9033652216473317`*^9}, {
   3.9033654072771564`*^9, 3.9033660290437393`*^9}, {3.903366071912367*^9, 
   3.9033661239087114`*^9}, {3.903366210488823*^9, 3.9033662146087675`*^9}, 
   3.903366268742918*^9, {3.903366314103799*^9, 3.9033663766984763`*^9}, {
   3.9033664268790736`*^9, 3.903366429572959*^9}, {3.903366485062214*^9, 
   3.903366549070778*^9}, {3.903366603118486*^9, 3.903366625079398*^9}, {
   3.9033666754818797`*^9, 3.9033666845918045`*^9}, 3.9033667795087924`*^9, {
   3.9033668497452526`*^9, 3.9033668946315117`*^9}, {3.903366934682482*^9, 
   3.9033669360780187`*^9}, {3.9033670556688333`*^9, 
   3.9033671178586655`*^9}, {3.903367163086542*^9, 3.903367177595671*^9}, {
   3.9033672660719776`*^9, 3.9033672843156443`*^9}, {3.903367325234885*^9, 
   3.9033673581501217`*^9}, {3.903367487246004*^9, 3.903367519447819*^9}, {
   3.903367556187047*^9, 3.9033675572679496`*^9}, 3.9033675893092318`*^9, {
   3.90336768974885*^9, 3.90336773196281*^9}, {3.9033677629660172`*^9, 
   3.9033677675081615`*^9}, {3.90336781001264*^9, 3.9033678553052716`*^9}, {
   3.9033678905145736`*^9, 3.9033679580651407`*^9}, {3.903368133142744*^9, 
   3.903368133343282*^9}, {3.90341839356828*^9, 3.903418413635346*^9}, {
   3.903418806581052*^9, 3.9034188316473722`*^9}, {3.90341887520944*^9, 
   3.9034189274989276`*^9}, {3.9034189577397847`*^9, 
   3.9034189682667575`*^9}, {3.903419404210492*^9, 3.903419446870926*^9}, {
   3.9034194955188665`*^9, 3.9034195243830605`*^9}, 3.9034195993093877`*^9, {
   3.903419724478938*^9, 3.9034197513663263`*^9}, 3.903419998335585*^9, {
   3.903420033674863*^9, 3.9034201279066815`*^9}, {3.9034201651465263`*^9, 
   3.9034201749767523`*^9}, {3.9034202535821514`*^9, 3.903420262007784*^9}, {
   3.9034203415683155`*^9, 3.9034203489944525`*^9}, {3.9034207622349977`*^9, 
   3.9034207641687527`*^9}, {3.9034210233046007`*^9, 3.903421025703529*^9}, {
   3.903421091547433*^9, 3.903421093190897*^9}, {3.9034220787720027`*^9, 
   3.903422080345462*^9}, 3.9034221333704805`*^9, {3.9034222897801685`*^9, 
   3.903422292075113*^9}, {3.9034223848203473`*^9, 3.903422393485564*^9}, {
   3.9034232833994627`*^9, 3.9034233136190453`*^9}, {3.9034233918053527`*^9, 
   3.9034233953577795`*^9}, {3.9034235165029736`*^9, 3.903423567643548*^9}, 
   3.903423739748234*^9, {3.903423814876255*^9, 3.9034238186103272`*^9}, {
   3.903424388703539*^9, 3.903424390590928*^9}, {3.9034244507363706`*^9, 
   3.9034244520394936`*^9}, {3.9034245782975774`*^9, 
   3.9034246431560936`*^9}, {3.9034246792707977`*^9, 
   3.9034246946129265`*^9}, {3.903426414592014*^9, 3.903426441344535*^9}, {
   3.903427827701002*^9, 3.903428132778655*^9}, {3.90342824159041*^9, 
   3.903428285713908*^9}, {3.903429900044857*^9, 3.903429986381666*^9}, {
   3.9034301270942073`*^9, 3.9034301308545494`*^9}, {3.9034302975208817`*^9, 
   3.9034303516033716`*^9}, {3.9034304649176226`*^9, 3.903430505346096*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"e4fa8dea-8c84-40a8-8e96-2b6713ba6c8d"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "0.005733779153239289`", "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>",
    "\[InvisibleSpace]", "1"}],
  SequenceForm[
  "j=", 1, "; \[CapitalDelta]V=", 0.005733779153239289, "; \[CapitalDelta]=", 
   1],
  Editable->False]], "Print",
 CellChangeTimes->{3.9034301461766777`*^9, 3.903430369090409*^9, 
  3.903430475532707*^9, 3.903430506703404*^9},
 CellLabel->
  "During evaluation of \
In[232]:=",ExpressionUUID->"4599635a-e50c-4762-8e2a-dd3294a67ca2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "0.007755861681365073`", "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>",
    "\[InvisibleSpace]", "0.010740194691641097`"}],
  SequenceForm[
  "j=", 2, "; \[CapitalDelta]V=", 0.007755861681365073, "; \[CapitalDelta]=", 
   0.010740194691641097`],
  Editable->False]], "Print",
 CellChangeTimes->{3.9034301461766777`*^9, 3.903430369090409*^9, 
  3.903430475532707*^9, 3.903430507326972*^9},
 CellLabel->
  "During evaluation of \
In[232]:=",ExpressionUUID->"cdf4d0b6-26a1-4b65-8072-d18bd130fb6d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "0.008470682709387231`", "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>",
    "\[InvisibleSpace]", "0.0038468105101241504`"}],
  SequenceForm[
  "j=", 3, "; \[CapitalDelta]V=", 0.008470682709387231, "; \[CapitalDelta]=", 
   0.0038468105101241504`],
  Editable->False]], "Print",
 CellChangeTimes->{3.9034301461766777`*^9, 3.903430369090409*^9, 
  3.903430475532707*^9, 3.9034305079458575`*^9},
 CellLabel->
  "During evaluation of \
In[232]:=",ExpressionUUID->"cde325a5-9088-4b77-b3aa-ca7a3bc84564"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "0.00872760775186135`", "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>", 
   "\[InvisibleSpace]", "0.001390813862583995`"}],
  SequenceForm[
  "j=", 4, "; \[CapitalDelta]V=", 0.00872760775186135, "; \[CapitalDelta]=", 
   0.001390813862583995],
  Editable->False]], "Print",
 CellChangeTimes->{3.9034301461766777`*^9, 3.903430369090409*^9, 
  3.903430475532707*^9, 3.9034305085958967`*^9},
 CellLabel->
  "During evaluation of \
In[232]:=",ExpressionUUID->"57b11ae0-1d67-4359-aa0d-bc9d6e0e378a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "0.008820659701265495`", "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>",
    "\[InvisibleSpace]", "0.0005048584759099403`"}],
  SequenceForm[
  "j=", 5, "; \[CapitalDelta]V=", 0.008820659701265495, "; \[CapitalDelta]=", 
   0.0005048584759099403],
  Editable->False]], "Print",
 CellChangeTimes->{3.9034301461766777`*^9, 3.903430369090409*^9, 
  3.903430475532707*^9, 3.9034305092216034`*^9},
 CellLabel->
  "During evaluation of \
In[232]:=",ExpressionUUID->"6ccd05cd-ac3a-4b74-bf19-0e2b9a46d613"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "0.008854459820150101`", "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>",
    "\[InvisibleSpace]", "0.00018353788709953717`"}],
  SequenceForm[
  "j=", 6, "; \[CapitalDelta]V=", 0.008854459820150101, "; \[CapitalDelta]=", 
   0.00018353788709953717`],
  Editable->False]], "Print",
 CellChangeTimes->{3.9034301461766777`*^9, 3.903430369090409*^9, 
  3.903430475532707*^9, 3.903430509858695*^9},
 CellLabel->
  "During evaluation of \
In[232]:=",ExpressionUUID->"151676a2-f6db-485c-8126-cb1bfff479a8"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.9034303707245803`*^9, 3.903430477490795*^9, 
  3.903430510387273*^9},
 CellLabel->
  "Out[232]=",ExpressionUUID->"fe7c19ae-92d5-4748-b99f-02575de19ad6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"\[CapitalDelta]V\[Lambda]", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.2"}], ",", 
         RowBox[{"-", ".8"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0.1"}], "}"}]}], "}"}]}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.9034281379085655`*^9, 3.903428141978312*^9}, {
  3.9034301816547604`*^9, 3.9034302217054663`*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"0fc21723-198e-408b-8f10-9752906b4fd6"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], 
    PointBox[{{-1., 0.00812939513522521}, {0., 0.20850200685516945`}, {1., 
     1.1547005383788032`}, {-1.1, 0.015369758533838937`}, {-0.9, 
     0.00010207834714047112`}, {-0.8, 0.009543366804870498}}]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-0.8, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{-1.2, -0.8}, {0, 0.1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.903430073920631*^9, {3.9034301761244383`*^9, 3.903430222343932*^9}},
 CellLabel->
  "Out[229]=",ExpressionUUID->"1fa5be0e-271e-4858-931a-92249cc3c80e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
   "\[CapitalDelta]en\[Lambda]", ",", "\[CapitalDelta]enSum\[Lambda]"}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9034300874709826`*^9, 3.9034301019588056`*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"cfb7cda2-97d4-41a1-8673-5d17c760ca55"],

Cell[BoxData[
 GraphicsBox[{{}, {
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{-1., -0.7941640066203702}, {0., -1.0080803788456614`}, {
      1., -2.899999999998466}}]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{-1., -0.812450945376084}, {0., -0.9393562518013099}, {
      1., -1.6999999999994508`}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{-1., 1.}, {-2.899999999998466, 0}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.903430096610936*^9, 3.9034301024957123`*^9}},
 CellLabel->
  "Out[222]=",ExpressionUUID->"003c06f5-351c-41f2-a15b-a18718830519"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["pure loop w/ vortices", "Subsubsection",ExpressionUUID->"2265bcee-baf6-4281-ae07-a0d367c545b4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "[", "]"}], ";", 
    RowBox[{"Print", "[", "\"\<    Pure and with vortices \>\"", "]"}], ";", 
    RowBox[{"Print", "[", "]"}], ";"}], "\n", 
   RowBox[{"Do", "[", "   ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"gauge", "=", "\"\<g4\>\""}], ",", "J", ",", "K", ",", 
         "\[CapitalGamma]", ",", "Jmod", ",", "Kmod", ",", 
         "\[CapitalGamma]mod", ",", "Jv", ",", "Kv", ",", "\[CapitalGamma]v", 
         ",", 
         RowBox[{"L", "=", 
          RowBox[{"Ls", "[", 
           RowBox[{"[", "l", "]"}], "]"}]}], ",", "Nc", ",", "h", ",", "T", 
         ",", "En", ",", "EMF", ",", "E\[Lambda]", ",", 
         RowBox[{"EnList", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", "u0", ",", "ES", ",", 
         "\[CapitalDelta]t", ",", 
         RowBox[{"hp", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{"p", ",", 
            RowBox[{"Length", "@", "hV"}], ",", "1"}], "]"}]}]}], " ", "}"}], 
       ",", " ", "\n", "\n", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", "Jmod", ",", 
           "Kmod", ",", "\[CapitalGamma]mod"}], "}"}], "=", 
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", 
            RowBox[{"ev", ",", "p"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], ";", " ", "\n", 
        RowBox[{"Nc", "=", 
         RowBox[{"L", "^", "2"}]}], ";", "\n", 
        RowBox[{"T", "=", 
         RowBox[{"Tmat", "[", 
          RowBox[{"L", ",", "L"}], "]"}]}], ";", "\n", 
        RowBox[{"Kv", "=", 
         RowBox[{"uniform", "[", 
          RowBox[{"K", ",", "L", ",", "L"}], "]"}]}], ";", 
        RowBox[{"Kv", "=", 
         RowBox[{"add4VorticesMaxSpaced", "[", " ", 
          RowBox[{"Kv", ",", "Kmod", ",", "L"}], "]"}]}], ";", "\n", 
        RowBox[{"Jv", "=", 
         RowBox[{"uniform", "[", 
          RowBox[{"J", ",", "L", ",", "L"}], "]"}]}], ";", 
        RowBox[{"Jv", "=", 
         RowBox[{"add4VorticesMaxSpaced", "[", " ", 
          RowBox[{"Jv", ",", "Jmod", ",", "L"}], "]"}]}], ";", "\n", 
        RowBox[{"\[CapitalGamma]v", "=", 
         RowBox[{"uniform", "[", 
          RowBox[{"\[CapitalGamma]", ",", "L", ",", "L"}], "]"}]}], ";", 
        RowBox[{"\[CapitalGamma]v", "=", 
         RowBox[{"add4VorticesMaxSpaced", "[", " ", 
          RowBox[{"\[CapitalGamma]v", ",", "\[CapitalGamma]mod", ",", "L"}], 
          "]"}]}], ";", "\n", 
        RowBox[{"u0", "=", 
         RowBox[{"gauge4v", "[", 
          RowBox[{
           RowBox[{"uniformU", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "L"}], "]"}], ",", "L"}], "]"}]}], ";", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{"for", " ", "Pure", " ", "Kitaev", " ", 
          RowBox[{"model", ":"}]}], " ", "*)"}], "\n", 
        RowBox[{"Module", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"h0", "=", 
             RowBox[{"Norm", "[", "h", "]"}]}], ",", "\[Kappa]0", ",", 
            "\[Kappa]", ",", "\[Chi]0", ",", "\[Omega]0", ",", "Hpure", ",", 
            "Tpure", ",", "Epure", ",", "Upure"}], "}"}], ",", "   ", "\n", 
          RowBox[{
           RowBox[{"\[Kappa]0", "=", 
            RowBox[{"toKappa", "[", "h", "]"}]}], ";", " ", "\n", 
           RowBox[{"\[Kappa]", "=", 
            RowBox[{"N", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"10000", " ", "\[Kappa]0"}], "]"}], "/", "10000"}], 
              ")"}]}]}], ";", "   ", "\n", 
           RowBox[{"\[Chi]0", "=", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "  ", 
           RowBox[{"(*", "\n", 
            RowBox[{
             RowBox[{"\[Omega]0", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"\[Omega]GA", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
             ";"}], "*)"}], "\n", 
           RowBox[{"Hpure", "=", 
            RowBox[{"Hreal", "[", 
             RowBox[{"Kv", ",", "\[Kappa]", ",", 
              RowBox[{"to\[Lambda]", "[", "h", "]"}], ",", "u0", ",", "L", 
              ",", "0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", "   ", 
           "\n", 
           RowBox[{"Tpure", "=", 
            RowBox[{"TmatPure", "[", "L", "]"}]}], ";", " ", "\n", 
           RowBox[{"Upure", "=", 
            RowBox[{"UmatPure", "[", 
             RowBox[{
              RowBox[{"Tpure", "\[ConjugateTranspose]"}], " ", ".", " ", 
              "Hpure", " ", ".", " ", "Tpure"}], "]"}]}], ";", " ", "\n", 
           RowBox[{"Epure", "=", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"Quiet", "@", 
                 RowBox[{"Eigenvalues", "[", "Hpure", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
             RowBox[{"(", "Nc", ")"}]}]}], ";", "\n", "\n", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "=", 
            RowBox[{"toMFparametersPure", "[", 
             RowBox[{"Upure", ",", "u0", ",", "L", ",", "0"}], "]"}]}], ";", 
           "   ", "\n", 
           RowBox[{"\[Chi]0", "=", 
            RowBox[{"\[Chi]gauge4v", "[", 
             RowBox[{"\[Chi]0", ",", "L"}], "]"}]}], ";", "\n", 
           RowBox[{"dataToFilePure", "[", 
            RowBox[{
             RowBox[{"parameters", "[", 
              RowBox[{"[", 
               RowBox[{"ev", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
             "acuracy", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "L", ",", "\[Chi]0", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{"{", "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{"{", "}"}]}], "}"}]}], "}"}], ",", 
               RowBox[{"{", "Epure", "}"}]}], " ", "}"}], ",", " ", "gauge", 
             ",", "NbName"}], " ", "]"}], ";", " ", "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{"ev", "==", "1"}], ",", " ", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Kappa=\>\"", ",", "\[Kappa]", ",", "\"\<; Lambda=\>\"", 
                  ",", 
                  RowBox[{"to\[Lambda]", "[", "h", "]"}], ",", " ", 
                  "\"\<; L=\>\"", ",", "L", ",", "\"\<; h=(\>\"", ",", " ", 
                  RowBox[{"hV", "[", 
                   RowBox[{"[", " ", 
                    RowBox[{"hp", ",", "1"}], " ", "]"}], "]"}], ",", 
                  "\"\<,\>\"", ",", 
                  RowBox[{"hV", "[", 
                   RowBox[{"[", " ", 
                    RowBox[{"hp", ",", "2"}], " ", "]"}], "]"}], ",", 
                  "\"\<,\>\"", ",", 
                  RowBox[{"hV", "[", 
                   RowBox[{"[", " ", 
                    RowBox[{"hp", ",", "3"}], "]"}], "]"}], ",", 
                  "\"\<); \>\""}], "]"}], ";"}]}], " ", "]"}], ";"}], "*)"}], 
           "\n", 
           RowBox[{"Print", "[", " ", 
            RowBox[{"\"\< eV0=\>\"", ",", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"Round", "[", " ", 
                RowBox[{"1000", "  ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"parameters", "[", 
                    RowBox[{"[", 
                    RowBox[{"ev", ",", "p"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "10", "]"}], "]"}], "/", "1700"}]}], " ", 
                "]"}], " ", "/", "1000"}], "]"}], " ", ",", "\"\< x 1700\>\"",
              ",", "\"\<; Epure=\>\"", ",", "Epure", ",", "\"\<; \>\""}], 
            "]"}], ";"}]}], "\n", "       ", "]"}], ";"}]}], " ", "\n", 
      "        ", "]"}], "  ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"ev", ",", "1", ",", 
       RowBox[{"Length", "[", "parameters", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", 
       RowBox[{"Length", "@", "Ls"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"p", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "  ", "]"}]}],
   "   ", "*)"}]], "Input",ExpressionUUID->"6ab80606-4180-4a50-9ad6-\
f692f57c78d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["vortex free", "Subsubsection",
 FontWeight->Bold,ExpressionUUID->"ac67c233-9311-4236-9c27-b4d81ab07561"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tvf", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Definition timing= \>\"", ",", 
    RowBox[{"round", "[", 
     RowBox[{"tvf", "-", "t0"}], "]"}]}], " ", "]"}], ";", " ", 
  RowBox[{"t0", "=", "tvf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", 
  RowBox[{"Print", "[", "\"\<    Starting free loop\>\"", "]"}], ";", 
  RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9030164181943235`*^9, 
  3.903016430140953*^9}},ExpressionUUID->"984bbfad-0c2e-4664-a92e-\
05e03865d0f1"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Do", "[", " ", 
    RowBox[{
     RowBox[{"Do", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Module", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"L", "=", 
             RowBox[{"Ls", "[", 
              RowBox[{"[", "l", "]"}], "]"}]}], ",", "Nc", ",", "h", ",", 
            "En", ",", 
            RowBox[{"EnList", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", "u", ",", "u2", ",", "U", 
            ",", "V", ",", "j", ",", 
            RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
            RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", "ES", ",", "gap", 
            ",", "\[CapitalDelta]t", ",", "\[CapitalDelta]tHours", ",", 
            "\[CapitalDelta]tMin", ",", "\[CapitalDelta]tSec", ",", "kTable", 
            ",", "constraintViolation", ",", 
            RowBox[{"\[CapitalDelta]Vseq", "=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"\[CapitalDelta]seq", "=", 
             RowBox[{"{", "}"}]}], ",", "EMF", ",", "Esum", ",", 
            RowBox[{"\[Eta]", "=", "1"}], ",", "p", ",", "Jmat"}], "}"}], ",",
           "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"p", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "hV", "]"}], 
              RowBox[{"(", 
               RowBox[{"pt", "-", "1"}], ")"}]}], "+", "ph"}]}], ";", "\n", 
           "           ", 
           RowBox[{"Nc", "=", 
            RowBox[{"L", "^", "2"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Jmat", ",", "h"}], "}"}], "=", 
            RowBox[{
             RowBox[{"parameters", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"U", "=", "Uguess"}], ";", 
           RowBox[{"V", "=", "Vguess"}], ";", "\n", "\t", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Jmat[z] \>\"", ",", 
             RowBox[{"MatrixForm", "[", " ", 
              RowBox[{"Jmat", "[", 
               RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], ",", 
             "\"\<; L=\>\"", ",", "L", ",", "\[IndentingNewLine]", 
             "\"\<; h=(\>\"", ",", " ", 
             RowBox[{"hV", "[", 
              RowBox[{"[", " ", 
               RowBox[{"ph", ",", "1"}], " ", "]"}], "]"}], ",", "\"\<,\>\"", 
             ",", 
             RowBox[{"hV", "[", 
              RowBox[{"[", " ", 
               RowBox[{"ph", ",", "2"}], " ", "]"}], "]"}], ",", "\"\<,\>\"", 
             ",", 
             RowBox[{"hV", "[", 
              RowBox[{"[", " ", 
               RowBox[{"ph", ",", "3"}], "]"}], "]"}], ",", "\"\<); \>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{"j", "<", 
                 RowBox[{"(", "steps", ")"}]}], ")"}], "\[And]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Chop", "[", " ", 
                  RowBox[{"\[CapitalDelta]1", ",", 
                   RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "8"}], ")"}]}]}], " ", "]"}], "!=", " ", 
                 "0"}], ")"}]}], " ", ")"}], ",", " ", 
             RowBox[{"j", "++"}], ","}], "  ", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\n", "\t", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", " ", "]"}], ";"}], "  ", ",", " ", 
       RowBox[{"{", 
        RowBox[{"pt", ",", "1", ",", 
         RowBox[{"Length", "@", "tV"}]}], "}"}], ",", "  ", 
       RowBox[{"{", 
        RowBox[{"ph", ",", "1", ",", 
         RowBox[{"Length", "@", "hV"}]}], "}"}]}], "  ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", 
       RowBox[{"Length", "@", "Ls"}]}], "}"}]}], "]"}], ";", 
   RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.903016460858768*^9, 3.9030165408905783`*^9}, 
   3.9030166019544983`*^9, {3.9030166693598137`*^9, 3.9030166764980645`*^9}, {
   3.903016733793085*^9, 3.903016769379383*^9}, {3.903016818860441*^9, 
   3.9030168513929896`*^9}, {3.9030170130833545`*^9, 3.903017042806652*^9}, {
   3.9030170981577063`*^9, 3.9030171387676363`*^9}, {3.903017174452446*^9, 
   3.9030171842846775`*^9}, {3.903017228027129*^9, 3.903017235249035*^9}, {
   3.9030172779572906`*^9, 3.9030173169247885`*^9}, {3.9030173709942102`*^9, 
   3.903017386069847*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"6c30ca45-decf-419b-b51e-ad5ca7f8bd20"]
}, Open  ]],

Cell[CellGroupData[{

Cell["vortex free momentum", "Subsubsection",
 CellChangeTimes->{{3.9030175049617443`*^9, 3.9030175072543926`*^9}},
 FontWeight->Bold,ExpressionUUID->"b8305b6a-2c62-41ce-8c80-77867ba76771"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", " ", 
     RowBox[{
      RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"L", "=", 
              RowBox[{"Ls", "[", 
               RowBox[{"[", "l", "]"}], "]"}]}], ",", "Jmat", ",", "Nc", ",", 
             "h", ",", "\[CapitalLambda]", ",", "T", ",", "H", ",", "\[Xi]", 
             ",", "EnG0", ",", "En", ",", 
             RowBox[{"EnList", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", "u", ",", "u2", ",", "U", 
             ",", "V", ",", "j", ",", 
             RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
             RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", "ES", ",", "gap", 
             ",", "\[CapitalDelta]t", ",", "\[CapitalDelta]tHours", ",", 
             "\[CapitalDelta]tMin", ",", "\[CapitalDelta]tSec", ",", "kTable",
              ",", "\[CapitalDelta]V", ",", 
             RowBox[{"\[CapitalDelta]Vseq", "=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"\[CapitalDelta]seq", "=", 
              RowBox[{"{", "}"}]}], ",", "EMF", ",", "Esum", ",", "cMF", ",", 
             "\[Eta]", ",", 
             RowBox[{"hp", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{"p", ",", 
                RowBox[{"Length", "@", "hV"}], ",", "1"}], "]"}]}], ",", 
             RowBox[{"Tk", "=", 
              RowBox[{
               FractionBox["1", 
                SqrtBox["2"]], "Tkmom"}]}], ",", "Umatvec"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[Eta]", "=", 
             RowBox[{"-", "1"}]}], ";", "\n", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Jmat", ",", "h"}], "}"}], "=", 
             RowBox[{
              RowBox[{"parametersMat", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
            RowBox[{"Nc", "=", 
             SuperscriptBox["L", "2"]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"p", "==", "1"}], ",", " ", 
              RowBox[{
               RowBox[{"UG", "=", "Uguess"}], ";", " ", 
               RowBox[{"VG", "=", "Vguess"}], ";"}]}], " ", "]"}], ";", "  ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"UG", "=", "Uguess"}], ";", " ", 
              RowBox[{"VG", "=", "Vguess"}], ";"}], " ", "*)"}], " ", 
            RowBox[{"U", "=", "UG"}], ";", " ", 
            RowBox[{"V", "=", "VG"}], ";", "   ", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Jmat=\>\"", ",", 
              RowBox[{"MatrixForm", "@", 
               RowBox[{"Jmat", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", "\"\<; L=\>\"", 
              ",", "L", ",", "\"\<; h=(\>\"", ",", " ", 
              RowBox[{"hV", "[", 
               RowBox[{"[", " ", 
                RowBox[{"hp", ",", "1"}], " ", "]"}], "]"}], ",", "\"\<,\>\"",
               ",", 
              RowBox[{"hV", "[", 
               RowBox[{"[", " ", 
                RowBox[{"hp", ",", "2"}], " ", "]"}], "]"}], ",", "\"\<,\>\"",
               ",", 
              RowBox[{"hV", "[", 
               RowBox[{"[", " ", 
                RowBox[{"hp", ",", "3"}], "]"}], "]"}], ",", "\"\<); \>\""}], 
             "]"}], ";", "\n", 
            RowBox[{"kTable", "=", 
             RowBox[{"toMomentumTable", "[", "L", "]"}]}], ";", "\n", 
            "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"(", " ", 
                 RowBox[{"j", "<", 
                  RowBox[{"(", "steps", ")"}]}], ")"}], "\[And]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Chop", "[", " ", 
                   RowBox[{"\[CapitalDelta]1", ",", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "8"}], ")"}]}]}], " ", "]"}], "!=", " ", 
                  "0"}], ")"}]}], " ", ")"}], ",", " ", 
              RowBox[{"j", "++"}], ",", "  ", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", "[", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"j", ",", "200"}], "]"}], "==", "80"}], ")"}], 
                   "\[And]", 
                   RowBox[{"(", " ", 
                    RowBox[{"\[CapitalDelta]1", ">", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], " ", ")"}]}], ",", " ", 
                  RowBox[{
                   RowBox[{"\[Chi]", "=", 
                    RowBox[{"0.6", 
                    RowBox[{"{", 
                    RowBox[{"\[Chi]Gx", ",", "\[Chi]Gy", ",", "\[Chi]Gz"}], 
                    "}"}]}]}], ";", " ", 
                   RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rm", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{".1", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}], ",", 
                    " ", 
                    RowBox[{"\[Omega]", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]GA", "+", 
                    RowBox[{"(", " ", 
                    RowBox[{"rm", "-", 
                    RowBox[{"Transpose", "[", "rm", "]"}]}], ")"}]}], ",", 
                    RowBox[{"\[Omega]GB", "+", 
                    RowBox[{"(", " ", 
                    RowBox[{"rm", "-", 
                    RowBox[{"Transpose", "[", "rm", "]"}]}], ")"}]}]}], 
                    "}"}]}]}], "]"}]}]}], " ", "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"MatrixForm", "/@", 
                  RowBox[{"AMFmom", "[", 
                   RowBox[{"Jmat", ",", "U"}], "]"}]}], "]"}], ";", " ", 
                RowBox[{"Print", "[", 
                 RowBox[{"MatrixForm", "/@", 
                  RowBox[{"BMFmom", "[", 
                   RowBox[{"Jmat", ",", "h", ",", " ", 
                    RowBox[{"\[Eta]", " ", 
                    RowBox[{"\[Lambda]effmom", "[", 
                    RowBox[{"Jmat", ",", "h", ",", "V"}], "]"}]}], ",", "V"}],
                    "]"}]}], " ", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Umatvec", "=", 
                RowBox[{"UmatVec", "[", 
                 RowBox[{
                 "Jmat", ",", "h", ",", "U", ",", "V", ",", " ", "kTable", 
                  ",", "Tk", ",", "\[Eta]"}], "]"}]}], " ", ";", "\n", 
               RowBox[{"u", "=", 
                RowBox[{"Chop", "@", 
                 RowBox[{"Sum", " ", "[", "  ", 
                  RowBox[{
                   RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "k", ",", "\[DoubleStruckCapitalU]", ",", 
                    "\[DoubleStruckCapitalU]less", ",", 
                    "\[DoubleStruckCapitalU]gtr"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"k", "=", 
                    RowBox[{"kTable", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ";", "\n", "\t", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"H0", "=", 
                    RowBox[{"HmfMomentum", "[", 
                    RowBox[{
                    "Jmat", ",", "h", ",", "U", ",", "V", ",", " ", "k", ",", 
                    "\[Eta]"}], "]"}]}], ";", 
                    RowBox[{"Hr", "=", 
                    RowBox[{
                    RowBox[{"Tk", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H0", " ", ".", " ", "Tk"}]}], ";", " ", 
                    RowBox[{"Umat", "=", 
                    RowBox[{"UmatK", "[", "Hr", "]"}]}], ";"}], "*)"}], 
                    RowBox[{"\[DoubleStruckCapitalU]", "=", 
                    RowBox[{"Tk", " ", ".", " ", 
                    RowBox[{"Umatvec", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}]}], ";", 
                    RowBox[{"\[DoubleStruckCapitalU]less", "=", 
                    RowBox[{"\[DoubleStruckCapitalU]", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], ";", " ", 
                    RowBox[{"\[DoubleStruckCapitalU]gtr", "=", 
                    RowBox[{"\[DoubleStruckCapitalU]", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", "\n", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", "/", "Nc"}], ")"}], 
                    RowBox[{"Conjugate", "@", 
                    RowBox[{"Chop", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Conjugate]"], " ", ".", " ", 
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Transpose]"]}], " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"k", " ", ".", " ", "nx"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[DoubleStruckCapitalU]less", " ", ".", " ", 
                    RowBox[{
                    "\[DoubleStruckCapitalU]less", 
                    "\[ConjugateTranspose]"}]}], " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"k", " ", ".", " ", "nx"}]}], "]"}]}]}], ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Conjugate]"], " ", ".", " ", 
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Transpose]"]}], " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"k", " ", ".", " ", "ny"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[DoubleStruckCapitalU]less", " ", ".", " ", 
                    RowBox[{
                    "\[DoubleStruckCapitalU]less", 
                    "\[ConjugateTranspose]"}]}], " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"k", " ", ".", " ", "ny"}]}], "]"}]}]}], ",", " ", 
                    RowBox[{
                    RowBox[{
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Conjugate]"], " ", ".", " ", 
                    
                    SuperscriptBox["\[DoubleStruckCapitalU]gtr", 
                    "\[Transpose]"]}], "+", " ", 
                    RowBox[{"\[DoubleStruckCapitalU]less", " ", ".", " ", 
                    RowBox[{
                    "\[DoubleStruckCapitalU]less", 
                    "\[ConjugateTranspose]"}]}]}]}], "}"}]}]}]}]}]}], " ", 
                    "\n", "\t", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"uu", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "Nc"}], ")"}], " ", "I", " ", 
                    RowBox[{"TUh", " ", ".", " ", 
                    RowBox[{"TUh", "\[ConjugateTranspose]"}]}]}]}], " ", ";", 
                    " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"uu", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"uu", "-", 
                    RowBox[{"ConjugateTranspose", "[", "uu", "]"}]}], ")"}], 
                    "/", "2"}]}], ";"}], " ", "*)"}], " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"uu", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", 
                    RowBox[{"k", " ", ".", " ", "nx"}]}], "]"}]}], ",", 
                    RowBox[{"uu", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", 
                    RowBox[{"k", " ", ".", " ", "ny"}]}], "]"}]}], ",", 
                    "uu"}], " ", "}"}]}], "*)"}], "  ", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", "Nc"}], "}"}]}], " ", 
                  "]"}]}]}], ";", " ", "\n", 
               RowBox[{
                RowBox[{"U", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"1", ";;", "4"}], ",", 
                   RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], " ", ";", 
               RowBox[{
                RowBox[{"U", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"1", ";;", "4"}], ",", 
                   RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], ";", 
               RowBox[{
                RowBox[{"U", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"1", ";;", "4"}], ",", 
                   RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], ";", 
               RowBox[{
                RowBox[{"V", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"1", ";;", "4"}], ",", 
                   RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", 
               RowBox[{
                RowBox[{"V", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"5", ";;", "8"}], ",", 
                   RowBox[{"5", ";;", "8"}]}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                  RowBox[{"U", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"Table", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4"}], ",", "\[Alpha]"}], "]"}], 
                    "]"}], ",", "  ", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
                   "]"}]}], ";", 
                 RowBox[{
                  RowBox[{"U", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"Table", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4"}], ",", "\[Alpha]"}], "]"}], 
                    "]"}], ",", "        ", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
                   "]"}]}], ";", 
                 RowBox[{
                  RowBox[{"U", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", 
                  RowBox[{"Table", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4"}], ",", "\[Alpha]"}], "]"}], 
                    "]"}], ",", "  ", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
                   "]"}]}], ";", "\n", 
                 RowBox[{
                  RowBox[{"V", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"Table", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Beta]", ",", "\[Alpha]"}], "]"}], "]"}], 
                    "       ", ",", "  ", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
                   "]"}]}], ";", 
                 RowBox[{
                  RowBox[{"V", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"Table", "[", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4"}], ",", 
                    RowBox[{"\[Alpha]", "+", "4"}]}], "]"}], "]"}], " ", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
                   "]"}]}], ";"}], "*)"}], "\n", "\[IndentingNewLine]", 
               RowBox[{"\[CapitalDelta]V", "=", 
                RowBox[{
                 RowBox[{"1", "/", "12"}], " ", 
                 RowBox[{"Total", "@", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"Abs", "@", 
                    RowBox[{"traceG", "[", 
                    RowBox[{"V", "[", 
                    RowBox[{"[", "\[Sigma]", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], 
                   "]"}]}]}]}], ";", " ", 
               RowBox[{"\[CapitalDelta]Vseq", "=", 
                RowBox[{"{", 
                 RowBox[{"\[CapitalDelta]Vseq", ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "\[CapitalDelta]V"}], "}"}]}], "}"}]}], 
               " ", ";", "   ", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"j", ">=", "2"}], ",", 
                 RowBox[{
                  RowBox[{"\[CapitalDelta]2", "=", "\[CapitalDelta]1"}], ";", 
                  " ", 
                  RowBox[{"\[CapitalDelta]1", "=", 
                   RowBox[{"Max", "[", " ", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"(", 
                    RowBox[{"u", "-", "u2"}], ")"}]}], " ", "]"}]}], ";", 
                  RowBox[{"\[CapitalDelta]seq", "=", 
                   RowBox[{"{", 
                    RowBox[{"\[CapitalDelta]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]1"}], "}"}]}], "}"}]}], 
                  "  ", ";"}]}], "   ", "]"}], ";", " ", 
               RowBox[{"u2", "=", "u"}], ";", "  ", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"j", "\[LessEqual]", "3"}], "\[Or]", 
                   RowBox[{"j", "\[GreaterEqual]", 
                    RowBox[{"steps", "-", "2"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<j=\>\"", ",", "j", ",", "\"\<; \[CapitalDelta]=\>\"",
                     ",", "\[CapitalDelta]1", ",", 
                    "\"\<; \[CapitalDelta]\[Omega]=\>\"", ",", 
                    "\[CapitalDelta]\[Omega]", ",", " ", "\"\<;  \>\"", ",", 
                    RowBox[{"MatrixForm", "/@", 
                    RowBox[{"{", "  ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "}"}]}]}], "]"}], 
                   ";"}]}], "  ", "]"}], " ", "*)"}], 
               "                             ", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<j=\>\"", ",", "j", ",", "\"\<; \[CapitalDelta]V=\>\"", 
                 ",", "\[CapitalDelta]V", ",", "\"\<; \[CapitalDelta]=\>\"", 
                 ",", "\[CapitalDelta]1"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", " ", 
                RowBox[{"MatrixForm", "/@", 
                 RowBox[{"Chop", "[", 
                  RowBox[{"u", ",", ".002"}], "]"}]}], " ", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", " ", 
                RowBox[{"MatrixForm", "/@", 
                 RowBox[{"Chop", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"U", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"V", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], " ", 
                "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", ">=", "1"}], ",", "  ", 
                RowBox[{"Abort", "[", "]"}]}], "  ", "]"}], "*)"}], 
             "\[IndentingNewLine]", "                             ", "]"}], 
            ";", "\n", 
            RowBox[{"t1", "=", 
             RowBox[{"AbsoluteTime", "[", "]"}]}], ";", " ", 
            RowBox[{"\[CapitalDelta]t", "=", 
             RowBox[{"UnitConvert", "[", " ", 
              RowBox[{
               RowBox[{"Quantity", "[", 
                RowBox[{
                 RowBox[{"t1", " ", "-", "t0"}], ",", " ", 
                 "\"\<Seconds\>\""}], " ", "]"}], ",", " ", 
               "\"\<Minutes\>\""}], " ", "]"}]}], ";", " ", 
            RowBox[{"t0", "=", "t1"}], ";", "\n", 
            RowBox[{"\[CapitalDelta]seq", "=", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "\[CapitalDelta]seq", "]"}], ",", 
               "2"}], "]"}]}], ";", " ", 
            RowBox[{"\[CapitalDelta]Vseq", "=", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "\[CapitalDelta]Vseq", "]"}], ",", 
               "2"}], "]"}]}], ";", "\n", "\t", 
            RowBox[{"EMF", "    ", "=", " ", 
             RowBox[{"enMFmom", "[", 
              RowBox[{"Jmat", ",", "U", ",", "V", ",", "h"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Esum", " ", "=", 
             RowBox[{"enSUMmom", "[", 
              RowBox[{"Jmat", ",", "U", ",", "V", ",", "h", ",", "L"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"cMF", "   ", "=", 
             RowBox[{"cMFmom", "[", 
              RowBox[{"Jmat", ",", "U", ",", "V"}], "]"}]}], ";", "\n", "\t", 
            RowBox[{"dataToFile800", "[", 
             RowBox[{
              RowBox[{"parametersMat", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
              "acuracy", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "L", ",", "U", ",", "V", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "EMF", "}"}], ",", 
                  RowBox[{"{", "Esum", "}"}], ",", 
                  RowBox[{"{", "cMF", "}"}], ",", "\[CapitalDelta]seq", ",", 
                  "\[CapitalDelta]Vseq"}], "}"}]}], "}"}], ",", 
              "\"\<free\>\"", ",", "NbName"}], "]"}], ";", " ", "\n", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Max Step = \>\"", ",", " ", "j", ",", "\"\<; Delta=\>\"", 
              ",", 
              RowBox[{"round", "@", "\[CapitalDelta]1"}], ",", 
              RowBox[{"(*", 
               RowBox[{",", "\"\<; \[CapitalDelta]t = \>\"", ",", 
                RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}], ",", 
                RowBox[{"IntegerPart", "@", 
                 RowBox[{"UnitConvert", "[", 
                  RowBox[{
                   RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], 
                   ",", " ", "\"\<Seconds\>\""}], " ", "]"}]}]}], "*)"}], 
              "\"\<; E=\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"EMF", ",", "Esum", ",", "cMF"}], "}"}], ",", 
              "\[IndentingNewLine]", "\"\<;  p=\>\"", ",", "p", ",", 
              "\"\</\>\"", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"parametersMat", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "jG", ",", "LG", ",", "\[Chi]G", ",", "\[Omega]G", ",", 
               "\[Xi]G", ",", "EnG"}], "}"}], "=", " ", 
             RowBox[{"loadData", "[", 
              RowBox[{"toPath800", "[", 
               RowBox[{
                RowBox[{"parametersMat", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                "acuracy", ",", "\"\<free\>\"", ",", "NbName"}], " ", "]"}], 
              "  ", "]"}]}], ";"}]}], "\n", " ", "]"}], ";"}], "  ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", " ", 
        RowBox[{"{", 
         RowBox[{"p", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"parametersMat", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "  ", "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", 
        RowBox[{"Length", "@", "Ls"}]}], "}"}]}], "]"}], ";", 
    "              ", 
    RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9033652043689866`*^9, 3.9033652216473317`*^9}, {
   3.9033654072771564`*^9, 3.9033660290437393`*^9}, {3.903366071912367*^9, 
   3.9033661239087114`*^9}, {3.903366210488823*^9, 3.9033662146087675`*^9}, 
   3.903366268742918*^9, {3.903366314103799*^9, 3.9033663766984763`*^9}, {
   3.9033664268790736`*^9, 3.903366429572959*^9}, {3.903366485062214*^9, 
   3.903366549070778*^9}, {3.903366603118486*^9, 3.903366625079398*^9}, {
   3.9033666754818797`*^9, 3.9033666845918045`*^9}, 3.9033667795087924`*^9, {
   3.9033668497452526`*^9, 3.9033668946315117`*^9}, {3.903366934682482*^9, 
   3.9033669360780187`*^9}, {3.9033670556688333`*^9, 
   3.9033671178586655`*^9}, {3.903367163086542*^9, 3.903367177595671*^9}, {
   3.9033672660719776`*^9, 3.9033672843156443`*^9}, {3.903367325234885*^9, 
   3.9033673581501217`*^9}, {3.903367487246004*^9, 3.903367519447819*^9}, {
   3.903367556187047*^9, 3.9033675572679496`*^9}, 3.9033675893092318`*^9, {
   3.90336768974885*^9, 3.90336773196281*^9}, {3.9033677629660172`*^9, 
   3.9033677675081615`*^9}, {3.90336781001264*^9, 3.9033678553052716`*^9}, {
   3.9033678905145736`*^9, 3.9033679580651407`*^9}, {3.903368133142744*^9, 
   3.903368133343282*^9}, {3.90341839356828*^9, 3.903418413635346*^9}, {
   3.903418806581052*^9, 3.9034188316473722`*^9}, {3.90341887520944*^9, 
   3.9034189274989276`*^9}, {3.9034189577397847`*^9, 
   3.9034189682667575`*^9}, {3.903419404210492*^9, 3.903419446870926*^9}, {
   3.9034194955188665`*^9, 3.9034195243830605`*^9}, 3.9034195993093877`*^9, {
   3.903419724478938*^9, 3.9034197513663263`*^9}, 3.903419998335585*^9, {
   3.903420033674863*^9, 3.9034201279066815`*^9}, {3.9034201651465263`*^9, 
   3.9034201749767523`*^9}, {3.9034202535821514`*^9, 3.903420262007784*^9}, {
   3.9034203415683155`*^9, 3.9034203489944525`*^9}, {3.9034207622349977`*^9, 
   3.9034207641687527`*^9}, {3.9034210233046007`*^9, 3.903421025703529*^9}, {
   3.903421091547433*^9, 3.903421093190897*^9}, {3.9034220787720027`*^9, 
   3.903422080345462*^9}, 3.9034221333704805`*^9, {3.9034222897801685`*^9, 
   3.903422292075113*^9}, {3.9034223848203473`*^9, 3.903422393485564*^9}, {
   3.9034232833994627`*^9, 3.9034233136190453`*^9}, {3.9034233918053527`*^9, 
   3.9034233953577795`*^9}, {3.9034235165029736`*^9, 3.903423567643548*^9}, 
   3.903423739748234*^9, {3.903423814876255*^9, 3.9034238186103272`*^9}, {
   3.903424388703539*^9, 3.903424390590928*^9}, {3.9034244507363706`*^9, 
   3.9034244520394936`*^9}, {3.9034245782975774`*^9, 
   3.9034246431560936`*^9}, {3.9034246792707977`*^9, 
   3.9034246946129265`*^9}, {3.903426414592014*^9, 3.903426441344535*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"7c53b24b-97ed-42f4-b1f3-ad91c9967140"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Jmat=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0.`", "0"},
       {"0.`", "0", "0"},
       {"0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\"; L=\"\>", 
   "\[InvisibleSpace]", "19", "\[InvisibleSpace]", "\<\"; h=(\"\>", 
   "\[InvisibleSpace]", "0.`", "\[InvisibleSpace]", "\<\",\"\>", 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", "\<\",\"\>", 
   "\[InvisibleSpace]", "0", "\[InvisibleSpace]", "\<\"); \"\>"}],
  SequenceForm["Jmat=", 
   MatrixForm[{{0, 0., 0}, {0., 0, 0}, {0, 0, -1}}], "; L=", 19, "; h=(", 0., 
   ",", 0, ",", 0, "); "],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9034202732235494`*^9, 3.9034203495803905`*^9, 3.903420683579562*^9, 
   3.9034207649266853`*^9, 3.9034208175613923`*^9, 3.903420848714819*^9, 
   3.903420885126033*^9, 3.903421026185999*^9, 3.90342109370866*^9, 
   3.9034212558584433`*^9, {3.903421445714838*^9, 3.903421466723831*^9}, 
   3.90342187393987*^9, 3.903422042829648*^9, 3.9034220815841436`*^9, {
   3.903422272517479*^9, 3.903422293265299*^9}, {3.9034223859351997`*^9, 
   3.9034224108090096`*^9}, 3.9034229531976776`*^9, {3.90342330334286*^9, 
   3.9034233141183558`*^9}, 3.9034233964630504`*^9, {3.9034235527707157`*^9, 
   3.903423568266883*^9}, 3.903423749302659*^9, {3.9034243684207726`*^9, 
   3.903424390870247*^9}, {3.903424427666894*^9, 3.903424452578229*^9}, 
   3.9034244952313366`*^9, {3.9034245298011456`*^9, 3.9034245398305607`*^9}, 
   3.9034246155829844`*^9, 3.9034246468165956`*^9, 3.903426526092123*^9, 
   3.9034266722896633`*^9, 3.90342670404867*^9, 3.903426764994146*^9, 
   3.9034268023096704`*^9},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"b30454b8-5dc9-4735-8d9f-deaa144b4fb0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "8.494348370260314`*^-8", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm[
  "j=", 1, "; \[CapitalDelta]V=", 8.494348370260314*^-8, "; \[CapitalDelta]=",
    1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9034202732235494`*^9, 3.9034203495803905`*^9, 3.903420683579562*^9, 
   3.9034207649266853`*^9, 3.9034208175613923`*^9, 3.903420848714819*^9, 
   3.903420885126033*^9, 3.903421026185999*^9, 3.90342109370866*^9, 
   3.9034212558584433`*^9, {3.903421445714838*^9, 3.903421466723831*^9}, 
   3.90342187393987*^9, 3.903422042829648*^9, 3.9034220815841436`*^9, {
   3.903422272517479*^9, 3.903422293265299*^9}, {3.9034223859351997`*^9, 
   3.9034224108090096`*^9}, 3.9034229531976776`*^9, {3.90342330334286*^9, 
   3.9034233141183558`*^9}, 3.9034233964630504`*^9, {3.9034235527707157`*^9, 
   3.903423568266883*^9}, 3.903423749302659*^9, {3.9034243684207726`*^9, 
   3.903424390870247*^9}, {3.903424427666894*^9, 3.903424452578229*^9}, 
   3.9034244952313366`*^9, {3.9034245298011456`*^9, 3.9034245398305607`*^9}, 
   3.9034246155829844`*^9, 3.9034246468165956`*^9, 3.903426526092123*^9, 
   3.9034266722896633`*^9, 3.90342670404867*^9, 3.903426764994146*^9, 
   3.9034268029102077`*^9},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"397d7192-d9f7-455f-8af0-674ac6c73cb8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "3.324192395169578`*^-8", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>", "\[InvisibleSpace]", 
   "2.898939513262248`*^-7"}],
  SequenceForm[
  "j=", 2, "; \[CapitalDelta]V=", 3.324192395169578*^-8, "; \[CapitalDelta]=",
    2.898939513262248*^-7],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9034202732235494`*^9, 3.9034203495803905`*^9, 3.903420683579562*^9, 
   3.9034207649266853`*^9, 3.9034208175613923`*^9, 3.903420848714819*^9, 
   3.903420885126033*^9, 3.903421026185999*^9, 3.90342109370866*^9, 
   3.9034212558584433`*^9, {3.903421445714838*^9, 3.903421466723831*^9}, 
   3.90342187393987*^9, 3.903422042829648*^9, 3.9034220815841436`*^9, {
   3.903422272517479*^9, 3.903422293265299*^9}, {3.9034223859351997`*^9, 
   3.9034224108090096`*^9}, 3.9034229531976776`*^9, {3.90342330334286*^9, 
   3.9034233141183558`*^9}, 3.9034233964630504`*^9, {3.9034235527707157`*^9, 
   3.903423568266883*^9}, 3.903423749302659*^9, {3.9034243684207726`*^9, 
   3.903424390870247*^9}, {3.903424427666894*^9, 3.903424452578229*^9}, 
   3.9034244952313366`*^9, {3.9034245298011456`*^9, 3.9034245398305607`*^9}, 
   3.9034246155829844`*^9, 3.9034246468165956`*^9, 3.903426526092123*^9, 
   3.9034266722896633`*^9, 3.90342670404867*^9, 3.903426764994146*^9, 
   3.9034268035027885`*^9},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"c1f8859c-0a01-450a-b068-a52723e0b148"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "1.3008828320237019`*^-8", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>", "\[InvisibleSpace]", 
   "1.1344683187321891`*^-7"}],
  SequenceForm[
  "j=", 3, "; \[CapitalDelta]V=", 1.3008828320237019`*^-8, 
   "; \[CapitalDelta]=", 1.1344683187321891`*^-7],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9034202732235494`*^9, 3.9034203495803905`*^9, 3.903420683579562*^9, 
   3.9034207649266853`*^9, 3.9034208175613923`*^9, 3.903420848714819*^9, 
   3.903420885126033*^9, 3.903421026185999*^9, 3.90342109370866*^9, 
   3.9034212558584433`*^9, {3.903421445714838*^9, 3.903421466723831*^9}, 
   3.90342187393987*^9, 3.903422042829648*^9, 3.9034220815841436`*^9, {
   3.903422272517479*^9, 3.903422293265299*^9}, {3.9034223859351997`*^9, 
   3.9034224108090096`*^9}, 3.9034229531976776`*^9, {3.90342330334286*^9, 
   3.9034233141183558`*^9}, 3.9034233964630504`*^9, {3.9034235527707157`*^9, 
   3.903423568266883*^9}, 3.903423749302659*^9, {3.9034243684207726`*^9, 
   3.903424390870247*^9}, {3.903424427666894*^9, 3.903424452578229*^9}, 
   3.9034244952313366`*^9, {3.9034245298011456`*^9, 3.9034245398305607`*^9}, 
   3.9034246155829844`*^9, 3.9034246468165956`*^9, 3.903426526092123*^9, 
   3.9034266722896633`*^9, 3.90342670404867*^9, 3.903426764994146*^9, 
   3.903426804170308*^9},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"ac11b2a2-7f4f-4c0c-9dac-691514b25f3e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "5.090848966516114`*^-9", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>", "\[InvisibleSpace]", 
   "4.4396057333861336`*^-8"}],
  SequenceForm[
  "j=", 4, "; \[CapitalDelta]V=", 5.090848966516114*^-9, "; \[CapitalDelta]=",
    4.4396057333861336`*^-8],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9034202732235494`*^9, 3.9034203495803905`*^9, 3.903420683579562*^9, 
   3.9034207649266853`*^9, 3.9034208175613923`*^9, 3.903420848714819*^9, 
   3.903420885126033*^9, 3.903421026185999*^9, 3.90342109370866*^9, 
   3.9034212558584433`*^9, {3.903421445714838*^9, 3.903421466723831*^9}, 
   3.90342187393987*^9, 3.903422042829648*^9, 3.9034220815841436`*^9, {
   3.903422272517479*^9, 3.903422293265299*^9}, {3.9034223859351997`*^9, 
   3.9034224108090096`*^9}, 3.9034229531976776`*^9, {3.90342330334286*^9, 
   3.9034233141183558`*^9}, 3.9034233964630504`*^9, {3.9034235527707157`*^9, 
   3.903423568266883*^9}, 3.903423749302659*^9, {3.9034243684207726`*^9, 
   3.903424390870247*^9}, {3.903424427666894*^9, 3.903424452578229*^9}, 
   3.9034244952313366`*^9, {3.9034245298011456`*^9, 3.9034245398305607`*^9}, 
   3.9034246155829844`*^9, 3.9034246468165956`*^9, 3.903426526092123*^9, 
   3.9034266722896633`*^9, 3.90342670404867*^9, 3.903426764994146*^9, 
   3.903426804762822*^9},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"d262f394-2d79-4ea3-a4fc-006668f2c58a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "1.9922427107680405`*^-9", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>", "\[InvisibleSpace]", 
   "1.737386473698678`*^-8"}],
  SequenceForm[
  "j=", 5, "; \[CapitalDelta]V=", 1.9922427107680405`*^-9, 
   "; \[CapitalDelta]=", 1.737386473698678*^-8],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9034202732235494`*^9, 3.9034203495803905`*^9, 3.903420683579562*^9, 
   3.9034207649266853`*^9, 3.9034208175613923`*^9, 3.903420848714819*^9, 
   3.903420885126033*^9, 3.903421026185999*^9, 3.90342109370866*^9, 
   3.9034212558584433`*^9, {3.903421445714838*^9, 3.903421466723831*^9}, 
   3.90342187393987*^9, 3.903422042829648*^9, 3.9034220815841436`*^9, {
   3.903422272517479*^9, 3.903422293265299*^9}, {3.9034223859351997`*^9, 
   3.9034224108090096`*^9}, 3.9034229531976776`*^9, {3.90342330334286*^9, 
   3.9034233141183558`*^9}, 3.9034233964630504`*^9, {3.9034235527707157`*^9, 
   3.903423568266883*^9}, 3.903423749302659*^9, {3.9034243684207726`*^9, 
   3.903424390870247*^9}, {3.903424427666894*^9, 3.903424452578229*^9}, 
   3.9034244952313366`*^9, {3.9034245298011456`*^9, 3.9034245398305607`*^9}, 
   3.9034246155829844`*^9, 3.9034246468165956`*^9, 3.903426526092123*^9, 
   3.9034266722896633`*^9, 3.90342670404867*^9, 3.903426764994146*^9, 
   3.9034268053858356`*^9},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"183590f1-13d2-47a2-8c3f-9dd57527ed1c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]V=\"\>", "\[InvisibleSpace]", 
   "7.796402928442108`*^-10", 
   "\[InvisibleSpace]", "\<\"; \[CapitalDelta]=\"\>", "\[InvisibleSpace]", 
   "6.799053712908901`*^-9"}],
  SequenceForm[
  "j=", 6, "; \[CapitalDelta]V=", 7.796402928442108*^-10, 
   "; \[CapitalDelta]=", 6.799053712908901*^-9],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9034202732235494`*^9, 3.9034203495803905`*^9, 3.903420683579562*^9, 
   3.9034207649266853`*^9, 3.9034208175613923`*^9, 3.903420848714819*^9, 
   3.903420885126033*^9, 3.903421026185999*^9, 3.90342109370866*^9, 
   3.9034212558584433`*^9, {3.903421445714838*^9, 3.903421466723831*^9}, 
   3.90342187393987*^9, 3.903422042829648*^9, 3.9034220815841436`*^9, {
   3.903422272517479*^9, 3.903422293265299*^9}, {3.9034223859351997`*^9, 
   3.9034224108090096`*^9}, 3.9034229531976776`*^9, {3.90342330334286*^9, 
   3.9034233141183558`*^9}, 3.9034233964630504`*^9, {3.9034235527707157`*^9, 
   3.903423568266883*^9}, 3.903423749302659*^9, {3.9034243684207726`*^9, 
   3.903424390870247*^9}, {3.903424427666894*^9, 3.903424452578229*^9}, 
   3.9034244952313366`*^9, {3.9034245298011456`*^9, 3.9034245398305607`*^9}, 
   3.9034246155829844`*^9, 3.9034246468165956`*^9, 3.903426526092123*^9, 
   3.9034266722896633`*^9, 3.90342670404867*^9, 3.903426764994146*^9, 
   3.903426806014311*^9},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"bef0bdc4-bc6a-417c-bad0-890e28f693a0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Max Step = \"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"; Delta=\"\>", "\[InvisibleSpace]", "0.`", 
   "\[InvisibleSpace]", "\<\"; E=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7873480944170127`"}], ",", 
     RowBox[{"-", "0.7873480944170154`"}], ",", 
     RowBox[{"-", "0.7873480944170127`"}]}], "}"}], 
   "\[InvisibleSpace]", "\<\";  p=\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"/\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm[
  "Max Step = ", 7, "; Delta=", 0., 
   "; E=", {-0.7873480944170127, -0.7873480944170154, -0.7873480944170127}, 
   ";  p=", 1, "/", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9034202732235494`*^9, 3.9034203495803905`*^9, 3.903420683579562*^9, 
   3.9034207649266853`*^9, 3.9034208175613923`*^9, 3.903420848714819*^9, 
   3.903420885126033*^9, 3.903421026185999*^9, 3.90342109370866*^9, 
   3.9034212558584433`*^9, {3.903421445714838*^9, 3.903421466723831*^9}, 
   3.90342187393987*^9, 3.903422042829648*^9, 3.9034220815841436`*^9, {
   3.903422272517479*^9, 3.903422293265299*^9}, {3.9034223859351997`*^9, 
   3.9034224108090096`*^9}, 3.9034229531976776`*^9, {3.90342330334286*^9, 
   3.9034233141183558`*^9}, 3.9034233964630504`*^9, {3.9034235527707157`*^9, 
   3.903423568266883*^9}, 3.903423749302659*^9, {3.9034243684207726`*^9, 
   3.903424390870247*^9}, {3.903424427666894*^9, 3.903424452578229*^9}, 
   3.9034244952313366`*^9, {3.9034245298011456`*^9, 3.9034245398305607`*^9}, 
   3.9034246155829844`*^9, 3.9034246468165956`*^9, 3.903426526092123*^9, 
   3.9034266722896633`*^9, 3.90342670404867*^9, 3.903426764994146*^9, 
   3.9034268064523325`*^9},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"89302171-1c89-41c0-9a59-ef451f3a08d3"],

Cell[BoxData["\<\" \"\>"], "Print",
 CellChangeTimes->{
  3.9034202732235494`*^9, 3.9034203495803905`*^9, 3.903420683579562*^9, 
   3.9034207649266853`*^9, 3.9034208175613923`*^9, 3.903420848714819*^9, 
   3.903420885126033*^9, 3.903421026185999*^9, 3.90342109370866*^9, 
   3.9034212558584433`*^9, {3.903421445714838*^9, 3.903421466723831*^9}, 
   3.90342187393987*^9, 3.903422042829648*^9, 3.9034220815841436`*^9, {
   3.903422272517479*^9, 3.903422293265299*^9}, {3.9034223859351997`*^9, 
   3.9034224108090096`*^9}, 3.9034229531976776`*^9, {3.90342330334286*^9, 
   3.9034233141183558`*^9}, 3.9034233964630504`*^9, {3.9034235527707157`*^9, 
   3.903423568266883*^9}, 3.903423749302659*^9, {3.9034243684207726`*^9, 
   3.903424390870247*^9}, {3.903424427666894*^9, 3.903424452578229*^9}, 
   3.9034244952313366`*^9, {3.9034245298011456`*^9, 3.9034245398305607`*^9}, 
   3.9034246155829844`*^9, 3.9034246468165956`*^9, 3.903426526092123*^9, 
   3.9034266722896633`*^9, 3.90342670404867*^9, 3.903426764994146*^9, 
   3.903426806483139*^9},
 CellLabel->
  "During evaluation of \
In[185]:=",ExpressionUUID->"d943d81e-25a7-4f92-a72d-e5c4392bbdef"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.903420423798297*^9, 
  3.903420425645831*^9}},ExpressionUUID->"0d3574bf-bb61-49e5-a638-\
e8ee9f3c9bfd"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.9029444378874626`*^9, 
  3.903420181474369*^9},ExpressionUUID->"680aeb83-633c-4391-97cc-\
8f5744c616e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["vortex free + gradually increase  electric field", "Subsubsection",
 FontWeight->Bold,ExpressionUUID->"40080617-38e9-4a1e-9c8d-1625a3134e05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[CapitalDelta]t", "}"}], ",", " ", 
    RowBox[{
     RowBox[{"t0v", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]t", "=", " ", 
      RowBox[{"UnitConvert", "[", " ", 
       RowBox[{
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"t0v", "-", "tvf"}], "]"}], ",", " ", "\"\<Seconds\>\""}], 
         " ", "]"}], ",", " ", "\"\<Minutes\>\""}], " ", "]"}]}], ";", "   ", 
     "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Free loop timing= \>\"", ",", " ", 
       RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}], ",", 
       RowBox[{"IntegerPart", "@", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", " ", 
          "\"\<Seconds\>\""}], " ", "]"}]}]}], "    ", "]"}], ";", 
     RowBox[{"t0", "=", "t0v"}], ";", "\n", 
     RowBox[{
      RowBox[{"Print", "[", "\"\< \>\"", "]"}], " ", 
      RowBox[{"Print", "[", "\"\< \>\"", "]"}]}], ";"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<    Starting vortex free + electric field loop: \>\"", 
   "]"}], ";", 
  RowBox[{"Print", "[", "\"\< \>\"", "]"}]}]}], "Input",ExpressionUUID->\
"ba2d58c4-5a69-4a6a-97fc-44415c31ec86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"L", "=", 
          RowBox[{"Ls", "[", 
           RowBox[{"[", "l", "]"}], "]"}]}], ",", "Nc", ",", "h", ",", "En", 
         ",", 
         RowBox[{"EnList", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", "EMF", ",", "Esum", ",", 
         "Econst", ",", "u0", ",", "u1", ",", "u2", ",", "U", ",", "\[Xi]", 
         ",", "V", ",", "j", ",", 
         RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
         RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", "ES", ",", "gap", ",", 
         "\[CapitalDelta]t", ",", "\[CapitalDelta]tHours", ",", 
         "\[CapitalDelta]tMin", ",", "\[CapitalDelta]tSec", ",", "kTable", 
         ",", "\[CapitalDelta]V", ",", 
         RowBox[{"\[CapitalDelta]Vseq", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\[CapitalDelta]seq", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\[Eta]", "=", "1"}], ",", "p", ",", "Jmat", ",", "JmatMod", 
         ",", "hv", ",", 
         RowBox[{"gauge", "=", "\"\<g0\>\""}], ",", "Jarray", ",", "T"}], 
        "}"}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "hV", "]"}], 
           RowBox[{"(", 
            RowBox[{"pt", "-", "1"}], ")"}]}], "+", "ph"}]}], ";", 
        "         ", 
        RowBox[{"Nc", "=", 
         RowBox[{"L", "^", "2"}]}], ";", " ", 
        RowBox[{"T", "=", 
         RowBox[{"Tmat", "[", 
          RowBox[{"L", ",", "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Jmat", ",", "h"}], "}"}], "=", 
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"JmatMod", ",", "hv"}], "}"}], "=", 
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Jmat[z] \>\"", ",", 
          RowBox[{"MatrixForm", "[", " ", 
           RowBox[{"Jmat", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", "]"}], ",", "\"\<; L=\>\"", 
          ",", "L", ",", "\"\<; h=(\>\"", ",", " ", 
          RowBox[{"hV", "[", 
           RowBox[{"[", " ", 
            RowBox[{"ph", ",", "1"}], " ", "]"}], "]"}], ",", "\"\<,\>\"", 
          ",", 
          RowBox[{"hV", "[", 
           RowBox[{"[", " ", 
            RowBox[{"ph", ",", "2"}], " ", "]"}], "]"}], ",", "\"\<,\>\"", 
          ",", 
          RowBox[{"hV", "[", 
           RowBox[{"[", " ", 
            RowBox[{"ph", ",", "3"}], "]"}], "]"}], ",", "\"\<); \>\""}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"u0", "=", 
         RowBox[{"uniformU", "[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "L"}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"<", 
          RowBox[{
           RowBox[{"-", "  ", "the"}], " ", "2", "nd", " ", 
           RowBox[{"difference", " ", ":", " ", "gauge4v"}]}]}], " ", "*)"}], 
        " \t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "jG", ",", "LG", ",", "UG", ",", "VG", ",", "\[Xi]G", ",", 
             "EnG"}], "}"}], "=", " ", 
           RowBox[{"loadData", "[", 
            RowBox[{"toPath", "[", 
             RowBox[{
              RowBox[{"parameters", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
              "acuracy", ",", "\"\<free\>\"", ",", "NbName"}], " ", "]"}], 
            "  ", "]"}]}], ";"}], "*)"}], " ", "\[IndentingNewLine]", "\t", 
        RowBox[{"V", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"Vguess", ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"U", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"Uguess", ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"Module", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"h0", "=", 
             RowBox[{"Norm", "[", "h", "]"}]}], ",", "\[Kappa]0", ",", 
            "\[Kappa]", ",", 
            RowBox[{"\[Lambda]", "=", 
             RowBox[{"to\[Lambda]", "[", "h", "]"}]}], ",", "\[Chi]0", ",", 
            "Hpure", ",", "Tpure", ",", "Upure", ",", "Epure", ",", "Kv"}], 
           "}"}], ",", "   ", "\n", 
          RowBox[{
           RowBox[{"\[Kappa]0", "=", 
            RowBox[{"toKappa", "[", "h", "]"}]}], ";", " ", "\n", 
           RowBox[{"\[Kappa]", "=", 
            RowBox[{"N", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"10000", " ", "\[Kappa]0"}], "]"}], "/", "10000"}], 
              ")"}]}]}], ";", "   ", "\n", 
           RowBox[{"\[Chi]0", "=", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "  ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"\[Omega]0", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"\[Omega]GA", ",", "2", ",", 
                RowBox[{"{", 
                 RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Kv", "=", 
            RowBox[{"add4VorticesMaxSpaced", "[", " ", 
             RowBox[{
              RowBox[{"uniform", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Jmat", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", "L", ",", "L"}],
                "]"}], ",", 
              RowBox[{
               RowBox[{"JmatMod", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", "L"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Hpure", "=", 
            RowBox[{"Hreal", "[", 
             RowBox[{
             "Kv", ",", "\[Kappa]", ",", "\[Lambda]", ",", "u0", ",", "L", 
              ",", "0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", "   ", 
           "\n", 
           RowBox[{"Tpure", "=", 
            RowBox[{"TmatPure", "[", "L", "]"}]}], ";", "  ", "\n", 
           RowBox[{"Upure", "=", 
            RowBox[{"UmatPure", "[", 
             RowBox[{
              RowBox[{"Tpure", "\[ConjugateTranspose]"}], " ", ".", " ", 
              "Hpure", " ", ".", " ", "Tpure"}], "]"}]}], ";", "\n", 
           RowBox[{"Epure", "=", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"Quiet", "@", 
                 RowBox[{"Eigenvalues", "[", "Hpure", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
             RowBox[{"(", "Nc", ")"}]}]}], ";", "\n", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "=", 
            RowBox[{"toMFparametersPure", "[", 
             RowBox[{"Upure", ",", "u0", ",", "L", ",", "0"}], "]"}]}], ";", 
           "   ", "\n", 
           RowBox[{"dataToFilePure", "[", 
            RowBox[{
             RowBox[{"parameters", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
             "acuracy", ",", "gauge", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "L", ",", "\[Chi]0", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{"{", "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{"{", "}"}]}], "}"}]}], "}"}], ",", 
               RowBox[{"{", "Epure", "}"}]}], " ", "}"}]}], " ", "]"}], ";", 
           " ", "\n", 
           RowBox[{"Print", "[", "\"\<Pure data saved: \>\"", "]"}], ";", 
           "\n", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Kappa=\>\"", ",", "\[Kappa]", ",", "\"\<; Lambda=\>\"", ",", 
             " ", "\[Lambda]", ",", " ", "\"\<; Epure=\>\"", ",", "Epure", 
             ",", "\"\<; \>\""}], "]"}], ";", 
           RowBox[{"Print", "[", "]"}], ";", "\n", 
           RowBox[{"Do", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"U", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "1"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"\[Chi]0", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"U", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "2"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"\[Chi]0", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "r"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"U", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "3"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"\[Chi]0", "[", 
                 RowBox[{"[", 
                  RowBox[{"3", ",", "r"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], " ", ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], "]"}], ";"}]}], 
         "\n", "  ", "]"}], ";", " ", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Jmat", ",", "h"}], "}"}], "=", 
            RowBox[{
             RowBox[{"parameters", "[", 
              RowBox[{"[", 
               RowBox[{"ev", ",", "p"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"JmatMod", ",", "hv"}], "}"}], "=", 
            RowBox[{
             RowBox[{"parameters", "[", 
              RowBox[{"[", 
               RowBox[{"ev", ",", "p"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], ";", " ", 
           RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Jarray", "=", 
            RowBox[{"Jarray4v", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"Jmat", ",", 
                SuperscriptBox["L", "2"]}], "]"}], ",", "JmatMod", ",", "L"}],
              "]"}]}], ";", "\n", "\n", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", " ", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{"j", "<", "steps"}], ")"}], "\[And]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "<", "minSteps"}], ")"}], "\[Or]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Chop", "[", " ", 
                   RowBox[{"\[CapitalDelta]1", ",", " ", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "acuracy"}]}]}], " ", "]"}], "!=", " ", 
                  "0"}], ")"}]}], "    ", ")"}]}], " ", ",", " ", 
             RowBox[{"j", "++"}], ",", "   ", "\n", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", ">=", "2"}], ",", 
                RowBox[{
                 RowBox[{"\[CapitalDelta]2", "=", "\[CapitalDelta]1"}], ";", 
                 " ", 
                 RowBox[{"\[CapitalDelta]1", "=", 
                  RowBox[{"Max", "[", " ", 
                   RowBox[{"Abs", "@", 
                    RowBox[{"(", 
                    RowBox[{"u1", "-", "u2"}], ")"}]}], " ", "]"}]}], ";", 
                 " ", 
                 RowBox[{"\[CapitalDelta]seq", "=", 
                  RowBox[{"{", 
                   RowBox[{"\[CapitalDelta]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]1"}], "}"}]}], "}"}]}], 
                 ";", "  ", 
                 RowBox[{"\[CapitalDelta]V", "=", 
                  RowBox[{
                   RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Nc"}], ")"}]}], " ", 
                   RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"traceG", "[", 
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Sigma]"}], "]"}], "]"}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1", ",", "Nc"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], 
                    "]"}]}]}], ";", " ", 
                 RowBox[{"\[CapitalDelta]Vseq", "=", 
                  RowBox[{"{", 
                   RowBox[{"\[CapitalDelta]Vseq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]V"}], "}"}]}], 
                   "}"}]}]}]}], "    ", "]"}], ";", " ", "\n", "\n", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"H", ",", "u"}], "}"}], ",", "  ", 
                RowBox[{
                 RowBox[{"H", "=", 
                  RowBox[{"Hmf", "[", 
                   RowBox[{
                   "Jarray", ",", "h", ",", "U", ",", "V", ",", "L", ",", 
                    "1"}], "]"}]}], " ", ";", 
                 RowBox[{"u", "=", 
                  RowBox[{"Umat", "[", 
                   RowBox[{
                    RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H", " ", ".", " ", "T"}], "]"}]}], ";", 
                 RowBox[{"u1", "=", 
                  RowBox[{"Re", "@", 
                   RowBox[{"Chop", "@", 
                    RowBox[{"icc", "[", 
                    RowBox[{"u", ",", "L", ",", "T"}], "]"}]}]}]}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"EMF", "=", 
                  RowBox[{"EnMF", "[", " ", 
                   RowBox[{
                   "Jarray", ",", "h", ",", "U", ",", "V", ",", " ", "L", ",",
                     "1"}], "]"}]}], ";", 
                 RowBox[{"Esum", "=", 
                  RowBox[{"eigenvaluesEmf", "[", " ", 
                   RowBox[{
                   "Jarray", ",", "h", ",", "U", ",", "V", ",", " ", "L", ",",
                     "1"}], "]"}]}], ";", 
                 RowBox[{"Econst", "=", 
                  RowBox[{"constantMF", "[", 
                   RowBox[{"Jarray", ",", "U", ",", "V", ",", "L"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"EnList", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "EMF"}], "}"}]}], "}"}]}], ";", "    ", 
                 RowBox[{
                  RowBox[{"EnList", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "Esum"}], "}"}]}], "}"}]}], ";", "    ", 
                 RowBox[{
                  RowBox[{"EnList", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "Econst"}], "}"}]}], "}"}]}], ";", 
                 "   ", "\[IndentingNewLine]", "\n", 
                 RowBox[{"Do", "[", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "m", ",", "n", ",", "\[Alpha]", ",", "\[Beta]", ",", "rz",
                     ",", "rx", ",", "ry", ",", "Io"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"rz", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"R0", "/", "16"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Beta]", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}]}], ")"}], "/", "4"}]}], 
                    "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Alpha]", "=", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}], "-", 
                    RowBox[{"4", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "+", "1"}]}], ";",
                     "\n", "   ", 
                    RowBox[{"n", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"rz", "/", "L"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"m", "=", 
                    RowBox[{"rz", "-", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"rx", "=", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"ry", "=", 
                    RowBox[{"m", "+", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", 
                    "L"}]}]}], ";", 
                    RowBox[{"Io", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], ";", " ", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], ",", "1", ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rx"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "    ", 
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], ",", "2", ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "ry"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "    ", 
                    RowBox[{
                    RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], ",", "3", ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], ",", "1", ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "    ", 
                    RowBox[{
                    RowBox[{"V", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], ",", "2", ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Io", "+", "4"}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], " ", "]"}], 
                    "]"}]}], ";"}]}], "    ", "]"}], ";"}], " ", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"R0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"16", "Nc"}], "-", "1"}]}], "}"}]}], "  ", "]"}], 
                 ";"}]}], "    ", "]"}], ";", " ", "\[IndentingNewLine]", 
              "\n", 
              RowBox[{"u2", "=", "u1"}], ";", 
              "                                                 ", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\< j =\>\"", ",", "j", ",", " ", "\"\</\>\"", ",", "steps", 
                ",", " ", "\"\<; Delta=\>\"", ",", 
                RowBox[{"round", "@", "\[CapitalDelta]1"}], ",", " ", 
                "\"\<;  E=\>\"", ",", " ", 
                RowBox[{"round", "/@", 
                 RowBox[{"{", 
                  RowBox[{"EMF", ",", "Esum", ",", "Econst"}], "}"}]}], ",", 
                "\"\<; \>\""}], "  ", "]"}], ";"}]}], "     ", "\n", "]"}], 
           ";", "  ", "\n", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"H", ",", "u"}], "}"}], ",", " ", 
             RowBox[{
              RowBox[{"H", "=", 
               RowBox[{"Hmf", "[", 
                RowBox[{
                "Jarray", ",", "h", ",", "U", ",", "V", ",", "L", ",", "1"}], 
                "]"}]}], ";", " ", 
              RowBox[{"u", "=", 
               RowBox[{"Umat", "[", 
                RowBox[{
                 RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", "H", 
                 " ", ".", " ", "T"}], "]"}]}], ";", " ", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"U", ",", "V", ",", "\[Xi]", ",", "u1"}], "}"}], "=", 
               RowBox[{"BiParallel", "[", 
                RowBox[{"u", ",", "L", ",", "T"}], "]"}]}], ";"}]}], "   ", 
            "]"}], ";", "  \t", "\[IndentingNewLine]", 
           RowBox[{"\[CapitalDelta]seq", "=", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[CapitalDelta]seq", "]"}], ",", "2"}],
              "]"}]}], ";", "\n", "\t", 
           RowBox[{
            RowBox[{"EnList", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"EnList", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], "]"}]}], 
           ";", "\n", "\t", 
           RowBox[{
            RowBox[{"EnList", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"EnList", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "2"}], "]"}]}], 
           ";", "\n", "\t", 
           RowBox[{
            RowBox[{"EnList", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "=", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"EnList", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "2"}], "]"}]}], 
           ";", " ", "\n", "\t", 
           RowBox[{"\[CapitalDelta]Vseq", "=", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[CapitalDelta]Vseq", "]"}], ",", 
              "2"}], "]"}]}], ";", " ", "\n", "\t", 
           RowBox[{"dataToFile", "[", 
            RowBox[{
             RowBox[{"parameters", "[", 
              RowBox[{"[", 
               RowBox[{"ev", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
             "acuracy", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "L", ",", "U", ",", "V", ",", "\[Xi]", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"EnList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"EnList", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"EnList", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]seq", 
                 ",", "\[CapitalDelta]Vseq"}], "}"}]}], "}"}], ",", "gauge", 
             ",", "NbName"}], "]"}], ";", "     ", "\[IndentingNewLine]", 
           "\n", 
           RowBox[{"Print", "[", " ", 
            RowBox[{"\"\<ev=\>\"", ",", "ev", " ", ",", "\"\</\>\"", ",", " ", 
             RowBox[{
              RowBox[{"Length", "@", "eVs"}], "\"\<; j MAX=\>\""}], ",", "j", 
             ",", " ", "\"\</\>\"", ",", "steps", ",", " ", 
             "\"\<; Delta=\>\"", ",", "\[CapitalDelta]1", ",", " ", 
             "\"\<; \>\""}], "   ", "]"}], ";"}], " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"ev", ",", "1", ",", 
            RowBox[{"Length", "[", "parameters", "]"}]}], "}"}]}], " ", "]"}],
         ";"}]}], "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", "]"}], ";"}], "  ", ",", " ", 
    RowBox[{"{", 
     RowBox[{"pt", ",", "1", ",", 
      RowBox[{"Length", "@", "tV"}]}], "}"}], ",", "  ", 
    RowBox[{"{", 
     RowBox[{"ph", ",", "1", ",", 
      RowBox[{"Length", "@", "hV"}]}], "}"}], "  ", ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "1", ",", 
      RowBox[{"Length", "@", "Ls"}]}], "}"}]}], "]"}], ";", 
  RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.903016460858768*^9, 3.9030165408905783`*^9}, 
   3.9030166019544983`*^9, {3.9030166693598137`*^9, 3.9030166764980645`*^9}, {
   3.903016733793085*^9, 3.903016769379383*^9}, {3.903016818860441*^9, 
   3.9030168513929896`*^9}, {3.9030170130833545`*^9, 3.903017042806652*^9}, {
   3.9030170981577063`*^9, 3.9030171387676363`*^9}, {3.903017174452446*^9, 
   3.9030171842846775`*^9}, {3.903017228027129*^9, 3.903017235249035*^9}, {
   3.9030172779572906`*^9, 3.9030173169247885`*^9}, {3.9030173709942102`*^9, 
   3.903017386069847*^9}, {3.903208148328744*^9, 3.903208204149869*^9}, {
   3.903208348988762*^9, 3.903208373511516*^9}, {3.903208473659769*^9, 
   3.9032084906927032`*^9}, {3.9032085265808334`*^9, 
   3.9032087121176944`*^9}, {3.903208756175791*^9, 3.903208869600963*^9}, {
   3.9032089010080614`*^9, 3.903208931540208*^9}, {3.9032089639195824`*^9, 
   3.903208983925414*^9}, {3.9032091581646366`*^9, 3.9032092415568285`*^9}, 
   3.9032093591895704`*^9, {3.9032101982028775`*^9, 3.903210233256913*^9}, {
   3.9032102650058603`*^9, 3.903210271153679*^9}, {3.903210301439819*^9, 
   3.9032105442851872`*^9}, {3.9032105832976227`*^9, 3.903210603101493*^9}, {
   3.9032106577295637`*^9, 3.903210658178791*^9}, {3.9032106939988694`*^9, 
   3.9032109154906716`*^9}, {3.903210973387393*^9, 3.9032110857770476`*^9}, {
   3.9032111639150476`*^9, 3.903211288637221*^9}, {3.903211336671553*^9, 
   3.903211404081724*^9}},ExpressionUUID->"32f352b1-0055-4210-b9fc-\
bdd230ac7c7b"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"minSteps", "=", "3"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Do", "[", "   ", "\n", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Chi]G", ",", "\[Omega]G", ",", "jG", ",", "LG", ",", "EnG", " ", 
          ",", 
          RowBox[{"gauge", "=", "\"\<g0\>\""}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         RowBox[{"<", 
          RowBox[{
           RowBox[{"-", "  ", "the"}], " ", "1", "st", " ", 
           RowBox[{"difference", " ", ":", " ", 
            RowBox[{"g0", " ", "\[UndirectedEdge]", " ", "g4"}]}]}]}], " ", 
         "*)"}], "\n", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{
            "J", ",", "K", ",", "\[CapitalGamma]", ",", "Jmod", ",", "Kmod", 
             ",", "\[CapitalGamma]mod", ",", "Jv", ",", "Kv", ",", 
             "\[CapitalGamma]v", ",", 
             RowBox[{"L", "=", 
              RowBox[{"Ls", "[", 
               RowBox[{"[", "l", "]"}], "]"}]}], ",", "Nc", ",", "h", " ", 
             ",", "\[CapitalLambda]", ",", "T", ",", "En", ",", "EMF", ",", 
             "Esum", ",", "E\[Lambda]", ",", 
             RowBox[{"EnList", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", "\[Xi]G", ",", 
             RowBox[{"\[CapitalDelta]seq", "=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
              RowBox[{"{", "}"}]}], ",", "\[CapitalDelta]\[Omega]", ",", 
             RowBox[{"u2", "=", "0"}], ",", "u1", ",", "u0", ",", 
             RowBox[{"\[Chi]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\[Omega]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\[Xi]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", "j", ",", 
             RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
             RowBox[{"\[CapitalDelta]2", "=", "2.56"}], ",", "ES", ",", "gap",
              ",", "\[CapitalDelta]t", ",", 
             RowBox[{"hp", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{"p", ",", 
                RowBox[{"Length", "@", "hV"}], ",", "1"}], "]"}]}]}], " ", 
            "}"}], ",", " ", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", "Jmod", 
               ",", "Kmod", ",", "\[CapitalGamma]mod"}], "}"}], "=", 
             RowBox[{
              RowBox[{"parameters", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], ";", " ", "\n", 
            RowBox[{"Nc", "=", 
             RowBox[{"L", "^", "2"}]}], ";", "\n", 
            RowBox[{"\[Omega]", "=", 
             RowBox[{"Table", "[", 
              RowBox[{"\[Omega]GA", ",", "2", ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{"T", "=", 
             RowBox[{"Tmat", "[", 
              RowBox[{"L", ",", "L"}], "]"}]}], ";", "\n", 
            RowBox[{"Kv", "=", 
             RowBox[{"uniform", "[", 
              RowBox[{"K", ",", "L", ",", "L"}], "]"}]}], ";", "\n", "\n", 
            RowBox[{"u0", "=", 
             RowBox[{"uniformU", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "L"}], "]"}]}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"<", 
              RowBox[{
               RowBox[{"-", "  ", "the"}], " ", "2", "nd", " ", 
               RowBox[{"difference", " ", ":", " ", "gauge4v"}]}]}], " ", 
             "*)"}], "\n", "\n", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "jG", ",", "LG", ",", "\[Chi]G", ",", "\[Omega]G", ",", 
               "\[Xi]G", ",", "EnG"}], "}"}], "=", " ", 
             RowBox[{"loadData", "[", 
              RowBox[{"toPath", "[", 
               RowBox[{
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                "acuracy", ",", "\"\<free\>\"", ",", "NbName"}], " ", "]"}], 
              "  ", "]"}]}], ";", " ", "\n", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"\[Omega]G", "=", 
               RowBox[{"sym\[Omega]", "[", "\[Omega]G", "]"}]}], ";"}], 
             "*)"}], "\n", 
            RowBox[{
             RowBox[{"\[Omega]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Omega]G", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Omega]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Omega]G", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Chi]G", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Chi]G", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Chi]G", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", "\n", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "Print", "[", "\"\< for Pure Kitaev model: \>\"", " ", "]"}], 
              ";"}], "*)"}], "\n", 
            RowBox[{"Module", "[", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"h0", "=", 
                 RowBox[{"Norm", "[", "h", "]"}]}], ",", "\[Kappa]0", ",", 
                "\[Kappa]", ",", 
                RowBox[{"\[Lambda]", "=", 
                 RowBox[{"to\[Lambda]", "[", "h", "]"}]}], ",", "\[Chi]0", 
                ",", "Hpure", ",", "Tpure", ",", "Upure", ",", "Epure"}], 
               "}"}], ",", "   ", "\n", 
              RowBox[{
               RowBox[{"\[Kappa]0", "=", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"h0", "/", 
                    RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}], "^", "3"}], "/", 
                  RowBox[{
                   RowBox[{"(", "0.262", ")"}], "^", "2"}]}], "*)"}], " ", 
                RowBox[{"toKappa", "[", "h", "]"}]}], ";", " ", "\n", 
               RowBox[{"\[Kappa]", "=", 
                RowBox[{"N", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Round", "[", 
                    RowBox[{"10000", " ", "\[Kappa]0"}], "]"}], "/", 
                   "10000"}], ")"}]}]}], ";", "   ", "\n", 
               RowBox[{"\[Chi]0", "=", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "  ", 
               RowBox[{"(*", "\n", 
                RowBox[{
                 RowBox[{"\[Omega]0", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{"\[Omega]GA", ",", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}],
                  ";"}], "*)"}], "\n", 
               RowBox[{"Hpure", "=", 
                RowBox[{"Hreal", "[", 
                 RowBox[{
                 "Kv", ",", "\[Kappa]", ",", "\[Lambda]", ",", "u0", ",", "L",
                   ",", "0", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", "   ",
                "\n", 
               RowBox[{"Tpure", "=", 
                RowBox[{"TmatPure", "[", "L", "]"}]}], ";", "  ", "\n", 
               RowBox[{"Upure", "=", 
                RowBox[{"UmatPure", "[", 
                 RowBox[{
                  RowBox[{"Tpure", "\[ConjugateTranspose]"}], " ", ".", " ", 
                  "Hpure", " ", ".", " ", "Tpure"}], "]"}]}], ";", "\n", 
               RowBox[{"Epure", "=", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Eigenvalues", "[", "Hpure", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
                 RowBox[{"(", "Nc", ")"}]}]}], ";", "\n", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Chi]0", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"\[Chi]0", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"\[Chi]0", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "=", 
                RowBox[{"toMFparametersPure", "[", 
                 RowBox[{"Upure", ",", "u0", ",", "L", ",", "0"}], "]"}]}], 
               ";", "   ", "\n", 
               RowBox[{"dataToFilePure", "[", 
                RowBox[{
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                 "acuracy", ",", "gauge", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "L", ",", "\[Chi]0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}]}], "}"}], ",", 
                   RowBox[{"{", "Epure", "}"}]}], " ", "}"}]}], " ", "]"}], 
               ";", " ", "\n", 
               RowBox[{"Print", "[", "\"\<Pure data saved: \>\"", "]"}], ";", 
               "\n", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Kappa=\>\"", ",", "\[Kappa]", ",", "\"\<; Lambda=\>\"", 
                 ",", " ", "\[Lambda]", ",", " ", "\"\<; Epure=\>\"", ",", 
                 "Epure", ",", "\"\<; \>\""}], "]"}], ";", 
               RowBox[{"Print", "[", "]"}], ";", "\n", 
               RowBox[{"Do", "[", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], " ", ",", 
                 RowBox[{"{", 
                  RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], "]"}], ";"}]}],
              "\n", "  ", "]"}], ";", " ", "\n", "\n", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"\[Chi]", "=", 
               RowBox[{"\[Chi]gauge4v", "[", 
                RowBox[{"\[Chi]", ",", "L"}], "]"}]}], ";"}], "*)"}], "   ", 
            RowBox[{"(*", " ", 
             RowBox[{"<", 
              RowBox[{
               RowBox[{"-", "  ", "the"}], " ", "3", "rd", " ", 
               RowBox[{"difference", " ", ":", "  ", "\[Chi]gauge4v"}]}]}], 
             " ", "*)"}], "\n", "\n", " ", 
            RowBox[{"Do", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", "Jmod",
                   ",", "Kmod", ",", "\[CapitalGamma]mod"}], "}"}], "=", 
                RowBox[{
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"ev", ",", "p"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], ";", " ", 
               RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<J=\>\"", ",", "J", ",", " ", "\"\<; K=\>\"", ",", "K", 
                 ",", " ", "\"\<; G=\>\"", ",", "\[CapitalGamma]", ",", 
                 "\"\<; Jmod=\>\"", ",", "Jmod", ",", " ", "\"\<; Kmod=\>\"", 
                 ",", "Kmod", ",", " ", "\"\<; Gmod=\>\"", ",", 
                 "\[CapitalGamma]mod", ",", " ", "\"\<; L=\>\"", ",", "L", 
                 ",", " ", "\"\<; h=(\>\"", ",", " ", 
                 RowBox[{"hV", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"hp", ",", "1"}], " ", "]"}], "]"}], ",", 
                 "\"\<,\>\"", ",", 
                 RowBox[{"hV", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"hp", ",", "2"}], " ", "]"}], "]"}], ",", 
                 "\"\<,\>\"", ",", 
                 RowBox[{"hV", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"hp", ",", "3"}], "]"}], "]"}], ",", 
                 "\"\<); eV=\>\"", ",", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"1000", " ", 
                    RowBox[{
                    RowBox[{"eVs", "[", 
                    RowBox[{"[", "ev", "]"}], "]"}], "/", "1700"}]}], "]"}], 
                    "/", "1000"}], "]"}], "\"\<; \>\""}]}], "]"}], ";", 
               RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", 
               RowBox[{"Kv", "=", 
                RowBox[{"uniform", "[", 
                 RowBox[{"K", ",", "L", ",", "L"}], "]"}]}], ";", 
               RowBox[{"Kv", "=", 
                RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                 RowBox[{"Kv", ",", "Kmod", ",", "L"}], "]"}]}], ";", "\n", 
               RowBox[{"Jv", "=", 
                RowBox[{"uniform", "[", 
                 RowBox[{"J", ",", "L", ",", "L"}], "]"}]}], ";", 
               RowBox[{"Jv", "=", 
                RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                 RowBox[{"Jv", ",", "Jmod", ",", "L"}], "]"}]}], ";", "\n", 
               RowBox[{"\[CapitalGamma]v", "=", 
                RowBox[{"uniform", "[", 
                 RowBox[{"\[CapitalGamma]", ",", "L", ",", "L"}], "]"}]}], 
               ";", 
               RowBox[{"\[CapitalGamma]v", "=", 
                RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                 RowBox[{
                 "\[CapitalGamma]v", ",", "\[CapitalGamma]mod", ",", "L"}], 
                 "]"}]}], ";", "\n", "\n", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"j", "=", "1"}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", " ", 
                   RowBox[{"j", "<", "steps"}], ")"}], "\[And]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "<", "minSteps"}], ")"}], "\[Or]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Chop", "[", " ", 
                    RowBox[{"\[CapitalDelta]1", ",", " ", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "acuracy"}]}]}], " ", "]"}], "!=", " ", 
                    "0"}], ")"}]}], "    ", ")"}]}], " ", ",", " ", 
                 RowBox[{"j", "++"}], ",", "   ", "\n", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", ">=", "2"}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalDelta]2", "=", "\[CapitalDelta]1"}], 
                    ";", " ", 
                    RowBox[{"\[CapitalDelta]1", "=", 
                    RowBox[{"Max", "[", " ", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"(", 
                    RowBox[{"u1", "-", "u2"}], ")"}]}], " ", "]"}]}], ";", 
                    " ", 
                    RowBox[{"\[CapitalDelta]seq", "=", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalDelta]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]1"}], "}"}]}], "}"}]}], 
                    ";", "  ", 
                    RowBox[{"\[CapitalDelta]\[Omega]", "=", 
                    RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Nc"}], ")"}]}], " ", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "r", ",", "2", ",", "1"}], "]"}],
                     "]"}], "+", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "r", ",", "3", ",", "4"}], "]"}],
                     "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1", ",", "Nc"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], 
                    "]"}]}]}], ";", " ", 
                    RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalDelta]\[Omega]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]\[Omega]"}], "}"}]}], 
                    "}"}]}]}]}], "    ", "]"}], ";", " ", "\n", "\n", 
                  RowBox[{"Module", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "H", ",", "u", ",", "TUh", ",", "Heff", ",", "\[Lambda]1",
                     ",", "\[Lambda]2", ",", "loaddata"}], "}"}], ",", "\n", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<=", "1"}], ",", " ", 
                    RowBox[{
                    RowBox[{"loaddata", "=", 
                    RowBox[{"loadDataTry", "[", 
                    RowBox[{"toPath", "[", 
                    RowBox[{
                    RowBox[{"parameters", "[", 
                    RowBox[{"[", 
                    RowBox[{"ev", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                    "acuracy", ",", "gauge", ",", "NbName"}], "]"}], "  ", 
                    "]"}]}], ";", "\n", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{"loaddata", "===", "$Failed"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "j", ",", "L", ",", "\[Chi]", ",", "\[Omega]", ",", 
                    "\[Xi]", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]seq",
                     ",", "\[CapitalDelta]\[Omega]seq"}], "}"}]}], "}"}], "=",
                     "loaddata"}]}], "]"}]}]}], "]"}], ";", "\n", "\n", 
                    RowBox[{"Heff", "=", 
                    RowBox[{"HeffList", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Omega]"}], "]"}]}], ";", 
                    RowBox[{"(*", "  ", 
                    RowBox[{
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";"}], "  ", 
                    "*)"}], "\n", 
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{"\[Lambda]1List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{"\[Lambda]2List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", " ", 
                    "\n", 
                    RowBox[{"H", "=", 
                    RowBox[{"HMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L", ",", 
                    "\[Lambda]1", ",", "\[Lambda]2", ",", "Heff"}], "]"}]}], 
                    ";", " ", "\n", 
                    RowBox[{"u", "=", 
                    RowBox[{"Umat", "[", 
                    RowBox[{
                    RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H", " ", ".", " ", "T"}], "]"}]}], ";", "\n", 
                    RowBox[{"u1", "=", 
                    RowBox[{"Re", "@", 
                    RowBox[{"Chop", "@", 
                    RowBox[{"icc", "[", 
                    RowBox[{"u", ",", "L", ",", "T"}], "]"}]}]}]}], ";", "\n",
                     "\n", "\t", 
                    RowBox[{"EMF", "=", 
                    RowBox[{"EnMF0", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                    ";", "                                        ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"<", 
                    RowBox[{"-", " ", 
                    RowBox[{"EnMF0", " ", "?"}]}]}], "  ", "*)"}], "\n", "\t", 
                    RowBox[{"Esum", "=", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Eigenvalues", "[", "H", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "Nc"}], ")"}]}]}], ";", "\n", "\t", 
                    RowBox[{"E\[Lambda]", "=", 
                    RowBox[{"EnLagMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                    ";", "\n", "\t", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "EMF"}], "}"}]}], "}"}]}], ";", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "Esum"}], "}"}]}], "}"}]}], ";", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], "}"}]}], 
                    ";", "   ", "\n", 
                    RowBox[{"Do", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "m", ",", "n", ",", "\[Alpha]", ",", "\[Beta]", ",", "rz",
                     ",", "rx", ",", "ry", ",", "Io"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"rz", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"R0", "/", "16"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Beta]", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}]}], ")"}], "/", "4"}]}], 
                    "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Alpha]", "=", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}], "-", 
                    RowBox[{"4", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "+", "1"}]}], ";",
                     "\n", "   ", 
                    RowBox[{"n", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"rz", "/", "L"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"m", "=", 
                    RowBox[{"rz", "-", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"rx", "=", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"ry", "=", 
                    RowBox[{"m", "+", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", 
                    "L"}]}]}], ";", 
                    RowBox[{"Io", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], ";", " ", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rx"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "ry"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Io", "+", "4"}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], " ", "]"}], 
                    "]"}]}], ";"}]}], "\n", "    ", "]"}], ";"}], " ", ",", 
                    " ", 
                    RowBox[{"{", 
                    RowBox[{"R0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"16", "Nc"}], "-", "1"}]}], "}"}]}], "  ", "]"}], 
                    ";"}]}], "    ", "\n", "]"}], ";", " ", "\n", 
                  RowBox[{"u2", "=", "u1"}], ";", "        ", "\n", 
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\< j =\>\"", ",", "j", ",", " ", "\"\</\>\"", ",", 
                    "steps", ",", " ", "\"\<; Delta=\>\"", ",", 
                    RowBox[{"round\[CapitalDelta]", "@", "\[CapitalDelta]1"}],
                     ",", " ", "\"\<;  E=\>\"", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"1000000", 
                    RowBox[{"(", "#", ")"}]}], "]"}], "/", "1000000"}], "]"}],
                     "&"}], "@", 
                    RowBox[{"{", 
                    RowBox[{"EMF", ",", "Esum", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], ",", 
                    "\"\<; \>\""}], "  ", "]"}], ";"}]}], "     ", "\n", 
                "         ", "]"}], ";", "  ", "\n", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "H", ",", "u", ",", "Heff", ",", "\[Lambda]1", ",", 
                   "\[Lambda]2"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"Heff", "=", 
                   RowBox[{"HeffList", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Omega]"}], "]"}]}], ";", " ", 
                  RowBox[{"(*", "\n", 
                   RowBox[{
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";"}], "*)"}], 
                  "\n", 
                  RowBox[{"\[Lambda]1", "=", 
                   RowBox[{"\[Lambda]1List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", 
                  RowBox[{"\[Lambda]2", "=", 
                   RowBox[{"\[Lambda]2List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", " ", 
                  "\n", 
                  RowBox[{"H", "=", 
                   RowBox[{"HMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L", ",", 
                    "\[Lambda]1", ",", "\[Lambda]2", ",", "Heff"}], "]"}]}], 
                  ";", " ", "\n", "    ", 
                  RowBox[{"u", "=", 
                   RowBox[{"Umat", "[", 
                    RowBox[{
                    RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H", " ", ".", " ", "T"}], "]"}]}], ";", "\n", "\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"\[Xi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Xi]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "u1"}], "}"}], "=", 
                   RowBox[{"BiParallel", "[", 
                    RowBox[{"u", ",", "L", ",", "T"}], "]"}]}], ";", "\n", 
                  "\n", "\t", 
                  RowBox[{"EMF", "=", 
                   RowBox[{"EnMF0", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                  ";", "                                        ", 
                  RowBox[{"(*", " ", 
                   RowBox[{"<", 
                    RowBox[{"-", " ", 
                    RowBox[{"EnMF0", " ", "?"}]}]}], "  ", "*)"}], "\n", "\t", 
                  RowBox[{"Esum", "=", 
                   RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Eigenvalues", "[", "H", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "Nc"}], ")"}]}]}], ";", "\n", "\t", 
                  RowBox[{"E\[Lambda]", "=", 
                   RowBox[{"EnLagMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                  ";", "\n", "\t", 
                  RowBox[{
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "EMF"}], "}"}]}], "}"}]}], ";", "\n", 
                  "    ", 
                  RowBox[{
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "Esum"}], "}"}]}], "}"}]}], ";", "\n", 
                  "    ", 
                  RowBox[{
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], "}"}]}], 
                  ";"}]}], "      ", "\n", "\n", "]"}], ";", "  \t", 
               RowBox[{"\[CapitalDelta]seq", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "\[CapitalDelta]seq", "]"}], ",", 
                  "2"}], "]"}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"EnList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"EnList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"EnList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], ";", " ", "\n", "\t", 
               RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "\[CapitalDelta]\[Omega]seq", "]"}],
                   ",", "2"}], "]"}]}], ";", " ", "\n", "\t", 
               RowBox[{"dataToFile", "[", 
                RowBox[{
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"ev", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                 "acuracy", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "j", ",", "L", ",", "\[Chi]", ",", "\[Omega]", ",", "\[Xi]",
                    ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]seq",
                     ",", "\[CapitalDelta]\[Omega]seq"}], "}"}]}], "}"}], ",",
                  "gauge", ",", "NbName"}], "]"}], ";", "     ", "\n", 
               RowBox[{"Print", "[", " ", 
                RowBox[{
                "\"\<ev=\>\"", ",", "ev", " ", ",", "\"\</\>\"", ",", " ", 
                 RowBox[{
                  RowBox[{"Length", "@", "eVs"}], "\"\<; j MAX=\>\""}], ",", 
                 "j", ",", " ", "\"\</\>\"", ",", "steps", ",", " ", 
                 "\"\<; Delta=\>\"", ",", "\[CapitalDelta]1", ",", " ", 
                 "\"\<; \>\""}], "   ", "]"}], ";"}], "\n", ",", " ", 
              RowBox[{"{", 
               RowBox[{"ev", ",", "1", ",", 
                RowBox[{"Length", "[", "parameters", "]"}]}], "}"}]}], " ", 
             "]"}], "   ", ";", "\n", "\n", "\t", 
            RowBox[{"t1", "=", 
             RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
            RowBox[{"\[CapitalDelta]t", "=", " ", 
             RowBox[{"UnitConvert", "[", " ", 
              RowBox[{
               RowBox[{"Quantity", "[", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{"t1", " ", "-", "t0"}], "]"}], ",", " ", 
                 "\"\<Seconds\>\""}], " ", "]"}], ",", " ", "\"\<Hours\>\""}],
               " ", "]"}]}], ";", 
            RowBox[{"t0", "=", "t1"}], ";", 
            RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", "\t", 
            RowBox[{"Print", "[", " ", 
             RowBox[{"\"\<p=\>\"", ",", "p", ",", "\"\</\>\"", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"parameters", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", "\"\<; l=\>\"", 
              ",", "l", ",", " ", "\"\</\>\"", ",", 
              RowBox[{"Length", "@", "Ls"}], ",", " ", 
              "\"\<; \[CapitalDelta]t = \>\"", ",", 
              RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}], ",", 
              RowBox[{"IntegerPart", "@", 
               RowBox[{"UnitConvert", "[", 
                RowBox[{
                 RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], 
                 ",", " ", "\"\<Minutes\>\""}], " ", "]"}]}]}], "   ", 
             "]"}]}]}], "\n", "  ", "]"}], ";"}]}], "\n", "]"}], "  ", ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", 
        RowBox[{"Length", "@", "Ls"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"p", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"parameters", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "  ", "]"}], 
    ";"}], "      ", "\n", "\n"}]}]], "Code",
 CellChangeTimes->{{3.9030175150318413`*^9, 
  3.903017518868645*^9}},ExpressionUUID->"516d261c-68fc-436c-b4cb-\
6a2feb104a84"]
}, Open  ]],

Cell[CellGroupData[{

Cell["four vortex + gradually increase  electric field", "Subsubsection",
 FontWeight->Bold,ExpressionUUID->"45c87f90-eb26-4fda-b817-fed84e6974f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[CapitalDelta]t", "}"}], ",", 
    RowBox[{
     RowBox[{"t4v", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
     RowBox[{"\[CapitalDelta]t", "=", " ", 
      RowBox[{"UnitConvert", "[", " ", 
       RowBox[{
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"t4v", "-", "t0v"}], "]"}], ",", " ", "\"\<Seconds\>\""}], 
         " ", "]"}], ",", " ", "\"\<Hours\>\""}], " ", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tHours", "=", 
      RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tMin", "=", 
      RowBox[{"IntegerPart", "@", 
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", " ", 
         "\"\<Minutes\>\""}], " ", "]"}]}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tSec", "=", 
      RowBox[{"IntegerPart", "@", 
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"FractionalPart", "@", 
          RowBox[{"UnitConvert", "[", 
           RowBox[{
            RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", 
            " ", "\"\<Minutes\>\""}], " ", "]"}]}], ",", " ", 
         "\"\<Seconds\>\""}], " ", "]"}]}]}], ";", "\n", 
     RowBox[{"Print", "[", " ", 
      RowBox[{"\"\<Free loop + electric field timing= \>\"", ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tHours"}], ",", "\"\< : \>\"",
        ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tMin"}], ",", "\"\< : \>\"", 
       ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tSec"}]}], "    ", "]"}], ";",
      "\n", 
     RowBox[{"t0", "=", "t4v"}], ";", 
     RowBox[{
      RowBox[{"Print", "[", "\"\< \>\"", "]"}], " ", 
      RowBox[{"Print", "[", "\"\< \>\"", "]"}]}], ";"}]}], "\n", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<    Starting four vortex + electric field loop: \>\"", 
   "]"}], ";", 
  RowBox[{"Print", "[", "\"\< \>\"", "]"}]}]}], "Code",ExpressionUUID->\
"5804fa87-423d-4ed1-9961-5b40631e42e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"minSteps", "=", "5"}], ";", "\n", 
    RowBox[{"Do", "[", "   ", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Chi]G", ",", "\[Omega]G", ",", "jG", ",", "LG", ",", "EnG", " ", 
          ",", 
          RowBox[{"gauge", "=", "\"\<g4\>\""}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         RowBox[{"<", 
          RowBox[{
           RowBox[{"-", "  ", "the"}], " ", "1", "st", " ", 
           RowBox[{"difference", " ", ":", " ", 
            RowBox[{"g0", " ", "\[UndirectedEdge]", " ", "g4"}]}]}]}], " ", 
         "*)"}], "\n", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{
            "J", ",", "K", ",", "\[CapitalGamma]", ",", "Jmod", ",", "Kmod", 
             ",", "\[CapitalGamma]mod", ",", "Jv", ",", "Kv", ",", 
             "\[CapitalGamma]v", ",", 
             RowBox[{"L", "=", 
              RowBox[{"Ls", "[", 
               RowBox[{"[", "l", "]"}], "]"}]}], ",", "Nc", ",", "h", " ", 
             ",", "\[CapitalLambda]", ",", "T", ",", "En", ",", "EMF", ",", 
             "E\[Lambda]", ",", 
             RowBox[{"EnList", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", "\[Xi]G", ",", 
             RowBox[{"\[CapitalDelta]seq", "=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
              RowBox[{"{", "}"}]}], ",", "\[CapitalDelta]\[Omega]", ",", "u2",
              ",", "u1", ",", "u0", ",", 
             RowBox[{"\[Chi]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\[Omega]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\[Xi]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", "j", ",", 
             RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
             RowBox[{"\[CapitalDelta]2", "=", "2.56"}], ",", "ES", ",", "gap",
              ",", "\[CapitalDelta]t", ",", 
             RowBox[{"hp", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{"p", ",", 
                RowBox[{"Length", "@", "hV"}], ",", "1"}], "]"}]}]}], " ", 
            "}"}], ",", " ", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", "Jmod", 
               ",", "Kmod", ",", "\[CapitalGamma]mod"}], "}"}], "=", 
             RowBox[{
              RowBox[{"parameters", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], ";", "  ", "\n", 
            RowBox[{"Nc", "=", 
             RowBox[{"L", "^", "2"}]}], ";", "\n", 
            RowBox[{"\[Omega]", "=", 
             RowBox[{"Table", "[", 
              RowBox[{"\[Omega]GA", ",", "2", ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{"T", "=", 
             RowBox[{"Tmat", "[", 
              RowBox[{"L", ",", "L"}], "]"}]}], ";", "\n", 
            RowBox[{"Kv", "=", 
             RowBox[{"uniform", "[", 
              RowBox[{"K", ",", "L", ",", "L"}], "]"}]}], ";", "\n", "\n", 
            RowBox[{"u0", "=", 
             RowBox[{"gauge4v", "[", 
              RowBox[{
               RowBox[{"uniformU", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "L"}], "]"}], ",", "L"}], "]"}]}], 
            ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"<", 
              RowBox[{
               RowBox[{"-", "  ", "the"}], " ", "2", "nd", " ", 
               RowBox[{"difference", " ", ":", " ", "gauge4v"}]}]}], " ", 
             "*)"}], "\n", "\n", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "jG", ",", "LG", ",", "\[Chi]G", ",", "\[Omega]G", ",", 
               "\[Xi]G", ",", "EnG"}], "}"}], "=", " ", 
             RowBox[{"loadData", "[", 
              RowBox[{"toPath", "[", 
               RowBox[{
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                "acuracy", ",", "\"\<free\>\"", ",", "NbName"}], " ", "]"}], 
              "  ", "]"}]}], ";", " ", "\n", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"\[Omega]G", "=", 
               RowBox[{"sym\[Omega]", "[", "\[Omega]G", "]"}]}], ";"}], 
             "*)"}], "\n", 
            RowBox[{
             RowBox[{"\[Omega]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Omega]G", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Omega]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Omega]G", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Chi]G", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Chi]G", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Chi]G", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", "\n", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "Print", "[", "\"\< for Pure Kitaev model: \>\"", " ", "]"}], 
              ";"}], "*)"}], "\n", 
            RowBox[{"Module", "[", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"h0", "=", 
                 RowBox[{"Norm", "[", "h", "]"}]}], ",", "\[Kappa]0", ",", 
                "\[Kappa]", ",", "\[Chi]0", ",", "Hpure", ",", "Tpure", ",", 
                "Upure"}], "}"}], ",", "   ", "\n", 
              RowBox[{
               RowBox[{"\[Kappa]0", "=", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"h0", "/", 
                    RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}], "^", "3"}], "/", 
                  RowBox[{
                   RowBox[{"(", "0.262", ")"}], "^", "2"}]}], "*)"}], " ", 
                RowBox[{"toKappa", "[", "h", "]"}]}], ";", " ", "\n", 
               RowBox[{"\[Kappa]", "=", 
                RowBox[{"N", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Round", "[", 
                    RowBox[{"10000", " ", "\[Kappa]0"}], "]"}], "/", 
                   "10000"}], ")"}]}]}], ";", "   ", "\n", 
               RowBox[{"\[Chi]0", "=", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "  ", 
               RowBox[{"(*", "\n", 
                RowBox[{
                 RowBox[{"\[Omega]0", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{"\[Omega]GA", ",", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}],
                  ";"}], "*)"}], "\n", 
               RowBox[{"Hpure", "=", 
                RowBox[{"Hreal", "[", 
                 RowBox[{"Kv", ",", "\[Kappa]", ",", 
                  RowBox[{"to\[Lambda]", "[", "h", "]"}], ",", "u0", ",", "L",
                   ",", "0", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", "   ",
                "\n", 
               RowBox[{"Tpure", "=", 
                RowBox[{"TmatPure", "[", "L", "]"}]}], ";", "  ", "\n", 
               RowBox[{"Upure", "=", 
                RowBox[{"UmatPure", "[", 
                 RowBox[{
                  RowBox[{"Tpure", "\[ConjugateTranspose]"}], " ", ".", " ", 
                  "Hpure", " ", ".", " ", "Tpure"}], "]"}]}], ";", "\n", 
               RowBox[{"Epure", "=", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Eigenvalues", "[", "Hpure", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
                 RowBox[{"(", "Nc", ")"}]}]}], ";", "\n", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Chi]0", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"\[Chi]0", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"\[Chi]0", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "=", 
                RowBox[{"toMFparametersPure", "[", 
                 RowBox[{"Upure", ",", "u0", ",", "L", ",", "0"}], "]"}]}], 
               ";", "   ", "\n", 
               RowBox[{"dataToFilePure", "[", 
                RowBox[{
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                 "acuracy", ",", "gauge", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "L", ",", "\[Chi]0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}]}], "}"}], ",", 
                   RowBox[{"{", "Epure", "}"}]}], " ", "}"}]}], " ", "]"}], 
               ";", " ", "\n", 
               RowBox[{"Print", "[", "\"\<Pure data saved: \>\"", "]"}], ";", 
               "\n", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Kappa=\>\"", ",", "\[Kappa]", ",", "\"\< Lambda=\>\"", 
                 ",", " ", "\[Lambda]", " ", ",", "\"\<; Epure=\>\"", ",", 
                 "Epure", ",", "\"\<; \>\""}], "]"}], ";", 
               RowBox[{"Print", "[", "]"}], ";", "\n", 
               RowBox[{"Do", "[", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], " ", ",", 
                 RowBox[{"{", 
                  RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], "]"}], ";"}]}],
              "\n", "  ", "]"}], ";", " ", "\n", "\n", 
            RowBox[{"\[Chi]", "=", 
             RowBox[{"\[Chi]gauge4v", "[", 
              RowBox[{"\[Chi]", ",", "L"}], "]"}]}], ";", "   ", 
            RowBox[{"(*", " ", 
             RowBox[{"<", 
              RowBox[{
               RowBox[{"-", "  ", "the"}], " ", "3", "rd", " ", 
               RowBox[{"difference", " ", ":", "  ", "\[Chi]gauge4v"}]}]}], 
             " ", "*)"}], "\n", "\n", " ", 
            RowBox[{"Do", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", "Jmod",
                   ",", "Kmod", ",", "\[CapitalGamma]mod"}], "}"}], "=", 
                RowBox[{
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"ev", ",", "p"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], ";", " ", 
               RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<J=\>\"", ",", "J", ",", " ", "\"\<; K=\>\"", ",", "K", 
                 ",", " ", "\"\<; G=\>\"", ",", "\[CapitalGamma]", ",", 
                 "\"\<; Jmod=\>\"", ",", "Jmod", ",", " ", "\"\<; Kmod=\>\"", 
                 ",", "Kmod", ",", " ", "\"\<; Gmod=\>\"", ",", 
                 "\[CapitalGamma]mod", ",", " ", "\"\<; L=\>\"", ",", "L", 
                 ",", " ", "\"\<; h=(\>\"", ",", " ", 
                 RowBox[{"hV", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"hp", ",", "1"}], " ", "]"}], "]"}], ",", 
                 "\"\<,\>\"", ",", 
                 RowBox[{"hV", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"hp", ",", "2"}], " ", "]"}], "]"}], ",", 
                 "\"\<,\>\"", ",", 
                 RowBox[{"hV", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"hp", ",", "3"}], "]"}], "]"}], ",", 
                 "\"\<); eV=\>\"", ",", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"1000", " ", 
                    RowBox[{
                    RowBox[{"eVs", "[", 
                    RowBox[{"[", "ev", "]"}], "]"}], "/", "1700"}]}], "]"}], 
                    "/", "1000"}], "]"}], "\"\<; \>\""}]}], "]"}], ";", 
               RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", 
               RowBox[{"Kv", "=", 
                RowBox[{"uniform", "[", 
                 RowBox[{"K", ",", "L", ",", "L"}], "]"}]}], ";", 
               RowBox[{"Kv", "=", 
                RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                 RowBox[{"Kv", ",", "Kmod", ",", "L"}], "]"}]}], ";", "\n", 
               RowBox[{"Jv", "=", 
                RowBox[{"uniform", "[", 
                 RowBox[{"J", ",", "L", ",", "L"}], "]"}]}], ";", 
               RowBox[{"Jv", "=", 
                RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                 RowBox[{"Jv", ",", "Jmod", ",", "L"}], "]"}]}], ";", "\n", 
               RowBox[{"\[CapitalGamma]v", "=", 
                RowBox[{"uniform", "[", 
                 RowBox[{"\[CapitalGamma]", ",", "L", ",", "L"}], "]"}]}], 
               ";", 
               RowBox[{"\[CapitalGamma]v", "=", 
                RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                 RowBox[{
                 "\[CapitalGamma]v", ",", "\[CapitalGamma]mod", ",", "L"}], 
                 "]"}]}], ";", "\n", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"j", "=", "1"}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", " ", 
                   RowBox[{"j", "<", "steps"}], ")"}], "\[And]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "<", "minSteps"}], ")"}], "\[Or]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Chop", "[", " ", 
                    RowBox[{"\[CapitalDelta]1", ",", " ", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "acuracy"}]}]}], " ", "]"}], "!=", " ", 
                    "0"}], ")"}]}], "    ", ")"}]}], " ", ",", " ", 
                 RowBox[{"j", "++"}], ",", "   ", "\n", "\n", 
                 RowBox[{
                  RowBox[{"Module", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "H", ",", "u", ",", "TUh", ",", "Heff", ",", "\[Lambda]1",
                     ",", "\[Lambda]2"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"Heff", "=", 
                    RowBox[{"HeffList", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Omega]"}], "]"}]}], ";", "\n", 
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";", "\n", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{"\[Lambda]1List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{"\[Lambda]2List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";"}], " ", 
                    "*)"}], "\n", 
                    RowBox[{"H", "=", 
                    RowBox[{"HMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L", ",", 
                    "\[Lambda]1", ",", "\[Lambda]2", ",", "Heff"}], "]"}]}], 
                    ";", " ", "\n", 
                    RowBox[{"u", "=", 
                    RowBox[{"Umat", "[", 
                    RowBox[{
                    RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H", " ", ".", " ", "T"}], "]"}]}], ";", "\n", 
                    RowBox[{"u1", "=", 
                    RowBox[{"Re", "@", 
                    RowBox[{"Chop", "@", 
                    RowBox[{"icc", "[", 
                    RowBox[{"u", ",", "L", ",", "T"}], "]"}]}]}]}], ";", "\n",
                     "\n", "\t", 
                    RowBox[{"EMF", "=", 
                    RowBox[{"EnMF0", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                    ";", "                                        ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"<", 
                    RowBox[{"-", " ", 
                    RowBox[{"EnMF0", " ", "?"}]}]}], "  ", "*)"}], "\n", "\t", 
                    RowBox[{"E\[Lambda]", "=", 
                    RowBox[{"EnLagMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                    ";", "\n", "\t", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "EMF"}], "}"}]}], "}"}]}], ";", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "0"}], "}"}]}], "}"}]}], ";", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], "}"}]}], 
                    ";", "   ", "\n", "\n", 
                    RowBox[{"Do", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "m", ",", "n", ",", "\[Alpha]", ",", "\[Beta]", ",", "rz",
                     ",", "rx", ",", "ry", ",", "Io"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"rz", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"R0", "/", "16"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Beta]", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}]}], ")"}], "/", "4"}]}], 
                    "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Alpha]", "=", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}], "-", 
                    RowBox[{"4", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "+", "1"}]}], ";",
                     "\n", "   ", 
                    RowBox[{"n", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"rz", "/", "L"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"m", "=", 
                    RowBox[{"rz", "-", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"rx", "=", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"ry", "=", 
                    RowBox[{"m", "+", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", 
                    "L"}]}]}], ";", 
                    RowBox[{"Io", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], ";", " ", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rx"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "ry"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Io", "+", "4"}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], " ", "]"}], 
                    "]"}]}], ";"}]}], "\n", "    ", "]"}], ";"}], " ", ",", 
                    " ", 
                    RowBox[{"{", 
                    RowBox[{"R0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"16", "Nc"}], "-", "1"}]}], "}"}]}], "  ", "]"}], 
                    ";"}]}], "     ", "\n", "]"}], ";", " ", "\n", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", ">=", "2"}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalDelta]2", "=", "\[CapitalDelta]1"}], 
                    ";", " ", 
                    RowBox[{"\[CapitalDelta]1", "=", 
                    RowBox[{"Max", "[", " ", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"(", 
                    RowBox[{"u1", "-", "u2"}], ")"}]}], " ", "]"}]}], ";", 
                    " ", 
                    RowBox[{"\[CapitalDelta]seq", "=", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalDelta]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]1"}], "}"}]}], "}"}]}], 
                    ";", "  ", 
                    RowBox[{"\[CapitalDelta]\[Omega]", "=", 
                    RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Nc"}], ")"}]}], " ", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "r", ",", "2", ",", "1"}], "]"}],
                     "]"}], "+", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "r", ",", "3", ",", "4"}], "]"}],
                     "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1", ",", "Nc"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], 
                    "]"}]}]}], ";", " ", 
                    RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalDelta]\[Omega]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]\[Omega]"}], "}"}]}], 
                    "}"}]}]}]}], "    ", "]"}], ";", " ", "\n", 
                  RowBox[{"u2", "=", "u1"}], ";", "        ", "\n", 
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\< j =\>\"", ",", "j", ",", " ", "\"\</\>\"", ",", 
                    "steps", ",", " ", "\"\<; Delta=\>\"", ",", 
                    RowBox[{"round\[CapitalDelta]", "@", "\[CapitalDelta]1"}],
                     ",", "  ", "\"\<;  E=\>\"", ",", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"1000000", 
                    RowBox[{"(", "EMF", ")"}]}], "]"}], "/", "1000000"}], 
                    "]"}], ",", "\"\<; \>\""}], "  ", "]"}], ";"}]}], "     ",
                 "\n", "         ", "]"}], ";", "  ", "\n", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "H", ",", "u", ",", "Heff", ",", "\[Lambda]1", ",", 
                   "\[Lambda]2"}], "}"}], ",", "\n", 
                 RowBox[{
                  RowBox[{"Heff", "=", 
                   RowBox[{"HeffList", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Omega]"}], "]"}]}], ";", " ", "\n", 
                  RowBox[{"\[Lambda]1", "=", 
                   RowBox[{
                    RowBox[{"(", "0.46", ")"}], "Heff"}]}], ";", 
                  RowBox[{"\[Lambda]2", "=", 
                   RowBox[{
                    RowBox[{"(", "0.46", ")"}], "Heff"}]}], ";", "\n", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{"\[Lambda]1List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{"\[Lambda]2List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";"}], " ", 
                   "*)"}], "\n", 
                  RowBox[{"H", "=", 
                   RowBox[{"HMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L", ",", 
                    "\[Lambda]1", ",", "\[Lambda]2", ",", "Heff"}], "]"}]}], 
                  ";", " ", "\n", "    ", 
                  RowBox[{"u", "=", 
                   RowBox[{"Umat", "[", 
                    RowBox[{
                    RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H", " ", ".", " ", "T"}], "]"}]}], ";", "\n", "\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"\[Xi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Xi]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "u1"}], "}"}], "=", 
                   RowBox[{"BiParallel", "[", 
                    RowBox[{"u", ",", "L", ",", "T"}], "]"}]}], ";", " ", 
                  "\n", "\t", 
                  RowBox[{"EMF", "=", 
                   RowBox[{"EnMF0", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                  ";", " ", "\n", "\t", 
                  RowBox[{"E\[Lambda]", "=", 
                   RowBox[{"EnLagMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                  ";", "\n", "\t", 
                  RowBox[{
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "EMF"}], "}"}]}], "}"}]}], ";", "\n", 
                  "    ", 
                  RowBox[{
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "0"}], "}"}]}], "}"}]}], ";", "\n", 
                  "    ", 
                  RowBox[{
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], "}"}]}], 
                  ";"}]}], "           ", "\n", "]"}], ";", "  \t", 
               RowBox[{"\[CapitalDelta]seq", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "\[CapitalDelta]seq", "]"}], ",", 
                  "2"}], "]"}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"EnList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"EnList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"EnList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], ";", " ", "\n", "\t", 
               RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "\[CapitalDelta]\[Omega]seq", "]"}],
                   ",", "2"}], "]"}]}], ";", " ", "\n", "\t", 
               RowBox[{"dataToFile", "[", 
                RowBox[{
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"ev", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                 "acuracy", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "j", ",", "L", ",", "\[Chi]", ",", "\[Omega]", ",", "\[Xi]",
                    ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]seq",
                     ",", "\[CapitalDelta]\[Omega]seq"}], "}"}]}], "}"}], ",",
                  "gauge", ",", "NbName"}], "]"}], ";", "     ", "\n", "\t", 
               "\n", 
               RowBox[{"Print", "[", " ", 
                RowBox[{
                "\"\<ev=\>\"", ",", "ev", " ", ",", "\"\</\>\"", ",", " ", 
                 RowBox[{
                  RowBox[{"Length", "@", "eVs"}], "\"\<; j MAX=\>\""}], ",", 
                 "j", ",", " ", "\"\</\>\"", ",", "steps", ",", " ", 
                 "\"\<; Delta=\>\"", ",", "\[CapitalDelta]1", ",", " ", 
                 "\"\<; \>\""}], "   ", "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"ev", ",", "1", ",", 
                RowBox[{"Length", "[", "parameters", "]"}]}], "}"}]}], " ", 
             "]"}], ";", "\n", "\n", "\t", 
            RowBox[{"t1", "=", 
             RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
            RowBox[{"\[CapitalDelta]t", "=", " ", 
             RowBox[{"UnitConvert", "[", " ", 
              RowBox[{
               RowBox[{"Quantity", "[", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{"t1", " ", "-", "t0"}], "]"}], ",", " ", 
                 "\"\<Seconds\>\""}], " ", "]"}], ",", " ", "\"\<Hours\>\""}],
               " ", "]"}]}], ";", 
            RowBox[{"t0", "=", "t1"}], ";", " ", 
            RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", "\t", 
            RowBox[{"Print", "[", " ", 
             RowBox[{"\"\<p=\>\"", ",", "p", ",", "\"\</\>\"", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"parameters", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", "\"\<; l=\>\"", 
              ",", "l", ",", " ", "\"\</\>\"", ",", 
              RowBox[{"Length", "@", "Ls"}], ",", " ", 
              "\"\<; \[CapitalDelta]t = \>\"", ",", 
              RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}], ",", 
              RowBox[{"IntegerPart", "@", 
               RowBox[{"UnitConvert", "[", 
                RowBox[{
                 RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], 
                 ",", " ", "\"\<Minutes\>\""}], " ", "]"}]}]}], "   ", 
             "]"}]}]}], "\n", "\n", "  ", "]"}], ";"}]}], "\n", "]"}], "  ", 
      ",", " ", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", 
        RowBox[{"Length", "@", "Ls"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"p", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"parameters", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "  ", 
     "]"}]}], "          ", "\n", "*)"}], 
  "                                     "}]], "Code",ExpressionUUID->\
"2aa113d0-4418-4f12-b1bb-136a7ea131a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[CapitalDelta]t", "}"}], ",", 
    RowBox[{
     RowBox[{"t1", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
     RowBox[{"\[CapitalDelta]t", "=", " ", 
      RowBox[{"UnitConvert", "[", " ", 
       RowBox[{
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"t1", "-", "t4v"}], "]"}], ",", " ", "\"\<Seconds\>\""}], 
         " ", "]"}], ",", " ", "\"\<Hours\>\""}], " ", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tHours", "=", 
      RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tMin", "=", 
      RowBox[{"IntegerPart", "@", 
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", " ", 
         "\"\<Minutes\>\""}], " ", "]"}]}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tSec", "=", 
      RowBox[{"IntegerPart", "@", 
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"FractionalPart", "@", 
          RowBox[{"UnitConvert", "[", 
           RowBox[{
            RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", 
            " ", "\"\<Minutes\>\""}], " ", "]"}]}], ",", " ", 
         "\"\<Seconds\>\""}], " ", "]"}]}]}], ";", "\n", 
     RowBox[{"Print", "[", " ", 
      RowBox[{"\"\<4 vortices loop timing \[CapitalDelta]t = \>\"", ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tHours"}], ",", "\"\< : \>\"",
        ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tMin"}], ",", "\"\< : \>\"", 
       ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tSec"}]}], "    ", "]"}]}]}], 
   " ", "\n", "]"}], ";"}]], "Code",ExpressionUUID->"40b41d05-2995-45c1-bd37-\
7b7242f5afbc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[CapitalDelta]t", "}"}], ",", 
     RowBox[{
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
      RowBox[{"\[CapitalDelta]t", "=", " ", 
       RowBox[{"UnitConvert", "[", " ", 
        RowBox[{
         RowBox[{"Quantity", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"t1", "-", "t4v"}], "]"}], ",", " ", "\"\<Seconds\>\""}], 
          " ", "]"}], ",", " ", "\"\<Hours\>\""}], " ", "]"}]}], ";", "\n", 
      RowBox[{"\[CapitalDelta]tHours", "=", 
       RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}]}], ";", "\n", 
      RowBox[{"\[CapitalDelta]tMin", "=", 
       RowBox[{"IntegerPart", "@", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", " ", 
          "\"\<Minutes\>\""}], " ", "]"}]}]}], ";", "\n", 
      RowBox[{"\[CapitalDelta]tSec", "=", 
       RowBox[{"IntegerPart", "@", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"FractionalPart", "@", 
           RowBox[{"UnitConvert", "[", 
            RowBox[{
             RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", 
             " ", "\"\<Minutes\>\""}], " ", "]"}]}], ",", " ", 
          "\"\<Seconds\>\""}], " ", "]"}]}]}], ";", "\n", 
      RowBox[{"Print", "[", " ", 
       RowBox[{"\"\<4 vortices loop timing \[CapitalDelta]t = \>\"", ",", 
        RowBox[{"ToString", "@", "\[CapitalDelta]tHours"}], ",", 
        "\"\< : \>\"", ",", 
        RowBox[{"ToString", "@", "\[CapitalDelta]tMin"}], ",", "\"\< : \>\"", 
        ",", 
        RowBox[{"ToString", "@", "\[CapitalDelta]tSec"}]}], "    ", "]"}]}]}],
     " ", "]"}], ";"}], "*)"}]], "Input",ExpressionUUID->"f4f80119-4d85-4b1b-\
a34a-3b705a11cc14"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subtitle",ExpressionUUID->"167d1afc-5ec2-47c0-a215-91af1c7d08ce"],

Cell["To do: ", "Subtitle",
 CellChangeTimes->{{3.902943683900139*^9, 
  3.902943687568568*^9}},ExpressionUUID->"eb28b657-6939-4d0b-96f9-\
17ecb59255e2"],

Cell[TextData[{
 "\[Times] Change W -> V  ",
 StyleBox["                                                                   \
                        ",
  FontWeight->"Bold"],
 " ",
 StyleBox["done",
  FontWeight->"Bold"],
 "\n\[Times] ",
 StyleBox["define mf energy   (via <> and eigenvalue)     ",
  FontWeight->"Bold"],
 StyleBox["                           ",
  FontWeight->"Bold"],
 StyleBox["done\n",
  FontWeight->"Bold"],
 "\[Times]     test  it for pure Kitaev h=0  ",
 StyleBox["                                                                \
done",
  FontWeight->"Bold"],
 "\n\[Times] Wilson loop  ( change order r and \[Sigma] )    ",
 StyleBox["                                          ",
  FontWeight->"Bold"],
 "  ",
 StyleBox["done",
  FontWeight->"Bold"],
 "\n\[Times] function Jmicro[t] output Jmat coupling for each t  ",
 StyleBox["                done",
  FontWeight->"Bold"],
 "\n\[Times] Change def parameters  (define DM as function of eV) ",
 StyleBox["            done",
  FontWeight->"Bold"],
 "\n\[Times] Define DM interaction as uniform 0 + 4v\n\[Times] Rewrite code \
for vortex free  (for 4v  then copy it making the trivial changes)\n\n"
}], "Text",
 CellChangeTimes->{{3.9029436907613115`*^9, 3.902943699776925*^9}, {
  3.9029437446225605`*^9, 3.902943802583638*^9}, {3.902944149757424*^9, 
  3.9029441730864925`*^9}, {3.902944375586528*^9, 3.902944422071251*^9}, {
  3.9029444606088433`*^9, 3.9029444693637924`*^9}, {3.9029448597412014`*^9, 
  3.9029448806464615`*^9}, {3.9029449631515136`*^9, 3.9029449866237817`*^9}, {
  3.9029450325880637`*^9, 3.9029450895618343`*^9}, {3.90294517989765*^9, 
  3.9029452093337307`*^9}, {3.9030117838884044`*^9, 3.9030118095826073`*^9}, {
  3.9030150071262054`*^9, 3.9030150078028717`*^9}, {3.903208046985075*^9, 
  3.903208107285267*^9}},ExpressionUUID->"bc7b4a9b-b6c4-48a6-99f0-\
23b0b7a120c5"]
}, Open  ]]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.7 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"30a32ddb-fa16-4b9b-9391-8058f56b62da"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 198, 3, 45, "Section",ExpressionUUID->"415c9f61-a31b-4391-823c-f2870c74e1aa"],
Cell[781, 27, 1954, 48, 74, "Input",ExpressionUUID->"6f9fb1b5-b826-4b31-9132-604e4661e681"],
Cell[CellGroupData[{
Cell[2760, 79, 201, 3, 31, "Subsubsection",ExpressionUUID->"2bab245a-01fa-44c7-b751-d57ae960babf"],
Cell[2964, 84, 4608, 131, 155, "Input",ExpressionUUID->"f0184288-61fc-41cb-a7d0-a5916251704c"],
Cell[7575, 217, 991, 28, 47, "Input",ExpressionUUID->"8fec6e4d-3d1c-490b-9399-dea6587b946c"],
Cell[8569, 247, 1846, 49, 47, "Input",ExpressionUUID->"06a805d6-3f79-43b4-80ea-7075d6508823"],
Cell[10418, 298, 2124, 66, 47, "Input",ExpressionUUID->"21eac056-e5f8-4675-b39a-f805e39b0180"],
Cell[12545, 366, 2824, 74, 100, "Input",ExpressionUUID->"196a36d5-1e02-49b5-b928-189dde5ba8b5"],
Cell[15372, 442, 1763, 49, 34, "Input",ExpressionUUID->"4213a20f-5ad4-4360-b9e0-617c213800cb"],
Cell[17138, 493, 998, 28, 23, "Input",ExpressionUUID->"21eb335b-74c5-44fa-a565-e51d1d1ddd5b"],
Cell[18139, 523, 12763, 284, 113, "Input",ExpressionUUID->"f80c03e2-74d5-4097-b8cb-f17bedf7607f"],
Cell[30905, 809, 1295, 35, 23, "Input",ExpressionUUID->"7a09828d-f575-4237-b329-52ea9ead9bca"],
Cell[32203, 846, 12191, 254, 220, "Input",ExpressionUUID->"46817649-1e32-4948-a463-af7375515378"]
}, Closed]],
Cell[CellGroupData[{
Cell[44431, 1105, 273, 4, 26, "Subsection",ExpressionUUID->"66e2a912-661e-4de4-8c26-c6934170dce4"],
Cell[CellGroupData[{
Cell[44729, 1113, 195, 3, 29, "Subsubsection",ExpressionUUID->"aa989c96-8c74-4b4a-9719-0a256d70b608"],
Cell[44927, 1118, 10496, 212, 306, "Input",ExpressionUUID->"0b1d8c6c-3246-4947-8bc0-288b138d209d"],
Cell[55426, 1332, 9178, 219, 390, "Code",ExpressionUUID->"544e050b-fff5-4e7c-b801-a70379cac8d6"]
}, Closed]],
Cell[CellGroupData[{
Cell[64641, 1556, 313, 5, 24, "Subsubsection",ExpressionUUID->"481ccb27-4efa-4a1b-b0a1-433a3d45e603"],
Cell[64957, 1563, 440, 10, 34, "Text",ExpressionUUID->"bda26fb8-b683-40a3-91c8-d47e91676755"],
Cell[65400, 1575, 1603, 36, 32, "Input",ExpressionUUID->"ea9fb8b5-cc52-4ef5-bb6f-3d99c940eda0"],
Cell[67006, 1613, 35368, 754, 608, "Input",ExpressionUUID->"f2915dff-fb33-4ed6-9988-91bfa27f058b"]
}, Closed]],
Cell[CellGroupData[{
Cell[102411, 2372, 242, 3, 26, "Subsubsection",ExpressionUUID->"34dac328-f6f0-43f0-aee3-cb143d586447"],
Cell[102656, 2377, 10675, 264, 390, "Input",ExpressionUUID->"27341382-f257-4496-9dc9-e70392e55115"],
Cell[113334, 2643, 11572, 294, 433, "Input",ExpressionUUID->"75dc91b6-2ba5-4b71-8e56-db4d9d758f83"],
Cell[124909, 2939, 252, 4, 24, "Text",ExpressionUUID->"3a7c1260-9853-40df-823e-7ac0bad83222"],
Cell[125164, 2945, 4185, 102, 96, "Input",ExpressionUUID->"7803c2ce-e2f3-4054-9a4c-cfd424ad2e64"],
Cell[129352, 3049, 2274, 59, 166, "Input",ExpressionUUID->"32a12fd4-6b04-4fa8-8921-0e1b06ab9778"],
Cell[131629, 3110, 226, 3, 24, "Text",ExpressionUUID->"9f3ab0b7-e36b-4339-a786-cd32ae12473b"],
Cell[131858, 3115, 2823, 66, 79, "Input",ExpressionUUID->"492db9da-0a1f-48f8-b014-291e7eb1ec50"],
Cell[134684, 3183, 9272, 223, 214, "Input",ExpressionUUID->"0e06b428-50bb-4179-a10e-15a5549a6dff"]
}, Closed]],
Cell[CellGroupData[{
Cell[143993, 3411, 206, 3, 24, "Subsubsection",ExpressionUUID->"082b1853-69cb-4515-a15e-ba6582944cba"],
Cell[144202, 3416, 9468, 251, 396, "Input",ExpressionUUID->"605b6fbc-7e7e-420c-b030-1c5336e2167d"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[153719, 3673, 158, 3, 27, "Subsection",ExpressionUUID->"790d9ca7-ba57-4940-b054-cfceed329436"],
Cell[CellGroupData[{
Cell[153902, 3680, 161, 3, 32, "Subsubsection",ExpressionUUID->"ac9c80e0-ac50-4e27-b393-99a0190e06d3"],
Cell[154066, 3685, 8671, 264, 220, "Input",ExpressionUUID->"26ba2ee8-5396-4639-b2b6-80e5e5c943d8"],
Cell[162740, 3951, 4095, 102, 108, "Input",ExpressionUUID->"d0ce5796-00d2-44df-8119-56473c029967"],
Cell[166838, 4055, 2892, 75, 81, "Input",ExpressionUUID->"e3a3bb23-1ed7-4858-bfcf-d3abc667a4a6"],
Cell[169733, 4132, 3849, 87, 101, "Input",ExpressionUUID->"54777c5c-751e-40be-a208-23b4cf7f1781"]
}, Closed]],
Cell[CellGroupData[{
Cell[173619, 4224, 158, 3, 27, "Subsubsection",ExpressionUUID->"1f5afdfa-dc4c-4a00-8688-f42b5073b989"],
Cell[173780, 4229, 3223, 87, 52, "Input",ExpressionUUID->"d8bc274c-06a5-4ae6-a5f5-488893b0ea80"],
Cell[177006, 4318, 17647, 434, 291, "Input",ExpressionUUID->"8f0586f9-c1a9-4b87-9063-b4bb29bf9443"],
Cell[194656, 4754, 785, 20, 21, "Input",ExpressionUUID->"f702e762-ce77-41ce-ad62-abe90276804a"],
Cell[195444, 4776, 2563, 54, 33, "Input",ExpressionUUID->"3eb0eb9b-d65d-43c2-9842-cacc20c6e560"],
Cell[198010, 4832, 735, 17, 21, "Input",ExpressionUUID->"5e55b3bb-8126-46b8-a50b-77090867de2b"],
Cell[198748, 4851, 1042, 25, 21, "Input",ExpressionUUID->"56b5f417-052a-4d40-ae63-c8fb9cc08094"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[199839, 4882, 258, 4, 36, "Subsection",ExpressionUUID->"0318476a-00b2-4dfc-9b63-3a22ad5f203f"],
Cell[CellGroupData[{
Cell[200122, 4890, 550, 8, 31, "Subsubsection",ExpressionUUID->"b71d4571-a688-41a0-930c-9da7a14bca46"],
Cell[200675, 4900, 529, 9, 22, "Text",ExpressionUUID->"fb7b3641-96cb-4bed-b03c-c6cf44a4b764"],
Cell[201207, 4911, 2791, 80, 89, "Input",ExpressionUUID->"f0c5c4d8-8323-43b3-9e5b-95b9cc6de7f9"],
Cell[204001, 4993, 1319, 35, 21, "Input",ExpressionUUID->"118d0bed-1fc6-47ff-8769-9499c4878a08"],
Cell[205323, 5030, 3649, 99, 60, "Input",ExpressionUUID->"209ca2b2-3b1d-40a7-842f-983acfb24eff"],
Cell[208975, 5131, 1591, 36, 60, "Input",ExpressionUUID->"fc4d5d20-75bd-4656-ab10-830001170971"],
Cell[210569, 5169, 469, 8, 22, "Text",ExpressionUUID->"e22cadd4-91eb-4583-8e63-ad2fd266acad"],
Cell[211041, 5179, 1548, 36, 100, "Input",ExpressionUUID->"4a8d010b-8cad-41cb-8c62-196ec1a1893b"],
Cell[212592, 5217, 5389, 121, 127, "Input",ExpressionUUID->"575eb2a2-01d7-4d66-8c20-b4aea72abfd5"],
Cell[217984, 5340, 4681, 105, 167, "Input",ExpressionUUID->"807f3ba5-2aef-4049-aea3-8f660cac15f9"],
Cell[222668, 5447, 556, 10, 22, "Text",ExpressionUUID->"297c7722-7294-4b07-a549-c0fa4766203d"],
Cell[223227, 5459, 1605, 43, 113, "Input",ExpressionUUID->"09917604-5614-4d44-b9d5-9d21d5a7d8a7"]
}, Closed]],
Cell[CellGroupData[{
Cell[224869, 5507, 278, 5, 25, "Subsubsection",ExpressionUUID->"89758110-0a30-4fa0-ad94-8c6848b529b0"],
Cell[225150, 5514, 947, 26, 21, "Input",ExpressionUUID->"e9ec061e-8742-4cb4-8771-20e212d3983a"],
Cell[226100, 5542, 4031, 118, 74, "Input",ExpressionUUID->"7b6e2af4-effe-4e1c-8193-f82a0e2a47b7"],
Cell[230134, 5662, 10268, 267, 133, "Input",ExpressionUUID->"6607212d-ab68-4a3c-9feb-c2c50dbddbb3"],
Cell[240405, 5931, 4576, 104, 147, "Input",ExpressionUUID->"f1470e9b-3fe3-4e66-94d3-615e42f9fb46"],
Cell[244984, 6037, 8573, 196, 98, "Input",ExpressionUUID->"a04abf83-75ac-4fe3-a3fa-1dc9618af95e"],
Cell[253560, 6235, 593, 18, 21, "Input",ExpressionUUID->"8cbf734c-61e8-4a65-b32f-a9aca70998d8"],
Cell[254156, 6255, 4775, 114, 86, "Input",ExpressionUUID->"4e63a703-f141-47f3-b08e-338c25c5f323"],
Cell[258934, 6371, 1918, 55, 41, "Input",ExpressionUUID->"ab3a2d95-6d51-476a-8e52-93ec3f131b36"],
Cell[260855, 6428, 4414, 103, 62, "Input",ExpressionUUID->"eff4ad7b-99d2-4cb6-8aee-329a987e753c"]
}, Closed]],
Cell[CellGroupData[{
Cell[265306, 6536, 269, 4, 26, "Subsubsection",ExpressionUUID->"b3e77d08-352b-4a7f-aa6e-6655b45d73f0"],
Cell[265578, 6542, 4928, 141, 100, "Input",ExpressionUUID->"d37ec3c5-abcc-4e5d-b6a4-5e9c0d44f4b4"],
Cell[270509, 6685, 30773, 777, 629, "Input",ExpressionUUID->"4f595269-c9d5-4b8e-9be1-753434b1bc87"],
Cell[301285, 7464, 3517, 93, 47, "Input",ExpressionUUID->"46979265-40c0-4da5-81d2-778e1f7d8218"],
Cell[304805, 7559, 1598, 44, 47, "Input",ExpressionUUID->"247d95a1-bf8f-431b-847d-f99a4a26dc9c"],
Cell[306406, 7605, 1221, 36, 21, "Input",ExpressionUUID->"3340ea2e-3efa-4880-b0e0-1592b4901db7"]
}, Closed]],
Cell[CellGroupData[{
Cell[307664, 7646, 256, 4, 26, "Subsubsection",ExpressionUUID->"c8642423-6c54-4e5b-bbfc-31fe829d8430"],
Cell[307923, 7652, 156, 3, 24, "Text",ExpressionUUID->"cab4f53f-a9ed-41c8-a8fe-51dab0829624"],
Cell[308082, 7657, 5192, 137, 66, "Input",ExpressionUUID->"e724c950-8902-4fbc-8d21-d9cd41715e69"],
Cell[313277, 7796, 7072, 158, 210, "Input",ExpressionUUID->"5c48473e-6e4d-477b-8c19-11e85689f659"],
Cell[320352, 7956, 9188, 203, 340, "Input",ExpressionUUID->"740095b0-2b72-4889-bdf9-861fb4f61bbe"],
Cell[329543, 8161, 1148, 32, 35, "Input",ExpressionUUID->"98434258-7224-4c9a-a9e3-674f75fe72d2"],
Cell[330694, 8195, 3327, 78, 123, "Input",ExpressionUUID->"97fb0b7f-4b9a-4f3e-9ad8-60103ac70714"],
Cell[334024, 8275, 336, 8, 40, "Text",ExpressionUUID->"13d8065b-58d8-4ebe-a7cc-39eba5cb54de"],
Cell[334363, 8285, 28848, 602, 444, "Input",ExpressionUUID->"3f4bae56-6c1d-4a7f-acad-165d3de18001"]
}, Closed]],
Cell[CellGroupData[{
Cell[363248, 8892, 267, 4, 27, "Subsubsection",ExpressionUUID->"1f33cda0-a6a0-4bff-91bf-11e7d8dd3cb5"],
Cell[363518, 8898, 8229, 191, 207, "Input",ExpressionUUID->"629fd037-c3e2-4a7e-90b0-4492629474f0"],
Cell[371750, 9091, 884, 23, 34, "Input",ExpressionUUID->"f85dc0d5-82a0-43e5-9241-9d68e8519105"],
Cell[372637, 9116, 658, 18, 21, "Input",ExpressionUUID->"22e72a6a-b20a-4975-ae94-b9fee4928764"],
Cell[373298, 9136, 13347, 291, 264, "Input",ExpressionUUID->"1c6a9ee3-0ca7-4512-9668-41dbee4fa656"],
Cell[386648, 9429, 13120, 320, 234, "Input",ExpressionUUID->"6b2aa10b-6863-4d41-8279-aaa4bda5a264"]
}, Closed]],
Cell[CellGroupData[{
Cell[399805, 9754, 205, 3, 26, "Subsubsection",ExpressionUUID->"fb707ad5-d51c-41d2-af20-83e7f8e31aac"],
Cell[400013, 9759, 5253, 160, 110, "Input",ExpressionUUID->"600637bf-5f6c-43c2-9da3-a1bbbdae2672"],
Cell[405269, 9921, 1418, 39, 98, "Input",ExpressionUUID->"4a25d347-b1d0-4ff4-82f8-033288d5e68f"],
Cell[406690, 9962, 1044, 27, 35, "Input",ExpressionUUID->"3b847d4e-4356-4bc0-883e-210d5ddbb2fe"],
Cell[407737, 9991, 1407, 36, 21, "Input",ExpressionUUID->"5c5949c5-1125-4374-aff4-f4d575819c46"],
Cell[409147, 10029, 6618, 178, 241, "Input",ExpressionUUID->"c5a5ca6f-b4ef-4a94-b744-cdbd67da976c"],
Cell[415768, 10209, 22088, 524, 461, "Input",ExpressionUUID->"450104ff-c0e4-4961-8842-e1410ab8bc09"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[437917, 10740, 190, 3, 50, "Section",ExpressionUUID->"65386cf6-13ec-4e69-bf3a-0864eae5c417"],
Cell[438110, 10745, 4541, 118, 167, "Input",ExpressionUUID->"ea4ba569-ecd9-46a1-8d24-6107708ff42b"],
Cell[CellGroupData[{
Cell[442676, 10867, 174, 3, 32, "Subsubsection",ExpressionUUID->"518e5963-48fb-4611-9a4f-2d9efd8b8a9c"],
Cell[442853, 10872, 161, 3, 21, "Input",ExpressionUUID->"adfb33b3-6a78-4ee0-8624-0b7219aea1b5"],
Cell[443017, 10877, 324, 8, 21, "Input",ExpressionUUID->"7888595a-9394-40b0-bcdc-a5e9fb80488c"],
Cell[443344, 10887, 504, 12, 21, "Input",ExpressionUUID->"88864d89-6cbc-45ba-accf-039b77e8c46b"],
Cell[CellGroupData[{
Cell[443873, 10903, 19795, 431, 496, "Input",ExpressionUUID->"e4fa8dea-8c84-40a8-8e96-2b6713ba6c8d"],
Cell[CellGroupData[{
Cell[463693, 11338, 623, 14, 17, "Print",ExpressionUUID->"4599635a-e50c-4762-8e2a-dd3294a67ca2"],
Cell[464319, 11354, 663, 14, 17, "Print",ExpressionUUID->"cdf4d0b6-26a1-4b65-8072-d18bd130fb6d"],
Cell[464985, 11370, 667, 14, 17, "Print",ExpressionUUID->"cde325a5-9088-4b77-b3aa-ca7a3bc84564"],
Cell[465655, 11386, 662, 14, 17, "Print",ExpressionUUID->"57b11ae0-1d67-4359-aa0d-bc9d6e0e378a"],
Cell[466320, 11402, 666, 14, 17, "Print",ExpressionUUID->"6ccd05cd-ac3a-4b74-bf19-0e2b9a46d613"],
Cell[466989, 11418, 667, 14, 17, "Print",ExpressionUUID->"151676a2-f6db-485c-8126-cb1bfff479a8"]
}, Open  ]],
Cell[467671, 11435, 209, 4, 23, "Output",ExpressionUUID->"fe7c19ae-92d5-4748-b99f-02575de19ad6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[467917, 11444, 592, 16, 21, "Input",ExpressionUUID->"0fc21723-198e-408b-8f10-9752906b4fd6"],
Cell[468512, 11462, 1414, 36, 170, "Output",ExpressionUUID->"1fa5be0e-271e-4858-931a-92249cc3c80e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[469963, 11503, 322, 8, 21, "Input",ExpressionUUID->"cfb7cda2-97d4-41a1-8673-5d17c760ca55"],
Cell[470288, 11513, 1589, 42, 168, "Output",ExpressionUUID->"003c06f5-351c-41f2-a15b-a18718830519"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[471926, 11561, 101, 0, 32, "Subsubsection",ExpressionUUID->"2265bcee-baf6-4281-ae07-a0d367c545b4"],
Cell[472030, 11563, 9578, 227, 390, "Input",ExpressionUUID->"6ab80606-4180-4a50-9ad6-f692f57c78d5"]
}, Closed]],
Cell[CellGroupData[{
Cell[481645, 11795, 110, 1, 27, "Subsubsection",ExpressionUUID->"ac67c233-9311-4236-9c27-b4d81ab07561"],
Cell[481758, 11798, 641, 15, 34, "Input",ExpressionUUID->"984bbfad-0c2e-4664-a92e-05e03865d0f1"],
Cell[482402, 11815, 5054, 114, 233, "Input",ExpressionUUID->"6c30ca45-decf-419b-b51e-ad5ca7f8bd20"]
}, Open  ]],
Cell[CellGroupData[{
Cell[487493, 11934, 189, 2, 32, "Subsubsection",ExpressionUUID->"b8305b6a-2c62-41ce-8c80-77867ba76771"],
Cell[CellGroupData[{
Cell[487707, 11940, 31195, 668, 634, "Input",ExpressionUUID->"7c53b24b-97ed-42f4-b1f3-ad91c9967140"],
Cell[CellGroupData[{
Cell[518927, 12612, 2210, 45, 38, "Print",ExpressionUUID->"b30454b8-5dc9-4735-8d9f-deaa144b4fb0"],
Cell[521140, 12659, 1523, 28, 17, "Print",ExpressionUUID->"397d7192-d9f7-455f-8af0-674ac6c73cb8"],
Cell[522666, 12689, 1564, 28, 17, "Print",ExpressionUUID->"c1f8859c-0a01-450a-b068-a52723e0b148"],
Cell[524233, 12719, 1568, 28, 17, "Print",ExpressionUUID->"ac11b2a2-7f4f-4c0c-9dac-691514b25f3e"],
Cell[525804, 12749, 1565, 28, 17, "Print",ExpressionUUID->"d262f394-2d79-4ea3-a4fc-006668f2c58a"],
Cell[527372, 12779, 1567, 28, 17, "Print",ExpressionUUID->"183590f1-13d2-47a2-8c3f-9dd57527ed1c"],
Cell[528942, 12809, 1564, 28, 17, "Print",ExpressionUUID->"bef0bdc4-bc6a-417c-bad0-890e28f693a0"],
Cell[530509, 12839, 1839, 34, 17, "Print",ExpressionUUID->"89302171-1c89-41c0-9a59-ef451f3a08d3"],
Cell[532351, 12875, 1146, 18, 17, "Print",ExpressionUUID->"d943d81e-25a7-4f92-a72d-e5c4392bbdef"]
}, Open  ]]
}, Open  ]],
Cell[533524, 12897, 152, 3, 21, "Input",ExpressionUUID->"0d3574bf-bb61-49e5-a638-e8ee9f3c9bfd"],
Cell[533679, 12902, 171, 3, 34, "Input",ExpressionUUID->"680aeb83-633c-4391-97cc-8f5744c616e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[533887, 12910, 147, 1, 32, "Subsubsection",ExpressionUUID->"40080617-38e9-4a1e-9c8d-1625a3134e05"],
Cell[534037, 12913, 1373, 34, 87, "Input",ExpressionUUID->"ba2d58c4-5a69-4a6a-97fc-44415c31ec86"],
Cell[535413, 12949, 31074, 711, 776, "Input",ExpressionUUID->"32f352b1-0055-4210-b9fc-bdd230ac7c7b"],
Cell[566490, 13662, 45452, 993, 1349, "Code",ExpressionUUID->"516d261c-68fc-436c-b4cb-6a2feb104a84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[611979, 14660, 147, 1, 32, "Subsubsection",ExpressionUUID->"45c87f90-eb26-4fda-b817-fed84e6974f5"],
Cell[612129, 14663, 2148, 52, 121, "Code",ExpressionUUID->"5804fa87-423d-4ed1-9961-5b40631e42e4"],
Cell[614280, 14717, 42230, 923, 1240, "Code",ExpressionUUID->"2aa113d0-4418-4f12-b1bb-136a7ea131a3"],
Cell[656513, 15642, 1810, 42, 97, "Code",ExpressionUUID->"40b41d05-2995-45c1-bd37-7b7242f5afbc"],
Cell[658326, 15686, 1870, 43, 73, "Input",ExpressionUUID->"f4f80119-4d85-4b1b-a34a-3b705a11cc14"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[660245, 15735, 75, 0, 37, "Subtitle",ExpressionUUID->"167d1afc-5ec2-47c0-a215-91af1c7d08ce"],
Cell[660323, 15737, 153, 3, 37, "Subtitle",ExpressionUUID->"eb28b657-6939-4d0b-96f9-17ecb59255e2"],
Cell[660479, 15742, 1867, 43, 169, "Text",ExpressionUUID->"bc7b4a9b-b6c4-48a6-99f0-23b0b7a120c5"]
}, Open  ]]
}
]
*)

