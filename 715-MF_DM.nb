(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    437070,      10306]
NotebookOptionsPosition[    428161,      10175]
NotebookOutlinePosition[    428598,      10192]
CellTagsIndexPosition[    428555,      10189]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions ", "Section",
 CellChangeTimes->{{3.870756830253976*^9, 3.870756834033395*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"415c9f61-a31b-4391-823c-f2870c74e1aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NbName", " ", "=", " ", "\"\<715\>\""}], ";", 
  RowBox[{"Needs", "[", "\"\<MaTeX`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ls", " ", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"32", ",", "32", ",", "2"}], "]"}]}], ";", " \t    ", 
  RowBox[{"tV", "=", 
   RowBox[{"{", "0", "}"}]}], ";", "\t   ", 
  RowBox[{"hV", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0.2", ",", "0", ",", "0"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"steps", "=", "600"}], ";", "                                     ", 
  RowBox[{"acuracy", "=", "3"}], ";", "    ", 
  RowBox[{"\[CapitalDelta]eV", "=", "0.099999"}], ";", " ", 
  RowBox[{"eVs", "=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"1700", " ", "\[Xi]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Xi]", ",", "0", ",", "0", ",", "\[CapitalDelta]eV"}], 
      "}"}]}], " ", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Js", "=", 
   RowBox[{"{", "0.", "}"}]}], ";", " ", 
  RowBox[{"Ks", "=", 
   RowBox[{"{", 
    RowBox[{"-", "1."}], "}"}]}], ";", " ", 
  RowBox[{"\[CapitalGamma]s", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"\[Gamma]", ",", 
     RowBox[{"{", 
      RowBox[{"\[Gamma]", ",", "0.", ",", ".0", ",", ".2"}], "}"}]}], "]"}]}],
   ";", " ", 
  RowBox[{"hV", "=", 
   RowBox[{"{", "  ", 
    RowBox[{"{", 
     RowBox[{"0.10", ",", "0", ",", "0"}], "}"}], "  ", "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.902507042162265*^9, 3.902507101695835*^9}, {
  3.9025079579684677`*^9, 3.9025079589810476`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"6f9fb1b5-b826-4b31-9132-604e4661e681"],

Cell[CellGroupData[{

Cell["Constants", "Subsubsection",
 CellChangeTimes->{{3.861809041310557*^9, 3.861809045921008*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"2bab245a-01fa-44c7-b751-d57ae960babf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"one", "[", 
    RowBox[{"i_", ",", "j_", ",", "N_"}], "]"}], ":=", " ", 
   RowBox[{"SparseArray", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], " ", "->", " ", "1"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"N", ",", "N"}], "}"}]}], "]"}]}], ";", "  ", 
  RowBox[{
   RowBox[{"block", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", " ", 
   RowBox[{"one", "[", 
    RowBox[{"i", ",", "j", ",", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hc", "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["3"]], 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], ";", 
  RowBox[{"hb", "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ";", 
  RowBox[{"ha", "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["6"]], 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "2"}]}], "}"}]}]}], ";", 
  RowBox[{"hx", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"hAngle", "[", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"ha", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}]}], "+", 
     RowBox[{"hb", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}]}], "+", " ", 
     RowBox[{"hc", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", " ", 
        FractionBox["\[Pi]", "180"]}], "]"}]}]}]}], " ", ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Magnetic", " ", "field", " ", "directions", " ", "a"}], ",", " ",
     "b", ",", " ", "c"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nx", "=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "2"], ",", 
      FractionBox[
       SqrtBox["3"], "2"]}], "}"}]}], ";", "  ", 
   RowBox[{"ny", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], ",", 
      FractionBox[
       SqrtBox["3"], "2"]}], "}"}]}], ";"}], 
  "                                                                           \
                ", 
  RowBox[{"(*", " ", 
   RowBox[{"Honeycomb", " ", "Bravais", " ", "basis"}], "  ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]x", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SqrtBox["3"]}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "/", 
     SqrtBox["3"]}]}], ";", "      ", 
   RowBox[{"\[Delta]y", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SqrtBox["3"], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "/", 
     SqrtBox["3"]}]}], ";", "        ", 
   RowBox[{"\[Delta]z", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "/", 
     SqrtBox["3"]}]}], ";"}], "   ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.852875554334752*^9, 3.8528756416630793`*^9}, {
   3.852875707963123*^9, 3.8528757293829327`*^9}, {3.8528838103795214`*^9, 
   3.8528838199064527`*^9}, {3.852891095679292*^9, 3.852891101317895*^9}, 
   3.85291623528564*^9, {3.8530724478837347`*^9, 3.853072467383951*^9}, {
   3.853223823970704*^9, 3.853223825094236*^9}, {3.8532525067709403`*^9, 
   3.8532525210040092`*^9}, {3.8532623077558775`*^9, 3.853262326616273*^9}, 
   3.8618090181133766`*^9, {3.861809058521018*^9, 3.8618093034580317`*^9}, {
   3.8684474692027063`*^9, 3.868447503152372*^9}, {3.8756388207891245`*^9, 
   3.8756388214349976`*^9}, {3.8756388621420355`*^9, 
   3.8756389093536043`*^9}, {3.8774129521164646`*^9, 
   3.8774129645832286`*^9}, {3.877413300921214*^9, 3.877413302630044*^9}, {
   3.877514698765851*^9, 3.8775147145600615`*^9}, {3.877514752094112*^9, 
   3.877514765792674*^9}, {3.877514804203418*^9, 3.8775148687992797`*^9}, {
   3.9025086257772474`*^9, 3.9025086393454986`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[32]:=",ExpressionUUID->"f0184288-61fc-41cb-a7d0-a5916251704c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"asites", "[", 
    RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"m", " ", "nx"}], "+", 
    RowBox[{"n", " ", "ny"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bsites", "[", 
    RowBox[{"m_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"m", " ", "nx"}], "+", 
    RowBox[{"n", " ", "ny"}], "-", "\[Delta]z"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]sites", "[", 
    RowBox[{"m_", ",", "n_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"m", " ", "nx"}], "+", 
    RowBox[{"n", " ", "ny"}], "-", 
    RowBox[{"\[Sigma]", " ", "\[Delta]z"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8866569972777066`*^9, 3.886657020522487*^9}, {
  3.9025072828234053`*^9, 3.9025072841056433`*^9}, {3.902944568684369*^9, 
  3.9029445698528204`*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"8fec6e4d-3d1c-490b-9399-dea6587b946c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"to\[Lambda]", "[", 
    RowBox[{"h_", ",", 
     RowBox[{"\[CapitalDelta]v_", ":", "0.262"}]}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], ",", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], ",", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "}"}], "/", 
    "\[CapitalDelta]v"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"toKappa", "[", 
    RowBox[{"h_", ",", 
     RowBox[{"\[CapitalDelta]v_", ":", "0.262"}]}], "]"}], ":=", 
   RowBox[{"8", 
    RowBox[{"h", "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{"h", "[", 
     RowBox[{"[", "2", "]"}], "]"}], 
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/", 
     RowBox[{"(", "  ", 
      RowBox[{"3", " ", 
       RowBox[{"\[CapitalDelta]v", "^", "2"}]}], " ", ")"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KappaToH", "[", 
    RowBox[{"\[Kappa]_", ",", "d_", ",", 
     RowBox[{"\[CapitalDelta]v_", ":", "0.262"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"C", "=", 
       RowBox[{
        RowBox[{"d", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"d", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"d", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"C", "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "  ", 
       RowBox[{"d", " ", 
        RowBox[{"CubeRoot", "[", 
         RowBox[{"3", "  ", 
          RowBox[{"\[CapitalDelta]v", "^", "2"}], " ", 
          RowBox[{"\[Kappa]", "/", 
           RowBox[{"(", 
            RowBox[{"8", "C"}], ")"}]}]}], "]"}]}]}], "   ", "]"}]}], "]"}]}],
   " ", ";"}]}], "Input",
 CellChangeTimes->{3.9025074785789137`*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"21eac056-e5f8-4675-b39a-f805e39b0180"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Chi]Gx", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5249", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"\[Chi]Gy", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5249", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"\[Chi]Gz", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5249", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]GA", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[ImaginaryI]", ",", "0.000001", ",", "0.000001", ",", "0.000001"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.000001"}], ",", "\[ImaginaryI]", ",", "0.000001", ",", 
       RowBox[{"-", "0.000001"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.000001"}], ",", 
       RowBox[{"-", "0.000001"}], ",", "\[ImaginaryI]", ",", "0.000001"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.000001"}], ",", "0.000001", ",", 
       RowBox[{"-", "0.000001"}], ",", "\[ImaginaryI]"}], "}"}]}], "}"}]}], 
  ";", " ", 
  RowBox[{"\[Omega]GB", " ", "=", " ", "\[Omega]GA"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Uguess", "=", 
   RowBox[{"{", 
    RowBox[{"\[Chi]Gx", ",", "\[Chi]Gy", ",", "\[Chi]Gz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vguess", "=", 
   RowBox[{"{", 
    RowBox[{"\[Omega]GA", ",", "\[Omega]GB"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8756389250988274`*^9, 3.8756389252703004`*^9}, {
  3.8866758705491185`*^9, 3.8866758792792473`*^9}, {3.902944517715661*^9, 
  3.902944564543311*^9}},
 FontFamily->
  "Consolas",ExpressionUUID->"196a36d5-1e02-49b5-b928-189dde5ba8b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"to3digits", "[", "list0_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list", "=", "list0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "list"}], ">=", "3"}], ",", " ", "list", ",", 
        " ", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "0", "}"}], ",", "list"}], "}"}], ",", "1"}], 
           "]"}]}], ";", " ", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "list"}], ">=", "3"}], ",", " ", "list", 
           ",", "  ", 
           RowBox[{"list", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "0", "}"}], ",", "list"}], "}"}], ",", "1"}], 
             "]"}]}]}], " ", "]"}]}]}], " ", "]"}], ";", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"ToString", "/@", "list"}], "]"}]}]}], "     ", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.88667315304346*^9, 3.8866733181688857`*^9}, {
  3.8866733576133575`*^9, 3.8866733752979927`*^9}, {3.886673930696776*^9, 
  3.8866739736944337`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"4213a20f-5ad4-4360-b9e0-617c213800cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Gmat", "=", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], " ", "]"}], ",", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", "\[ImaginaryI]"}], " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", 
       RowBox[{"PauliMatrix", "[", "3", "]"}]}], " ", "]"}], ",", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", "  ", 
       RowBox[{"PauliMatrix", "[", "1", "]"}]}], " ", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mmat", "=", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "3", "]"}], ",", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], " ", "]"}], ",", 
     RowBox[{"KroneckerProduct", "[", " ", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", 
       RowBox[{"PauliMatrix", "[", "0", "]"}]}], " ", "]"}], ",", 
     RowBox[{"KroneckerProduct", "[", "  ", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "1", "]"}], ",", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], " ", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nmat", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Mmat", "-", "Gmat"}], ")"}], "/", "2"}]}], ";"}]}], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"06a805d6-3f79-43b4-80ea-7075d6508823"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UpperLeft8x8", "[", "matrice_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], " ", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpperRight8x8", "[", "matrice_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LowerLeft8x8", "[", "matrice_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LowerRight8x8", "[", "matrice_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"matrice", "\[LeftDoubleBracket]", 
        RowBox[{"4", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"b400fb06-4a4d-4c53-b98e-c3db057cf663"]
}, Closed]],

Cell[CellGroupData[{

Cell["Pure Kitaev model definitions", "Subsection",
 CellChangeTimes->{{3.8707569815383644`*^9, 3.8707569829934263`*^9}, {
  3.9029446078075714`*^9, 3.902944616787716*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"66e2a912-661e-4de4-8c26-c6934170dce4"],

Cell[CellGroupData[{

Cell["file", "Subsubsection",
 CellChangeTimes->{{3.87742012187215*^9, 3.877420123272871*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"aa989c96-8c74-4b4a-9719-0a256d70b608"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"dataToFilePure", "[", " ", 
     RowBox[{
     "parameters_", ",", "L_", ",", "acuracy_", ",", "gauge_", ",", "data_"}],
      "]"}], " ", ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"path", ",", "f"}], "}"}], ",", "\t\t", 
      RowBox[{
       RowBox[{"createDir", "@", 
        RowBox[{"FileNameJoin", "[", "  ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<Files\>\"",
            ",", "\"\<pure\>\"", ",", " ", "gauge"}], "}"}], "]"}]}], " ", 
       ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"path", " ", "=", " ", 
        RowBox[{"toPathPure", "[", 
         RowBox[{"parameters", ",", "L", ",", "acuracy", ",", "gauge"}], 
         "]"}]}], ";", "\t\t", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"OpenWrite", "[", "path", "]"}]}], ";", "\[IndentingNewLine]",
        "\t\t ", 
       RowBox[{"Write", "[", " ", 
        RowBox[{"f", ",", " ", "data"}], "]"}], ";", "\[IndentingNewLine]", 
       "\t\t ", 
       RowBox[{"Close", "[", "f", "]"}], ";"}]}], "                ", "]"}]}],
    ";", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"toPathPure", "[", 
       RowBox[{"\[Kappa]_", ",", "L_", ",", "K_", ",", "gauge_"}], "]"}], ":=",
       "  ", "\[IndentingNewLine]", 
      RowBox[{"FileNameJoin", "[", "  ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<Files\>\"", 
         ",", "\"\<pure\>\"", ",", " ", "gauge", ",", "\"\<data\>\"", ",", 
         " ", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"\"\<K=Z-L=Y-kappa=M.txt\>\"", ",", "     ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Y\>\"", "\[Rule]", " ", 
              RowBox[{"ToString", "[", "L", "]"}]}], ",", " ", 
             RowBox[{"\"\<M\>\"", "->", "  ", 
              RowBox[{"ToString", "@", 
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{"Round", "[", 
                  RowBox[{"10000", "\[Kappa]"}], "]"}], "/", "10000"}], 
                "]"}]}]}], "  ", ",", " ", 
             RowBox[{"\"\<Z\>\"", "\[Rule]", " ", 
              RowBox[{"ToString", "[", "K", "]"}]}]}], "}"}]}], "   ", 
          "]"}]}], " ", "}"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toPathPure", "[", 
     RowBox[{"parameters0_", ",", "L_", ",", "acuracy_", ",", "gauge_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h", " ", ",", "hS", ",", 
        RowBox[{"parameters", "=", "parameters0"}], ",", " ", "r", ",", 
        "\[Phi]", ",", "\[Theta]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"h", "=", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], " ", ";", 
       RowBox[{"hS", "=", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], ";", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "=", "hS"}], 
       ";", "   ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", "       ", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "   ", ",", " ", 
          "\"\<Files\>\"", " ", ",", "\"\<pure\>\"", ",", "gauge", ",", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<X1\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X2\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "10", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X3\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "3"}], "]"}], "]"}], "  ", "]"}]}], ",", 
              RowBox[{"\"\<X4\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ";;", "7"}], "]"}], "]"}], "]"}]}]}], "   ", 
             "}"}]}], "]"}], " ", ",", " ", "\"\<data\>\"", "  ", ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"\"\<h=(M,N,T)_L=Y_A=Z.txt\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Y\>\"", "\[Rule]", " ", 
               RowBox[{"ToString", "[", "L", "]"}]}], ",", " ", 
              RowBox[{"\"\<Z\>\"", "\[Rule]", " ", 
               RowBox[{"ToString", "[", "acuracy", "]"}]}], ",", 
              RowBox[{"\"\<M\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"r", ",", "InputForm"}], "]"}]}], " ", ",", 
              RowBox[{"\"\<N\>\"", "->", 
               RowBox[{"ToString", "@", "\[Phi]"}]}], ",", 
              RowBox[{"\"\<T\>\"", "->", 
               RowBox[{"ToString", "@", "\[Theta]"}]}]}], "}"}]}], "   ", 
           "]"}]}], " ", "\[IndentingNewLine]", "   ", "}"}], "]"}]}]}], 
     "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"loadDataPure", "[", " ", "path_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"(*", 
        RowBox[{"path", ","}], "*)"}], 
       RowBox[{"f", ",", "data"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"path", "=", " ", 
         RowBox[{"toPathPure", "[", 
          RowBox[{"\[Kappa]", ",", "L", ",", "K", ",", "gauge"}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"ReadList", "[", " ", "f", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Close", "[", "f", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}]}], "  ", "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8254288065377936`*^9, 3.825428841713072*^9}, {
   3.8254288747294965`*^9, 3.8254289327034874`*^9}, {3.8254290690244417`*^9, 
   3.825429086830716*^9}, {3.8254292125632935`*^9, 3.8254292153062105`*^9}, 
   3.825432723019988*^9, {3.8254327912552967`*^9, 3.8254327941640835`*^9}, {
   3.825440990645873*^9, 3.825440994901019*^9}, {3.825441345260458*^9, 
   3.8254413466537695`*^9}, {3.8254506418782215`*^9, 3.825450650290518*^9}, {
   3.8529094705191126`*^9, 3.8529094720186415`*^9}, {3.8529095483702064`*^9, 
   3.852909565665416*^9}, {3.8529100872088737`*^9, 3.8529101044886456`*^9}, {
   3.8529101826546993`*^9, 3.852910202458308*^9}, {3.8529102358757887`*^9, 
   3.852910254145278*^9}, {3.8529102940457497`*^9, 3.8529103018660717`*^9}, {
   3.8529104251789255`*^9, 3.8529104549253473`*^9}, {3.852910494328519*^9, 
   3.8529105245381174`*^9}, {3.8529106309948378`*^9, 3.852910651544997*^9}, {
   3.8529107284973173`*^9, 3.852910740886837*^9}, {3.8529107809069815`*^9, 
   3.8529108119113445`*^9}, {3.8529108541822195`*^9, 3.852910856718191*^9}, {
   3.852911119263612*^9, 3.8529111230151443`*^9}, {3.852916225986535*^9, 
   3.852916233148164*^9}, {3.852979650926306*^9, 3.8529796519995484`*^9}, {
   3.8532414494729376`*^9, 3.8532414537045374`*^9}, {3.853260268042261*^9, 
   3.8532602690024405`*^9}, {3.8532603499747133`*^9, 
   3.8532603678235893`*^9}, {3.853349821217956*^9, 3.8533498376884365`*^9}, 
   3.8547828543456783`*^9, 3.854783320313581*^9, {3.8547845534831142`*^9, 
   3.8547845750219774`*^9}, {3.854784619736085*^9, 3.854784626696515*^9}, {
   3.854784725426998*^9, 3.854784780462199*^9}, {3.8547852446459894`*^9, 
   3.854785251104698*^9}, {3.8547854491808615`*^9, 3.8547854526048017`*^9}, {
   3.8547910057811832`*^9, 3.854791009081539*^9}, {3.8547910548772345`*^9, 
   3.854791056931079*^9}, {3.8558411929567842`*^9, 3.855841196611833*^9}, {
   3.861193020602044*^9, 3.861193030883548*^9}, {3.8611930900547967`*^9, 
   3.861193205795993*^9}, 3.8611932648361797`*^9, {3.861193315349481*^9, 
   3.8611933398511276`*^9}, {3.8612000529305067`*^9, 3.861200068056779*^9}, {
   3.8617845376579056`*^9, 3.8617846931129293`*^9}, {3.861990537785631*^9, 
   3.8619905742347116`*^9}, 3.8619912018233023`*^9, {3.861991891824879*^9, 
   3.8619919036598415`*^9}, {3.8619920045658207`*^9, 3.8619920571249347`*^9}, 
   3.8619921109610553`*^9, {3.8619922627760134`*^9, 3.8619922639319153`*^9}, {
   3.8707570031663084`*^9, 3.870757003838168*^9}, {3.8707577719901476`*^9, 
   3.870757814650009*^9}, {3.87075793121721*^9, 3.8707579356736717`*^9}, {
   3.8707704850725055`*^9, 3.87077048522886*^9}, {3.8707705281715193`*^9, 
   3.870770571436262*^9}, 3.870776445075299*^9, {3.870776903341896*^9, 
   3.870776923748447*^9}, {3.8829597232317047`*^9, 3.88295974596167*^9}, 
   3.883733848765046*^9, {3.8933180048306646`*^9, 3.8933180152257133`*^9}, {
   3.8933180942233677`*^9, 3.8933180989522038`*^9}, {3.8933181808053684`*^9, 
   3.8933181882741013`*^9}, {3.8933182229931817`*^9, 3.893318223486579*^9}, 
   3.8933182630526695`*^9, {3.8933182993574038`*^9, 3.8933183407805524`*^9}, {
   3.8933183931911516`*^9, 3.8933184015744143`*^9}, {3.8933187046974554`*^9, 
   3.8933187198398533`*^9}, {3.893387496319642*^9, 3.8933875006442747`*^9}, {
   3.893835697803788*^9, 3.893835697807776*^9}, 3.8938361474724445`*^9, 
   3.8944372476955523`*^9},
 FontFamily->"Consolas",
 CellLabel->"In[51]:=",ExpressionUUID->"0b1d8c6c-3246-4947-8bc0-288b138d209d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dataToFilePure", "[", " ", 
     RowBox[{
     "parameters0_", ",", "L_", ",", "acuracy_", ",", "gauge_", ",", 
      "data_"}], "]"}], " ", ":=", "\n", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"path", ",", 
        RowBox[{"parameters", "=", "parameters0"}], ",", "f"}], "}"}], ",", 
      "\t\t", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"createDir", "@", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Files\>\"", 
            ",", "\"\<pure\>\"", ",", " ", "gauge"}], "}"}], "]"}]}], " ", 
        ";"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "=", "0"}], ";", "\n", 
       RowBox[{"createDir", "@", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Files\>\"", 
           ",", "\"\<pure\>\"", ",", "gauge", ",", " ", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\"", ",", "\n", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<X1\>\"", "->", "  ", 
                RowBox[{"ToString", "[", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", "9", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<X2\>\"", "->", "  ", 
                RowBox[{"ToString", "[", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", "10", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"\"\<X3\>\"", "->", "  ", 
                RowBox[{"ToString", "[", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "3"}], "]"}], "]"}], "  ", "]"}]}], ",", 
               RowBox[{"\"\<X4\>\"", "->", "  ", 
                RowBox[{"ToString", "[", 
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"5", ";;", "7"}], "]"}], "]"}], "]"}]}]}], "   ", 
              "}"}]}], "]"}]}], "\n", "           ", "}"}], "]"}]}], " ", ";",
        "\n", "\t\t", 
       RowBox[{"path", " ", "=", " ", 
        RowBox[{"toPathPure", "[", 
         RowBox[{"parameters", ",", "L", ",", "acuracy", ",", "gauge"}], 
         "]"}]}], ";", "\t\t", "\n", "\t\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Pure path=\>\"", ",", "path"}], "]"}], ";", 
       RowBox[{"Print", "[", "]"}], ";", "\n", "\t\t", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"OpenWrite", "[", "path", "]"}]}], ";", "\n", "\t\t ", 
       RowBox[{"Write", "[", " ", 
        RowBox[{"f", ",", " ", "data"}], "]"}], ";", "\n", "\t\t ", 
       RowBox[{"Close", "[", "f", "]"}], ";"}]}], "                ", "]"}]}],
    ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"toPathPure", "[", 
     RowBox[{"parameters0_", ",", "L_", ",", "acuracy_", ",", "gauge_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h", " ", ",", "hS", ",", 
        RowBox[{"parameters", "=", "parameters0"}], ",", " ", "r", ",", 
        "\[Phi]", ",", "\[Theta]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"h", "=", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], " ", ";", 
       RowBox[{"hS", "=", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], ";", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "=", "hS"}], 
       ";", "   ", "\n", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"parameters", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "=", "0"}], ";", "\n", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<Files\>\"", 
          " ", ",", "\"\<pure\>\"", ",", "gauge", ",", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\"", ",", "\n", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<X1\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X2\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "10", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X3\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "3"}], "]"}], "]"}], "  ", "]"}]}], ",", 
              "\n", 
              RowBox[{"\"\<X4\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ";;", "7"}], "]"}], "]"}], "]"}]}]}], "   ", 
             "}"}]}], "]"}], " ", ",", " ", "\"\<data\>\"", "  ", ",", " ", 
          "\n", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"\"\<h=(M,N,T)_L=Y_A=Z.txt\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Y\>\"", "->", " ", 
               RowBox[{"ToString", "[", "L", "]"}]}], ",", " ", 
              RowBox[{"\"\<Z\>\"", "->", " ", 
               RowBox[{"ToString", "[", "acuracy", "]"}]}], ",", 
              RowBox[{"\"\<M\>\"", "->", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"r", ",", "InputForm"}], "]"}]}], " ", ",", 
              RowBox[{"\"\<N\>\"", "->", 
               RowBox[{"ToString", "@", "\[Phi]"}]}], ",", 
              RowBox[{"\"\<T\>\"", "->", 
               RowBox[{"ToString", "@", "\[Theta]"}]}]}], "}"}]}], "   ", 
           "]"}]}], " ", "\n", "   ", "}"}], "]"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"loadDataPure", "[", "path_", "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "data"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"f", "==", "$Failed"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Failed to OpenRead file at: \>\"", "]"}], 
         ";", " ", 
         RowBox[{"Print", "[", " ", "path", " ", "]"}], ";", " ", 
         RowBox[{"Abort", "[", "]"}]}]}], " ", "]"}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{"ReadList", "[", "f", "]"}]}], ";", "\n", 
      RowBox[{"Close", "[", "f", "]"}], ";", "\t\t\t", "\n", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"createDir", "[", "path_", "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"FileNames", "[", "path", "]"}]}]}], "}"}], ",", "\t\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"l", "\[Equal]", "0"}], ",", "  ", 
       RowBox[{
        RowBox[{"CreateDirectory", "@", 
         RowBox[{"File", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", "\"\<data\>\""}], " ", "}"}], "]"}]}]}], ";",
         " ", 
        RowBox[{"CreateDirectory", "@", 
         RowBox[{"File", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", " ", ",", "\"\<graph\>\""}], " ", "}"}], 
           "]"}]}]}], ";"}], " ", "\[IndentingNewLine]", ",", "Null"}], 
      "]"}]}], "  ", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.8933922359595656`*^9, 3.8933922918200893`*^9}, {
   3.893393019868514*^9, 3.8933930203215427`*^9}, {3.8933930561733446`*^9, 
   3.8933930881579976`*^9}, {3.8933931954297695`*^9, 
   3.8933933091509676`*^9}, {3.893835519728897*^9, 3.8938355783647785`*^9}, {
   3.893835697841716*^9, 3.8938356978477345`*^9}, {3.8944373442244453`*^9, 
   3.8944373573383036`*^9}, {3.894437408394402*^9, 3.8944374113641896`*^9}, 
   3.894437546900584*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"544e050b-fff5-4e7c-b801-a70379cac8d6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auxiliary matrices for the Hamiltonian  [2x2 matrices]", "Subsubsection",
 CellChangeTimes->{{3.85287578110361*^9, 3.8528758327496805`*^9}, {
  3.864820309629444*^9, 3.8648203109406557`*^9}},
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Bold",ExpressionUUID->"481ccb27-4efa-4a1b-b0a1-433a3d45e603"],

Cell[TextData[{
 "we define Z2 gauge field u[r] for each unit cell r as a three component \
vector which each component correspond \[Alpha] to the gauge field in the \
\[Alpha] bond for the",
 StyleBox[" A site",
  FontWeight->"Bold"],
 " in the unit cell r."
}], "Text",
 CellChangeTimes->{{3.855728826948078*^9, 3.8557289259519978`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"bda26fb8-b683-40a3-91c8-d47e91676755"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toR", "[", 
    RowBox[{"m0_", ",", "n0_", ",", "L_", ",", "M_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]n", "=", 
        RowBox[{"\[LeftFloor]", 
         FractionBox["n0", "L"], "\[RightFloor]"}]}], ",", "n", ",", "m"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{"n0", " ", ",", "L"}], "]"}]}], ";", " ", 
      RowBox[{"m", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"m0", "+", 
          RowBox[{"M", " ", "\[CapitalDelta]n"}]}], ",", "L"}], "]"}]}], ";", 
      " ", 
      RowBox[{"m", " ", "+", " ", 
       RowBox[{"n", " ", "L"}], "+", "1"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8557274589179*^9, 3.85572747382506*^9}, {
   3.8557275064828796`*^9, 3.855727515632272*^9}, {3.8557299396143484`*^9, 
   3.855729941186406*^9}, {3.855732405649863*^9, 3.855732522469389*^9}, {
   3.855732567906459*^9, 3.8557325868336535`*^9}, {3.8557330023839936`*^9, 
   3.855733129420061*^9}, {3.8557332510251293`*^9, 3.8557332554621067`*^9}, {
   3.855751327260338*^9, 3.855751360666909*^9}, {3.85575140193087*^9, 
   3.8557514068373327`*^9}, {3.8557514409604826`*^9, 3.855751471890725*^9}, 
   3.8557559153753133`*^9, {3.861790114478228*^9, 3.861790126289379*^9}, {
   3.8709477736359825`*^9, 3.8709477788211184`*^9}, {3.8774137290539703`*^9, 
   3.8774137295918627`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[56]:=",ExpressionUUID->"ea9fb8b5-cc52-4ef5-bb6f-3d99c940eda0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HNN", "[", 
     RowBox[{
     "K_", ",", "\[Kappa]_", ",", "\[Lambda]_", ",", "u_", ",", "m_", ",", 
      "n_", ",", "L_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", "=", 
        RowBox[{"toR", "[", 
         RowBox[{"m", ",", "n", " ", ",", "L", ",", "M"}], "]"}]}], "}"}], 
      ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"K", "\[LeftDoubleBracket]", 
                 RowBox[{"r", ",", "\[Alpha]"}], "\[RightDoubleBracket]"}]}], 
               "+", 
               RowBox[{"\[Lambda]", "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], ")"}], " ", 
             RowBox[{"u", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "\[Alpha]"}], "\[RightDoubleBracket]"}]}]}], 
           " ", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HNNNA", "[", 
    RowBox[{
    "K_", ",", "\[Kappa]_", ",", "\[Lambda]_", ",", "u_", ",", "m_", ",", 
     "n_", ",", "L_", ",", "M_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"toR", "[", 
           RowBox[{"m", ",", "n", " ", ",", "L", ",", "M"}], "]"}], ",", 
          RowBox[{"toR", "[", 
           RowBox[{"m", ",", "n", " ", ",", "L", ",", "M"}], "]"}], ",", 
          RowBox[{"toR", "[", 
           RowBox[{"m", ",", "n", ",", "L", ",", "M"}], "]"}]}], "}"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"r2", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"toR", "[", 
           RowBox[{
            RowBox[{"m", "+", "1"}], ",", 
            RowBox[{"n", "-", "1"}], " ", ",", "L", ",", "M"}], "]"}], ",", 
          RowBox[{"toR", "[", 
           RowBox[{"m", ",", 
            RowBox[{"n", "+", "1"}], " ", ",", "L", ",", "M"}], "]"}], ",", 
          RowBox[{"toR", "[", 
           RowBox[{
            RowBox[{"m", "-", "1"}], ",", "n", ",", "L", ",", "M"}], "]"}]}], 
         "}"}]}]}], "        ", "}"}], "      ", ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Kappa]", " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"r1", "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "\[Alpha]"}], 
              "]"}], "]"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"r2", "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", "1"}], ",", "3", ",", "1"}], 
                "]"}]}], " ", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], " ", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HNNNB", "[", 
     RowBox[{
     "K_", ",", "\[Kappa]_", ",", "\[Lambda]_", ",", "u_", ",", "m_", ",", 
      "n_", ",", "L_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"toR", "[", 
            RowBox[{
             RowBox[{"m", "-", "1"}], ",", "n", " ", ",", "L", ",", "M"}], 
            "]"}], ",", 
           RowBox[{"toR", "[", 
            RowBox[{"m", ",", 
             RowBox[{"n", " ", "-", "1"}], ",", "L", ",", "M"}], "]"}], ",", 
           RowBox[{"toR", "[", 
            RowBox[{"m", ",", "n", ",", "L", ",", "M"}], "]"}]}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"r2", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"toR", "[", 
            RowBox[{
             RowBox[{"m", "-", "1"}], ",", "n", " ", ",", "L", ",", "M"}], 
            "]"}], ",", 
           RowBox[{"toR", "[", 
            RowBox[{"m", ",", 
             RowBox[{"n", "-", "1"}], " ", ",", "L", ",", "M"}], "]"}], ",", 
           RowBox[{"toR", "[", 
            RowBox[{"m", ",", "n", ",", "L", ",", "M"}], "]"}]}], "}"}]}]}], 
       "        ", "}"}], "      ", ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"\[Kappa]", " ", 
             RowBox[{"u", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"r1", "[", 
                 RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "\[Alpha]"}], 
               "]"}], "]"}], " ", 
             RowBox[{"u", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"r2", "[", 
                 RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"\[Alpha]", "+", "1"}], ",", "3", ",", "1"}], 
                 "]"}]}], " ", "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\t\t\t\t\t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Hreal", "[", 
     RowBox[{
     "K_", ",", "\[Kappa]_", ",", "\[Lambda]_", ",", "u_", ",", "L_", ",", 
      "M_", ",", "\[Delta]k_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nc", "=", 
         SuperscriptBox["L", "2"]}], ",", "H"}], " ", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"H", "=", " ", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Hnn", ",", "HnnnA", ",", "HnnnB", ",", " ", 
               RowBox[{"\[CurlyPhi]", "=", 
                RowBox[{"\[Delta]k", ".", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"m", " ", "nx"}], "+", 
                   RowBox[{"n", " ", "ny"}]}], ")"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"r", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n", " ", ",", "L", ",", 
                    "M"}], "]"}], ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{"m", ",", "n", " ", ",", "L", ",", "M"}], "]"}]}], 
                 "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"RA", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", 
                    RowBox[{"n", "-", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "-", "1"}], ",", "n", ",", "L", ",", "M"}], 
                   "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"RB", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "-", "1"}], ",", 
                    RowBox[{"n", "+", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "-", "1"}], " ", ",", "L", ",", "M"}], "]"}],
                   ",", 
                  RowBox[{"toR", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n", ",", "L", ",", "M"}], 
                   "]"}]}], "}"}]}]}], "    ", "}"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Hnn", "=", 
               RowBox[{"HNN", "[", 
                RowBox[{
                "K", ",", "\[Kappa]", ",", "\[Lambda]", ",", "u", ",", "m", 
                 ",", "n", ",", "L", ",", "M"}], "]"}]}], " ", ";", 
              RowBox[{"HnnnA", "=", 
               RowBox[{"HNNNA", "[", 
                RowBox[{
                "K", ",", "\[Kappa]", ",", "\[Lambda]", ",", "u", ",", "m", 
                 ",", "n", ",", "L", ",", "M"}], "]"}]}], " ", ";", 
              RowBox[{"HnnnB", "=", 
               RowBox[{"HNNNB", "[", 
                RowBox[{
                "K", ",", "\[Kappa]", ",", "\[Lambda]", ",", "u", ",", "m", 
                 ",", "n", ",", "L", ",", "M"}], "]"}]}], " ", ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Sum", "[", "       ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KroneckerProduct", "[", " ", 
                   RowBox[{
                    RowBox[{"one", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "Nc"}], "]"}],
                     ",", 
                    RowBox[{"Hnn", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "   ", 
                  "+", "\[IndentingNewLine]", 
                  RowBox[{"KroneckerProduct", "[", " ", 
                   RowBox[{
                    RowBox[{"one", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"RA", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "Nc"}], "]"}],
                     ",", 
                    RowBox[{"HnnnA", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "   ", 
                  "+", "\[IndentingNewLine]", 
                  RowBox[{"KroneckerProduct", "[", " ", 
                   RowBox[{
                    RowBox[{"one", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"RB", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", "Nc"}], "]"}],
                     ",", 
                    RowBox[{"HnnnB", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}]}], "   ", 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}], 
               " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}], "]"}]}]}]}], 
            "      ", "]"}], " ", "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
       RowBox[{"H", "+", 
        RowBox[{"H", "\[ConjugateTranspose]"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TmatPure", "[", "L_", "]"}], " ", ":=", 
   RowBox[{"KroneckerProduct", "[", "   ", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", 
      SuperscriptBox["L", "2"], "]"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[ImaginaryI]", ",", 
         RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}], "}"}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UmatPure", "[", "H_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{"Eigensystem", "@", 
         RowBox[{"N", "[", "H", "]"}]}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ReverseSort", "[", 
         RowBox[{"R", "\[Transpose]"}], "]"}], "\[Transpose]"}], 
       "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "\[Transpose]"}]}], " ", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EandUPure", "[", "H_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"ReverseSort", "@", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Quiet", "@", 
           RowBox[{"Eigensystem", "@", 
            RowBox[{"N", "[", "H", "]"}]}]}]}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"R", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "\[Transpose]"}]}], " ", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[DoubleStruckCapitalU]occupiedPure", "[", 
     RowBox[{"TU_", ",", "Nc_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{
         RowBox[{"TU", "\[Transpose]"}], ",", 
         RowBox[{
          RowBox[{"-", "Nc"}], "-", "1"}]}], "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Transpose]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"correlations", "[", 
     RowBox[{"U_", ",", "u_", ",", "L_", ",", "M_"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", "  ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Nc", "=", 
         SuperscriptBox["L", "2"]}], ",", "\[DoubleStruckCapitalU]", ",", 
        "\[DoubleStruckCapitalU]h", ",", "icc", ",", "SS"}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[DoubleStruckCapitalU]", "=", 
        RowBox[{
         RowBox[{"TmatPure", "[", "L", "]"}], ".", "U"}]}], ";", 
       RowBox[{"\[DoubleStruckCapitalU]h", "=", 
        RowBox[{"\[DoubleStruckCapitalU]", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", 
           RowBox[{
            RowBox[{"-", "Nc"}], ";;", 
            RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", 
       RowBox[{"icc", "=", 
        RowBox[{"Chop", "[", 
         RowBox[{"\[ImaginaryI]", "  ", 
          RowBox[{"\[DoubleStruckCapitalU]h", ".", 
           RowBox[{"\[DoubleStruckCapitalU]h", "\[ConjugateTranspose]"}]}]}], 
         " ", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SS", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"2", "rz"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", " ", "+", 
                  RowBox[{"2", "rz"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], " ", 
               RowBox[{"icc", "[", 
                RowBox[{"[", 
                 RowBox[{"J", ",", "Io"}], "]"}], "]"}]}]}]}], "    ", "]"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", "L"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "L"}], "}"}], ",", " ", " ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SS", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "rx", ",", "mx", ",", "Io", ",", "J"}], 
              "}"}], ",", 
             RowBox[{
              RowBox[{"mx", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ",", "L", ",", "1"}], "]"}]}], ";", 
              " ", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              RowBox[{"rx", "=", 
               RowBox[{"mx", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"2", "rz"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"2", "rx"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"icc", "[", 
               RowBox[{"[", 
                RowBox[{"J", ",", "Io"}], "]"}], "]"}]}]}], "  ", "    ", 
            "]"}], "   ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", "L"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "L"}], "}"}], ",", " ", " ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SS", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
              "rz", ",", "ry", ",", "my", ",", "ny", ",", "Io", ",", "J"}], 
              "}"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ny", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ",", "L", ",", "1"}], "]"}]}], ";", 
              RowBox[{"my", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"ny", "==", "1"}], ",", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"m", "-", "M"}], ",", "L", ",", "1"}], "]"}], " ", 
                 ",", " ", "m"}], "]"}]}], ";", "  ", 
              RowBox[{"ry", "=", 
               RowBox[{"my", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ny", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "L"}], "-", "1"}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"2", "rz"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"2", "ry"}]}], ",", 
                 RowBox[{"2", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"icc", "[", 
               RowBox[{"[", 
                RowBox[{"J", ",", "Io"}], "]"}], "]"}]}]}], "  ", "  ", "]"}],
            "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", "L"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "L"}], "}"}], ",", " ", " ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", "SS"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8528758449600377`*^9, 3.852875851317932*^9}, {
   3.852875904853912*^9, 3.852875915503503*^9}, {3.8528761464601192`*^9, 
   3.8528761497601175`*^9}, {3.8528762152352686`*^9, 3.852876486873237*^9}, {
   3.852876517382826*^9, 3.8528765488237467`*^9}, {3.852876617691535*^9, 
   3.852876630773582*^9}, {3.852876681275669*^9, 3.852876683033943*^9}, {
   3.852876752290346*^9, 3.8528768321083784`*^9}, {3.852877583739396*^9, 
   3.8528776297643785`*^9}, 3.852878485471594*^9, {3.8528786358334894`*^9, 
   3.8528787210650144`*^9}, {3.852878759192633*^9, 3.852878768598241*^9}, 
   3.8528790483123007`*^9, {3.8528791363713408`*^9, 3.8528791461974735`*^9}, {
   3.8528816239160953`*^9, 3.852881729212538*^9}, {3.852881882837495*^9, 
   3.8528819263157663`*^9}, {3.8528822816250267`*^9, 3.852882326210932*^9}, {
   3.85288309701149*^9, 3.852883119871728*^9}, {3.852883434648644*^9, 
   3.852883436345559*^9}, {3.852883636444565*^9, 3.8528836619774866`*^9}, {
   3.852883732505681*^9, 3.852883791490629*^9}, 3.852883866665865*^9, {
   3.852884274145113*^9, 3.852884274640607*^9}, {3.8528849750242677`*^9, 
   3.852885003583339*^9}, {3.852885726364476*^9, 3.852885729336274*^9}, {
   3.852885985896722*^9, 3.8528859869295225`*^9}, {3.8528863866837935`*^9, 
   3.852886387274601*^9}, {3.8528868590918474`*^9, 3.852886862581946*^9}, {
   3.8528880737000465`*^9, 3.852888202804117*^9}, {3.8528901767144485`*^9, 
   3.852890184256923*^9}, {3.8528910619601126`*^9, 3.8528910673569593`*^9}, {
   3.8528911862507696`*^9, 3.852891188182824*^9}, {3.852923886080432*^9, 
   3.852923890271291*^9}, {3.852925801914589*^9, 3.8529258035812016`*^9}, {
   3.8530724404028645`*^9, 3.853072440655604*^9}, {3.853072477405422*^9, 
   3.853072494372284*^9}, {3.853072576917039*^9, 3.8530725802889585`*^9}, {
   3.853076926184968*^9, 3.8530769266382856`*^9}, {3.8530780636922255`*^9, 
   3.8530780700651655`*^9}, 3.8530781028725114`*^9, {3.8530782971242743`*^9, 
   3.853078340788065*^9}, 3.853078378753234*^9, {3.853078428795388*^9, 
   3.853078495453339*^9}, {3.853078531723461*^9, 3.85307866677022*^9}, {
   3.8530787191062756`*^9, 3.853078737601467*^9}, {3.8530791415812216`*^9, 
   3.8530791475541053`*^9}, {3.85307945238385*^9, 3.853079468494498*^9}, {
   3.85308055640246*^9, 3.853080561337586*^9}, {3.8530971425072594`*^9, 
   3.853097145604178*^9}, {3.8531415868139057`*^9, 3.8531416025694733`*^9}, {
   3.8531416870211706`*^9, 3.8531417227669353`*^9}, {3.853143708650571*^9, 
   3.8531437141748314`*^9}, {3.853144193392844*^9, 3.8531442238434987`*^9}, {
   3.853144268092826*^9, 3.853144270822891*^9}, {3.8531450336257677`*^9, 
   3.853145083877353*^9}, 3.8531451154202566`*^9, 3.8531452841420984`*^9, {
   3.8531486180825777`*^9, 3.853148627055408*^9}, {3.853223677930112*^9, 
   3.8532237646175203`*^9}, 3.8532238455749087`*^9, {3.853243460670273*^9, 
   3.853243464495823*^9}, {3.8532436975202584`*^9, 3.853243712101506*^9}, {
   3.853243747139862*^9, 3.8532437514909477`*^9}, {3.853243888726163*^9, 
   3.8532438937947392`*^9}, {3.853245278795165*^9, 3.853245282558984*^9}, {
   3.8532453949863462`*^9, 3.8532454024552493`*^9}, {3.853247276397146*^9, 
   3.8532472853377967`*^9}, {3.8532600359333797`*^9, 3.85326018260196*^9}, {
   3.853260961714988*^9, 3.8532609635717797`*^9}, {3.8532609971748533`*^9, 
   3.8532610070121326`*^9}, {3.8532611752260156`*^9, 
   3.8532612442596474`*^9}, {3.853310277441637*^9, 3.853310347228627*^9}, {
   3.8533106746503196`*^9, 3.853310674905801*^9}, {3.853310796841713*^9, 
   3.853310801416527*^9}, {3.8533112015235786`*^9, 3.8533112776992483`*^9}, {
   3.8533113847401357`*^9, 3.8533114181155763`*^9}, {3.8533114953673553`*^9, 
   3.853311532373185*^9}, {3.8533116240812445`*^9, 3.853311640341432*^9}, 
   3.8533117420422497`*^9, {3.853315421239539*^9, 3.853315438053417*^9}, {
   3.8533154915893583`*^9, 3.853315519459155*^9}, {3.8533168513733253`*^9, 
   3.8533168604336987`*^9}, {3.8533196752849383`*^9, 3.85331978595446*^9}, {
   3.8533203282983627`*^9, 3.853320358086738*^9}, {3.8533262578399696`*^9, 
   3.8533262772945127`*^9}, 3.8533499437574263`*^9, {3.8536082712806854`*^9, 
   3.8536083712295647`*^9}, {3.8536106320320024`*^9, 
   3.8536106342209206`*^9}, {3.853610715955882*^9, 3.8536107573404007`*^9}, {
   3.8536111255464272`*^9, 3.8536111408185387`*^9}, {3.853611675853198*^9, 
   3.8536116916029596`*^9}, {3.8536119114008026`*^9, 3.853611928020993*^9}, {
   3.8536120984219313`*^9, 3.8536121113802576`*^9}, {3.8536135117562547`*^9, 
   3.8536135173662744`*^9}, {3.8536135660560923`*^9, 
   3.8536135949459777`*^9}, {3.8536142062125597`*^9, 3.853614210247241*^9}, 
   3.8536148282202673`*^9, {3.8536148718387394`*^9, 3.853614911454711*^9}, {
   3.8536156471973243`*^9, 3.8536157434622383`*^9}, {3.8536157974475203`*^9, 
   3.853615804124118*^9}, {3.8536158491983356`*^9, 3.8536158511320553`*^9}, {
   3.8536163747420654`*^9, 3.8536163767060027`*^9}, {3.8544484272733793`*^9, 
   3.8544484454237475`*^9}, {3.854448639692511*^9, 3.8544486430773993`*^9}, {
   3.8544487868867416`*^9, 3.8544487932276707`*^9}, {3.8544496767480435`*^9, 
   3.8544498081796846`*^9}, 3.8545155505665965`*^9, {3.8545163302189655`*^9, 
   3.854516372584405*^9}, 3.8545260811447535`*^9, {3.8545267891556215`*^9, 
   3.854526800523856*^9}, {3.854526854326292*^9, 3.8545268603395433`*^9}, {
   3.854791157073604*^9, 3.854791237469392*^9}, {3.8547915849928074`*^9, 
   3.854791773020918*^9}, {3.854805553117719*^9, 3.854805820402554*^9}, {
   3.8548058508539715`*^9, 3.8548061038594112`*^9}, {3.8548063786944485`*^9, 
   3.854806426695154*^9}, {3.8548080939663086`*^9, 3.8548081677669125`*^9}, {
   3.8548081983664722`*^9, 3.854808537433962*^9}, {3.854869287024946*^9, 
   3.8548693173192434`*^9}, {3.8548694113351603`*^9, 3.854869413317813*^9}, 
   3.854869453816128*^9, {3.854873268317705*^9, 3.85487326926128*^9}, 
   3.855492722611916*^9, {3.855496767119727*^9, 3.855496867621081*^9}, {
   3.8554969289407053`*^9, 3.8554970131338167`*^9}, {3.855497357655508*^9, 
   3.8554974082517815`*^9}, {3.855726089402378*^9, 3.8557261773450117`*^9}, {
   3.855726280545883*^9, 3.855726393079608*^9}, {3.8557267779669547`*^9, 
   3.85572678240956*^9}, {3.8557269298934193`*^9, 3.8557269982319884`*^9}, {
   3.855727068060168*^9, 3.855727094112295*^9}, {3.8557272006619787`*^9, 
   3.855727226761417*^9}, {3.8557272883380117`*^9, 3.8557272908420153`*^9}, 
   3.855727329180155*^9, {3.8557274196183577`*^9, 3.855727455720439*^9}, {
   3.8557275240201054`*^9, 3.855727543834139*^9}, {3.855727593278549*^9, 
   3.855727751786045*^9}, {3.855727784185049*^9, 3.85572781914747*^9}, {
   3.8557278956347613`*^9, 3.8557279523934946`*^9}, {3.85572803222721*^9, 
   3.8557280343580017`*^9}, {3.8557280838258805`*^9, 3.855728168293166*^9}, {
   3.8557282883409643`*^9, 3.855728306717916*^9}, {3.855728351807845*^9, 
   3.855728384313888*^9}, {3.8557284214965277`*^9, 3.855728421766863*^9}, {
   3.855728532755906*^9, 3.8557285368346615`*^9}, {3.855728569055975*^9, 
   3.8557286032384768`*^9}, {3.8557286578088694`*^9, 
   3.8557287178416405`*^9}, {3.855729147180728*^9, 3.855729203041545*^9}, {
   3.8557294802207375`*^9, 3.855729603367707*^9}, {3.8557299234607573`*^9, 
   3.855729980733724*^9}, {3.8557300253874655`*^9, 3.8557300673309755`*^9}, {
   3.8557315364422207`*^9, 3.8557315380481052`*^9}, {3.855732779829007*^9, 
   3.8557328122966075`*^9}, {3.855733340308092*^9, 3.8557333872423*^9}, {
   3.8557509008442984`*^9, 3.855750911913181*^9}, {3.855751627448631*^9, 
   3.855751643796854*^9}, {3.855753148079071*^9, 3.8557532019313245`*^9}, {
   3.855755375484496*^9, 3.8557555471270475`*^9}, {3.8557556700513773`*^9, 
   3.855755724455683*^9}, {3.8557560037741895`*^9, 3.855756004376707*^9}, {
   3.8557560529602757`*^9, 3.8557561224266615`*^9}, {3.8557561999173203`*^9, 
   3.855756201294737*^9}, {3.8557563471422462`*^9, 3.855756348295101*^9}, 
   3.85575667321168*^9, {3.8557568468126864`*^9, 3.855756909328105*^9}, {
   3.8557570106107273`*^9, 3.8557570787549953`*^9}, {3.855757170148386*^9, 
   3.8557571995801396`*^9}, {3.8557572643042603`*^9, 
   3.8557574019617014`*^9}, {3.855757572326028*^9, 3.8557575762151814`*^9}, {
   3.8557578357467976`*^9, 3.8557578584722786`*^9}, {3.8557579192527246`*^9, 
   3.8557579812620935`*^9}, {3.8557581255035133`*^9, 
   3.8557581420339108`*^9}, {3.8557583741287575`*^9, 
   3.8557583988218994`*^9}, {3.855758536313141*^9, 3.855758643140071*^9}, {
   3.855758684212161*^9, 3.855758686461157*^9}, {3.8557587338471384`*^9, 
   3.855758775471654*^9}, {3.8557589354346504`*^9, 3.855758969046561*^9}, 
   3.855759042142415*^9, {3.8557592138021197`*^9, 3.855759222395499*^9}, {
   3.8557592765920677`*^9, 3.855759308107052*^9}, {3.855759365045355*^9, 
   3.855759366664935*^9}, {3.855759682837141*^9, 3.85575974756188*^9}, {
   3.855759780666892*^9, 3.855759807742917*^9}, {3.855759848857659*^9, 
   3.8557598968748546`*^9}, {3.8557603267908945`*^9, 3.855760328427106*^9}, {
   3.855760361664936*^9, 3.855760380731134*^9}, 3.855760489511751*^9, 
   3.8557605492570825`*^9, {3.855761644937914*^9, 3.8557616535908546`*^9}, {
   3.8557620585952926`*^9, 3.855762069483996*^9}, {3.8557631701741657`*^9, 
   3.8557631734884653`*^9}, {3.8557693004330764`*^9, 3.855769312237853*^9}, {
   3.861182458480302*^9, 3.8611825918601675`*^9}, {3.861182639855942*^9, 
   3.8611827003579526`*^9}, {3.861183162621685*^9, 3.8611831634342365`*^9}, {
   3.8611851664009857`*^9, 3.8611851671659327`*^9}, {3.8611851996759024`*^9, 
   3.8611852144823637`*^9}, {3.8611852580621195`*^9, 3.861185346789046*^9}, {
   3.8611853850319743`*^9, 3.8611853863825407`*^9}, {3.861186044171493*^9, 
   3.861186046397727*^9}, {3.861186948381232*^9, 3.86118694967027*^9}, {
   3.8611873577076735`*^9, 3.861187360381447*^9}, {3.861187404669917*^9, 
   3.8611874161382866`*^9}, {3.8611877409275723`*^9, 
   3.8611878252366333`*^9}, {3.861187884501717*^9, 3.861187919693507*^9}, {
   3.861187964963818*^9, 3.8611879759209213`*^9}, {3.8611882589470177`*^9, 
   3.8611882628670435`*^9}, {3.8611883371373034`*^9, 3.861188373607299*^9}, {
   3.8611886381176524`*^9, 3.8611886387469697`*^9}, {3.861189071987913*^9, 
   3.8611890839132247`*^9}, {3.861189115326182*^9, 3.861189120430971*^9}, {
   3.861189255342099*^9, 3.86118928700307*^9}, {3.8611928626530457`*^9, 
   3.861192874103575*^9}, {3.8617871103770833`*^9, 3.8617871109391007`*^9}, {
   3.86178718831822*^9, 3.8617871891947803`*^9}, {3.8617874566341743`*^9, 
   3.8617876167022963`*^9}, {3.8617884260755596`*^9, 
   3.8617884833155518`*^9}, {3.861788729466521*^9, 3.8617887329076047`*^9}, {
   3.8617889088790627`*^9, 3.8617889091937447`*^9}, {3.8617889966968484`*^9, 
   3.8617889970359497`*^9}, {3.8617890704539914`*^9, 
   3.8617890992575116`*^9}, {3.861789140744379*^9, 3.8617891578421555`*^9}, {
   3.861789229197182*^9, 3.8617892460443764`*^9}, {3.8617893629334316`*^9, 
   3.8617893798504667`*^9}, {3.861789492869958*^9, 3.861789493970908*^9}, {
   3.8617902731047697`*^9, 3.8617903156528425`*^9}, {3.8617903926303277`*^9, 
   3.8617903933225203`*^9}, {3.8617908978248315`*^9, 3.861790905248172*^9}, {
   3.861791017886675*^9, 3.8617910382265587`*^9}, {3.861791095802981*^9, 
   3.8617911090091047`*^9}, 3.861792287025064*^9, {3.861792333915367*^9, 
   3.861792360355414*^9}, {3.8617925475487537`*^9, 3.86179255108071*^9}, 
   3.861989772138296*^9, {3.8685297418237967`*^9, 3.8685297541300707`*^9}, 
   3.868529787490057*^9, {3.870773784975574*^9, 3.870773810346074*^9}, {
   3.8707744346649723`*^9, 3.870774447209771*^9}, {3.870947771334036*^9, 
   3.87094779374683*^9}, {3.8709478332674356`*^9, 3.870947896206917*^9}, {
   3.8709480545854483`*^9, 3.870948076870053*^9}, {3.8709486630946693`*^9, 
   3.8709487204458914`*^9}, 3.870951826645936*^9, 3.8709519905063725`*^9, {
   3.8709522020005245`*^9, 3.870952240875334*^9}, {3.870952350455531*^9, 
   3.8709523542858553`*^9}, {3.872588984471874*^9, 3.8725890430175934`*^9}, 
   3.876563562792527*^9, {3.877413709544568*^9, 3.877413732433918*^9}, {
   3.877420084938509*^9, 3.877420091124686*^9}, 3.8818319490401535`*^9},
 FontFamily->"Consolas",
 FontSize->12,
 CellLabel->"In[57]:=",ExpressionUUID->"f2915dff-fb33-4ed6-9988-91bfa27f058b"]
}, Closed]],

Cell[CellGroupData[{

Cell["to MF pure + gauge", "Subsubsection",
 CellChangeTimes->{{3.8818319546363163`*^9, 3.8818319571784873`*^9}, {
  3.9025075997447543`*^9, 3.9025076016772747`*^9}},
 FontWeight->"Bold",ExpressionUUID->"34dac328-f6f0-43f0-aee3-cb143d586447"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toMFparametersPure", "[", 
    RowBox[{"U_", ",", "u_", ",", "L_", ",", "M_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", "  ", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"Nc", "=", 
        SuperscriptBox["L", "2"]}], ",", "\[DoubleStruckCapitalU]", ",", 
       "\[DoubleStruckCapitalU]h", ",", "icc", ",", 
       RowBox[{"SS", "=", 
        RowBox[{"Array", "[", 
         RowBox[{"Null", ",", "3"}], "]"}]}]}], "  ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[DoubleStruckCapitalU]", "=", 
       RowBox[{
        RowBox[{"TmatPure", "[", "L", "]"}], ".", "U"}]}], ";", 
      RowBox[{"\[DoubleStruckCapitalU]h", "=", 
       RowBox[{"\[DoubleStruckCapitalU]", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", 
          RowBox[{
           RowBox[{"-", "Nc"}], ";;", 
           RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", 
      RowBox[{"icc", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"\[ImaginaryI]", "  ", 
         RowBox[{"\[DoubleStruckCapitalU]h", ".", 
          RowBox[{"\[DoubleStruckCapitalU]h", "\[ConjugateTranspose]"}]}]}], 
        " ", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SS", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayFlatten", "[", " ", 
          RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
        RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", " ", 
             RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
            RowBox[{
             RowBox[{"rz", "=", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", "L"}]}]}], ";", " ", 
             RowBox[{"Io", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"2", "rz"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"J", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", " ", "+", " ", "1", " ", "+", 
                 RowBox[{"2", "rz"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "   ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"u", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], ",", "3"}], "]"}], "]"}]}], " ",
                   " ", 
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], "-", 
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}], 
                 ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", 
                 RowBox[{"-", "1"}]}], " ", "}"}]}], "}"}]}]}], "    ", "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}], " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SS", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayFlatten", "[", " ", 
          RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", " ", 
             RowBox[{"rz", ",", "rx", ",", "mx", ",", "Io", ",", "J"}], "}"}],
             ",", 
            RowBox[{
             RowBox[{"mx", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "L"}], "]"}]}], ";", " ", 
             RowBox[{"rz", "=", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", "L"}]}]}], ";", 
             RowBox[{"rx", "=", " ", 
              RowBox[{"mx", "+", 
               RowBox[{"n", " ", "L"}]}]}], " ", ";", 
             RowBox[{"Io", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"2", "rz"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"J", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", " ", "+", " ", "1", "+", 
                 RowBox[{"2", "rx"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"u", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], " ", ",", "1"}], "]"}], "]"}]}],
                   "  ", 
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], "-", 
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}], 
                 " ", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], " ", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
              "}"}]}]}], "     ", "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}], " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SS", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayFlatten", "[", " ", 
          RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", " ", 
             RowBox[{
             "rz", ",", "ry", ",", "my", ",", "ny", ",", "Io", ",", "J"}], 
             "}"}], ",", " ", 
            RowBox[{
             RowBox[{"ny", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L"}], "]"}]}], ";", 
             RowBox[{"my", "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ny", "==", "0"}], ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "-", "M"}], ",", "L"}], "]"}], " ", ",", " ", 
                "m"}], "]"}]}], ";", "  ", 
             RowBox[{"ry", "=", " ", 
              RowBox[{"my", "+", 
               RowBox[{"ny", " ", "L"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"rz", "=", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", "L"}]}]}], ";", 
             RowBox[{"Io", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"2", "rz"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"J", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"1", "+", " ", "1", "+", 
                 RowBox[{"2", "ry"}]}], ",", 
                RowBox[{"2", 
                 SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "   ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"u", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"rz", "+", "1"}], ",", "2"}], "]"}], "]"}]}], "  ", 
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], "-", 
                    RowBox[{"icc", "[", 
                    RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}], 
                 ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"-", "1"}], " ", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
              "}"}]}]}], "        ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}], " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "SS"}]}], "        ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8818322636999674`*^9, 3.8818322963920617`*^9}, {
  3.881834529682357*^9, 3.881834546377516*^9}, {3.902507587122853*^9, 
  3.902507590590311*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"27341382-f257-4496-9dc9-e70392e55115"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gaugeConfigUPure", "[", 
     RowBox[{"\[Sigma]_", ",", "L1_", ",", "L2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bonds", ",", 
        RowBox[{"linethick", "=", 
         RowBox[{".012", " ", 
          RowBox[{"(", 
           FractionBox[
            RowBox[{"Log", "[", "49", "]"}], 
            RowBox[{"Log", "[", 
             RowBox[{"L1", " ", "L2"}], "]"}]], ")"}]}]}], ",", "lattice", 
        ",", "size"}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"size", " ", "=", " ", 
        RowBox[{"0.01", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"Log", "[", "49", "]"}], 
            RowBox[{"Log", "[", 
             RowBox[{"L1", " ", "L2"}], "]"}]], ")"}], "2"]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lattice", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "  ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", 
                 RowBox[{"4", " ", "size"}], "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"asites", "[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Black", ",", 
                RowBox[{"PointSize", "[", 
                 RowBox[{"4", " ", "size"}], "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"bsites", "[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], "  ", ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"Gray", ",", 
                RowBox[{"PointSize", "[", 
                 RowBox[{"2", "  ", "size"}], " ", "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"asites", "[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"White", ",", 
                RowBox[{"PointSize", "[", 
                 RowBox[{"2", "  ", "size"}], "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"bsites", "[", 
                  RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}]}], "     ", 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "0", ",", 
              RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", 
              RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", 
          "2"}], "    ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bonds", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "    ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}], ",", "3"}], "]"}], 
                    "]"}], ">=", " ", "0"}], ",", " ", "Cyan", " ", ",", 
                  RowBox[{"Darker", "@", "Blue"}]}], "]"}], ",", 
                RowBox[{"Thickness", "[", "linethick", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"asites", "[", 
                    RowBox[{"m", ",", "n"}], "]"}], ",", 
                   RowBox[{"bsites", "[", 
                    RowBox[{"m", ",", "n"}], "]"}]}], "}"}], "]"}]}], "}"}], 
              ",", "                   ", 
              RowBox[{"(*", 
               RowBox[{"z", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}], ",", "1"}], "]"}], 
                    "]"}], ">=", " ", "0"}], ",", " ", "Magenta", " ", ",", 
                  RowBox[{"Darker", "@", "Red"}]}], "]"}], ",", 
                RowBox[{"Thickness", "[", "linethick", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"asites", "[", 
                    RowBox[{"m", ",", "n"}], "]"}], ",", 
                   RowBox[{"bsites", "[", 
                    RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n"}], "]"}]}], "}"}], 
                 "]"}]}], "}"}], ",", "             ", 
              RowBox[{"(*", 
               RowBox[{"x", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}], ",", "2"}], "]"}], 
                    "]"}], ">=", " ", "0"}], ",", " ", 
                  RowBox[{"Darker", "@", "Yellow"}], " ", ",", 
                  RowBox[{"Darker", "@", "Green"}]}], "]"}], ",", 
                RowBox[{"Thickness", "[", "linethick", "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"asites", "[", 
                    RowBox[{"m", ",", "n"}], "]"}], ",", 
                   RowBox[{"bsites", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}]}], "}"}], "]"}]}], 
               "}"}]}], "              ", 
             RowBox[{"(*", 
              RowBox[{"y", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "0", ",", 
              RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "0", ",", 
              RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", 
          "2"}], "    ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bonds", ",", "lattice"}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}]}], "            ",
      "]"}]}], ";"}], "  ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uniformU", "[", 
    RowBox[{"u_", ",", "L1_", ",", "L2_"}], "]"}], ":=", 
   RowBox[{"Table", "[", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "u", ",", "u"}], "}"}], "     ", ",", 
     RowBox[{"L1", " ", "L2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"flipUoneZbond", "[", 
    RowBox[{"u0_", ",", "L1_", ",", "L2_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R1", ",", 
       RowBox[{"u", "=", "u0"}], ",", 
       RowBox[{"m0", "=", 
        RowBox[{
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L1", "2"], "\[RightCeiling]"}], " ", "-", "1"}]}], ",", 
       RowBox[{"n0", "=", 
        RowBox[{
         RowBox[{"\[LeftCeiling]", 
          FractionBox[
           RowBox[{"L2", "+", "1"}], "2"], "\[RightCeiling]"}], "-", 
         "1"}]}]}], " ", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"R1", "=", " ", 
       RowBox[{"{", " ", 
        RowBox[{"m0", ",", "n0"}], "}"}]}], ";", "\[IndentingNewLine]", "  ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"m", " ", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"R1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "L1"}], "]"}]}], " ", ";", 
         " ", 
         RowBox[{"n", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"R1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "L2"}], "]"}]}], " ", ";", 
         " ", 
         RowBox[{"r", " ", "=", " ", 
          RowBox[{"m", "+", 
           RowBox[{"n", " ", "L1"}], "+", "1"}]}], ";", "    ", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", 
            RowBox[{"r", ",", " ", "3"}], " ", "]"}], "]"}], " ", "=", 
          RowBox[{"-", 
           RowBox[{"u0", "[", 
            RowBox[{"[", 
             RowBox[{"r", ",", "3"}], " ", "]"}], "]"}]}]}], ";"}]}], 
       "      ", "]"}], "   ", ";", "  ", "u"}]}], "           ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"flipUZMaxSpaced", "[", 
    RowBox[{"u0_", ",", "L1_", ",", "L2_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R1", ",", "d", ",", 
       RowBox[{"u", "=", "u0"}], ",", 
       RowBox[{"m0", "=", 
        RowBox[{
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L1", "2"], "\[RightCeiling]"}], " ", "-", "1"}]}], ",", 
       RowBox[{"n0", "=", 
        RowBox[{
         RowBox[{"\[LeftCeiling]", 
          FractionBox[
           RowBox[{"L2", "+", "1"}], "2"], "\[RightCeiling]"}], "-", 
         "1"}]}]}], " ", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"\[LeftFloor]", 
        FractionBox[
         RowBox[{"L1", "-", "1"}], "2"], "\[RightFloor]"}]}], ";", " ", 
      RowBox[{"R1", "=", " ", 
       RowBox[{"{", " ", 
        RowBox[{"m0", ",", "n0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"R1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", "i"}], ",", "L1"}], 
             "]"}]}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"R1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", "i"}], ",", "L2"}], 
             "]"}]}], " ", ";", " ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L1"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", " ", "3"}], " ", "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{"u0", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "3"}], " ", "]"}], "]"}]}]}], ";"}]}], 
         "      ", "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", "  ", "u"}]}], 
    "           ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8774201644067698`*^9, {3.8774202813124714`*^9, 3.8774203178342075`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[67]:=",ExpressionUUID->"75dc91b6-2ba5-4b71-8e56-db4d9d758f83"],

Cell["\t\tconsider other gauge configurations: ", "Text",
 CellChangeTimes->{{3.8774138005392923`*^9, 3.877413819817518*^9}, 
   3.877420284641838*^9},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"3a7c1260-9853-40df-823e-7ac0bad83222"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uniformU", "[", 
    RowBox[{"u_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "u", ",", "u"}], "}"}], ",", 
     SuperscriptBox["L", "2"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gauge4v", "[", 
    RowBox[{"u0_", ",", "L_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d1", ",", "d2", ",", 
       RowBox[{"u", "=", "u0"}], ",", "mS", ",", "nS", ",", "mN", ",", "nN", 
       ",", "r2"}], " ", "}"}], ",", "   ", 
     RowBox[{
      RowBox[{"r2", "=", " ", 
       RowBox[{"\[LeftFloor]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L", "2"], "\[RightCeiling]"}]}], "\[RightFloor]"}]}], 
      ";", " ", 
      RowBox[{"d2", "=", 
       RowBox[{"2", "r2"}]}], ";", 
      RowBox[{"d1", "=", 
       RowBox[{"L", "-", "d2"}]}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"mS", "=", 
       RowBox[{"r2", "-", "1"}]}], ";", 
      RowBox[{"nS", "=", 
       RowBox[{"r2", "-", "1"}]}], ";", 
      RowBox[{"mN", "=", 
       RowBox[{"L", "-", "r2", "-", "1"}]}], ";", 
      RowBox[{"nN", "=", 
       RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", "mS"}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"nS", "+", "i"}]}], " ", ";", "       ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "1"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{"u0", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], "      ", 
         "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", "   ", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", "mN"}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"nN", "-", "i", "+", "1"}]}], ";", " ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "1"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{"u0", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], "      ", 
         "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", "   ", 
      "            ", "u"}]}], "           ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877413757328269*^9, 3.877413768202237*^9}, {
   3.8774138231010857`*^9, 3.877413848300172*^9}, {3.877413879685502*^9, 
   3.877413949262847*^9}, {3.8774139852355285`*^9, 3.877414080256706*^9}, {
   3.8774141169548974`*^9, 3.8774141377700357`*^9}, {3.877414267779165*^9, 
   3.877414341260338*^9}, {3.877419149820367*^9, 3.877419195698786*^9}, {
   3.8774192277606983`*^9, 3.8774192942256985`*^9}, {3.877419347957699*^9, 
   3.877419351444234*^9}, {3.877419500326869*^9, 3.877419553115043*^9}, {
   3.8774196619030886`*^9, 3.8774198021925917`*^9}, {3.87741988196052*^9, 
   3.8774199064128284`*^9}, {3.877419981025444*^9, 3.8774199826907544`*^9}, {
   3.877420328994586*^9, 3.8774203312385015`*^9}, 3.887361778186434*^9, 
   3.9025074927316213`*^9},
 FontFamily->"Consolas",
 CellLabel->"In[71]:=",ExpressionUUID->"7803c2ce-e2f3-4054-9a4c-cfd424ad2e64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"positionVortex", "[", 
   RowBox[{"v_", ",", "L_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "d1", ",", "d2", ",", "r2", ",", "mS", ",", "nS", ",", "mW", ",", "nW", 
      ",", "mE", ",", "nE", ",", "mN", ",", "nN"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t\t ", 
    RowBox[{
     RowBox[{"r2", "=", " ", 
      RowBox[{"\[LeftFloor]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"\[LeftCeiling]", 
         FractionBox["L", "2"], "\[RightCeiling]"}]}], "\[RightFloor]"}]}], 
     ";", " ", 
     RowBox[{"d2", "=", 
      RowBox[{"2", "r2"}]}], ";", 
     RowBox[{"d1", "=", 
      RowBox[{"L", "-", "d2"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t ", 
     RowBox[{"mS", "=", 
      RowBox[{"r2", "-", "1"}]}], ";", "           ", 
     RowBox[{"nS", "=", 
      RowBox[{"r2", "-", "1"}]}], ";", "\[IndentingNewLine]", "\t\t ", 
     RowBox[{"mW", "=", 
      RowBox[{"r2", "-", "1"}]}], ";", "           ", 
     RowBox[{"nW", "=", 
      RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     "\t\t ", 
     RowBox[{"mE", "=", 
      RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "     ", 
     RowBox[{"nE", "=", 
      RowBox[{"r2", "-", "1"}]}], ";", "\[IndentingNewLine]", "\t\t ", 
     RowBox[{"mN", "=", 
      RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "     ", 
     RowBox[{"nN", "=", 
      RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mS", ",", "nS"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mW", ",", "nW"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mE", ",", "nE"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mN", ",", "nN"}], "}"}]}], "}"}], "[", 
      RowBox[{"[", "v", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.877422181703511*^9, 3.8774223167524166`*^9}, {
  3.8774223936121354`*^9, 3.877422504063735*^9}, {3.8774247710594387`*^9, 
  3.8774247740989656`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[73]:=",ExpressionUUID->"32a12fd4-6b04-4fa8-8921-0e1b06ab9778"],

Cell["v=1  South, v=2 West, v=3 East, v=4 North", "Text",
 CellChangeTimes->{{3.877424777947485*^9, 3.8774248031912775`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"9f3ab0b7-e36b-4339-a786-cd32ae12473b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gauge2v", "[", 
    RowBox[{"u0_", ",", "L_", ",", "\[Alpha]_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d1", ",", "d2", ",", 
       RowBox[{"u", "=", "u0"}], ",", "m0", ",", "n0", ",", "r2", " ", ",", 
       "v"}], "}"}], ",", "   ", 
     RowBox[{
      RowBox[{"r2", "=", " ", 
       RowBox[{"\[LeftFloor]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L", "2"], "\[RightCeiling]"}]}], "\[RightFloor]"}]}], 
      ";", "   ", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", 
          "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"m", "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r2", "-", "1"}], ",", "             ", 
               RowBox[{"r2", "-", "1", "+", "i"}], ",", "              ", 
               RowBox[{"r2", "-", "1", "+", "i"}]}], "   ", "}"}], 
             "\[LeftDoubleBracket]", "\[Alpha]", "\[RightDoubleBracket]"}]}], 
           ";", " ", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
           RowBox[{"n", "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r2", "-", "1", "+", "i"}], ",", "       ", 
               RowBox[{"L", "-", "r2", "-", "1"}], ",", "             ", 
               RowBox[{"L", "-", "r2", "-", "i"}]}], "   ", "}"}], 
             "\[LeftDoubleBracket]", "\[Alpha]", "\[RightDoubleBracket]"}]}], 
           ";", "\[IndentingNewLine]", " ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", 
              RowBox[{"r", ",", "\[Alpha]"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{"u0", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "\[Alpha]"}], "]"}], "]"}]}]}], ";"}]}], 
         "      ", "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", 
      "                ", "u"}]}], "           ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877422782257123*^9, 3.877422803474776*^9}, {
  3.877422889070754*^9, 3.877422950159266*^9}, {3.8774234770945377`*^9, 
  3.8774235757615786`*^9}, {3.877423614257307*^9, 3.8774236572791567`*^9}, {
  3.8774237055398655`*^9, 3.8774237075241146`*^9}, {3.8774238082793474`*^9, 
  3.8774238100344543`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[74]:=",ExpressionUUID->"492db9da-0a1f-48f8-b014-291e7eb1ec50"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaugeConfig", "[", 
    RowBox[{"\[Chi]_", ",", "L1_", ",", "L2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bonds", ",", 
       RowBox[{"linethick", "=", 
        RowBox[{".012", " ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "49", "]"}], 
           RowBox[{"Log", "[", 
            RowBox[{"L1", " ", "L2"}], "]"}]], ")"}]}]}], ",", "lattice", ",",
        "size"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"size", " ", "=", " ", 
       RowBox[{"0.01", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "49", "]"}], 
           RowBox[{"Log", "[", 
            RowBox[{"L1", " ", "L2"}], "]"}]], ")"}], "2"]}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lattice", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"4", " ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"asites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"4", " ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"bsites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], "  ", ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"2", "  ", "size"}], " ", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"asites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"White", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"2", "  ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"bsites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}]}], "     ", 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", "2"}],
         "    ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bonds", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "    ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"4", ",", "4"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", " ", 
                 RowBox[{"Darker", "@", "Yellow"}], " ", ",", 
                 RowBox[{"Darker", "@", "Blue"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"4", ",", "4"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", "  ", 
                 RowBox[{"Thickness", "[", 
                  RowBox[{"1.5", "linethick"}], "]"}], " ", ",", 
                 RowBox[{"Thickness", "[", "linethick", "]"}]}], " ", "]"}], 
               " ", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}]}], "}"}], "]"}]}], "}"}], 
             ",", "                   ", 
             RowBox[{"(*", 
              RowBox[{"z", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", " ", "Cyan", ",", 
                 RowBox[{"Darker", "@", "Red"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", 
                 RowBox[{"Thickness", "[", 
                  RowBox[{"1.5", " ", "linethick"}], "]"}], " ", ",", 
                 RowBox[{"Thickness", "[", "linethick", "]"}]}], " ", "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n"}], "]"}]}], "}"}], 
                "]"}]}], "}"}], ",", "             ", 
             RowBox[{"(*", 
              RowBox[{"x", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", " ", "Magenta", " ", ",", 
                 RowBox[{"Darker", "@", "Green"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L1"}], "+", "1"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}], ">=", " ", "0"}], 
                 ",", " ", 
                 RowBox[{"Thickness", "[", 
                  RowBox[{"1.5", "linethick"}], "]"}], " ", ",", 
                 RowBox[{"Thickness", "[", "linethick", "]"}]}], " ", "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}]}], "}"}], "]"}]}], 
              "}"}]}], "              ", 
            RowBox[{"(*", 
             RowBox[{"y", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", "2"}],
         "    ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"bonds", ",", "lattice"}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}]}], "             ",
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8770681627949257`*^9, 3.8770682147921047`*^9}, {
   3.877072738637565*^9, 3.8770727399904113`*^9}, 3.8774136111284676`*^9, {
   3.877413642604847*^9, 3.8774136699916964`*^9}, {3.9025071995514545`*^9, 
   3.9025072008403997`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[75]:=",ExpressionUUID->"0e06b428-50bb-4179-a10e-15a5549a6dff"]
}, Closed]],

Cell[CellGroupData[{

Cell["electric field", "Subsubsection",
 CellChangeTimes->{{3.877420233679596*^9, 3.877420236990667*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"082b1853-69cb-4515-a15e-ba6582944cba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uniform", "[", 
     RowBox[{"K_", ",", "L1_", ",", "L2_"}], "]"}], ":=", 
    RowBox[{"Table", "[", "   ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"K", ",", "K", ",", "K"}], "}"}], "     ", ",", 
      RowBox[{"L1", " ", "L2"}]}], "]"}]}], ";"}], "  ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addVortex", "[", " ", 
     RowBox[{"Ko_", ",", "K0_", ",", " ", "R_", ",", "L1_", ",", "L2_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"R", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"K", "=", "Ko"}], ",", 
        RowBox[{"r", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", "6"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{"m", "+", 
            RowBox[{"n", " ", "L1"}], " ", "+", "1"}], ",", "3"}], "    ", 
          "]"}], "]"}], "=", "K0"}], ";", "  ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "-", "1"}], ",", "L2"}], "]"}], " ", "L1"}], " ", 
            "+", "1"}], "  ", ",", "2"}], "    ", "]"}], "]"}], "=", "K0"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}], "+", 
            RowBox[{"n", " ", "L1"}], " ", "+", "1"}], ",", "1"}], "    ", 
          "]"}], "]"}], "=", "K0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}], " ", "L1"}], " ", 
            "+", "1"}], "  ", ",", "3"}], "   ", "]"}], "]"}], "=", "K0"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{"m", "+", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}], " ", "L1"}], "+", 
            "1"}], "   ", ",", "2"}], "    ", "]"}], "]"}], "=", "K0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"m", "-", "1"}], ",", "L1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}], " ", "L1"}], " ", 
            "+", "1"}], "  ", ",", "1"}], "   ", "]"}], "]"}], "=", "K0"}], 
       ";", "\[IndentingNewLine]", "K"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"add2Vortices", "[", " ", 
    RowBox[{
    "Ko_", ",", "K1_", ",", "K2_", ",", " ", "R1_", ",", "R2_", ",", "L1_", 
     ",", "L2_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "K", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"addVortex", "[", " ", 
        RowBox[{"Ko", ",", "K1", ",", " ", "R1", ",", "L1", ",", "L2"}], 
        "]"}]}], ";", " ", 
      RowBox[{"addVortex", "[", " ", 
       RowBox[{"K", ",", "K2", ",", " ", "R2", ",", "L1", ",", "L2"}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"add4Vortices", "[", " ", 
    RowBox[{
    "K0_", ",", "Kmod_", ",", " ", "R1_", ",", "R2_", ",", " ", "R3_", ",", 
     "R4_", ",", "L_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "K", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"addVortex", "[", " ", 
        RowBox[{"K0", ",", "Kmod", ",", " ", "R1", ",", "L", ",", "L"}], 
        "]"}]}], ";", " ", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"addVortex", "[", " ", 
        RowBox[{"K", ",", "Kmod", ",", " ", "R2", ",", "L", ",", "L"}], 
        "]"}]}], ";", " ", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"addVortex", "[", " ", 
        RowBox[{"K", ",", "Kmod", ",", " ", "R3", ",", "L", ",", "L"}], 
        "]"}]}], ";", " ", 
      RowBox[{"addVortex", "[", " ", 
       RowBox[{"K", ",", "Kmod", ",", " ", "R4", ",", "L", ",", "L"}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"add2VorticesMaxSpaced", "[", " ", 
    RowBox[{"Ko_", ",", "K1_", ",", "K2_", ",", "L1_", ",", "L2_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R1", ",", "R2", ",", "d"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"\[LeftFloor]", 
        FractionBox[
         RowBox[{"L1", "-", "1"}], "2"], "\[RightFloor]"}]}], ";", " ", 
      RowBox[{"R1", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[LeftFloor]", 
          FractionBox["L1", "2"], "\[RightFloor]"}], " ", ",", 
         RowBox[{"\[LeftFloor]", 
          FractionBox[
           RowBox[{"L2", "+", "1"}], "2"], "\[RightFloor]"}]}], " ", "}"}]}], 
      ";", 
      RowBox[{"R2", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[LeftFloor]", 
           FractionBox["L1", "2"], "\[RightFloor]"}], "   ", "+", "d"}], ",", 
         RowBox[{
          RowBox[{"\[LeftFloor]", 
           FractionBox[
            RowBox[{"L2", "+", "1"}], "2"], "\[RightFloor]"}], " ", "-", 
          "d"}]}], "}"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"add2Vortices", "[", " ", 
       RowBox[{
       "Ko", ",", "K1", ",", "K2", ",", " ", "R1", ",", "R2", ",", "L1", ",", 
        "L2"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"add4VorticesMaxSpaced", "[", " ", 
    RowBox[{"K0_", ",", "Kmod_", ",", "L_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"RS", ",", "RE", ",", "RW", ",", "RN", ",", "r2"}], "}"}], ",", 
     "   ", 
     RowBox[{
      RowBox[{"r2", "=", " ", 
       RowBox[{"\[LeftFloor]", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"\[LeftCeiling]", 
          FractionBox["L", "2"], "\[RightCeiling]"}]}], "\[RightFloor]"}]}], 
      ";", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"RS", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "-", "1"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"RW", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "-", "1"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"L", "-", "r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"RE", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "r2", "-", "1"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"RN", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"L", "-", "r2", "-", "1"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"L", "-", "r2", "-", "1"}], ")"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"add4Vortices", "[", " ", 
       RowBox[{
       "K0", ",", "Kmod", ",", " ", "RS", ",", "RW", ",", " ", "RE", ",", 
        "RN", ",", "L"}], "]"}]}]}], " ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8774201825463543`*^9, 3.8774201826093636`*^9}, {
   3.8774202274947453`*^9, 3.8774202735734367`*^9}, {3.8837280670530324`*^9, 
   3.883728249212535*^9}, {3.8837282947134576`*^9, 3.883728377375498*^9}, {
   3.883728643549054*^9, 3.883728707133957*^9}, {3.883729140365653*^9, 
   3.8837291663613977`*^9}, {3.883729201619478*^9, 3.8837292319061832`*^9}, {
   3.883729278548962*^9, 3.883729406214078*^9}, {3.8866548585169263`*^9, 
   3.886654861283292*^9}, 3.887362028713689*^9, {3.887363211834648*^9, 
   3.887363243764592*^9}, {3.8873649187913427`*^9, 3.8873649407067575`*^9}, {
   3.887365033541148*^9, 3.887365053722599*^9}, {3.8873656177368665`*^9, 
   3.887365621493929*^9}, {3.8873659326750774`*^9, 3.8873659335741405`*^9}, {
   3.8873661782887497`*^9, 3.887366182518972*^9}, 3.8873675363125753`*^9, {
   3.9025072095402822`*^9, 3.9025072257868547`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[76]:=",ExpressionUUID->"605b6fbc-7e7e-420c-b030-1c5336e2167d"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MF model definitions", "Subsection",
 CellChangeTimes->{{3.87077371823326*^9, 3.8707737241148777`*^9}, {
  3.902944620994293*^9, 3.90294462287626*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"0318476a-00b2-4dfc-9b63-3a22ad5f203f"],

Cell[CellGroupData[{

Cell["Saving and Loading data", "Subsubsection",
 CellChangeTimes->{{3.825426408557412*^9, 3.825426432409486*^9}, {
   3.8529094592650013`*^9, 3.8529094611880875`*^9}, {3.853005908308914*^9, 
   3.853005909153577*^9}, {3.85322366934897*^9, 3.8532236708509216`*^9}, {
   3.8536110407913527`*^9, 3.853611041586192*^9}, {3.8618090265261803`*^9, 
   3.8618090351881347`*^9}, {3.8618090685118675`*^9, 3.8618090699964824`*^9}, 
   3.8684476950768623`*^9},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"b71d4571-a688-41a0-930c-9da7a14bca46"],

Cell[TextData[StyleBox["To create a given NotebookDirectory  \
\[OpenCurlyDoubleQuote]path\[CloseCurlyDoubleQuote] if it does not exist:",
 FontSize->10]], "Text",
 CellChangeTimes->{{3.8618093666644535`*^9, 3.8618093681452913`*^9}, {
   3.861809496262456*^9, 3.8618095726055417`*^9}, {3.861809716496188*^9, 
   3.8618097310756235`*^9}, {3.861809820018787*^9, 3.8618098375466695`*^9}, 
   3.8938356979390116`*^9},
 FontFamily->"Consolas",
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"fb7b3641-96cb-4bed-b03c-c6cf44a4b764"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"createDir", "[", "path_", "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"FileNames", "[", "path", "]"}]}]}], "}"}], ",", "\t\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"l", "\[Equal]", "0"}], ",", "  ", 
       RowBox[{
        RowBox[{"CreateDirectory", "@", 
         RowBox[{"File", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", "\"\<data\>\""}], " ", "}"}], "]"}]}]}], ";",
         " ", 
        RowBox[{"CreateDirectory", "@", 
         RowBox[{"File", "@", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", " ", ",", "\"\<graph\>\""}], " ", "}"}], 
           "]"}]}]}], ";"}], " ", "\[IndentingNewLine]", ",", "Null"}], 
      "]"}]}], "  ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8618095638310165`*^9, 3.8618095694119525`*^9}, {
  3.8618096143228226`*^9, 3.861809620194528*^9}, {3.861809705133501*^9, 
  3.8618097094986787`*^9}, {3.861809968970943*^9, 3.8618099701175966`*^9}, {
  3.8707707754220266`*^9, 3.8707707795036244`*^9}, {3.8707714803304873`*^9, 
  3.870771490870921*^9}, {3.8938356980287085`*^9, 3.893835698032206*^9}, {
  3.8944375325214396`*^9, 3.894437535830594*^9}, {3.9025076376323586`*^9, 
  3.902507646455291*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[82]:=",ExpressionUUID->"fc4d5d20-75bd-4656-ab10-830001170971"],

Cell[TextData[StyleBox["to read the data at \[OpenCurlyDoubleQuote]pathData\
\[CloseCurlyDoubleQuote] : ",
 FontSize->10]], "Text",
 CellChangeTimes->{{3.8618093666644535`*^9, 3.8618093681452913`*^9}, {
  3.861809496262456*^9, 3.8618095726055417`*^9}, {3.861809716496188*^9, 
  3.8618097310756235`*^9}, {3.8618097795183105`*^9, 3.8618098147100163`*^9}},
 FontFamily->"Consolas",
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"e22cadd4-91eb-4583-8e63-ad2fd266acad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadData", "[", "pathData_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
     "\t\t        ", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"OpenRead", "[", "pathData", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"f", "==", "$Failed"}], ",", " ", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Failed to OpenRead file at: \>\"", "]"}], 
         ";", " ", 
         RowBox[{"Print", "[", " ", "pathData", " ", "]"}], ";", " ", 
         RowBox[{"Abort", "[", "]"}]}]}], " ", "]"}], ";", 
      "\[IndentingNewLine]", "\t\t        ", 
      RowBox[{"data", "=", 
       RowBox[{"ReadList", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t        ", 
      RowBox[{"Close", "[", "f", "]"}], ";", "\t\t\t", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8618097941897097`*^9, 3.861809795066695*^9}, {
  3.8707707932947135`*^9, 3.870770803870585*^9}, {3.8707708935789065`*^9, 
  3.87077089811934*^9}, {3.8866751090973635`*^9, 3.8866751192438755`*^9}, {
  3.8866753274385633`*^9, 3.8866754074060183`*^9}, {3.8866754429355125`*^9, 
  3.886675452764537*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[83]:=",ExpressionUUID->"4a8d010b-8cad-41cb-8c62-196ec1a1893b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"toPath", " ", "[", 
    RowBox[{
    "parameters0_", ",", "L_", ",", "acuracy_", ",", "gauge_", ",", 
     "NbName_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", " ", ",", "hS", ",", 
       RowBox[{"parameters", "=", "parameters0"}], ",", " ", "filename", ",", 
       "r", ",", "\[Phi]", ",", "\[Theta]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"h", "=", 
       RowBox[{"parameters", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], " ", ";", 
      RowBox[{"hS", "=", 
       RowBox[{"parameters", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], ";", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "=", "hS"}], 
      ";", "   ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gauge", "==", "\"\<free\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", 
            RowBox[{"5", ";;", "7"}], "]"}], "]"}], "=", 
          RowBox[{"parameters0", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "=", "0"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"filename", "=", "\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gauge", "==", "\"\<free_lambda\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", 
            RowBox[{"5", ";;", "7"}], "]"}], "]"}], "=", 
          RowBox[{"parameters0", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
         RowBox[{"filename", "=", "\"\<lambda_X2_JKG=X3\>\""}], ";"}]}], " ", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", "       ", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "   ", ",", " ", 
         "\"\<Files\>\"", " ", ",", "NbName", ",", "gauge", ",", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"filename", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<X1\>\"", "\[Rule]", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{"parameters", "[", 
                RowBox[{"[", "9", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"\"\<X2\>\"", "\[Rule]", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{"parameters", "[", 
                RowBox[{"[", "10", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"\"\<X3\>\"", "\[Rule]", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{"parameters", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "3"}], "]"}], "]"}], "  ", "]"}]}], ",", 
             RowBox[{"\"\<X4\>\"", "\[Rule]", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{"parameters", "[", 
                RowBox[{"[", 
                 RowBox[{"5", ";;", "7"}], "]"}], "]"}], "]"}]}]}], "   ", 
            "}"}]}], "]"}], " ", ",", " ", "\"\<data\>\"", "  ", ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"\"\<h=(M,N,T)_L=Y_A=Z.txt\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<Y\>\"", "\[Rule]", " ", 
              RowBox[{"ToString", "[", "L", "]"}]}], ",", " ", 
             RowBox[{"\"\<Z\>\"", "\[Rule]", " ", 
              RowBox[{"ToString", "[", "acuracy", "]"}]}], ",", 
             RowBox[{"\"\<M\>\"", "->", "  ", 
              RowBox[{"ToString", "[", 
               RowBox[{"r", ",", "InputForm"}], "]"}]}], " ", ",", 
             RowBox[{"\"\<N\>\"", "->", 
              RowBox[{"ToString", "@", "\[Phi]"}]}], ",", 
             RowBox[{"\"\<T\>\"", "->", 
              RowBox[{"ToString", "@", "\[Theta]"}]}]}], "}"}]}], "   ", 
          "]"}]}], " ", "\[IndentingNewLine]", "   ", "}"}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8837297245896273`*^9, 3.883729842715426*^9}, {
   3.883729878467956*^9, 3.8837299877278028`*^9}, {3.8837301471639495`*^9, 
   3.8837301791854925`*^9}, {3.8837302422957497`*^9, 
   3.8837302584996448`*^9}, {3.883731474627163*^9, 3.8837315229124055`*^9}, 
   3.893387502402667*^9, 3.893835698039189*^9, {3.8967710490434704`*^9, 
   3.896771182847247*^9}, {3.896771476452685*^9, 3.8967714796981735`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"575eb2a2-01d7-4d66-8c20-b4aea72abfd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dataToFile", "[", " ", 
    RowBox[{
    "parameters0_", ",", "L_", ",", "acuracy_", ",", "data_", ",", "gauge_", 
     ",", "NbName_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"path", ",", "f", ",", "filename", ",", 
       RowBox[{"parameters", "=", "parameters0"}]}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gauge", "==", "\"\<free\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", 
            RowBox[{"5", ";;", "7"}], "]"}], "]"}], "=", 
          RowBox[{"parameters0", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", "10", "]"}], "]"}], "=", "0"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"filename", "=", "\"\<t=X1_eV=X2_JKG=X3_JKGmod=X4\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gauge", "==", "\"\<free_lambda\>\""}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "[", 
           RowBox[{"[", 
            RowBox[{"5", ";;", "7"}], "]"}], "]"}], "=", 
          RowBox[{"parameters0", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
         RowBox[{"filename", "=", "\"\<lambda_X2_JKG=X3\>\""}], ";"}]}], " ", 
       "]"}], ";", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"createDir", "@", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], " ", ",", "\"\<Files\>\"", 
          ",", "  ", "NbName", ",", "gauge", ",", " ", 
          RowBox[{"StringReplace", "[", 
           RowBox[{"filename", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<X1\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X2\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", "10", "]"}], "]"}], "]"}]}], ",", 
              RowBox[{"\"\<X3\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "3"}], "]"}], "]"}], "  ", "]"}]}], ",", 
              RowBox[{"\"\<X4\>\"", "\[Rule]", "  ", 
               RowBox[{"ToString", "[", 
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"5", ";;", "7"}], "]"}], "]"}], "]"}]}]}], "   ", 
             "}"}]}], "]"}]}], " ", "     ", "}"}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"path", " ", "=", " ", 
       RowBox[{"toPath", "[", " ", 
        RowBox[{
        "parameters", ",", "L", ",", "acuracy", ",", "gauge", ",", "NbName"}],
         "]"}]}], ";", "\t\t", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"OpenAppend", "[", "path", "]"}]}], ";", "\[IndentingNewLine]",
       "\t\t ", 
      RowBox[{"Write", "[", " ", 
       RowBox[{"f", ",", " ", "data"}], "]"}], ";", "\[IndentingNewLine]", 
      "\t\t ", 
      RowBox[{"Close", "[", "f", "]"}], ";"}]}], "                ", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8707712817983246`*^9, 3.8707713306544037`*^9}, {
   3.870771423627341*^9, 3.870771423806079*^9}, {3.870772180366624*^9, 
   3.8707721999571996`*^9}, {3.8707766845051775`*^9, 3.870776686806966*^9}, {
   3.883730295598323*^9, 3.883730305116412*^9}, {3.8837313882037907`*^9, 
   3.883731462746214*^9}, 3.8933875037014513`*^9, 3.893835698045164*^9, {
   3.8967715074256697`*^9, 3.8967715516265264`*^9}},
 FontFamily->"Consolas",
 CellLabel->"In[85]:=",ExpressionUUID->"807f3ba5-2aef-4049-aea3-8f660cac15f9"],

Cell[TextData[StyleBox["create a function that automatically creates a path \
name given a set of values [  parameters = { J, K, \[CapitalGamma], \
{hx,hy,hz} }  ]",
 FontSize->10]], "Text",
 CellChangeTimes->{{3.8618093666644535`*^9, 3.8618093681452913`*^9}, {
   3.861809496262456*^9, 3.8618095726055417`*^9}, {3.861809716496188*^9, 
   3.8618097310756235`*^9}, 3.8618097795183105`*^9, {3.861809858894718*^9, 
   3.8618099376722355`*^9}},
 FontFamily->"Consolas",
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"297c7722-7294-4b07-a549-c0fa4766203d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"loadDataTry", "[", "pathData_", "]"}], ":=", "\n", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "data", ",", 
       RowBox[{"path", "=", 
        RowBox[{"FindFile", "[", "pathData", "]"}]}]}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"path", "==", "$Failed"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<New entry at:\>\"", ",", "pathData"}], "]"}], ";"}], 
         "*)"}], 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", "\n", 
      "\t\t        ", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"OpenRead", "[", "pathData", "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"f", "==", "$Failed"}], ",", " ", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Failed to OpenRead file at: \>\"", ",", " ", "pathData"}], 
            " ", "]"}], ";", " ", 
           RowBox[{"Abort", "[", "]"}]}]}], " ", "]"}], ";"}], "*)"}], "\n", 
      "\t\t        ", 
      RowBox[{"data", "=", 
       RowBox[{"ReadList", "[", "f", "]"}]}], ";", "\n", "\t\t        ", 
      RowBox[{"Close", "[", "f", "]"}], ";", "\t\t\t", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\n", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.902507651875539*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"09917604-5614-4d44-b9d5-9d21d5a7d8a7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Hamiltonian  matrices", "Subsubsection",
 CellChangeTimes->{{3.85287578110361*^9, 3.8528758327496805`*^9}, {
  3.868447724572776*^9, 3.868447729906935*^9}},
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Bold",ExpressionUUID->"89758110-0a30-4fa0-ad94-8c6848b529b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Jmat", "[", 
    RowBox[{"J_", ",", "K_", ",", "G_", ",", "Gp_", ",", "D_"}], "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"J", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"K", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Gp", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"J", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Gp", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"J", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"J", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Gp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"J", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"K", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"J", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"J", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"J", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Gp", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"Gp", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"J", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", 
          RowBox[{"K", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}]}], "   ", 
    "}"}]}], ";"}]], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"7b6e2af4-effe-4e1c-8193-f82a0e2a47b7"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AMF", "[", 
     RowBox[{"Jm_", ",", "U_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"AMF", ",", 
        RowBox[{"N", "=", "Nmat"}]}], "}"}], ",", "  ", 
      RowBox[{
       RowBox[{"AMF", "=", 
        RowBox[{"Table", "[", "    ", 
         RowBox[{
          RowBox[{"Sum", "[", "   ", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"Jm", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
              RowBox[{"U", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}]}], " ", ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], "    ", 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "   ", 
       RowBox[{
        RowBox[{
         RowBox[{"KroneckerProduct", "[", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "#"}], "]"}], 
         "&"}], "/@", 
        RowBox[{"Re", "@", "AMF"}]}]}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"BMF", "[", 
     RowBox[{"Jm_", ",", "h_", ",", "\[Lambda]_", ",", "W_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ba", ",", "Bb", ",", 
        RowBox[{"M", "=", "Mmat"}], ",", 
        RowBox[{"N", "=", "Nmat"}], ",", 
        RowBox[{"G", "=", "Gmat"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ba", "=", 
        RowBox[{"Sum", "[", "    ", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", "    ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Jm", "[", 
                RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
              RowBox[{"Tr", "[", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"W", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[Transpose]"], ".", 
                RowBox[{"N", "[", 
                 RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", 
           "-", 
           RowBox[{"2", " ", 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"N", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"G", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], "        ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bb", "=", 
        RowBox[{"Sum", "[", "    ", 
         RowBox[{
          RowBox[{
           RowBox[{"Sum", "[", "    ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Jm", "[", 
                RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
              RowBox[{"Tr", "[", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"W", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Transpose]"], ".", 
                RowBox[{"N", "[", 
                 RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], " ", 
           "-", 
           RowBox[{"2", " ", 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"N", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"G", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], "         ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"Re", "@", "Ba"}]}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"Re", "@", "Bb"}]}], "]"}]}]}]}], " ", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"cMF", "[", 
     RowBox[{"Jm_", ",", "U_", ",", "W_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"N", "=", "Nmat"}], "}"}], ",", " ", 
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "8"}], "  ", 
         RowBox[{
          RowBox[{"Jm", "[", 
           RowBox[{"[", "\[Gamma]", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], " ", "]"}], " ", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}]}], "+", 
           RowBox[{"2", "  ", 
            RowBox[{"Tr", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"U", "[", 
                RowBox[{"[", "\[Gamma]", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
              RowBox[{"U", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}]}], "   ", 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
     "          ", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"enMF", "[", 
     RowBox[{"Jm_", ",", "U_", ",", "W_", ",", "h_", ",", "\[Lambda]_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"M", "=", "Mmat"}], ",", 
        RowBox[{"N", "=", "Nmat"}], ",", 
        RowBox[{"G", "=", "Gmat"}]}], "}"}], ",", "    ", 
      RowBox[{
       RowBox[{"cMF", "[", 
        RowBox[{"Jm", ",", "U", ",", "W"}], "]"}], " ", "+", 
       RowBox[{
        RowBox[{"1", "/", "4"}], "  ", 
        RowBox[{"Sum", "[", "   ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"h", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", "\[Sigma]", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "]"}]}], " ", 
           "+", "    ", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", 
              RowBox[{"\[Sigma]", ",", "\[Gamma]"}], "]"}], "]"}], " ", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", "\[Sigma]", "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"G", "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "]"}]}]}], 
          "       ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}]}], 
     "        ", "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.9025091654690228`*^9, 3.9025091755303926`*^9}, 
   3.90251031710708*^9, 3.9025103833038435`*^9, {3.9025133214905095`*^9, 
   3.9025133400093775`*^9}, 
   3.9026591380290966`*^9},ExpressionUUID->"6607212d-ab68-4a3c-9feb-\
c2c50dbddbb3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cMF", "[", 
    RowBox[{"Jm_", ",", "U_", ",", "W_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"N", "=", "Nmat"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"8", 
        SuperscriptBox["L", "2"]}]], 
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Jm", "[", 
           RowBox[{"[", 
            RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", 
                 RowBox[{"r", ",", "1"}], "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], " ", "]"}], " ", 
            RowBox[{"Tr", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"W", "[", 
                RowBox[{"[", 
                 RowBox[{"r", ",", "2"}], "]"}], "]"}], "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}]}], "+", 
           RowBox[{"2", "  ", 
            RowBox[{"Tr", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"U", "[", 
                RowBox[{"[", 
                 RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], 
               "\[Transpose]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
              RowBox[{"U", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], ".", 
              RowBox[{"N", "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}]}], "   ", 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", 
          SuperscriptBox["L", "2"]}], "}"}]}], "]"}]}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"enMF", "[", 
    RowBox[{
    "Jm_", ",", "U_", ",", "W_", ",", "h_", ",", "\[Lambda]_", ",", "L_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "=", "Mmat"}], ",", 
       RowBox[{"N", "=", "Nmat"}], ",", 
       RowBox[{"G", "=", "Gmat"}]}], "}"}], ",", "    ", 
     RowBox[{
      RowBox[{"cMF", "[", 
       RowBox[{"Jm", ",", "U", ",", "W", ",", "L"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["1", 
         RowBox[{"4", 
          SuperscriptBox["L", "2"]}]], ")"}], " ", " ", 
       RowBox[{"Sum", "[", "   ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"h", "[", 
            RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
           RowBox[{"Tr", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"W", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "\[Sigma]"}], "]"}], "]"}], 
              "\[Transpose]"}], ".", 
             RowBox[{"N", "[", 
              RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "]"}]}], " ", "+",
           "  ", 
          RowBox[{
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", 
             RowBox[{"r", ",", "\[Sigma]", ",", "\[Gamma]"}], "]"}], "]"}], 
           " ", 
           RowBox[{"Tr", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"W", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "\[Sigma]"}], "]"}], "]"}], 
              "\[Transpose]"}], ".", 
             RowBox[{"G", "[", 
              RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], " ", "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           SuperscriptBox["L", "2"]}], "}"}]}], "]"}]}]}]}], "        ", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9025103193342323`*^9, 3.9025103272773685`*^9}, {
  3.9025103859588904`*^9, 3.9025105223766904`*^9}, {3.902510600677963*^9, 
  3.902510727876316*^9}, {3.902510761240363*^9, 3.902510801582918*^9}, {
  3.9025130806922216`*^9, 3.9025132554314413`*^9}, {3.902513346842637*^9, 
  3.9025133519363637`*^9}, {3.9025133853069897`*^9, 3.902513387618909*^9}, {
  3.902513867235485*^9, 
  3.902513867615872*^9}},ExpressionUUID->"e7b1cf79-f21c-4b18-bb19-\
46600335e85d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Hmf", "[", 
    RowBox[{
    "Jmat_", ",", "h_", ",", "U_", ",", "W_", ",", "L_", ",", "\[Lambda]_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Nc", "=", 
        SuperscriptBox["L", "2"]}], ",", "H", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Hx", ",", "Hy", ",", "Hz"}], "}"}], "=", 
        RowBox[{"Haux", "[", 
         RowBox[{
         "Jmat", ",", "h", ",", "U", ",", "W", ",", "\[Lambda]", ",", "L"}], 
         "]"}]}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"H", "=", " ", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rx", ",", "ry", ",", "rz", ",", "mx", ",", "ny"}], 
             "}"}], ",", " ", 
            RowBox[{
             RowBox[{"mx", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "L"}], "]"}]}], ";", 
             RowBox[{"ny", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L"}], "]"}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"rx", "=", 
              RowBox[{"mx", "+", 
               RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", 
             RowBox[{"ry", "=", 
              RowBox[{"m", "+", 
               RowBox[{"ny", " ", "L"}], "+", "1"}]}], ";", 
             RowBox[{"rz", "=", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", 
             "\[IndentingNewLine]", "  ", 
             RowBox[{
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"one", "[", 
                 RowBox[{"rz", ",", "rx", ",", "Nc"}], "]"}], ",", 
                RowBox[{"Hx", "[", 
                 RowBox[{"[", "rz", "]"}], "]"}]}], "      ", "]"}], "+", " ",
               "\[IndentingNewLine]", 
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"one", "[", 
                 RowBox[{"rz", ",", "ry", ",", "Nc"}], "]"}], ",", 
                RowBox[{"Hy", "[", 
                 RowBox[{"[", "rz", "]"}], "]"}]}], "    ", "]"}], "+", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"one", "[", 
                 RowBox[{"rz", ",", "rz", ",", "Nc"}], "]"}], ",", 
                RowBox[{"Hz", "[", 
                 RowBox[{"[", "rz", "]"}], "]"}]}], "    ", "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", "  ", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"H", "+", 
         RowBox[{"H", "\[ConjugateTranspose]"}]}], ")"}]}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.882957814291709*^9, 3.8829578181393504`*^9}, {
   3.8829580740550365`*^9, 3.8829581001830273`*^9}, 3.8829582795039988`*^9, {
   3.902507683557411*^9, 3.9025077652299805`*^9}, {3.902507827533038*^9, 
   3.9025078285684214`*^9}, {3.9025078597786555`*^9, 3.902507879037114*^9}, {
   3.902508533614656*^9, 3.9025085675012665`*^9}, {3.902508721494076*^9, 
   3.902508726219141*^9}, {3.9025087594972258`*^9, 3.9025088386511073`*^9}, {
   3.902508915108306*^9, 3.902508915352504*^9}, {3.902514813640723*^9, 
   3.902514825767732*^9}, {3.9025163542755394`*^9, 3.902516378623106*^9}, {
   3.902942914290815*^9, 
   3.902942915472452*^9}},ExpressionUUID->"f1470e9b-3fe3-4e66-94d3-\
615e42f9fb46"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Haux", "[", 
    RowBox[{
    "Jmat_", ",", "h_", ",", "U_", ",", "W_", ",", "\[Lambda]_", ",", "L_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "=", "Mmat"}], ",", 
       RowBox[{"Nm", "=", "Nmat"}], ",", 
       RowBox[{"G", "=", "Gmat"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"Ax", ",", "Ay", ",", "Az", ",", "BA", ",", "BB"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Ax", ",", "Ay", ",", "Az"}], "}"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "#"}], 
               "]"}]}], "&"}], "/@", 
            RowBox[{"Re", "@", 
             RowBox[{"Table", "[", "    ", 
              RowBox[{
               RowBox[{"Sum", "[", "   ", 
                RowBox[{
                 RowBox[{"2", "  ", 
                  RowBox[{
                   RowBox[{"Jmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
                  RowBox[{
                   RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], ".", 
                   RowBox[{"U", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], ".", 
                   RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Beta]", "]"}], "]"}]}]}], " ", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], 
               ",", " ", 
               RowBox[{"{", 
                RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], 
              "]"}]}]}]}], "   ", ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"BA", ",", "BB"}], "}"}], "        ", "=", 
           RowBox[{"\[ImaginaryI]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
                RowBox[{"Re", "@", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sum", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Jmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
                    RowBox[{"Tr", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "\[Transpose]"], 
                    ".", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], 
                    " ", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"h", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Lambda]", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
                    RowBox[{"G", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], 
                  "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"KroneckerProduct", "[", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
                RowBox[{"Re", "@", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sum", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Jmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "]"}], " ", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], " ", 
                    RowBox[{"Tr", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"W", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}], "\[Transpose]"], 
                    ".", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Beta]", "]"}], "]"}]}], " ", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}], 
                    " ", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"h", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
                    RowBox[{"Nm", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Lambda]", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}], " ", 
                    RowBox[{"G", "[", 
                    RowBox[{"[", "\[Gamma]", "]"}], "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], 
                  "]"}]}]}], "]"}]}], "   ", "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Ax", ",", "Ay", ",", 
            RowBox[{"Az", "+", "BA", "+", "BB"}]}], "}"}]}]}], " ", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1", ",", 
         SuperscriptBox["L", "2"]}], "}"}]}], "]"}]}], "                  ", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9025088498778496`*^9, 3.9025089298882294`*^9}, {
  3.902509285971363*^9, 3.9025093227265406`*^9}, {3.9025093696372375`*^9, 
  3.9025093854549227`*^9}, {3.9025094171353865`*^9, 3.902509432097284*^9}, {
  3.9025095286924124`*^9, 3.9025095310096292`*^9}, {3.902509687859318*^9, 
  3.902509719158452*^9}, {3.902509972042452*^9, 3.9025099908098965`*^9}, {
  3.9025135731164737`*^9, 3.90251361375003*^9}, {3.9025136649801493`*^9, 
  3.9025138543861732`*^9}, {3.902513895786209*^9, 3.902513897159852*^9}, {
  3.9025151146503754`*^9, 
  3.902515141875595*^9}},ExpressionUUID->"a04abf83-75ac-4fe3-a3fa-\
1dc9618af95e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UmatK", "[", "H_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R", "=", 
       RowBox[{"Eigensystem", "@", 
        RowBox[{"N", "[", "H", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ReverseSort", "[", 
         RowBox[{"R", "\[Transpose]"}], "]"}], "\[Transpose]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[Transpose]"}]}], " ", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"8cbf734c-61e8-4a65-b32f-a9aca70998d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Heff", "[", 
    RowBox[{"Jmat_", ",", "h_", ",", "W_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Nm", "=", "Nmat"}], ",", "M"}], "}"}], ",", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"Tr", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"W", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "\[Sigma]"}], "]"}], "]"}], "\[Transpose]"], 
            ".", 
            RowBox[{"Nm", "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", 
           SuperscriptBox["L", "2"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], " ", "]"}]}], 
      " ", ";", "\[IndentingNewLine]", " ", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{"h", "-", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"Sum", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Jmat", "[", 
              RowBox[{"[", 
               RowBox[{"r", ",", "\[Gamma]"}], "]"}], "]"}], ".", 
             RowBox[{"M", "\[LeftDoubleBracket]", "   ", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"r", "+", 
                  RowBox[{
                   RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"r", ",", "L"}], "]"}], "-", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"r", "-", 
                    RowBox[{"1", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "\[Sigma]"}], "-", "3"}], ")"}]}]}], ",", 
                    "L"}], "]"}]}], " ", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[LeftFloor]", 
                    FractionBox[
                    RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "+", 
                    RowBox[{"1", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "\[Sigma]"}], "-", "3"}], ")"}]}]}], ",", 
                    "L"}], "]"}], "-", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[LeftFloor]", 
                    FractionBox[
                    RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], ",", 
                    "L"}], "]"}]}], ")"}], " ", " ", "L"}], ",", "0"}], " ", 
                    "}"}], "[", 
                   RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "  ", ",", 
                 SuperscriptBox["L", "2"]}], "]"}], ",", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Sigma]", "+", "1"}], ",", "2", ",", "1"}], 
                "]"}]}], "\[RightDoubleBracket]"}]}], "  ", ",", 
            RowBox[{"{", 
             RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", 
          SuperscriptBox["L", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}], "    ",
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9025102120971794`*^9, 3.9025102709820414`*^9}, {
   3.9025139204260073`*^9, 3.902514012764992*^9}, {3.9025140437481017`*^9, 
   3.9025141017741847`*^9}, {3.9025146389479337`*^9, 3.902514745216813*^9}, {
   3.9025147836964645`*^9, 3.902514784123452*^9}, {3.902514887601636*^9, 
   3.9025150478268223`*^9}, {3.9025151037826395`*^9, 3.902515105425405*^9}, {
   3.902515193445398*^9, 3.902515212368495*^9}, {3.9025157190082474`*^9, 
   3.902515741956709*^9}, 3.9025158981792884`*^9, {3.9025159569920483`*^9, 
   3.9025159633835125`*^9}, 3.902516008051693*^9, {3.9025160985200043`*^9, 
   3.902516204181082*^9}, {3.9025162364923077`*^9, 3.9025162516813183`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"54525139-b2a2-4e5f-a1f6-fa653db5e49e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"r", "-", "1", "-", 
      RowBox[{
       RowBox[{"\[LeftFloor]", 
        FractionBox[
         RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "L"}]}]}], ";", 
    "  ", 
    RowBox[{"n", "=", 
     RowBox[{"\[LeftFloor]", 
      FractionBox[
       RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}]}], ";", "       ", 
    RowBox[{"\[Delta]", "=", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"r", "-", "1", "-", 
            RowBox[{
             RowBox[{"\[LeftFloor]", 
              FractionBox[
               RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "L"}], "+", 
            "1"}], ",", "L"}], "]"}], "-", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"r", "-", "1", "-", 
            RowBox[{
             RowBox[{"\[LeftFloor]", 
              FractionBox[
               RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "L"}]}], ",",
            "L"}], "]"}]}], "        ", ")"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[LeftFloor]", 
              FractionBox[
               RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}], "+", "1"}], 
            ",", "L"}], "]"}], "-", 
          RowBox[{"\[LeftFloor]", 
           FractionBox[
            RowBox[{"r", "-", "1"}], "L"], "\[RightFloor]"}]}], ")"}], " ", 
        "L"}], ",", "0"}], " ", "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9025152146181574`*^9, 3.9025152656708097`*^9}, {
  3.9025155114411435`*^9, 3.9025155190158577`*^9}, {3.902516253567867*^9, 
  3.9025162602373214`*^9}},ExpressionUUID->"ab3a2d95-6d51-476a-8e52-\
93ec3f131b36"]
}, Closed]],

Cell[CellGroupData[{

Cell["Mean field parameters ", "Subsubsection",
 CellChangeTimes->{{3.8684480451770086`*^9, 3.8684480477902627`*^9}, {
  3.902944628617072*^9, 3.9029446303535547`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"b3e77d08-352b-4a7f-aa6e-6655b45d73f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tx", " ", "=", " ", 
    RowBox[{"KroneckerProduct", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[ImaginaryI]", ",", 
          RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Band", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "  ", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ty", " ", "=", " ", 
   RowBox[{"KroneckerProduct", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[ImaginaryI]", ",", 
         RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}], "}"}], ",", " ", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "  ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tz", " ", "=", " ", 
    RowBox[{"KroneckerProduct", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[ImaginaryI]", ",", 
          RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Band", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "  ", "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tmat", "[", 
    RowBox[{"L1_", ",", "L2_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Nc", "=", 
        RowBox[{"L1", " ", "L2"}]}], ",", "T"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rx", ",", "ry", ",", "rz", ",", "mx", ",", "ny"}], "}"}],
            ",", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"mx", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"m", "+", "1"}], ",", "L1", ",", "1"}], "]"}]}], ";", 
            RowBox[{"ny", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", "L2", ",", "1"}], "]"}]}], ";", 
            " ", 
            RowBox[{"rx", "=", 
             RowBox[{"mx", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}], "L1"}]}]}], ";", 
            RowBox[{"ry", "=", 
             RowBox[{"m", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ny", "-", "1"}], ")"}], "L1"}]}]}], ";", 
            RowBox[{"rz", "=", 
             RowBox[{"m", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}], "L1"}]}]}], ";", 
            "\[IndentingNewLine]", " ", 
            RowBox[{
             RowBox[{"KroneckerProduct", "[", " ", 
              RowBox[{
               RowBox[{"one", "[", 
                RowBox[{"rz", ",", "rx", ",", "Nc"}], "]"}], ",", "Tx"}], 
              "]"}], "+", "  ", 
             RowBox[{"KroneckerProduct", "[", " ", 
              RowBox[{
               RowBox[{"one", "[", 
                RowBox[{"rz", ",", "ry", ",", "Nc"}], "]"}], ",", "Ty"}], 
              "]"}], "+", " ", 
             RowBox[{"KroneckerProduct", "[", " ", 
              RowBox[{
               RowBox[{"one", "[", 
                RowBox[{"rz", ",", "rz", ",", "Nc"}], "]"}], ",", "Tz"}], " ",
               "]"}]}]}]}], "]"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "L1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "L2"}], "}"}]}], "]"}]}], ";", "T"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.868448425163019*^9},
 FontFamily->"Consolas",
 CellLabel->
  "In[106]:=",ExpressionUUID->"d37ec3c5-abcc-4e5d-b6a4-5e9c0d44f4b4"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bilinears", "[", 
     RowBox[{"U_", ",", "L_"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", "  ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"Nc", "=", 
         SuperscriptBox["L", "2"]}], ",", "TU", ",", "TUh", ",", "u", ",", 
        RowBox[{"\[Chi]", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"Null", ",", "3"}], "]"}]}], ",", 
        RowBox[{"\[Omega]", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"Null", ",", "2"}], "]"}]}], ",", 
        RowBox[{"\[Xi]", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"Null", ",", "6"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TU", "=", 
        RowBox[{
         RowBox[{"Tmat", "[", 
          RowBox[{"L", ",", "L"}], "]"}], ".", "U"}]}], ";", 
       RowBox[{"TUh", "=", 
        RowBox[{"TU", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], "Nc"}], ";;", 
            RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", 
       RowBox[{"u", "=", 
        RowBox[{"\[ImaginaryI]", "  ", 
         RowBox[{"TUh", ".", 
          RowBox[{"TUh", "\[ConjugateTranspose]"}]}]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", " ", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}]}]}],
             "   ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "rx", ",", "mx", ",", "Io", ",", "J"}], 
              "}"}], ",", 
             RowBox[{
              RowBox[{"mx", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ",", "L"}], " ", "]"}]}], ";", " ", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"rx", "=", 
               RowBox[{"mx", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"8", "rx"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], " ", ")"}]}]}]}],
             "    ", "]"}], "   ", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Chi]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "ry", ",", "ny", ",", "Io", ",", "J"}], 
              "}"}], ",", " ", 
             RowBox[{
              RowBox[{"ny", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ",", "L"}], "]"}]}], ";", "  ", 
              RowBox[{"ry", "=", 
               RowBox[{"m", "+", 
                RowBox[{"ny", " ", "L"}]}]}], ";", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"8", "ry"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "  ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", " ", 
                TemplateBox[{
                  RowBox[{"Io", ",", "J"}]},
                 "KroneckerDeltaSeq"]}], "  ", "+", " ", 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"u", "[", 
                   RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                  RowBox[{"u", "[", 
                   RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
            " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"+", " ", 
               FractionBox["1", "2"]}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}], "  ", 
              RowBox[{"u", "[", 
               RowBox[{"[", 
                RowBox[{"J", ",", "Io"}], "]"}], "]"}]}], "  ", "*)"}], "   ",
             "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "Io", ",", "J"}], "}"}], ",", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", " ", 
                TemplateBox[{
                  RowBox[{"Io", ",", "J"}]},
                 "KroneckerDeltaSeq"]}], " ", "+", 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"u", "[", 
                   RowBox[{"[", 
                    RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                  RowBox[{"u", "[", 
                   RowBox[{"[", 
                    RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
            " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"+", " ", 
               FractionBox["1", "2"]}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                RowBox[{"u", "[", 
                 RowBox[{"[", 
                  RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}], "  ", 
              RowBox[{"u", "[", 
               RowBox[{"[", 
                RowBox[{"J", ",", "Io"}], "]"}], "]"}]}], "  ", "*)"}], " ", 
            " ", "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", " ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"r", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "+", "1"}], ",", "L"}], " ", "]"}], " ", 
                 "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "         ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", " ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"r", "=", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "-", "1"}], ",", "L"}], " ", "]"}], "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "       ", "    ", "]"}], "   ", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", " ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", "  ", 
              RowBox[{"r", "=", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "+", "1"}], ",", "L"}], " ", "]"}], "+", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "-", "1"}], ",", "L"}], "]"}], " ", "L"}]}]}],
               ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "            ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", "  ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"r", "=", 
               RowBox[{"m", "+", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "-", "1"}], ",", "L"}], " ", "]"}], " ", 
                 "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", " ", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "            ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{"rz", ",", "r", ",", "Io", ",", "J"}], "}"}], ",", "  ", 
             RowBox[{
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"r", "=", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "+", "1"}], ",", "L"}], " ", "]"}], "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", " ", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "+", " ", "4", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "            ", "]"}], "   ", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", " ", 
           RowBox[{"#", " ", ",", "1"}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
              "rz", ",", "r", ",", "mx", ",", "ny", ",", "Io", ",", "J"}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"r", "=", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"m", "-", "1"}], ",", "L"}], " ", "]"}], "+", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}]}]}],
               ";", 
              RowBox[{"rz", "=", 
               RowBox[{"m", "+", 
                RowBox[{"n", " ", "L"}]}]}], ";", " ", 
              RowBox[{"Io", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Alpha]", "+", "4", "+", 
                  RowBox[{"8", "rz"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              RowBox[{"J", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", "+", "4", " ", "+", 
                  RowBox[{"8", "r"}]}], ",", 
                 RowBox[{"8", 
                  SuperscriptBox["L", "2"]}], ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"J", ",", "Io"}], "]"}], "]"}], " ", "-", 
                 RowBox[{"u", "[", 
                  RowBox[{"[", 
                   RowBox[{"Io", ",", "J"}], "]"}], "]"}]}], ")"}]}]}]}], 
            "           ", "]"}], "    ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Chi]", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"\[Chi]", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"\[Chi]", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"\[Xi]", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], " ", ",", "u"}], " ", 
          "}"}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "16"}]]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",ExpressionUUID->"4f595269-c9d5-4b8e-9be1-753434b1bc87"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]gauge4v", "[", 
    RowBox[{"\[Chi]0_", ",", "L_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d1", ",", "d2", ",", 
       RowBox[{"\[Chi]", "=", "\[Chi]0"}], ",", "mS", ",", "nS", ",", "mN", 
       ",", "nN", ",", "r2"}], " ", "}"}], ",", "   ", 
     RowBox[{
      RowBox[{"r2", "=", " ", 
       RowBox[{"\[LeftFloor]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"\[LeftCeiling]", 
          RowBox[{"L", "/", "2"}], "\[RightCeiling]"}]}], "\[RightFloor]"}]}],
       ";", " ", 
      RowBox[{"d2", "=", 
       RowBox[{"2", "r2"}]}], ";", 
      RowBox[{"d1", "=", 
       RowBox[{"L", "-", "d2"}]}], ";", "  ", 
      RowBox[{"mS", "=", 
       RowBox[{"r2", "-", "1"}]}], ";", 
      RowBox[{"nS", "=", 
       RowBox[{"r2", "-", "1"}]}], ";", 
      RowBox[{"mN", "=", 
       RowBox[{"L", "-", "r2", "-", "1"}]}], ";", 
      RowBox[{"nN", "=", 
       RowBox[{"L", "-", "r2", "-", "1"}]}], ";", "\n", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", "mS"}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"nS", "+", "i"}]}], " ", ";", "       ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}]}], "      ", 
         "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", "   ", "\n", 
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "m", ",", "n"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"m", " ", "=", "mN"}], " ", ";", " ", 
           RowBox[{"n", "=", 
            RowBox[{"nN", "-", "i", "+", "1"}]}], ";", " ", 
           RowBox[{"r", " ", "=", " ", 
            RowBox[{"m", "+", 
             RowBox[{"n", " ", "L"}], "+", "1"}]}], ";", "    ", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"\[Chi]0", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ";"}]}], "       ", 
         "]"}], "   ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "d1"}], "}"}]}], "]"}], ";", "       ", 
      "\[Chi]"}]}], " ", "]"}]}], ";"}]], "Input",ExpressionUUID->"46979265-\
40c0-4da5-81d2-778e1f7d8218"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Chi]fixgauge", "[", 
    RowBox[{"\[Chi]0_", ",", "u0_", ",", "L_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]", "=", "\[Chi]0"}], " ", "}"}], ",", " ", "\n", 
     RowBox[{
      RowBox[{"Do", "[", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Chi]", "[", 
            RowBox[{"[", 
             RowBox[{"\[Alpha]", ",", "r"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"\[Alpha]", "+", "1"}], ",", 
             RowBox[{"\[Alpha]", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"u0", "[", 
            RowBox[{"[", 
             RowBox[{"r", ",", "\[Alpha]"}], "]"}], "]"}], 
           RowBox[{"Abs", "@", 
            RowBox[{
             RowBox[{"\[Chi]0", "[", 
              RowBox[{"[", 
               RowBox[{"\[Alpha]", ",", "r"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"\[Alpha]", "+", "1"}], ",", 
               RowBox[{"\[Alpha]", "+", "1"}]}], "]"}], "]"}]}]}]}], ";"}], 
        "      ", ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], " ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"r", ",", "1", ",", 
          RowBox[{"L", "^", "2"}]}], "}"}]}], "]"}], ";", "   ", 
      "\[IndentingNewLine]", "   ", "\[Chi]"}]}], " ", "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"247d95a1-bf8f-431b-847d-f99a4a26dc9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"icc", "[", 
    RowBox[{"U_", ",", "L_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "  ", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"Nc", "=", 
        RowBox[{"L", "^", "2"}]}], ",", "TUh", ",", "icc"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"TUh", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"T", " ", ".", " ", "U"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], "Nc"}], ";;", 
             RowBox[{"-", "1"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"10", "^", 
          RowBox[{"-", "12"}]}]}], "]"}]}], ";", 
      RowBox[{"icc", "=", " ", 
       RowBox[{"I", " ", 
        RowBox[{"TUh", " ", ".", " ", 
         RowBox[{"TUh", "\[ConjugateTranspose]"}]}]}]}], " ", ";", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"icc", "-", 
         RowBox[{"ConjugateTranspose", "[", "icc", "]"}]}], " ", ")"}], "/", 
       "2"}]}]}], " ", "]"}]}], ";"}]], "Input",ExpressionUUID->"3340ea2e-\
3efa-4880-b0e0-1592b4901db7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy MF", "Subsubsection",
 CellChangeTimes->{{3.871463671236149*^9, 3.8714636725835357`*^9}, {
  3.8951314360002074`*^9, 3.8951314365585756`*^9}},
 FontFamily->"Consolas",
 FontWeight->"Bold",ExpressionUUID->"c8642423-6c54-4e5b-bbfc-31fe829d8430"],

Cell["Define energy ", "Text",
 CellChangeTimes->{{3.902943663087566*^9, 
  3.902943669564706*^9}},ExpressionUUID->"cab4f53f-a9ed-41c8-a8fe-\
51dab0829624"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"EnMF", "[", 
   RowBox[{
   "J_", ",", "K_", ",", "\[CapitalGamma]_", ",", "h_", ",", "\[Chi]_", ",", 
    "\[Omega]_", ",", "L1_", ",", "L2_"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.903449513409891*^9},ExpressionUUID->"740095b0-2b72-4889-bdf9-\
861fb4f61bbe"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"EnMF", "[", 
     RowBox[{
     "J_", ",", "K_", ",", "\[CapitalGamma]_", ",", "h_", ",", "\[Chi]_", ",",
       "\[Omega]_", ",", "L1_", ",", "L2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nc", "=", 
         RowBox[{"L1", " ", "L2"}]}], ",", "E"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"E", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r", ",", "mx", ",", "ny", ",", 
              RowBox[{"\[CurlyEpsilon]", "=", 
               RowBox[{"Abs", "@", 
                RowBox[{"LeviCivitaTensor", "[", "3", "]"}]}]}]}], "}"}], ",",
             " \t", 
            RowBox[{
             RowBox[{"mx", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}]}], ";", 
             RowBox[{"ny", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}]}], ";", "   ", 
             RowBox[{"r", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"mx", "+", 
                 RowBox[{"n", " ", "L1"}], "+", "1"}], ",", 
                RowBox[{"m", "+", 
                 RowBox[{"ny", " ", "L1"}], "+", "1"}], ",", 
                RowBox[{"m", "+", 
                 RowBox[{"n", " ", "L1"}], "+", "1"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"h", "[", 
                 RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}]}], " ", 
               RowBox[{"(", "   ", 
                RowBox[{
                 RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", 
                   RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                   RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                  "\[RightDoubleBracket]"}], "+", 
                 RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", 
                   RowBox[{"r", "[", 
                    RowBox[{"[", " ", "3", "]"}], "]"}], " ", ",", " ", 
                   RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                  "\[RightDoubleBracket]"}]}], "    ", ")"}]}], "         ", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"J", " ", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                "\[RightDoubleBracket]"}], "  ", 
               RowBox[{"Sum", "[", "    ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                  RowBox[{
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "+", 
                  RowBox[{
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", "\[Beta]"}]}], 
                    "\[RightDoubleBracket]"}]}]}], "      ", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
              " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"K", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", " ", "\[Gamma]"}], 
                 "]"}], "]"}], " ", 
               RowBox[{"(", "  ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                 RowBox[{
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}]}], 
                   "\[RightDoubleBracket]"}], "   ", 
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                   "\[RightDoubleBracket]"}]}], "  ", "+", 
                 RowBox[{
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "   ", 
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", " ", "\[Gamma]"}]}], 
                   "\[RightDoubleBracket]"}]}]}], "    ", ")"}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{"Sum", "[", "    ", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                  "\[RightDoubleBracket]"}], "  ", 
                 RowBox[{"\[CurlyEpsilon]", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
                   "]"}], "]"}], " ", 
                 RowBox[{"(", "  ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                   RowBox[{
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", " ", 
                    RowBox[{"\[Beta]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}], "   ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "+", 
                   RowBox[{
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "   ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", " ", "\[Beta]"}]}], 
                    "\[RightDoubleBracket]"}]}]}], "    ", ")"}]}], 
                "\[IndentingNewLine]", ",", "     ", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", "  ", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], 
               "]"}]}]}]}], "    ", "]"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", "     ", 
          RowBox[{"{", " ", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}]}], ";", " ", 
       RowBox[{"Re", "@", 
        FractionBox["E", 
         RowBox[{" ", "Nc", " "}]]}]}]}], "   ", "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EnLagMF", "[", 
     RowBox[{
     "J_", ",", "K_", ",", "\[CapitalGamma]_", ",", "h_", ",", "\[Chi]_", ",",
       "\[Omega]_", ",", "L1_", ",", "L2_", ",", 
      RowBox[{"\[Lambda]_", ":", "\[Lambda]0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nc", "=", 
         RowBox[{"L1", " ", "L2"}]}], ",", "E"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"E", "=", " ", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"r", ",", "mx", ",", "ny"}], "}"}], ",", " \t", 
             RowBox[{
              RowBox[{"mx", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}]}], ";", 
              RowBox[{"ny", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}]}], ";", "   ", 
              RowBox[{"r", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mx", "+", 
                  RowBox[{"n", " ", "L1"}], "+", "1"}], ",", 
                 RowBox[{"m", "+", 
                  RowBox[{"ny", " ", "L1"}], "+", "1"}], ",", 
                 RowBox[{"m", "+", 
                  RowBox[{"n", " ", "L1"}], "+", "1"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", "      ", 
              RowBox[{
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", 
                RowBox[{"(", "   ", 
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"1", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "+", 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"2", "+", "1"}], ",", 
                    RowBox[{"3", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
                 "    ", ")"}]}], "  ", "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", 
                RowBox[{"(", "   ", 
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"2", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "+", 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"3", "+", "1"}], ",", 
                    RowBox[{"1", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
                 "    ", ")"}]}], "  ", "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], " ", 
                RowBox[{"(", "   ", 
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"3", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "+", 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"\[Sigma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"1", "+", "1"}], ",", 
                    RowBox[{"2", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
                 "    ", ")"}]}]}]}]}], "         ", "\[IndentingNewLine]", 
            "  ", "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}], ",", "   ", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", 
             RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}]}]}], ";", " ", 
       FractionBox["E", 
        RowBox[{" ", "Nc", " "}]]}]}], "   ", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"EnMF0", "[", 
     RowBox[{
     "J_", ",", "K_", ",", "\[CapitalGamma]_", ",", "h_", ",", "\[Chi]_", ",",
       "\[Omega]_", ",", "L1_", ",", "L2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nc", "=", 
         RowBox[{"L1", " ", "L2"}]}], ",", "E"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"E", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r", ",", "mx", ",", "ny", ",", 
              RowBox[{"\[CurlyEpsilon]", "=", 
               RowBox[{"Abs", "@", 
                RowBox[{"LeviCivitaTensor", "[", "3", "]"}]}]}]}], "}"}], ",",
             " \t", 
            RowBox[{
             RowBox[{"mx", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "L1"}], "]"}]}], ";", 
             RowBox[{"ny", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "L2"}], "]"}]}], ";", "   ", 
             RowBox[{"r", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"mx", "+", 
                 RowBox[{"n", " ", "L1"}], "+", "1"}], ",", 
                RowBox[{"m", "+", 
                 RowBox[{"ny", " ", "L1"}], "+", "1"}], ",", 
                RowBox[{"m", "+", 
                 RowBox[{"n", " ", "L1"}], "+", "1"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               RowBox[{"h", "[", 
                RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", 
               RowBox[{"(", "   ", 
                RowBox[{
                 RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", 
                   RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                   RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                  "\[RightDoubleBracket]"}], "+", 
                 RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", 
                   RowBox[{"r", "[", 
                    RowBox[{"[", " ", "3", "]"}], "]"}], " ", ",", " ", 
                   RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                  "\[RightDoubleBracket]"}]}], "    ", ")"}]}], "         ", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"J", " ", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                "\[RightDoubleBracket]"}], "  ", 
               RowBox[{"Sum", "[", "    ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                  RowBox[{
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "    ", "+", 
                  RowBox[{
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", "\[Beta]"}]}], 
                    "\[RightDoubleBracket]"}]}]}], "      ", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
              " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{
               RowBox[{"K", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", " ", "\[Gamma]"}], 
                 "]"}], "]"}], " ", 
               RowBox[{"(", "  ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}]}], " ", "+", 
                 RowBox[{"Abs", "[", " ", 
                  RowBox[{
                   RowBox[{"-", " ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}]}], "   ", 
                   RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], " ", "]"}], " ", "+", 
                 RowBox[{
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Gamma]", "+", "1"}], ",", "1"}], 
                   "\[RightDoubleBracket]"}], "   ", 
                  RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                   RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", " ", "\[Gamma]"}]}], 
                   "\[RightDoubleBracket]"}]}]}], "    ", ")"}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "+", 
              RowBox[{"Sum", "[", "    ", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[Gamma]"}], 
                  "\[RightDoubleBracket]"}], "  ", 
                 RowBox[{"\[CurlyEpsilon]", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], 
                   "]"}], "]"}], " ", 
                 RowBox[{"(", "  ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", " ", "\[Gamma]", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"\[Beta]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "-", " ", 
                   RowBox[{
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", " ", 
                    RowBox[{"\[Beta]", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}], "   ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "  ", "+", 
                   RowBox[{
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
                    RowBox[{"\[Alpha]", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "   ", 
                    RowBox[{"\[Chi]", "\[LeftDoubleBracket]", " ", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1", ",", 
                    RowBox[{"1", "+", " ", "\[Beta]"}]}], 
                    "\[RightDoubleBracket]"}]}]}], "    ", ")"}]}], 
                "\[IndentingNewLine]", ",", "     ", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", "  ", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], 
               "]"}]}]}]}], "    ", "]"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", "     ", 
          RowBox[{"{", " ", 
           RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", 
            RowBox[{"L1", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "0", ",", 
            RowBox[{"L2", "-", "1"}]}], "}"}]}], " ", "]"}]}], ";", " ", 
       RowBox[{"Re", "@", 
        FractionBox["E", 
         RowBox[{" ", "Nc", " "}]]}]}]}], "   ", "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.871472256995206*^9, 3.8714723852678127`*^9}, {
   3.871472425928979*^9, 3.8714725783063393`*^9}, {3.8714726258096247`*^9, 
   3.8714729588880634`*^9}, {3.8714730232256002`*^9, 3.871473036406559*^9}, {
   3.8714730727212043`*^9, 3.871473079531608*^9}, {3.8714731109367337`*^9, 
   3.8714732607115307`*^9}, {3.871473326384891*^9, 3.8714733809568787`*^9}, {
   3.8714734159388523`*^9, 3.8714734178723702`*^9}, {3.871473822646452*^9, 
   3.8714738333651667`*^9}, 3.8714740941826563`*^9, {3.8715311759553733`*^9, 
   3.8715311870612297`*^9}, {3.871531251313411*^9, 3.8715313041178064`*^9}, {
   3.8715313532868347`*^9, 3.871531372330895*^9}, {3.8715314084527965`*^9, 
   3.8715314226007547`*^9}, 3.871531473179598*^9, {3.8715450768704815`*^9, 
   3.8715450777302523`*^9}, {3.871548008531889*^9, 3.8715480115428467`*^9}, {
   3.8715493861292086`*^9, 3.8715493920209494`*^9}, 3.871550039784697*^9, {
   3.871550097746545*^9, 3.871550098182736*^9}, {3.871550159726452*^9, 
   3.871550356235974*^9}, {3.8715568724544907`*^9, 3.871556874014618*^9}, {
   3.8715570949736185`*^9, 3.871557095355794*^9}, {3.8780325726062584`*^9, 
   3.878032573386405*^9}, {3.878037804366704*^9, 3.878037808348261*^9}, 
   3.882352269680444*^9, {3.8944400048612423`*^9, 3.8944400118352566`*^9}, 
   3.895046602320809*^9, 3.9029436576170673`*^9},
 FontFamily->
  "Consolas",ExpressionUUID->"3f4bae56-6c1d-4a7f-acad-165d3de18001"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wilson loop", "Subsubsection",
 CellChangeTimes->{{3.8866550978543205`*^9, 3.8866551044908752`*^9}, {
  3.8866562240394773`*^9, 3.8866562278844843`*^9}, {3.9029442087699633`*^9, 
  3.902944210842572*^9}},ExpressionUUID->"1f33cda0-a6a0-4bff-91bf-\
11e7d8dd3cb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WilsonLoop", "[", 
    RowBox[{"\[Chi]_", ",", "\[Omega]_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cyc", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"cyc", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n", ",", "R", ",", 
            RowBox[{"W", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
          ",", "  ", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{"\[LeftFloor]", 
             RowBox[{"p", "/", "L"}], "\[RightFloor]"}]}], ";", 
           RowBox[{"m", "=", 
            RowBox[{"p", "-", 
             RowBox[{"n", " ", "L"}]}]}], ";", " ", "\[IndentingNewLine]", 
           RowBox[{"R", "=", 
            RowBox[{"{", "    ", 
             RowBox[{"(*", "  ", 
              RowBox[{"r", ",", "\[Sigma]", ",", 
               RowBox[{"\[Gamma]", " ", "->", " ", "ext"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "+", 
                 RowBox[{"n", " ", "L"}], " ", "+", "1"}], ",", "0", ",", 
                "3"}], "  ", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"n", ",", "L"}], "]"}], " ", "L"}], " ", "+", 
                 "1"}], "  ", ",", "1", ",", "2"}], " ", "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                 RowBox[{"n", " ", "L"}], " ", "+", "1"}], ",", "0", ",", 
                "1"}], "    ", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                 " ", "+", "1"}], "  ", ",", "1", ",", "3"}], "  ", "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"m", "+", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                 "+", "1"}], "   ", ",", "0", ",", "2"}], "   ", "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"m", ",", "L"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                 " ", "+", "1"}], "  ", ",", "1", ",", "1"}], " ", "}"}]}], 
             "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"W", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
            RowBox[{"Product", "[", "   ", 
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", "1"}], ",", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "  ", "]"}], "]"}], ",",
                 "   ", 
                RowBox[{"cyc", "[", 
                 RowBox[{"[", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], 
               "    ", "]"}], "  ", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"W", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
            RowBox[{"Product", "[", "   ", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\[Gamma]", "=", 
                  RowBox[{
                   RowBox[{"cyc", "[", 
                    RowBox[{"[", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}], " ", 
                   "\[LeftDoubleBracket]", "g", "\[RightDoubleBracket]"}]}], 
                 "         ", "}"}], ",", "                     ", 
                RowBox[{
                 RowBox[{"\[Chi]", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"\[Gamma]", "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "  ", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Gamma]", ",", "\[Gamma]"}], "]"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "  ", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "3", ",", "5"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"g", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"W", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "+", 
             RowBox[{"W", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", 
          RowBox[{
           RowBox[{"L", "^", "2"}], "-", "1"}]}], "}"}]}], "]"}]}]}], "  ", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.886577297929345*^9, 3.8865774163443823`*^9}, {
   3.886577486094192*^9, 3.886577573260448*^9}, {3.886577604737681*^9, 
   3.886577688754797*^9}, {3.8865777785953984`*^9, 3.886577859080839*^9}, {
   3.886655190801131*^9, 3.886655260441708*^9}, {3.886655405185495*^9, 
   3.8866554294595222`*^9}, {3.886655514893617*^9, 3.886655515142964*^9}, 
   3.8866558223211565`*^9, {3.886655928048565*^9, 3.8866560367925*^9}, {
   3.886656068944904*^9, 3.8866561152531104`*^9}, {3.8866625161085405`*^9, 
   3.886662540364295*^9}, {3.886667132145313*^9, 3.8866671713303165`*^9}, 
   3.8866672030290933`*^9, 3.886668045441769*^9, {3.886668082846902*^9, 
   3.88666808590635*^9}, {3.8866877202335267`*^9, 3.8866877259689994`*^9}, 
   3.8866881720628347`*^9, {3.8873613558774967`*^9, 3.8873613687487946`*^9}, 
   3.8873666845333247`*^9},
 CellLabel->
  "In[174]:=",ExpressionUUID->"629fd037-c3e2-4a7e-90b0-4492629474f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"setP", "[", 
    RowBox[{"x_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"10", "^", "p"}], " ", "x"}], "]"}], "/", 
     RowBox[{"10", "^", "p"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setP1", "[", "x_", "]"}], ":=", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"10", " ", "x"}], "]"}], "/", "10"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8866876583274527`*^9, 3.8866877022308736`*^9}, {
  3.8866881207567883`*^9, 3.8866881219393177`*^9}, {3.8866881926094*^9, 
  3.886688193379299*^9}, {3.8866883322398443`*^9, 3.886688333149808*^9}, {
  3.8866885812246127`*^9, 3.886688595000948*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"f85dc0d5-82a0-43e5-9241-9d68e8519105"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyHueP", "[", 
   RowBox[{"x_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Hue", "@@", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"setP", "[", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "n", "]"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", "4"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8866884106151743`*^9, 3.8866885032164965`*^9}, {
  3.886688744616431*^9, 3.8866888575412292`*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"22e72a6a-b20a-4975-ae94-b9fee4928764"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WilsonLoopGraphicsZoom", "[", 
    RowBox[{"\[Chi]_", ",", "\[Omega]_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cyc", ",", 
       RowBox[{"linethick", "=", 
        RowBox[{".01", " ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "7", "]"}], 
           RowBox[{"Log", "[", "L", "]"}]], ")"}]}]}]}], " ", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"cyc", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"R", ",", 
             RowBox[{"W", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], "}"}], 
           ",", "  ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"R", "=", 
             RowBox[{"{", "    ", 
              RowBox[{"(*", "  ", 
               RowBox[{"r", ",", "\[Sigma]", ",", 
                RowBox[{"\[Gamma]", " ", "->", " ", "ext"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"m", "+", 
                  RowBox[{"n", " ", "L"}], " ", "+", "1"}], ",", "0", ",", 
                 "3"}], "  ", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                  RowBox[{"n", " ", "L"}], " ", "+", "1"}], "  ", ",", "1", 
                 ",", "2"}], " ", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                  RowBox[{"n", " ", "L"}], " ", "+", "1"}], ",", "0", ",", 
                 "1"}], "    ", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                  " ", "+", "1"}], "  ", ",", "1", ",", "3"}], "  ", "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"m", "+", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                  "+", "1"}], "   ", ",", "0", ",", "2"}], "   ", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"m", "+", 
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", "L"}], 
                  " ", "+", "1"}], "  ", ",", "1", ",", "1"}], " ", "}"}]}], 
              "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"W", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
             RowBox[{"Product", "[", "   ", 
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "  ", "]"}], "]"}], ",",
                  "   ", 
                 RowBox[{"cyc", "[", 
                  RowBox[{"[", 
                   RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], 
                "    ", "]"}], "  ", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"W", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
             RowBox[{"Product", "[", "   ", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]", "=", 
                   RowBox[{
                    RowBox[{"cyc", "[", 
                    RowBox[{"[", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}], " ", 
                    "\[LeftDoubleBracket]", "g", "\[RightDoubleBracket]"}]}], 
                  "         ", "}"}], ",", "                   ", 
                 RowBox[{
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "  ", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Gamma]", ",", "\[Gamma]"}], "]"}], "]"}]}], 
                "     ", "]"}], "  ", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "3", ",", "5"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"g", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"applyHueP", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "1", ",", "3", ",", "1"}], "}"}]}], 
                 "]"}], " ", "&"}], " ", "@", " ", 
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{
                   RowBox[{"Hue", "[", 
                    RowBox[{"0.97", ",", "0.3", ",", "0.96"}], "]"}], ",", 
                   " ", 
                   RowBox[{"Hue", "[", 
                    RowBox[{"0.5", ",", "0", ",", "0.5", ",", "0.7"}], "]"}], 
                   " ", ",", 
                   RowBox[{"Hue", "[", 
                    RowBox[{"0.65", ",", "1", ",", "1", ",", "0.4"}], "]"}]}],
                   "}"}], ",", 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", "2"], "+", 
                   RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"W", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                    RowBox[{"W", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "     ", ")"}]}]}], " ",
                   ")"}]}], "  ", "]"}]}], "   ", ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "[", 
                  RowBox[{"5", "linethick"}], "]"}], ",", 
                 RowBox[{"Hue", "[", 
                  RowBox[{"0.5", ",", "0.0", ",", "1", ",", "0.9"}], "]"}]}], 
                "}"}], "  ", "]"}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"Polygon", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "n", ",", "0"}], "]"}], ",", 
                 "   ", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", 
                   RowBox[{"n", "+", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{"m", ",", 
                   RowBox[{"n", "+", "1"}], ",", "0"}], "]"}], ",", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{"m", ",", 
                   RowBox[{"n", "+", "1"}], ",", "1"}], "]"}], " ", ",", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{"m", ",", "n", ",", "0"}], "]"}], ",", 
                 RowBox[{"\[Sigma]sites", "[", 
                  RowBox[{
                   RowBox[{"m", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
                "}"}], "  ", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "  ", 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{
            RowBox[{"L", "/", "2"}], "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"L", "/", "2"}], ",", 
           RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}]}]}], "  ", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8866568189244237`*^9, 3.8866568210135384`*^9}, {
   3.8866568744456973`*^9, 3.8866569467021303`*^9}, {3.8866570342948256`*^9, 
   3.8866570457892637`*^9}, {3.8866572089668126`*^9, 
   3.8866572257357535`*^9}, {3.8866572615234184`*^9, 
   3.8866572641346474`*^9}, {3.8866573343592267`*^9, 
   3.8866574444983244`*^9}, {3.886657505944301*^9, 3.8866575522971716`*^9}, 
   3.886657686422468*^9, {3.886657738057664*^9, 3.8866577512923994`*^9}, {
   3.886662473471694*^9, 3.8866624828733897`*^9}, {3.886662574270269*^9, 
   3.8866625901990314`*^9}, {3.8866627238953094`*^9, 3.8866627294517055`*^9}, 
   3.8866629632546062`*^9, {3.8866630032165675`*^9, 3.8866630278966837`*^9}, {
   3.886663531497528*^9, 3.886663621996422*^9}, {3.8866637919392395`*^9, 
   3.886663820516225*^9}, {3.8866638667541623`*^9, 3.8866639041954174`*^9}, {
   3.8866640389496183`*^9, 3.88666407490174*^9}, {3.8866641400430403`*^9, 
   3.886664154169366*^9}, {3.886664238323161*^9, 3.8866642386140375`*^9}, {
   3.886664287483392*^9, 3.8866642928836074`*^9}, {3.886664381854021*^9, 
   3.8866644280878906`*^9}, {3.886664466944436*^9, 3.886664554450766*^9}, {
   3.886665099883546*^9, 3.8866651202478323`*^9}, {3.8866651586282682`*^9, 
   3.8866652248723803`*^9}, {3.88666525504259*^9, 3.886665256281698*^9}, {
   3.886665386688386*^9, 3.8866653869139795`*^9}, {3.8866654513531656`*^9, 
   3.88666549653339*^9}, {3.8866657554878583`*^9, 3.886665815517968*^9}, {
   3.886665849358279*^9, 3.886665907834586*^9}, {3.8866664634405975`*^9, 
   3.8866665717318087`*^9}, {3.8866666105219545`*^9, 
   3.8866666687957587`*^9}, {3.886666722640232*^9, 3.8866667963971176`*^9}, {
   3.8866669128802805`*^9, 3.886666990683054*^9}, 3.8866681060216007`*^9, {
   3.8866686156960526`*^9, 3.8866686157631545`*^9}, {3.8866688471664424`*^9, 
   3.8866689578772416`*^9}, {3.8866870101407623`*^9, 3.886687014838278*^9}, {
   3.886687056947236*^9, 3.886687062139759*^9}, {3.8866872076719646`*^9, 
   3.886687217602276*^9}, {3.886687302600501*^9, 3.8866873359150896`*^9}, {
   3.8866875630460877`*^9, 3.886687564733532*^9}, {3.8866876495090303`*^9, 
   3.8866876507019677`*^9}, {3.886687707678115*^9, 3.8866877096264877`*^9}, {
   3.8866878329493113`*^9, 3.886687861982074*^9}, {3.8866879750103116`*^9, 
   3.8866879851685123`*^9}, {3.886688033834028*^9, 3.886688065205904*^9}, {
   3.8866881163846493`*^9, 3.8866881174810524`*^9}, {3.88668833648405*^9, 
   3.8866883366986237`*^9}, {3.8866885172334814`*^9, 
   3.8866885520814695`*^9}, {3.8866885999961386`*^9, 
   3.8866886235248985`*^9}, {3.8866886862238865`*^9, 3.886688703759144*^9}, {
   3.8866888746013746`*^9, 3.8866889179542065`*^9}, {3.886688956525893*^9, 
   3.8866889643246317`*^9}, {3.886689008036938*^9, 3.886689038226878*^9}, {
   3.8866890892898026`*^9, 3.8866890924114494`*^9}, 3.8872624714157*^9, {
   3.887349351124804*^9, 3.887349351754312*^9}, {3.887349432688151*^9, 
   3.887349483785801*^9}, {3.887349514232171*^9, 3.887349518976432*^9}, 
   3.8873667007123766`*^9, {3.887366755715024*^9, 3.8873667720494356`*^9}, {
   3.8873668260730705`*^9, 3.887366829718055*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"1c6a9ee3-0ca7-4512-9668-41dbee4fa656"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MFgaugeConfigZoom", "[", 
    RowBox[{"\[Chi]0_", ",", "\[Omega]_", ",", "L_", ",", 
     RowBox[{"title_", ":", "\"\<\>\""}], ",", 
     RowBox[{"comment_", ":", 
      RowBox[{"{", 
       RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bonds", ",", 
       RowBox[{"linethick", "=", 
        RowBox[{".012", " ", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "7", "]"}], 
           RowBox[{"Log", "[", "L", "]"}]], ")"}]}]}], ",", "lattice", ",", 
       "size", ",", "\[Chi]", ",", 
       RowBox[{"rt", "=", "0.8"}], ",", "max", ",", "plaquettes"}], "}"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"size", " ", "=", " ", 
       RowBox[{"0.01", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"Log", "[", "7", "]"}], 
           RowBox[{"Log", "[", "L", "]"}]], ")"}], "2"]}]}], " ", ";", " ", 
      RowBox[{"max", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"Abs", "@", "\[Chi]0"}]}]}], ";", " ", 
      RowBox[{"\[Chi]", "=", 
       RowBox[{"\[Chi]0", "/", "max"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lattice", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"4", " ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"asites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"4", " ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"bsites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], "  ", ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"2", "  ", "size"}], " ", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"asites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"White", ",", 
               RowBox[{"PointSize", "[", 
                RowBox[{"2", "  ", "size"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"bsites", "[", 
                 RowBox[{"m", ",", "n"}], "]"}], "]"}]}], "}"}]}], "     ", 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{
              RowBox[{"L", "/", "2"}], "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"L", "/", "2"}], ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", "2"}], 
        "    ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bonds", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "    ", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{"Cyan", ",", " ", "Gray", " ", ",", 
                   RowBox[{"Darker", "@", "Magenta"}]}], "}"}], ",", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ")"}]}]}], "  ", 
                "]"}], ",", 
               RowBox[{"Thickness", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"0.5", "+", 
                    RowBox[{"0.5", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}]}], "&"}], "@", 
                   RowBox[{"Abs", "@", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "4"}], "]"}], "]"}]}]}], ")"}], 
                 "linethick"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}]}], "}"}], "]"}]}], "}"}], 
             ",", "                   ", 
             RowBox[{"(*", 
              RowBox[{"z", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{"Cyan", ",", " ", "Gray", " ", ",", 
                   RowBox[{"Darker", "@", "Magenta"}]}], "}"}], ",", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}]}]}], "  ", 
                "]"}], ",", 
               RowBox[{"Thickness", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"0.5", "+", 
                    RowBox[{"0.5", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}]}], "&"}], "@", 
                   RowBox[{"Abs", "@", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
                 "linethick"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "n"}], "]"}]}], "}"}], 
                "]"}]}], "}"}], ",", "             ", 
             RowBox[{"(*", 
              RowBox[{"x", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{"Cyan", ",", " ", "Gray", " ", ",", 
                   RowBox[{"Darker", "@", "Magenta"}]}], "}"}], ",", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}], "&"}], "@", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], "  ", 
                "]"}], ",", 
               RowBox[{"Thickness", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"0.5", "+", 
                    RowBox[{"0.5", 
                    RowBox[{"root", "[", 
                    RowBox[{"#", ",", "rt"}], "]"}]}]}], "&"}], "@", 
                   RowBox[{"Abs", "@", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"m", "+", 
                    RowBox[{"n", " ", "L"}], "+", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}], 
                 "linethick"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"asites", "[", 
                   RowBox[{"m", ",", "n"}], "]"}], ",", 
                  RowBox[{"bsites", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}]}], "}"}], "]"}]}], 
              "}"}]}], "              ", 
            RowBox[{"(*", 
             RowBox[{"y", "-", "bonds"}], "*)"}], "\[IndentingNewLine]", 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{
              RowBox[{"L", "/", "2"}], "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"L", "/", "2"}], ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], " ", "]"}], ",", " ", "2"}], 
        "    ", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plaquettes", "=", 
       RowBox[{"WilsonLoopGraphicsZoom", "[", 
        RowBox[{"\[Chi]", ",", "\[Omega]", ",", "L"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"plaquettes", ",", "bonds", ",", "lattice"}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
        RowBox[{"ContentSelectable", "\[Rule]", "True"}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Inset", "[", " ", 
            RowBox[{
             RowBox[{"MaTeX", "[", 
              RowBox[{"title", ",", 
               RowBox[{"Magnification", "\[Rule]", "1.8"}]}], "]"}], " ", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.95"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Left", ",", "Center"}], "}"}]}], "]"}], ",", 
           RowBox[{"Inset", "[", " ", 
            RowBox[{
             RowBox[{"MaTeX", "[", 
              RowBox[{
               RowBox[{"comment", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"Magnification", "\[Rule]", "1.5"}]}], "]"}], " ", ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"1.0", ",", "0.95"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Right", ",", "Center"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"Inset", "[", " ", 
            RowBox[{
             RowBox[{"MaTeX", "[", 
              RowBox[{
               RowBox[{"comment", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"Magnification", "\[Rule]", "1.35"}]}], "]"}], " ", 
             ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"1.0", ",", "0.88"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Right", ",", "Center"}], "}"}]}], "]"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "  ", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8867434944218855`*^9, 3.886743550245146*^9}, {
   3.886745267428046*^9, 3.8867452717540464`*^9}, 3.887349356907258*^9, {
   3.8873495388223543`*^9, 3.8873495559671035`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"6b2aa10b-6863-4d41-8279-aaa4bda5a264"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["    Loop ", "Section",
 CellChangeTimes->{{3.902944289274684*^9, 3.9029443015336604`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"65386cf6-13ec-4e69-bf3a-0864eae5c417"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ts", " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"5", "x"}], ",", "160", ",", 
       RowBox[{
        RowBox[{"-", "12"}], "x"}], ",", "0", ",", 
       RowBox[{"-", "60"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "tV"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"hs", " ", "=", 
    RowBox[{"Table", "[", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "  ", 
       RowBox[{"hAngle", "[", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"h", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], " ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"h", ",", "hV"}], "}"}]}], "]"}]}], ";"}], "  "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eV0", "=", "0"}], ";", 
   RowBox[{"U", "=", "2600"}], ";", 
   RowBox[{"JH", "=", "300"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parameters", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"Jr", "[", 
              RowBox[{"0", ",", "JH", ",", "U", ",", 
               RowBox[{"ts", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], " ", "]"}]}], ",", 
            RowBox[{"N", "@", 
             RowBox[{"Kr", "[", 
              RowBox[{"0", ",", "JH", ",", "U", ",", 
               RowBox[{"ts", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"N", "@", 
             RowBox[{"\[CapitalGamma]r", "[", 
              RowBox[{"0", ",", "JH", ",", "U", ",", 
               RowBox[{"ts", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"hs", "[", 
             RowBox[{"[", "h", "]"}], "]"}], " ", ",", 
            RowBox[{"N", "@", 
             RowBox[{"Jr", "[", 
              RowBox[{
               RowBox[{"eVs", "[", 
                RowBox[{"[", "ev", "]"}], "]"}], ",", "JH", ",", "U", ",", 
               RowBox[{"ts", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], " ", "]"}]}], ",", 
            RowBox[{"N", "@", 
             RowBox[{"Kr", "[", 
              RowBox[{
               RowBox[{"eVs", "[", 
                RowBox[{"[", "ev", "]"}], "]"}], ",", "JH", ",", "U", ",", 
               RowBox[{"ts", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"N", "@", 
             RowBox[{"\[CapitalGamma]r", "[", 
              RowBox[{
               RowBox[{"eVs", "[", 
                RowBox[{"[", "ev", "]"}], "]"}], ",", "JH", ",", "U", ",", 
               RowBox[{"ts", "[", 
                RowBox[{"[", "t", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"hV", "[", 
             RowBox[{"[", "h", "]"}], "]"}], ",", 
            RowBox[{"tV", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", 
            RowBox[{"eVs", "[", 
             RowBox[{"[", "ev", "]"}], "]"}]}], "}"}], " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", 
            RowBox[{"Length", "@", "tV"}]}], "}"}], ",", "  ", 
          RowBox[{"{", 
           RowBox[{"h", ",", "1", ",", 
            RowBox[{"Length", "@", "hV"}]}], "}"}]}], "]"}], ",", "1"}], 
       "]"}], " ", ",", "  ", 
      RowBox[{"{", 
       RowBox[{"ev", ",", "1", ",", 
        RowBox[{"Length", "@", "eVs"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.902944455255044*^9, 
  3.9029444570996265`*^9}},ExpressionUUID->"ea4ba569-ecd9-46a1-8d24-\
6107708ff42b"],

Cell[CellGroupData[{

Cell["vortex free", "Subsubsection",
 FontWeight->Bold,ExpressionUUID->"ac67c233-9311-4236-9c27-b4d81ab07561"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tvf", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Definition timing= \>\"", ",", 
    RowBox[{"round", "[", 
     RowBox[{"tvf", "-", "t0"}], "]"}]}], " ", "]"}], ";", " ", 
  RowBox[{"t0", "=", "tvf"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Chi]G", "=", 
   RowBox[{"{", 
    RowBox[{"\[Chi]Gx", ",", "\[Chi]Gy", ",", "\[Chi]Gz"}], "}"}]}], ";", " ", 
  RowBox[{"\[Omega]G", "=", 
   RowBox[{"{", 
    RowBox[{"\[Omega]GA", ",", "\[Omega]GB"}], "}"}]}]}]}], "Code",ExpressionU\
UID->"18a79ce6-b12c-452c-abdc-dc53ee0c11c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", 
  RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", 
  RowBox[{"Print", "[", "\"\<    Starting free loop\>\"", "]"}], ";", 
  RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", " ", 
   RowBox[{
    RowBox[{"Do", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"loaddata", ",", "\[CapitalGamma]", ",", "J", ",", "K", ",", 
           RowBox[{"L", "=", 
            RowBox[{"Ls", "[", 
             RowBox[{"[", "l", "]"}], "]"}]}], ",", "Nc", ",", "h", ",", 
           "\[CapitalLambda]", ",", "T", ",", "H", ",", "\[Xi]", ",", "EnG0", 
           ",", "En", ",", 
           RowBox[{"EnList", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], ",", "u", ",", "u2", ",", 
           "\[Chi]", ",", "\[Omega]", ",", "j", ",", 
           RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
           RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", "ES", ",", "gap", ",",
            "\[CapitalDelta]t", ",", "\[CapitalDelta]tHours", ",", 
           "\[CapitalDelta]tMin", ",", "\[CapitalDelta]tSec", ",", "kTable", 
           ",", "\[CapitalDelta]\[Omega]", ",", 
           RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"\[CapitalDelta]seq", "=", 
            RowBox[{"{", "}"}]}], ",", "EMF", ",", "Esum", ",", "E\[Lambda]", 
           ",", 
           RowBox[{"\[Eta]", "=", "\[Lambda]0"}], ",", 
           RowBox[{"hp", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{"p", ",", 
              RowBox[{"Length", "@", "hV"}], ",", "1"}], "]"}]}]}], "}"}], 
         ",", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"J", ",", "K", ",", "\[CapitalGamma]", ",", "h"}], "}"}], 
           "=", 
           RowBox[{
            RowBox[{"parameters", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", " ", 
          RowBox[{"Nc", "=", 
           RowBox[{"L", "^", "2"}]}], ";", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{"change", " ", 
            RowBox[{"here", ":"}]}], "*)"}], "\n", "\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Norm", "[", "h", "]"}], "==", "0"}], " ", 
              RowBox[{"(*", 
               RowBox[{"p", "==", 
                RowBox[{"1", " ", 
                 RowBox[{"Abs", "[", "\[CapitalGamma]", "]"}]}], "==", "1"}], 
               "*)"}], ",", " ", 
              RowBox[{
               RowBox[{"\[Chi]G", "=", 
                RowBox[{"{", 
                 RowBox[{"\[Chi]Gx", ",", "\[Chi]Gy", ",", "\[Chi]Gz"}], 
                 "}"}]}], ";", " ", 
               RowBox[{"\[Omega]G", "=", 
                RowBox[{"{", 
                 RowBox[{"\[Omega]GA", ",", "\[Omega]GB"}], "}"}]}], ";"}]}], 
             " ", "]"}], ";"}], "*)"}], "\n", "\t", 
          RowBox[{"\[Chi]G", "=", 
           RowBox[{"{", 
            RowBox[{"\[Chi]Gx", ",", "\[Chi]Gy", ",", "\[Chi]Gz"}], "}"}]}], 
          ";", " ", 
          RowBox[{"\[Omega]G", "=", 
           RowBox[{"{", 
            RowBox[{"\[Omega]GA", ",", "\[Omega]GB"}], "}"}]}], ";", "\n", 
          "\t", 
          RowBox[{"\[Chi]", "=", "\[Chi]G"}], ";", " ", 
          RowBox[{"\[Omega]", "=", "\[Omega]G"}], ";", "   ", "\n", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<J=\>\"", ",", "J", ",", "\"\<; K=\>\"", ",", "K", ",", " ", 
            "\"\<; G=\>\"", ",", "\[CapitalGamma]", ",", " ", "\"\<; L=\>\"", 
            ",", "L", ",", "\"\<; h=(\>\"", ",", " ", 
            RowBox[{"hV", "[", 
             RowBox[{"[", " ", 
              RowBox[{"hp", ",", "1"}], " ", "]"}], "]"}], ",", "\"\<,\>\"", 
            ",", 
            RowBox[{"hV", "[", 
             RowBox[{"[", " ", 
              RowBox[{"hp", ",", "2"}], " ", "]"}], "]"}], ",", "\"\<,\>\"", 
            ",", 
            RowBox[{"hV", "[", 
             RowBox[{"[", " ", 
              RowBox[{"hp", ",", "3"}], "]"}], "]"}], ",", "\"\<); \>\""}], 
           "]"}], ";", "\n", 
          RowBox[{"kTable", "=", 
           RowBox[{"toMomentumTable", "[", "L", "]"}]}], ";", "\n", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{"j", "<", 
                RowBox[{"(", "steps", ")"}]}], ")"}], "\[And]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Chop", "[", " ", 
                 RowBox[{"\[CapitalDelta]1", ",", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "8"}], ")"}]}]}], " ", "]"}], "!=", " ", 
                "0"}], ")"}]}], " ", ")"}], ",", " ", 
            RowBox[{"j", "++"}], ",", "  ", "\n", "  ", 
            RowBox[{"(*", "  ", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "<=", "1"}], ",", " ", 
                RowBox[{
                 RowBox[{"loaddata", "=", 
                  RowBox[{"loadDataTry", "[", 
                   RowBox[{"toPath", "[", 
                    RowBox[{
                    RowBox[{"parameters", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                    "acuracy", ",", "\"\<free\>\"", ",", "NbName"}], "]"}], 
                   "  ", "]"}]}], ";", "\n", "    ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{"loaddata", "===", "$Failed"}], ")"}]}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "j", ",", "L", ",", "\[Chi]", ",", "\[Omega]", ",", 
                    "\[Xi]", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]seq",
                     ",", "\[CapitalDelta]\[Omega]seq"}], "}"}]}], "}"}], "=",
                     "loaddata"}]}], "]"}]}]}], "]"}], ";"}], "\n", "    ", 
             "*)"}], 
            RowBox[{
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"j", ",", "200"}], "]"}], "==", "80"}], ")"}], 
                "\[And]", 
                RowBox[{"(", " ", 
                 RowBox[{"\[CapitalDelta]1", ">", 
                  RowBox[{"10", "^", 
                   RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}], " ", ")"}]}], ",", " ", 
               RowBox[{
                RowBox[{"\[Chi]", "=", 
                 RowBox[{"0.6", 
                  RowBox[{"{", 
                   RowBox[{"\[Chi]Gx", ",", "\[Chi]Gy", ",", "\[Chi]Gz"}], 
                   "}"}]}]}], ";", " ", 
                RowBox[{"Module", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"rm", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{".1", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}], ",", 
                  " ", 
                  RowBox[{"\[Omega]", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]GA", "+", 
                    RowBox[{"(", " ", 
                    RowBox[{"rm", "-", 
                    RowBox[{"Transpose", "[", "rm", "]"}]}], ")"}]}], ",", 
                    RowBox[{"\[Omega]GB", "+", 
                    RowBox[{"(", " ", 
                    RowBox[{"rm", "-", 
                    RowBox[{"Transpose", "[", "rm", "]"}]}], ")"}]}]}], 
                    "}"}]}]}], "]"}]}]}], " ", "]"}], ";", "\n", 
             RowBox[{"u", "=", 
              RowBox[{"Chop", "@", 
               RowBox[{"Total", "@", 
                RowBox[{"Table", "[", " ", 
                 RowBox[{
                  RowBox[{"Module", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "H0", ",", "Hr", ",", "U", ",", "TU", ",", "TUh", ",", 
                    "k", ",", "uu"}], "}"}], ",", "\n", 
                    RowBox[{
                    RowBox[{"k", "=", 
                    RowBox[{"kTable", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ";", "\n", 
                    RowBox[{"H0", "=", 
                    RowBox[{"HMFk", "[", 
                    RowBox[{
                    "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "\[Eta]", ",", "k"}], 
                    "]"}]}], ";", "\n", 
                    RowBox[{"Hr", "=", 
                    RowBox[{
                    RowBox[{"Tk", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H0", " ", ".", " ", "Tk"}]}], ";", " ", "\n", 
                    RowBox[{"U", "=", 
                    RowBox[{"UmatK", "[", "Hr", "]"}]}], ";", "\n", 
                    RowBox[{"TU", "=", 
                    RowBox[{"Tk", " ", ".", " ", "U"}]}], ";", "\n", 
                    RowBox[{"TUh", "=", 
                    RowBox[{"TU", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{
                    RowBox[{"-", "4"}], ";;", 
                    RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], ";", "\n", 
                    RowBox[{"uu", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "Nc"}], ")"}], " ", "I", " ", 
                    RowBox[{"TUh", " ", ".", " ", 
                    RowBox[{"TUh", "\[ConjugateTranspose]"}]}]}]}], " ", ";", 
                    "\n", 
                    RowBox[{"uu", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"uu", "-", 
                    RowBox[{"ConjugateTranspose", "[", "uu", "]"}]}], ")"}], 
                    "/", "2"}]}], ";", "  ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"uu", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", 
                    RowBox[{"k", " ", ".", " ", "nx"}]}], "]"}]}], ",", 
                    RowBox[{"uu", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", 
                    RowBox[{"k", " ", ".", " ", "ny"}]}], "]"}]}], ",", 
                    "uu"}], " ", "}"}]}]}], "  ", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", "1", ",", "Nc"}], "}"}]}], "]"}]}]}]}], 
             ";", " ", "\n", 
             RowBox[{
              RowBox[{"\[Chi]", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{"Table", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"\[Beta]", "+", "4"}], ",", "\[Alpha]"}], "]"}], 
                 "]"}], "   ", ",", "  ", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
               "]"}]}], ";", "\n", 
             RowBox[{
              RowBox[{"\[Chi]", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{"Table", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"\[Beta]", "+", "4"}], ",", "\[Alpha]"}], "]"}], 
                 "]"}], "   ", ",", "  ", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
               "]"}]}], ";", "\n", 
             RowBox[{
              RowBox[{"\[Chi]", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "=", 
              RowBox[{"Table", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"\[Beta]", "+", "4"}], ",", "\[Alpha]"}], "]"}], 
                 "]"}], "   ", ",", "  ", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
               "]"}]}], ";", "\n", 
             RowBox[{
              RowBox[{"\[Omega]", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{"Table", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"\[Beta]", ",", "\[Alpha]"}], "]"}], "]"}], "     ",
                 ",", "  ", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
               "]"}]}], ";", "\n", 
             RowBox[{
              RowBox[{"\[Omega]", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{"Table", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"u", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"\[Beta]", "+", "4"}], ",", 
                   RowBox[{"\[Alpha]", "+", "4"}]}], "]"}], "]"}], " ", ",", 
                "  ", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]", ",", "1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]", ",", "1", ",", "4"}], "}"}]}], " ", 
               "]"}]}], ";", "\n", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", ">=", "2"}], ",", 
               RowBox[{
                RowBox[{"\[CapitalDelta]2", "=", "\[CapitalDelta]1"}], ";", 
                " ", 
                RowBox[{"\[CapitalDelta]1", "=", 
                 RowBox[{"Max", "[", " ", 
                  RowBox[{"Abs", "@", 
                   RowBox[{"(", 
                    RowBox[{"u", "-", "u2"}], ")"}]}], " ", "]"}]}], ";", 
                RowBox[{"\[CapitalDelta]seq", "=", 
                 RowBox[{"{", 
                  RowBox[{"\[CapitalDelta]seq", ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]1"}], "}"}]}], "}"}]}], 
                "  ", ";", "  ", "\n", 
                RowBox[{"\[CapitalDelta]\[Omega]", "=", 
                 RowBox[{
                  RowBox[{"1", "/", "12"}], " ", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "2", ",", "1"}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "3", ",", "4"}], "]"}], "]"}]}], 
                    "]"}], "+", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "3", ",", "1"}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "4", ",", "2"}], "]"}], "]"}]}], 
                    "]"}], "+", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "4", ",", "1"}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "2", ",", "3"}], "]"}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], 
                   "]"}]}]}], ";", " ", 
                RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
                 RowBox[{"{", 
                  RowBox[{"\[CapitalDelta]\[Omega]seq", ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]\[Omega]"}], "}"}]}], 
                  "}"}]}], " ", ";"}]}], "]"}], ";", " ", "\n", 
             RowBox[{"u2", "=", "u"}], ";"}]}], "  ", 
           RowBox[{"(*", "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "\[LessEqual]", "3"}], "\[Or]", 
               RowBox[{"j", "\[GreaterEqual]", 
                RowBox[{"steps", "-", "2"}]}]}], ",", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<j=\>\"", ",", "j", ",", "\"\<; \[CapitalDelta]=\>\"", 
                 ",", "\[CapitalDelta]1", ",", 
                 "\"\<; \[CapitalDelta]\[Omega]=\>\"", ",", 
                 "\[CapitalDelta]\[Omega]", ",", " ", "\"\<;  \>\"", ",", 
                 RowBox[{"MatrixForm", "/@", 
                  RowBox[{"{", "  ", 
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "}"}]}]}], "]"}], 
               ";"}]}], "  ", "]"}], " ", "*)"}], "\n", "\t", "]"}], ";", 
          "\n", 
          RowBox[{"t1", "=", 
           RowBox[{"AbsoluteTime", "[", "]"}]}], ";", " ", 
          RowBox[{"\[CapitalDelta]t", "=", 
           RowBox[{"UnitConvert", "[", " ", 
            RowBox[{
             RowBox[{"Quantity", "[", 
              RowBox[{
               RowBox[{"t1", " ", "-", "t0"}], ",", " ", "\"\<Seconds\>\""}], 
              " ", "]"}], ",", " ", "\"\<Minutes\>\""}], " ", "]"}]}], ";", 
          " ", 
          RowBox[{"t0", "=", "t1"}], ";", "\n", "\t", 
          RowBox[{"\[CapitalDelta]seq", "=", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "\[CapitalDelta]seq", "]"}], ",", "2"}], 
            "]"}]}], ";", " ", 
          RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "\[CapitalDelta]\[Omega]seq", "]"}], ",",
              "2"}], "]"}]}], ";", "\n", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Omega]v", ",", "\[Chi]v"}], "}"}], ",", "\n", 
            RowBox[{
             RowBox[{"\[Omega]v", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}], 
                ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
               " ", "}"}]}], ";", "\n", 
             RowBox[{"\[Chi]v", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}], 
                ",", " ", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], "]"}], ",", 
                " ", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], "]"}]}], "  ",
                "}"}]}], ";", "\n", 
             RowBox[{"EMF", "=", 
              RowBox[{"EnMF", "[", 
               RowBox[{
                RowBox[{"uniform", "[", 
                 RowBox[{"J", ",", "L", ",", "L"}], "]"}], ",", 
                RowBox[{"uniform", "[", 
                 RowBox[{"K", ",", "L", ",", "L"}], "]"}], ",", 
                RowBox[{"uniform", "[", 
                 RowBox[{"\[CapitalGamma]", ",", "L", ",", "L"}], "]"}], ",", 
                "h", ",", "\[Chi]v", ",", "\[Omega]v", ",", "L", ",", "L"}], 
               "]"}]}], ";", "\n", 
             RowBox[{"E\[Lambda]", "=", 
              RowBox[{"EnLagMF", "[", 
               RowBox[{
                RowBox[{"uniform", "[", 
                 RowBox[{"J", ",", "L", ",", "L"}], "]"}], ",", 
                RowBox[{"uniform", "[", 
                 RowBox[{"K", ",", "L", ",", "L"}], "]"}], ",", 
                RowBox[{"uniform", "[", 
                 RowBox[{"\[CapitalGamma]", ",", "L", ",", "L"}], "]"}], ",", 
                "h", ",", "\[Chi]v", ",", "\[Omega]v", ",", "L", ",", "L"}], 
               "]"}]}], ";"}]}], "\n", "]"}], ";", 
          "                                        ", 
          RowBox[{"(*", " ", 
           RowBox[{"<", 
            RowBox[{"-", " ", 
             RowBox[{"EnMF0", " ", "?"}]}]}], "  ", "*)"}], "\n", 
          RowBox[{"Esum", "=", 
           RowBox[{
            RowBox[{"Sum", "[", "  ", 
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Eigenvalues", "[", 
                  RowBox[{"HMFk", "[", 
                   RowBox[{
                   "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "\[Eta]", ",", 
                    RowBox[{"kTable", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], " ", "]"}], "  ", "]"}],
                  ",", 
                 RowBox[{
                  RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], " ", ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "Nc"}], "}"}]}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "Nc"}], ")"}]}]}], ";", " ", "\n", "\n", "\t", 
          RowBox[{"dataToFile", "[", 
           RowBox[{
            RowBox[{"parameters", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", "acuracy",
             ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "L", ",", "\[Chi]", ",", "\[Omega]", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "EMF", "}"}], ",", 
                RowBox[{"{", "Esum", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"EMF", "+", "E\[Lambda]"}], "}"}], ",", 
                "\[CapitalDelta]seq", ",", "\[CapitalDelta]\[Omega]seq"}], 
               "}"}]}], "}"}], ",", "\"\<free\>\"", ",", "NbName"}], "]"}], 
          ";", " ", "\n", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Max Step = \>\"", ",", " ", "j", ",", "\"\<; Delta=\>\"", ",", 
            RowBox[{"round\[CapitalDelta]", "@", "\[CapitalDelta]1"}], ",", 
            RowBox[{"(*", 
             RowBox[{",", "\"\<; \[CapitalDelta]t = \>\"", ",", 
              RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}], ",", 
              RowBox[{"IntegerPart", "@", 
               RowBox[{"UnitConvert", "[", 
                RowBox[{
                 RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], 
                 ",", " ", "\"\<Seconds\>\""}], " ", "]"}]}]}], "*)"}], 
            "\"\<; E=\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"EMF", ",", "Esum", ",", 
              RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}], ",", 
            "\"\<;  p=\>\"", ",", "p", ",", "\"\</\>\"", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"parameters", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "\n", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "jG", ",", "LG", ",", "\[Chi]G", ",", "\[Omega]G", ",", "\[Xi]G", 
             ",", "EnG"}], "}"}], "=", " ", 
           RowBox[{"loadData", "[", 
            RowBox[{"toPath", "[", 
             RowBox[{
              RowBox[{"parameters", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
              "acuracy", ",", "\"\<free\>\"", ",", "NbName"}], " ", "]"}], 
            "  ", "]"}]}], ";"}]}], "\n", " ", "]"}], ";"}], "  ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"p", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"parameters", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "  ", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", "1", ",", 
      RowBox[{"Length", "@", "Ls"}]}], "}"}]}], "]"}], ";", 
  RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";"}], "\n", 
 RowBox[{" "}]}], "Code",ExpressionUUID->"b3fb577a-c068-4a25-bbbc-\
a165ba747849"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.9029444378874626`*^9},ExpressionUUID->"680aeb83-633c-4391-97cc-\
8f5744c616e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["vortex free + gradually increase  electric field", "Subsubsection",
 FontWeight->Bold,ExpressionUUID->"40080617-38e9-4a1e-9c8d-1625a3134e05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[CapitalDelta]t", "}"}], ",", " ", 
    RowBox[{
     RowBox[{"t0v", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]t", "=", " ", 
      RowBox[{"UnitConvert", "[", " ", 
       RowBox[{
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"t0v", "-", "tvf"}], "]"}], ",", " ", "\"\<Seconds\>\""}], 
         " ", "]"}], ",", " ", "\"\<Minutes\>\""}], " ", "]"}]}], ";", "   ", 
     "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Free loop timing= \>\"", ",", " ", 
       RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}], ",", 
       RowBox[{"IntegerPart", "@", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", " ", 
          "\"\<Seconds\>\""}], " ", "]"}]}]}], "    ", "]"}], ";", 
     RowBox[{"t0", "=", "t0v"}], ";", "\n", 
     RowBox[{
      RowBox[{"Print", "[", "\"\< \>\"", "]"}], " ", 
      RowBox[{"Print", "[", "\"\< \>\"", "]"}]}], ";"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<    Starting vortex free + electric field loop: \>\"", 
   "]"}], ";", 
  RowBox[{"Print", "[", "\"\< \>\"", "]"}]}]}], "Code",ExpressionUUID->\
"905b0c58-f21f-44c7-942d-4b80aab1fd81"],

Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"minSteps", "=", "3"}], ";", "\n", 
   RowBox[{"Do", "[", "   ", "\n", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Chi]G", ",", "\[Omega]G", ",", "jG", ",", "LG", ",", "EnG", " ", 
         ",", 
         RowBox[{"gauge", "=", "\"\<g0\>\""}]}], "}"}], ",", "   ", 
       RowBox[{"(*", " ", 
        RowBox[{"<", 
         RowBox[{
          RowBox[{"-", "  ", "the"}], " ", "1", "st", " ", 
          RowBox[{"difference", " ", ":", " ", 
           RowBox[{"g0", " ", "\[UndirectedEdge]", " ", "g4"}]}]}]}], " ", 
        "*)"}], "\n", 
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
           "J", ",", "K", ",", "\[CapitalGamma]", ",", "Jmod", ",", "Kmod", 
            ",", "\[CapitalGamma]mod", ",", "Jv", ",", "Kv", ",", 
            "\[CapitalGamma]v", ",", 
            RowBox[{"L", "=", 
             RowBox[{"Ls", "[", 
              RowBox[{"[", "l", "]"}], "]"}]}], ",", "Nc", ",", "h", " ", ",",
             "\[CapitalLambda]", ",", "T", ",", "En", ",", "EMF", ",", "Esum",
             ",", "E\[Lambda]", ",", 
            RowBox[{"EnList", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", "\[Xi]G", ",", 
            RowBox[{"\[CapitalDelta]seq", "=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
             RowBox[{"{", "}"}]}], ",", "\[CapitalDelta]\[Omega]", ",", 
            RowBox[{"u2", "=", "0"}], ",", "u1", ",", "u0", ",", 
            RowBox[{"\[Chi]", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
            RowBox[{"\[Omega]", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", 
            RowBox[{"\[Xi]", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ",", "j", ",", 
            RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
            RowBox[{"\[CapitalDelta]2", "=", "2.56"}], ",", "ES", ",", "gap", 
            ",", "\[CapitalDelta]t", ",", 
            RowBox[{"hp", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{"p", ",", 
               RowBox[{"Length", "@", "hV"}], ",", "1"}], "]"}]}]}], " ", 
           "}"}], ",", " ", "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", "Jmod", 
              ",", "Kmod", ",", "\[CapitalGamma]mod"}], "}"}], "=", 
            RowBox[{
             RowBox[{"parameters", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], ";", " ", "\n", 
           RowBox[{"Nc", "=", 
            RowBox[{"L", "^", "2"}]}], ";", "\n", 
           RowBox[{"\[Omega]", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"\[Omega]GA", ",", "2", ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], ";",
            "\n", 
           RowBox[{"T", "=", 
            RowBox[{"Tmat", "[", 
             RowBox[{"L", ",", "L"}], "]"}]}], ";", "\n", 
           RowBox[{"Kv", "=", 
            RowBox[{"uniform", "[", 
             RowBox[{"K", ",", "L", ",", "L"}], "]"}]}], ";", "\n", "\n", 
           RowBox[{"u0", "=", 
            RowBox[{"uniformU", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "L"}], "]"}]}], ";", " ", 
           RowBox[{"(*", " ", 
            RowBox[{"<", 
             RowBox[{
              RowBox[{"-", "  ", "the"}], " ", "2", "nd", " ", 
              RowBox[{"difference", " ", ":", " ", "gauge4v"}]}]}], " ", 
            "*)"}], "\n", "\n", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "jG", ",", "LG", ",", "\[Chi]G", ",", "\[Omega]G", ",", "\[Xi]G",
               ",", "EnG"}], "}"}], "=", " ", 
            RowBox[{"loadData", "[", 
             RowBox[{"toPath", "[", 
              RowBox[{
               RowBox[{"parameters", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
               "acuracy", ",", "\"\<free\>\"", ",", "NbName"}], " ", "]"}], 
             "  ", "]"}]}], ";", " ", "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"\[Omega]G", "=", 
              RowBox[{"sym\[Omega]", "[", "\[Omega]G", "]"}]}], ";"}], "*)"}],
            "\n", 
           RowBox[{
            RowBox[{"\[Omega]", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"\[Omega]G", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], ";",
            "\n", 
           RowBox[{
            RowBox[{"\[Omega]", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"\[Omega]G", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], ";",
            "\n", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"\[Chi]G", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], ";",
            "\n", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"\[Chi]G", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], ";",
            "\n", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"\[Chi]G", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], ";",
            "\n", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\< for Pure Kitaev model: \>\"", " ", "]"}], 
             ";"}], "*)"}], "\n", 
           RowBox[{"Module", "[", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"h0", "=", 
                RowBox[{"Norm", "[", "h", "]"}]}], ",", "\[Kappa]0", ",", 
               "\[Kappa]", ",", 
               RowBox[{"\[Lambda]", "=", 
                RowBox[{"to\[Lambda]", "[", "h", "]"}]}], ",", "\[Chi]0", ",",
                "Hpure", ",", "Tpure", ",", "Upure", ",", "Epure"}], "}"}], 
             ",", "   ", "\n", 
             RowBox[{
              RowBox[{"\[Kappa]0", "=", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"h0", "/", 
                    RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}], "^", "3"}], "/", 
                 RowBox[{
                  RowBox[{"(", "0.262", ")"}], "^", "2"}]}], "*)"}], " ", 
               RowBox[{"toKappa", "[", "h", "]"}]}], ";", " ", "\n", 
              RowBox[{"\[Kappa]", "=", 
               RowBox[{"N", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Round", "[", 
                   RowBox[{"10000", " ", "\[Kappa]0"}], "]"}], "/", "10000"}],
                  ")"}]}]}], ";", "   ", "\n", 
              RowBox[{"\[Chi]0", "=", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "  ", 
              RowBox[{"(*", "\n", 
               RowBox[{
                RowBox[{"\[Omega]0", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{"\[Omega]GA", ",", "2", ",", 
                   RowBox[{"{", 
                    RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}],
                 ";"}], "*)"}], "\n", 
              RowBox[{"Hpure", "=", 
               RowBox[{"Hreal", "[", 
                RowBox[{
                "Kv", ",", "\[Kappa]", ",", "\[Lambda]", ",", "u0", ",", "L", 
                 ",", "0", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", "   ", 
              "\n", 
              RowBox[{"Tpure", "=", 
               RowBox[{"TmatPure", "[", "L", "]"}]}], ";", "  ", "\n", 
              RowBox[{"Upure", "=", 
               RowBox[{"UmatPure", "[", 
                RowBox[{
                 RowBox[{"Tpure", "\[ConjugateTranspose]"}], " ", ".", " ", 
                 "Hpure", " ", ".", " ", "Tpure"}], "]"}]}], ";", "\n", 
              RowBox[{"Epure", "=", 
               RowBox[{
                RowBox[{"Total", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"Quiet", "@", 
                    RowBox[{"Eigenvalues", "[", "Hpure", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
                RowBox[{"(", "Nc", ")"}]}]}], ";", "\n", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Chi]0", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"\[Chi]0", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"\[Chi]0", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "=", 
               RowBox[{"toMFparametersPure", "[", 
                RowBox[{"Upure", ",", "u0", ",", "L", ",", "0"}], "]"}]}], 
              ";", "   ", "\n", 
              RowBox[{"dataToFilePure", "[", 
               RowBox[{
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                "acuracy", ",", "gauge", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "L", ",", "\[Chi]0", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}]}], "}"}], ",", 
                  RowBox[{"{", "Epure", "}"}]}], " ", "}"}]}], " ", "]"}], 
              ";", " ", "\n", 
              RowBox[{"Print", "[", "\"\<Pure data saved: \>\"", "]"}], ";", 
              "\n", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Kappa=\>\"", ",", "\[Kappa]", ",", "\"\<; Lambda=\>\"", 
                ",", " ", "\[Lambda]", ",", " ", "\"\<; Epure=\>\"", ",", 
                "Epure", ",", "\"\<; \>\""}], "]"}], ";", 
              RowBox[{"Print", "[", "]"}], ";", "\n", 
              RowBox[{"Do", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "r"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "r"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "r"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "r"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], " ", ",", 
                RowBox[{"{", 
                 RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], "]"}], ";"}]}], 
            "\n", "  ", "]"}], ";", " ", "\n", "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"\[Chi]", "=", 
              RowBox[{"\[Chi]gauge4v", "[", 
               RowBox[{"\[Chi]", ",", "L"}], "]"}]}], ";"}], "*)"}], "   ", 
           RowBox[{"(*", " ", 
            RowBox[{"<", 
             RowBox[{
              RowBox[{"-", "  ", "the"}], " ", "3", "rd", " ", 
              RowBox[{"difference", " ", ":", "  ", "\[Chi]gauge4v"}]}]}], 
            " ", "*)"}], "\n", "\n", " ", 
           RowBox[{"Do", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", "Jmod", 
                 ",", "Kmod", ",", "\[CapitalGamma]mod"}], "}"}], "=", 
               RowBox[{
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"ev", ",", "p"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], ";", " ", 
              RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<J=\>\"", ",", "J", ",", " ", "\"\<; K=\>\"", ",", "K", 
                ",", " ", "\"\<; G=\>\"", ",", "\[CapitalGamma]", ",", 
                "\"\<; Jmod=\>\"", ",", "Jmod", ",", " ", "\"\<; Kmod=\>\"", 
                ",", "Kmod", ",", " ", "\"\<; Gmod=\>\"", ",", 
                "\[CapitalGamma]mod", ",", " ", "\"\<; L=\>\"", ",", "L", ",",
                 " ", "\"\<; h=(\>\"", ",", " ", 
                RowBox[{"hV", "[", 
                 RowBox[{"[", " ", 
                  RowBox[{"hp", ",", "1"}], " ", "]"}], "]"}], ",", 
                "\"\<,\>\"", ",", 
                RowBox[{"hV", "[", 
                 RowBox[{"[", " ", 
                  RowBox[{"hp", ",", "2"}], " ", "]"}], "]"}], ",", 
                "\"\<,\>\"", ",", 
                RowBox[{"hV", "[", 
                 RowBox[{"[", " ", 
                  RowBox[{"hp", ",", "3"}], "]"}], "]"}], ",", 
                "\"\<); eV=\>\"", ",", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"Round", "[", 
                    RowBox[{"1000", " ", 
                    RowBox[{
                    RowBox[{"eVs", "[", 
                    RowBox[{"[", "ev", "]"}], "]"}], "/", "1700"}]}], "]"}], 
                   "/", "1000"}], "]"}], "\"\<; \>\""}]}], "]"}], ";", 
              RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", 
              RowBox[{"Kv", "=", 
               RowBox[{"uniform", "[", 
                RowBox[{"K", ",", "L", ",", "L"}], "]"}]}], ";", 
              RowBox[{"Kv", "=", 
               RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                RowBox[{"Kv", ",", "Kmod", ",", "L"}], "]"}]}], ";", "\n", 
              RowBox[{"Jv", "=", 
               RowBox[{"uniform", "[", 
                RowBox[{"J", ",", "L", ",", "L"}], "]"}]}], ";", 
              RowBox[{"Jv", "=", 
               RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                RowBox[{"Jv", ",", "Jmod", ",", "L"}], "]"}]}], ";", "\n", 
              RowBox[{"\[CapitalGamma]v", "=", 
               RowBox[{"uniform", "[", 
                RowBox[{"\[CapitalGamma]", ",", "L", ",", "L"}], "]"}]}], ";", 
              RowBox[{"\[CapitalGamma]v", "=", 
               RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                RowBox[{
                "\[CapitalGamma]v", ",", "\[CapitalGamma]mod", ",", "L"}], 
                "]"}]}], ";", "\n", "\n", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", " ", 
                RowBox[{
                 RowBox[{"(", " ", 
                  RowBox[{"j", "<", "steps"}], ")"}], "\[And]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"j", "<", "minSteps"}], ")"}], "\[Or]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Chop", "[", " ", 
                    RowBox[{"\[CapitalDelta]1", ",", " ", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "acuracy"}]}]}], " ", "]"}], "!=", " ", 
                    "0"}], ")"}]}], "    ", ")"}]}], " ", ",", " ", 
                RowBox[{"j", "++"}], ",", "   ", "\n", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"j", ">=", "2"}], ",", 
                   RowBox[{
                    RowBox[{"\[CapitalDelta]2", "=", "\[CapitalDelta]1"}], 
                    ";", " ", 
                    RowBox[{"\[CapitalDelta]1", "=", 
                    RowBox[{"Max", "[", " ", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"(", 
                    RowBox[{"u1", "-", "u2"}], ")"}]}], " ", "]"}]}], ";", 
                    " ", 
                    RowBox[{"\[CapitalDelta]seq", "=", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalDelta]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]1"}], "}"}]}], "}"}]}], 
                    ";", "  ", 
                    RowBox[{"\[CapitalDelta]\[Omega]", "=", 
                    RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Nc"}], ")"}]}], " ", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "r", ",", "2", ",", "1"}], "]"}],
                     "]"}], "+", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "r", ",", "3", ",", "4"}], "]"}],
                     "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1", ",", "Nc"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], 
                    "]"}]}]}], ";", " ", 
                    RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalDelta]\[Omega]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]\[Omega]"}], "}"}]}], 
                    "}"}]}]}]}], "    ", "]"}], ";", " ", "\n", "\n", 
                 RowBox[{"Module", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "H", ",", "u", ",", "TUh", ",", "Heff", ",", "\[Lambda]1",
                     ",", "\[Lambda]2", ",", "loaddata"}], "}"}], ",", "\n", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<=", "1"}], ",", " ", 
                    RowBox[{
                    RowBox[{"loaddata", "=", 
                    RowBox[{"loadDataTry", "[", 
                    RowBox[{"toPath", "[", 
                    RowBox[{
                    RowBox[{"parameters", "[", 
                    RowBox[{"[", 
                    RowBox[{"ev", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                    "acuracy", ",", "gauge", ",", "NbName"}], "]"}], "  ", 
                    "]"}]}], ";", "\n", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{"loaddata", "===", "$Failed"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "j", ",", "L", ",", "\[Chi]", ",", "\[Omega]", ",", 
                    "\[Xi]", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]seq",
                     ",", "\[CapitalDelta]\[Omega]seq"}], "}"}]}], "}"}], "=",
                     "loaddata"}]}], "]"}]}]}], "]"}], ";", "\n", "\n", 
                    RowBox[{"Heff", "=", 
                    RowBox[{"HeffList", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Omega]"}], "]"}]}], ";", 
                    RowBox[{"(*", "  ", 
                    RowBox[{
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";"}], "  ", 
                    "*)"}], "\n", 
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{"\[Lambda]1List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{"\[Lambda]2List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", " ", 
                    "\n", 
                    RowBox[{"H", "=", 
                    RowBox[{"HMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L", ",", 
                    "\[Lambda]1", ",", "\[Lambda]2", ",", "Heff"}], "]"}]}], 
                    ";", " ", "\n", 
                    RowBox[{"u", "=", 
                    RowBox[{"Umat", "[", 
                    RowBox[{
                    RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H", " ", ".", " ", "T"}], "]"}]}], ";", "\n", 
                    RowBox[{"u1", "=", 
                    RowBox[{"Re", "@", 
                    RowBox[{"Chop", "@", 
                    RowBox[{"icc", "[", 
                    RowBox[{"u", ",", "L", ",", "T"}], "]"}]}]}]}], ";", "\n",
                     "\n", "\t", 
                    RowBox[{"EMF", "=", 
                    RowBox[{"EnMF0", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                    ";", "                                        ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"<", 
                    RowBox[{"-", " ", 
                    RowBox[{"EnMF0", " ", "?"}]}]}], "  ", "*)"}], "\n", "\t", 
                    RowBox[{"Esum", "=", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Eigenvalues", "[", "H", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "Nc"}], ")"}]}]}], ";", "\n", "\t", 
                    RowBox[{"E\[Lambda]", "=", 
                    RowBox[{"EnLagMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                    ";", "\n", "\t", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "EMF"}], "}"}]}], "}"}]}], ";", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "Esum"}], "}"}]}], "}"}]}], ";", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], "}"}]}], 
                    ";", "   ", "\n", 
                    RowBox[{"Do", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "m", ",", "n", ",", "\[Alpha]", ",", "\[Beta]", ",", "rz",
                     ",", "rx", ",", "ry", ",", "Io"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"rz", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"R0", "/", "16"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Beta]", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}]}], ")"}], "/", "4"}]}], 
                    "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Alpha]", "=", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}], "-", 
                    RowBox[{"4", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "+", "1"}]}], ";",
                     "\n", "   ", 
                    RowBox[{"n", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"rz", "/", "L"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"m", "=", 
                    RowBox[{"rz", "-", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"rx", "=", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"ry", "=", 
                    RowBox[{"m", "+", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", 
                    "L"}]}]}], ";", 
                    RowBox[{"Io", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], ";", " ", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rx"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "ry"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Io", "+", "4"}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], " ", "]"}], 
                    "]"}]}], ";"}]}], "\n", "    ", "]"}], ";"}], " ", ",", 
                    " ", 
                    RowBox[{"{", 
                    RowBox[{"R0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"16", "Nc"}], "-", "1"}]}], "}"}]}], "  ", "]"}], 
                    ";"}]}], "    ", "\n", "]"}], ";", " ", "\n", 
                 RowBox[{"u2", "=", "u1"}], ";", "        ", "\n", 
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\< j =\>\"", ",", "j", ",", " ", "\"\</\>\"", ",", 
                   "steps", ",", " ", "\"\<; Delta=\>\"", ",", 
                   RowBox[{"round\[CapitalDelta]", "@", "\[CapitalDelta]1"}], 
                   ",", " ", "\"\<;  E=\>\"", ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"1000000", 
                    RowBox[{"(", "#", ")"}]}], "]"}], "/", "1000000"}], "]"}],
                     "&"}], "@", 
                    RowBox[{"{", 
                    RowBox[{"EMF", ",", "Esum", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], ",", 
                   "\"\<; \>\""}], "  ", "]"}], ";"}]}], "     ", "\n", 
               "         ", "]"}], ";", "  ", "\n", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "H", ",", "u", ",", "Heff", ",", "\[Lambda]1", ",", 
                  "\[Lambda]2"}], "}"}], ",", 
                RowBox[{
                 RowBox[{"Heff", "=", 
                  RowBox[{"HeffList", "[", 
                   RowBox[{
                   "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Omega]"}], "]"}]}], ";", " ", 
                 RowBox[{"(*", "\n", 
                  RowBox[{
                   RowBox[{"\[Lambda]1", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";", 
                   RowBox[{"\[Lambda]2", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";"}], "*)"}], 
                 "\n", 
                 RowBox[{"\[Lambda]1", "=", 
                  RowBox[{"\[Lambda]1List", "[", 
                   RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", 
                 RowBox[{"\[Lambda]2", "=", 
                  RowBox[{"\[Lambda]2List", "[", 
                   RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", " ", "\n", 
                 RowBox[{"H", "=", 
                  RowBox[{"HMF", "[", 
                   RowBox[{
                   "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L", ",", 
                    "\[Lambda]1", ",", "\[Lambda]2", ",", "Heff"}], "]"}]}], 
                 ";", " ", "\n", "    ", 
                 RowBox[{"u", "=", 
                  RowBox[{"Umat", "[", 
                   RowBox[{
                    RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H", " ", ".", " ", "T"}], "]"}]}], ";", "\n", "\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"\[Xi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Xi]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "u1"}], "}"}], "=", 
                  RowBox[{"BiParallel", "[", 
                   RowBox[{"u", ",", "L", ",", "T"}], "]"}]}], ";", "\n", 
                 "\n", "\t", 
                 RowBox[{"EMF", "=", 
                  RowBox[{"EnMF0", "[", 
                   RowBox[{
                   "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                 ";", "                                        ", 
                 RowBox[{"(*", " ", 
                  RowBox[{"<", 
                   RowBox[{"-", " ", 
                    RowBox[{"EnMF0", " ", "?"}]}]}], "  ", "*)"}], "\n", "\t", 
                 RowBox[{"Esum", "=", 
                  RowBox[{
                   RowBox[{"Total", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Eigenvalues", "[", "H", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "Nc"}], ")"}]}]}], ";", "\n", "\t", 
                 RowBox[{"E\[Lambda]", "=", 
                  RowBox[{"EnLagMF", "[", 
                   RowBox[{
                   "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                 ";", "\n", "\t", 
                 RowBox[{
                  RowBox[{"EnList", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "EMF"}], "}"}]}], "}"}]}], ";", "\n", 
                 "    ", 
                 RowBox[{
                  RowBox[{"EnList", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "Esum"}], "}"}]}], "}"}]}], ";", "\n", 
                 "    ", 
                 RowBox[{
                  RowBox[{"EnList", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], "}"}]}], 
                 ";"}]}], "      ", "\n", "\n", "]"}], ";", "  \t", 
              RowBox[{"\[CapitalDelta]seq", "=", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "\[CapitalDelta]seq", "]"}], ",", 
                 "2"}], "]"}]}], ";", "\n", "\t", 
              RowBox[{
               RowBox[{"EnList", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "=", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"EnList", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], "]"}]}],
               ";", "\n", "\t", 
              RowBox[{
               RowBox[{"EnList", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"EnList", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "2"}], "]"}]}],
               ";", "\n", "\t", 
              RowBox[{
               RowBox[{"EnList", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "=", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"EnList", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "2"}], "]"}]}],
               ";", " ", "\n", "\t", 
              RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "\[CapitalDelta]\[Omega]seq", "]"}], 
                 ",", "2"}], "]"}]}], ";", " ", "\n", "\t", 
              RowBox[{"dataToFile", "[", 
               RowBox[{
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"ev", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                "acuracy", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "j", ",", "L", ",", "\[Chi]", ",", "\[Omega]", ",", "\[Xi]", 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]seq",
                     ",", "\[CapitalDelta]\[Omega]seq"}], "}"}]}], "}"}], ",",
                 "gauge", ",", "NbName"}], "]"}], ";", "     ", "\n", 
              RowBox[{"Print", "[", " ", 
               RowBox[{
               "\"\<ev=\>\"", ",", "ev", " ", ",", "\"\</\>\"", ",", " ", 
                RowBox[{
                 RowBox[{"Length", "@", "eVs"}], "\"\<; j MAX=\>\""}], ",", 
                "j", ",", " ", "\"\</\>\"", ",", "steps", ",", " ", 
                "\"\<; Delta=\>\"", ",", "\[CapitalDelta]1", ",", " ", 
                "\"\<; \>\""}], "   ", "]"}], ";"}], "\n", ",", " ", 
             RowBox[{"{", 
              RowBox[{"ev", ",", "1", ",", 
               RowBox[{"Length", "[", "parameters", "]"}]}], "}"}]}], " ", 
            "]"}], "   ", ";", "\n", "\n", "\t", 
           RowBox[{"t1", "=", 
            RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
           RowBox[{"\[CapitalDelta]t", "=", " ", 
            RowBox[{"UnitConvert", "[", " ", 
             RowBox[{
              RowBox[{"Quantity", "[", 
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{"t1", " ", "-", "t0"}], "]"}], ",", " ", 
                "\"\<Seconds\>\""}], " ", "]"}], ",", " ", "\"\<Hours\>\""}], 
             " ", "]"}]}], ";", 
           RowBox[{"t0", "=", "t1"}], ";", 
           RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", "\t", 
           RowBox[{"Print", "[", " ", 
            RowBox[{"\"\<p=\>\"", ",", "p", ",", "\"\</\>\"", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"parameters", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", "\"\<; l=\>\"", 
             ",", "l", ",", " ", "\"\</\>\"", ",", 
             RowBox[{"Length", "@", "Ls"}], ",", " ", 
             "\"\<; \[CapitalDelta]t = \>\"", ",", 
             RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}], ",", 
             RowBox[{"IntegerPart", "@", 
              RowBox[{"UnitConvert", "[", 
               RowBox[{
                RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",",
                 " ", "\"\<Minutes\>\""}], " ", "]"}]}]}], "   ", "]"}]}]}], 
         "\n", "  ", "]"}], ";"}]}], "\n", "]"}], "  ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", 
       RowBox[{"Length", "@", "Ls"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"p", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"parameters", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "  ", "]"}], 
   ";"}], "      ", "\n", "\n", "*)"}]], "Code",ExpressionUUID->"516d261c-\
68fc-436c-b4cb-6a2feb104a84"]
}, Closed]],

Cell[CellGroupData[{

Cell["four vortex + gradually increase  electric field", "Subsubsection",
 FontWeight->Bold,ExpressionUUID->"45c87f90-eb26-4fda-b817-fed84e6974f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[CapitalDelta]t", "}"}], ",", 
    RowBox[{
     RowBox[{"t4v", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
     RowBox[{"\[CapitalDelta]t", "=", " ", 
      RowBox[{"UnitConvert", "[", " ", 
       RowBox[{
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"t4v", "-", "t0v"}], "]"}], ",", " ", "\"\<Seconds\>\""}], 
         " ", "]"}], ",", " ", "\"\<Hours\>\""}], " ", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tHours", "=", 
      RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tMin", "=", 
      RowBox[{"IntegerPart", "@", 
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", " ", 
         "\"\<Minutes\>\""}], " ", "]"}]}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tSec", "=", 
      RowBox[{"IntegerPart", "@", 
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"FractionalPart", "@", 
          RowBox[{"UnitConvert", "[", 
           RowBox[{
            RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", 
            " ", "\"\<Minutes\>\""}], " ", "]"}]}], ",", " ", 
         "\"\<Seconds\>\""}], " ", "]"}]}]}], ";", "\n", 
     RowBox[{"Print", "[", " ", 
      RowBox[{"\"\<Free loop + electric field timing= \>\"", ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tHours"}], ",", "\"\< : \>\"",
        ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tMin"}], ",", "\"\< : \>\"", 
       ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tSec"}]}], "    ", "]"}], ";",
      "\n", 
     RowBox[{"t0", "=", "t4v"}], ";", 
     RowBox[{
      RowBox[{"Print", "[", "\"\< \>\"", "]"}], " ", 
      RowBox[{"Print", "[", "\"\< \>\"", "]"}]}], ";"}]}], "\n", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<    Starting four vortex + electric field loop: \>\"", 
   "]"}], ";", 
  RowBox[{"Print", "[", "\"\< \>\"", "]"}]}]}], "Code",ExpressionUUID->\
"5804fa87-423d-4ed1-9961-5b40631e42e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{"minSteps", "=", "5"}], ";", "\n", 
    RowBox[{"Do", "[", "   ", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Chi]G", ",", "\[Omega]G", ",", "jG", ",", "LG", ",", "EnG", " ", 
          ",", 
          RowBox[{"gauge", "=", "\"\<g4\>\""}]}], "}"}], ",", "   ", 
        RowBox[{"(*", " ", 
         RowBox[{"<", 
          RowBox[{
           RowBox[{"-", "  ", "the"}], " ", "1", "st", " ", 
           RowBox[{"difference", " ", ":", " ", 
            RowBox[{"g0", " ", "\[UndirectedEdge]", " ", "g4"}]}]}]}], " ", 
         "*)"}], "\n", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{
            "J", ",", "K", ",", "\[CapitalGamma]", ",", "Jmod", ",", "Kmod", 
             ",", "\[CapitalGamma]mod", ",", "Jv", ",", "Kv", ",", 
             "\[CapitalGamma]v", ",", 
             RowBox[{"L", "=", 
              RowBox[{"Ls", "[", 
               RowBox[{"[", "l", "]"}], "]"}]}], ",", "Nc", ",", "h", " ", 
             ",", "\[CapitalLambda]", ",", "T", ",", "En", ",", "EMF", ",", 
             "E\[Lambda]", ",", 
             RowBox[{"EnList", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", "\[Xi]G", ",", 
             RowBox[{"\[CapitalDelta]seq", "=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
              RowBox[{"{", "}"}]}], ",", "\[CapitalDelta]\[Omega]", ",", "u2",
              ",", "u1", ",", "u0", ",", 
             RowBox[{"\[Chi]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\[Omega]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", 
             RowBox[{"\[Xi]", "=", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", "j", ",", 
             RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
             RowBox[{"\[CapitalDelta]2", "=", "2.56"}], ",", "ES", ",", "gap",
              ",", "\[CapitalDelta]t", ",", 
             RowBox[{"hp", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{"p", ",", 
                RowBox[{"Length", "@", "hV"}], ",", "1"}], "]"}]}]}], " ", 
            "}"}], ",", " ", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", "Jmod", 
               ",", "Kmod", ",", "\[CapitalGamma]mod"}], "}"}], "=", 
             RowBox[{
              RowBox[{"parameters", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "p"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], ";", "  ", "\n", 
            RowBox[{"Nc", "=", 
             RowBox[{"L", "^", "2"}]}], ";", "\n", 
            RowBox[{"\[Omega]", "=", 
             RowBox[{"Table", "[", 
              RowBox[{"\[Omega]GA", ",", "2", ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{"T", "=", 
             RowBox[{"Tmat", "[", 
              RowBox[{"L", ",", "L"}], "]"}]}], ";", "\n", 
            RowBox[{"Kv", "=", 
             RowBox[{"uniform", "[", 
              RowBox[{"K", ",", "L", ",", "L"}], "]"}]}], ";", "\n", "\n", 
            RowBox[{"u0", "=", 
             RowBox[{"gauge4v", "[", 
              RowBox[{
               RowBox[{"uniformU", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "L"}], "]"}], ",", "L"}], "]"}]}], 
            ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"<", 
              RowBox[{
               RowBox[{"-", "  ", "the"}], " ", "2", "nd", " ", 
               RowBox[{"difference", " ", ":", " ", "gauge4v"}]}]}], " ", 
             "*)"}], "\n", "\n", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "jG", ",", "LG", ",", "\[Chi]G", ",", "\[Omega]G", ",", 
               "\[Xi]G", ",", "EnG"}], "}"}], "=", " ", 
             RowBox[{"loadData", "[", 
              RowBox[{"toPath", "[", 
               RowBox[{
                RowBox[{"parameters", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                "acuracy", ",", "\"\<free\>\"", ",", "NbName"}], " ", "]"}], 
              "  ", "]"}]}], ";", " ", "\n", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"\[Omega]G", "=", 
               RowBox[{"sym\[Omega]", "[", "\[Omega]G", "]"}]}], ";"}], 
             "*)"}], "\n", 
            RowBox[{
             RowBox[{"\[Omega]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Omega]G", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Omega]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Omega]G", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Chi]G", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Chi]G", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"\[Chi]G", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}], 
            ";", "\n", "\n", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "Print", "[", "\"\< for Pure Kitaev model: \>\"", " ", "]"}], 
              ";"}], "*)"}], "\n", 
            RowBox[{"Module", "[", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"h0", "=", 
                 RowBox[{"Norm", "[", "h", "]"}]}], ",", "\[Kappa]0", ",", 
                "\[Kappa]", ",", "\[Chi]0", ",", "Hpure", ",", "Tpure", ",", 
                "Upure"}], "}"}], ",", "   ", "\n", 
              RowBox[{
               RowBox[{"\[Kappa]0", "=", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"h0", "/", 
                    RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}], "^", "3"}], "/", 
                  RowBox[{
                   RowBox[{"(", "0.262", ")"}], "^", "2"}]}], "*)"}], " ", 
                RowBox[{"toKappa", "[", "h", "]"}]}], ";", " ", "\n", 
               RowBox[{"\[Kappa]", "=", 
                RowBox[{"N", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Round", "[", 
                    RowBox[{"10000", " ", "\[Kappa]0"}], "]"}], "/", 
                   "10000"}], ")"}]}]}], ";", "   ", "\n", 
               RowBox[{"\[Chi]0", "=", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", "  ", 
               RowBox[{"(*", "\n", 
                RowBox[{
                 RowBox[{"\[Omega]0", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{"\[Omega]GA", ",", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], " ", "]"}]}],
                  ";"}], "*)"}], "\n", 
               RowBox[{"Hpure", "=", 
                RowBox[{"Hreal", "[", 
                 RowBox[{"Kv", ",", "\[Kappa]", ",", 
                  RowBox[{"to\[Lambda]", "[", "h", "]"}], ",", "u0", ",", "L",
                   ",", "0", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], " ", ";", "   ",
                "\n", 
               RowBox[{"Tpure", "=", 
                RowBox[{"TmatPure", "[", "L", "]"}]}], ";", "  ", "\n", 
               RowBox[{"Upure", "=", 
                RowBox[{"UmatPure", "[", 
                 RowBox[{
                  RowBox[{"Tpure", "\[ConjugateTranspose]"}], " ", ".", " ", 
                  "Hpure", " ", ".", " ", "Tpure"}], "]"}]}], ";", "\n", 
               RowBox[{"Epure", "=", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Eigenvalues", "[", "Hpure", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
                 RowBox[{"(", "Nc", ")"}]}]}], ";", "\n", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Chi]0", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"\[Chi]0", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"\[Chi]0", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "=", 
                RowBox[{"toMFparametersPure", "[", 
                 RowBox[{"Upure", ",", "u0", ",", "L", ",", "0"}], "]"}]}], 
               ";", "   ", "\n", 
               RowBox[{"dataToFilePure", "[", 
                RowBox[{
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                 "acuracy", ",", "gauge", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "L", ",", "\[Chi]0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}]}], "}"}]}], "}"}], ",", 
                   RowBox[{"{", "Epure", "}"}]}], " ", "}"}]}], " ", "]"}], 
               ";", " ", "\n", 
               RowBox[{"Print", "[", "\"\<Pure data saved: \>\"", "]"}], ";", 
               "\n", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Kappa=\>\"", ",", "\[Kappa]", ",", "\"\< Lambda=\>\"", 
                 ",", " ", "\[Lambda]", " ", ",", "\"\<; Epure=\>\"", ",", 
                 "Epure", ",", "\"\<; \>\""}], "]"}], ";", 
               RowBox[{"Print", "[", "]"}], ";", "\n", 
               RowBox[{"Do", "[", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"\[Chi]0", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "r"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], " ", ",", 
                 RowBox[{"{", 
                  RowBox[{"r", ",", "1", ",", "Nc"}], "}"}]}], "]"}], ";"}]}],
              "\n", "  ", "]"}], ";", " ", "\n", "\n", 
            RowBox[{"\[Chi]", "=", 
             RowBox[{"\[Chi]gauge4v", "[", 
              RowBox[{"\[Chi]", ",", "L"}], "]"}]}], ";", "   ", 
            RowBox[{"(*", " ", 
             RowBox[{"<", 
              RowBox[{
               RowBox[{"-", "  ", "the"}], " ", "3", "rd", " ", 
               RowBox[{"difference", " ", ":", "  ", "\[Chi]gauge4v"}]}]}], 
             " ", "*)"}], "\n", "\n", " ", 
            RowBox[{"Do", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "J", ",", "K", ",", "\[CapitalGamma]", ",", "h", ",", "Jmod",
                   ",", "Kmod", ",", "\[CapitalGamma]mod"}], "}"}], "=", 
                RowBox[{
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"ev", ",", "p"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], ";", " ", 
               RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<J=\>\"", ",", "J", ",", " ", "\"\<; K=\>\"", ",", "K", 
                 ",", " ", "\"\<; G=\>\"", ",", "\[CapitalGamma]", ",", 
                 "\"\<; Jmod=\>\"", ",", "Jmod", ",", " ", "\"\<; Kmod=\>\"", 
                 ",", "Kmod", ",", " ", "\"\<; Gmod=\>\"", ",", 
                 "\[CapitalGamma]mod", ",", " ", "\"\<; L=\>\"", ",", "L", 
                 ",", " ", "\"\<; h=(\>\"", ",", " ", 
                 RowBox[{"hV", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"hp", ",", "1"}], " ", "]"}], "]"}], ",", 
                 "\"\<,\>\"", ",", 
                 RowBox[{"hV", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"hp", ",", "2"}], " ", "]"}], "]"}], ",", 
                 "\"\<,\>\"", ",", 
                 RowBox[{"hV", "[", 
                  RowBox[{"[", " ", 
                   RowBox[{"hp", ",", "3"}], "]"}], "]"}], ",", 
                 "\"\<); eV=\>\"", ",", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"1000", " ", 
                    RowBox[{
                    RowBox[{"eVs", "[", 
                    RowBox[{"[", "ev", "]"}], "]"}], "/", "1700"}]}], "]"}], 
                    "/", "1000"}], "]"}], "\"\<; \>\""}]}], "]"}], ";", 
               RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", 
               RowBox[{"Kv", "=", 
                RowBox[{"uniform", "[", 
                 RowBox[{"K", ",", "L", ",", "L"}], "]"}]}], ";", 
               RowBox[{"Kv", "=", 
                RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                 RowBox[{"Kv", ",", "Kmod", ",", "L"}], "]"}]}], ";", "\n", 
               RowBox[{"Jv", "=", 
                RowBox[{"uniform", "[", 
                 RowBox[{"J", ",", "L", ",", "L"}], "]"}]}], ";", 
               RowBox[{"Jv", "=", 
                RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                 RowBox[{"Jv", ",", "Jmod", ",", "L"}], "]"}]}], ";", "\n", 
               RowBox[{"\[CapitalGamma]v", "=", 
                RowBox[{"uniform", "[", 
                 RowBox[{"\[CapitalGamma]", ",", "L", ",", "L"}], "]"}]}], 
               ";", 
               RowBox[{"\[CapitalGamma]v", "=", 
                RowBox[{"add4VorticesMaxSpaced", "[", " ", 
                 RowBox[{
                 "\[CapitalGamma]v", ",", "\[CapitalGamma]mod", ",", "L"}], 
                 "]"}]}], ";", "\n", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"j", "=", "1"}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", " ", 
                   RowBox[{"j", "<", "steps"}], ")"}], "\[And]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "<", "minSteps"}], ")"}], "\[Or]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Chop", "[", " ", 
                    RowBox[{"\[CapitalDelta]1", ",", " ", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "acuracy"}]}]}], " ", "]"}], "!=", " ", 
                    "0"}], ")"}]}], "    ", ")"}]}], " ", ",", " ", 
                 RowBox[{"j", "++"}], ",", "   ", "\n", "\n", 
                 RowBox[{
                  RowBox[{"Module", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "H", ",", "u", ",", "TUh", ",", "Heff", ",", "\[Lambda]1",
                     ",", "\[Lambda]2"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"Heff", "=", 
                    RowBox[{"HeffList", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Omega]"}], "]"}]}], ";", "\n", 
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], " ", "Heff"}]}], ";", "\n", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{"\[Lambda]1List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{"\[Lambda]2List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";"}], " ", 
                    "*)"}], "\n", 
                    RowBox[{"H", "=", 
                    RowBox[{"HMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L", ",", 
                    "\[Lambda]1", ",", "\[Lambda]2", ",", "Heff"}], "]"}]}], 
                    ";", " ", "\n", 
                    RowBox[{"u", "=", 
                    RowBox[{"Umat", "[", 
                    RowBox[{
                    RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H", " ", ".", " ", "T"}], "]"}]}], ";", "\n", 
                    RowBox[{"u1", "=", 
                    RowBox[{"Re", "@", 
                    RowBox[{"Chop", "@", 
                    RowBox[{"icc", "[", 
                    RowBox[{"u", ",", "L", ",", "T"}], "]"}]}]}]}], ";", "\n",
                     "\n", "\t", 
                    RowBox[{"EMF", "=", 
                    RowBox[{"EnMF0", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                    ";", "                                        ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"<", 
                    RowBox[{"-", " ", 
                    RowBox[{"EnMF0", " ", "?"}]}]}], "  ", "*)"}], "\n", "\t", 
                    RowBox[{"E\[Lambda]", "=", 
                    RowBox[{"EnLagMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                    ";", "\n", "\t", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "EMF"}], "}"}]}], "}"}]}], ";", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "0"}], "}"}]}], "}"}]}], ";", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], "}"}]}], 
                    ";", "   ", "\n", "\n", 
                    RowBox[{"Do", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "m", ",", "n", ",", "\[Alpha]", ",", "\[Beta]", ",", "rz",
                     ",", "rx", ",", "ry", ",", "Io"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"rz", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"R0", "/", "16"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Beta]", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}]}], ")"}], "/", "4"}]}], 
                    "\[RightFloor]"}]}], ";", 
                    RowBox[{"\[Alpha]", "=", 
                    RowBox[{"R0", "-", 
                    RowBox[{"16", "rz"}], "-", 
                    RowBox[{"4", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "+", "1"}]}], ";",
                     "\n", "   ", 
                    RowBox[{"n", "=", 
                    RowBox[{"\[LeftFloor]", 
                    RowBox[{"rz", "/", "L"}], "\[RightFloor]"}]}], ";", 
                    RowBox[{"m", "=", 
                    RowBox[{"rz", "-", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"rx", "=", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"m", "+", "1"}], ",", "L"}], "]"}], "+", 
                    RowBox[{"n", " ", "L"}]}]}], ";", 
                    RowBox[{"ry", "=", 
                    RowBox[{"m", "+", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "L"}], "]"}], " ", 
                    "L"}]}]}], ";", 
                    RowBox[{"Io", "=", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], ";", " ", "\n", 
                    "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rx"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "ry"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", "Io"}], 
                    "]"}], "]"}]}], ";", "\n", "    ", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"rz", "+", "1"}], ",", "\[Alpha]", ",", 
                    "\[Beta]"}], "]"}], "]"}], "=", 
                    RowBox[{"u1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"\[Beta]", "+", "4", "+", 
                    RowBox[{"8", "rz"}]}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Io", "+", "4"}], ",", 
                    RowBox[{"8", "Nc"}], ",", "1"}], "]"}]}], " ", "]"}], 
                    "]"}]}], ";"}]}], "\n", "    ", "]"}], ";"}], " ", ",", 
                    " ", 
                    RowBox[{"{", 
                    RowBox[{"R0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"16", "Nc"}], "-", "1"}]}], "}"}]}], "  ", "]"}], 
                    ";"}]}], "     ", "\n", "]"}], ";", " ", "\n", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", ">=", "2"}], ",", 
                    RowBox[{
                    RowBox[{"\[CapitalDelta]2", "=", "\[CapitalDelta]1"}], 
                    ";", " ", 
                    RowBox[{"\[CapitalDelta]1", "=", 
                    RowBox[{"Max", "[", " ", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"(", 
                    RowBox[{"u1", "-", "u2"}], ")"}]}], " ", "]"}]}], ";", 
                    " ", 
                    RowBox[{"\[CapitalDelta]seq", "=", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalDelta]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]1"}], "}"}]}], "}"}]}], 
                    ";", "  ", 
                    RowBox[{"\[CapitalDelta]\[Omega]", "=", 
                    RowBox[{
                    RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "Nc"}], ")"}]}], " ", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "r", ",", "2", ",", "1"}], "]"}],
                     "]"}], "+", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Sigma]", ",", "r", ",", "3", ",", "4"}], "]"}],
                     "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", "1", ",", "Nc"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]", ",", "1", ",", "2"}], "}"}]}], 
                    "]"}]}]}], ";", " ", 
                    RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalDelta]\[Omega]seq", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "\[CapitalDelta]\[Omega]"}], "}"}]}], 
                    "}"}]}]}]}], "    ", "]"}], ";", " ", "\n", 
                  RowBox[{"u2", "=", "u1"}], ";", "        ", "\n", 
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\< j =\>\"", ",", "j", ",", " ", "\"\</\>\"", ",", 
                    "steps", ",", " ", "\"\<; Delta=\>\"", ",", 
                    RowBox[{"round\[CapitalDelta]", "@", "\[CapitalDelta]1"}],
                     ",", "  ", "\"\<;  E=\>\"", ",", " ", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"1000000", 
                    RowBox[{"(", "EMF", ")"}]}], "]"}], "/", "1000000"}], 
                    "]"}], ",", "\"\<; \>\""}], "  ", "]"}], ";"}]}], "     ",
                 "\n", "         ", "]"}], ";", "  ", "\n", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "H", ",", "u", ",", "Heff", ",", "\[Lambda]1", ",", 
                   "\[Lambda]2"}], "}"}], ",", "\n", 
                 RowBox[{
                  RowBox[{"Heff", "=", 
                   RowBox[{"HeffList", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Omega]"}], "]"}]}], ";", " ", "\n", 
                  RowBox[{"\[Lambda]1", "=", 
                   RowBox[{
                    RowBox[{"(", "0.46", ")"}], "Heff"}]}], ";", 
                  RowBox[{"\[Lambda]2", "=", 
                   RowBox[{
                    RowBox[{"(", "0.46", ")"}], "Heff"}]}], ";", "\n", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"\[Lambda]1", "=", 
                    RowBox[{"\[Lambda]1List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";", 
                    RowBox[{"\[Lambda]2", "=", 
                    RowBox[{"\[Lambda]2List", "[", 
                    RowBox[{"Heff", ",", "\[Omega]"}], "]"}]}], ";"}], " ", 
                   "*)"}], "\n", 
                  RowBox[{"H", "=", 
                   RowBox[{"HMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L", ",", 
                    "\[Lambda]1", ",", "\[Lambda]2", ",", "Heff"}], "]"}]}], 
                  ";", " ", "\n", "    ", 
                  RowBox[{"u", "=", 
                   RowBox[{"Umat", "[", 
                    RowBox[{
                    RowBox[{"T", "\[ConjugateTranspose]"}], " ", ".", " ", 
                    "H", " ", ".", " ", "T"}], "]"}]}], ";", "\n", "\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"\[Chi]", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Omega]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"\[Xi]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"\[Xi]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "u1"}], "}"}], "=", 
                   RowBox[{"BiParallel", "[", 
                    RowBox[{"u", ",", "L", ",", "T"}], "]"}]}], ";", " ", 
                  "\n", "\t", 
                  RowBox[{"EMF", "=", 
                   RowBox[{"EnMF0", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                  ";", " ", "\n", "\t", 
                  RowBox[{"E\[Lambda]", "=", 
                   RowBox[{"EnLagMF", "[", 
                    RowBox[{
                    "Jv", ",", "Kv", ",", "\[CapitalGamma]v", ",", "h", ",", 
                    "\[Chi]", ",", "\[Omega]", ",", "L", ",", "L"}], "]"}]}], 
                  ";", "\n", "\t", 
                  RowBox[{
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "EMF"}], "}"}]}], "}"}]}], ";", "\n", 
                  "    ", 
                  RowBox[{
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "0"}], "}"}]}], "}"}]}], ";", "\n", 
                  "    ", 
                  RowBox[{
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"EMF", "+", "E\[Lambda]"}]}], "}"}]}], "}"}]}], 
                  ";"}]}], "           ", "\n", "]"}], ";", "  \t", 
               RowBox[{"\[CapitalDelta]seq", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "\[CapitalDelta]seq", "]"}], ",", 
                  "2"}], "]"}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"EnList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"EnList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], ";", "\n", "\t", 
               RowBox[{
                RowBox[{"EnList", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "2"}], 
                 "]"}]}], ";", " ", "\n", "\t", 
               RowBox[{"\[CapitalDelta]\[Omega]seq", "=", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "\[CapitalDelta]\[Omega]seq", "]"}],
                   ",", "2"}], "]"}]}], ";", " ", "\n", "\t", 
               RowBox[{"dataToFile", "[", 
                RowBox[{
                 RowBox[{"parameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"ev", ",", "p"}], "]"}], "]"}], ",", "L", ",", 
                 "acuracy", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "j", ",", "L", ",", "\[Chi]", ",", "\[Omega]", ",", "\[Xi]",
                    ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"EnList", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]seq",
                     ",", "\[CapitalDelta]\[Omega]seq"}], "}"}]}], "}"}], ",",
                  "gauge", ",", "NbName"}], "]"}], ";", "     ", "\n", "\t", 
               "\n", 
               RowBox[{"Print", "[", " ", 
                RowBox[{
                "\"\<ev=\>\"", ",", "ev", " ", ",", "\"\</\>\"", ",", " ", 
                 RowBox[{
                  RowBox[{"Length", "@", "eVs"}], "\"\<; j MAX=\>\""}], ",", 
                 "j", ",", " ", "\"\</\>\"", ",", "steps", ",", " ", 
                 "\"\<; Delta=\>\"", ",", "\[CapitalDelta]1", ",", " ", 
                 "\"\<; \>\""}], "   ", "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"ev", ",", "1", ",", 
                RowBox[{"Length", "[", "parameters", "]"}]}], "}"}]}], " ", 
             "]"}], ";", "\n", "\n", "\t", 
            RowBox[{"t1", "=", 
             RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
            RowBox[{"\[CapitalDelta]t", "=", " ", 
             RowBox[{"UnitConvert", "[", " ", 
              RowBox[{
               RowBox[{"Quantity", "[", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{"t1", " ", "-", "t0"}], "]"}], ",", " ", 
                 "\"\<Seconds\>\""}], " ", "]"}], ",", " ", "\"\<Hours\>\""}],
               " ", "]"}]}], ";", 
            RowBox[{"t0", "=", "t1"}], ";", " ", 
            RowBox[{"Print", "[", "\"\< \>\"", "]"}], ";", "\n", "\t", 
            RowBox[{"Print", "[", " ", 
             RowBox[{"\"\<p=\>\"", ",", "p", ",", "\"\</\>\"", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"parameters", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", "\"\<; l=\>\"", 
              ",", "l", ",", " ", "\"\</\>\"", ",", 
              RowBox[{"Length", "@", "Ls"}], ",", " ", 
              "\"\<; \[CapitalDelta]t = \>\"", ",", 
              RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}], ",", 
              RowBox[{"IntegerPart", "@", 
               RowBox[{"UnitConvert", "[", 
                RowBox[{
                 RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], 
                 ",", " ", "\"\<Minutes\>\""}], " ", "]"}]}]}], "   ", 
             "]"}]}]}], "\n", "\n", "  ", "]"}], ";"}]}], "\n", "]"}], "  ", 
      ",", " ", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", 
        RowBox[{"Length", "@", "Ls"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"p", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"parameters", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], "}"}]}], "  ", 
     "]"}]}], "          ", "\n", "*)"}], 
  "                                     "}]], "Code",ExpressionUUID->\
"2aa113d0-4418-4f12-b1bb-136a7ea131a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[CapitalDelta]t", "}"}], ",", 
    RowBox[{
     RowBox[{"t1", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
     RowBox[{"\[CapitalDelta]t", "=", " ", 
      RowBox[{"UnitConvert", "[", " ", 
       RowBox[{
        RowBox[{"Quantity", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"t1", "-", "t4v"}], "]"}], ",", " ", "\"\<Seconds\>\""}], 
         " ", "]"}], ",", " ", "\"\<Hours\>\""}], " ", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tHours", "=", 
      RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tMin", "=", 
      RowBox[{"IntegerPart", "@", 
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", " ", 
         "\"\<Minutes\>\""}], " ", "]"}]}]}], ";", "\n", 
     RowBox[{"\[CapitalDelta]tSec", "=", 
      RowBox[{"IntegerPart", "@", 
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"FractionalPart", "@", 
          RowBox[{"UnitConvert", "[", 
           RowBox[{
            RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", 
            " ", "\"\<Minutes\>\""}], " ", "]"}]}], ",", " ", 
         "\"\<Seconds\>\""}], " ", "]"}]}]}], ";", "\n", 
     RowBox[{"Print", "[", " ", 
      RowBox[{"\"\<4 vortices loop timing \[CapitalDelta]t = \>\"", ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tHours"}], ",", "\"\< : \>\"",
        ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tMin"}], ",", "\"\< : \>\"", 
       ",", 
       RowBox[{"ToString", "@", "\[CapitalDelta]tSec"}]}], "    ", "]"}]}]}], 
   " ", "\n", "]"}], ";"}]], "Code",ExpressionUUID->"40b41d05-2995-45c1-bd37-\
7b7242f5afbc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[CapitalDelta]t", "}"}], ",", 
     RowBox[{
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
      RowBox[{"\[CapitalDelta]t", "=", " ", 
       RowBox[{"UnitConvert", "[", " ", 
        RowBox[{
         RowBox[{"Quantity", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"t1", "-", "t4v"}], "]"}], ",", " ", "\"\<Seconds\>\""}], 
          " ", "]"}], ",", " ", "\"\<Hours\>\""}], " ", "]"}]}], ";", "\n", 
      RowBox[{"\[CapitalDelta]tHours", "=", 
       RowBox[{"IntegerPart", "[", "\[CapitalDelta]t", "]"}]}], ";", "\n", 
      RowBox[{"\[CapitalDelta]tMin", "=", 
       RowBox[{"IntegerPart", "@", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", " ", 
          "\"\<Minutes\>\""}], " ", "]"}]}]}], ";", "\n", 
      RowBox[{"\[CapitalDelta]tSec", "=", 
       RowBox[{"IntegerPart", "@", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"FractionalPart", "@", 
           RowBox[{"UnitConvert", "[", 
            RowBox[{
             RowBox[{"FractionalPart", "[", "\[CapitalDelta]t", "]"}], ",", 
             " ", "\"\<Minutes\>\""}], " ", "]"}]}], ",", " ", 
          "\"\<Seconds\>\""}], " ", "]"}]}]}], ";", "\n", 
      RowBox[{"Print", "[", " ", 
       RowBox[{"\"\<4 vortices loop timing \[CapitalDelta]t = \>\"", ",", 
        RowBox[{"ToString", "@", "\[CapitalDelta]tHours"}], ",", 
        "\"\< : \>\"", ",", 
        RowBox[{"ToString", "@", "\[CapitalDelta]tMin"}], ",", "\"\< : \>\"", 
        ",", 
        RowBox[{"ToString", "@", "\[CapitalDelta]tSec"}]}], "    ", "]"}]}]}],
     " ", "]"}], ";"}], "*)"}]], "Input",ExpressionUUID->"f4f80119-4d85-4b1b-\
a34a-3b705a11cc14"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subtitle",ExpressionUUID->"167d1afc-5ec2-47c0-a215-91af1c7d08ce"],

Cell["To do: ", "Subtitle",
 CellChangeTimes->{{3.902943683900139*^9, 
  3.902943687568568*^9}},ExpressionUUID->"eb28b657-6939-4d0b-96f9-\
17ecb59255e2"],

Cell[TextData[{
 "\[Times] Change W -> V\n\[Times] ",
 StyleBox["define mf energy   (via <> and eigenvalue)\n",
  FontWeight->"Bold"],
 "\[Times]     test  it for pure Kitaev h=0",
 "\n\[Times] Wilson loop  ( change order r and \[Sigma] )\n\[Times] function \
Jmicro[t] output Jmat coupling for each t\n\[Times] Change def parameters  \
(define DM as function of eV)\n\[Times] Define DM interaction as uniform 0 + \
4v\n\[Times] Rewrite code for vortex free  (for 4v  then copy it making the \
trivial changes)\n\n"
}], "Text",
 CellChangeTimes->{{3.9029436907613115`*^9, 3.902943699776925*^9}, {
  3.9029437446225605`*^9, 3.902943802583638*^9}, {3.902944149757424*^9, 
  3.9029441730864925`*^9}, {3.902944375586528*^9, 3.902944422071251*^9}, {
  3.9029444606088433`*^9, 3.9029444693637924`*^9}, {3.9029448597412014`*^9, 
  3.9029448806464615`*^9}, {3.9029449631515136`*^9, 3.9029449866237817`*^9}, {
  3.9029450325880637`*^9, 3.9029450895618343`*^9}, {3.90294517989765*^9, 
  3.9029452093337307`*^9}},ExpressionUUID->"bc7b4a9b-b6c4-48a6-99f0-\
23b0b7a120c5"]
}, Open  ]]
},
WindowSize->{1152., 579.75},
WindowMargins->{{Automatic, 132}, {62.25, Automatic}},
Magnification:>0.8 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"30a32ddb-fa16-4b9b-9391-8058f56b62da"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 198, 3, 51, "Section",ExpressionUUID->"415c9f61-a31b-4391-823c-f2870c74e1aa"],
Cell[781, 27, 1709, 45, 84, "Input",ExpressionUUID->"6f9fb1b5-b826-4b31-9132-604e4661e681"],
Cell[CellGroupData[{
Cell[2515, 76, 201, 3, 34, "Subsubsection",ExpressionUUID->"2bab245a-01fa-44c7-b751-d57ae960babf"],
Cell[2719, 81, 4585, 131, 195, "Input",ExpressionUUID->"f0184288-61fc-41cb-a7d0-a5916251704c"],
Cell[7307, 214, 970, 28, 55, "Input",ExpressionUUID->"8fec6e4d-3d1c-490b-9399-dea6587b946c"],
Cell[8280, 244, 2124, 66, 55, "Input",ExpressionUUID->"21eac056-e5f8-4675-b39a-f805e39b0180"],
Cell[10407, 312, 2736, 76, 114, "Input",ExpressionUUID->"196a36d5-1e02-49b5-b928-189dde5ba8b5"],
Cell[13146, 390, 1456, 40, 39, "Input",ExpressionUUID->"4213a20f-5ad4-4360-b9e0-617c213800cb"],
Cell[14605, 432, 1846, 49, 54, "Input",ExpressionUUID->"06a805d6-3f79-43b4-80ea-7075d6508823"],
Cell[16454, 483, 11953, 256, 253, "Input",ExpressionUUID->"b400fb06-4a4d-4c53-b98e-c3db057cf663"]
}, Closed]],
Cell[CellGroupData[{
Cell[28444, 744, 273, 4, 30, "Subsection",ExpressionUUID->"66e2a912-661e-4de4-8c26-c6934170dce4"],
Cell[CellGroupData[{
Cell[28742, 752, 195, 3, 34, "Subsubsection",ExpressionUUID->"aa989c96-8c74-4b4a-9719-0a256d70b608"],
Cell[28940, 757, 10496, 212, 350, "Input",ExpressionUUID->"0b1d8c6c-3246-4947-8bc0-288b138d209d"],
Cell[39439, 971, 9178, 219, 446, "Code",ExpressionUUID->"544e050b-fff5-4e7c-b801-a70379cac8d6"]
}, Closed]],
Cell[CellGroupData[{
Cell[48654, 1195, 313, 5, 28, "Subsubsection",ExpressionUUID->"481ccb27-4efa-4a1b-b0a1-433a3d45e603"],
Cell[48970, 1202, 440, 10, 40, "Text",ExpressionUUID->"bda26fb8-b683-40a3-91c8-d47e91676755"],
Cell[49413, 1214, 1603, 36, 37, "Input",ExpressionUUID->"ea9fb8b5-cc52-4ef5-bb6f-3d99c940eda0"],
Cell[51019, 1252, 35368, 754, 696, "Input",ExpressionUUID->"f2915dff-fb33-4ed6-9988-91bfa27f058b"]
}, Closed]],
Cell[CellGroupData[{
Cell[86424, 2011, 242, 3, 30, "Subsubsection",ExpressionUUID->"34dac328-f6f0-43f0-aee3-cb143d586447"],
Cell[86669, 2016, 10675, 264, 446, "Input",ExpressionUUID->"27341382-f257-4496-9dc9-e70392e55115"],
Cell[97347, 2282, 11572, 294, 495, "Input",ExpressionUUID->"75dc91b6-2ba5-4b71-8e56-db4d9d758f83"],
Cell[108922, 2578, 252, 4, 28, "Text",ExpressionUUID->"3a7c1260-9853-40df-823e-7ac0bad83222"],
Cell[109177, 2584, 4185, 102, 110, "Input",ExpressionUUID->"7803c2ce-e2f3-4054-9a4c-cfd424ad2e64"],
Cell[113365, 2688, 2274, 59, 190, "Input",ExpressionUUID->"32a12fd4-6b04-4fa8-8921-0e1b06ab9778"],
Cell[115642, 2749, 226, 3, 28, "Text",ExpressionUUID->"9f3ab0b7-e36b-4339-a786-cd32ae12473b"],
Cell[115871, 2754, 2823, 66, 91, "Input",ExpressionUUID->"492db9da-0a1f-48f8-b014-291e7eb1ec50"],
Cell[118697, 2822, 9272, 223, 245, "Input",ExpressionUUID->"0e06b428-50bb-4179-a10e-15a5549a6dff"]
}, Closed]],
Cell[CellGroupData[{
Cell[128006, 3050, 206, 3, 28, "Subsubsection",ExpressionUUID->"082b1853-69cb-4515-a15e-ba6582944cba"],
Cell[128215, 3055, 9468, 251, 453, "Input",ExpressionUUID->"605b6fbc-7e7e-420c-b030-1c5336e2167d"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[137732, 3312, 258, 4, 42, "Subsection",ExpressionUUID->"0318476a-00b2-4dfc-9b63-3a22ad5f203f"],
Cell[CellGroupData[{
Cell[138015, 3320, 550, 8, 34, "Subsubsection",ExpressionUUID->"b71d4571-a688-41a0-930c-9da7a14bca46"],
Cell[138568, 3330, 529, 9, 24, "Text",ExpressionUUID->"fb7b3641-96cb-4bed-b03c-c6cf44a4b764"],
Cell[139100, 3341, 1591, 36, 69, "Input",ExpressionUUID->"fc4d5d20-75bd-4656-ab10-830001170971"],
Cell[140694, 3379, 469, 8, 24, "Text",ExpressionUUID->"e22cadd4-91eb-4583-8e63-ad2fd266acad"],
Cell[141166, 3389, 1548, 36, 115, "Input",ExpressionUUID->"4a8d010b-8cad-41cb-8c62-196ec1a1893b"],
Cell[142717, 3427, 4658, 106, 162, "Input",ExpressionUUID->"575eb2a2-01d7-4d66-8c20-b4aea72abfd5"],
Cell[147378, 3535, 4148, 94, 177, "Input",ExpressionUUID->"807f3ba5-2aef-4049-aea3-8f660cac15f9"],
Cell[151529, 3631, 556, 10, 24, "Text",ExpressionUUID->"297c7722-7294-4b07-a549-c0fa4766203d"],
Cell[152088, 3643, 1601, 42, 130, "Input",ExpressionUUID->"09917604-5614-4d44-b9d5-9d21d5a7d8a7"]
}, Closed]],
Cell[CellGroupData[{
Cell[153726, 3690, 278, 5, 28, "Subsubsection",ExpressionUUID->"89758110-0a30-4fa0-ad94-8c6848b529b0"],
Cell[154007, 3697, 3878, 115, 69, "Input",ExpressionUUID->"7b6e2af4-effe-4e1c-8193-f82a0e2a47b7"],
Cell[157888, 3814, 10246, 267, 308, "Input",ExpressionUUID->"6607212d-ab68-4a3c-9feb-c2c50dbddbb3"],
Cell[168137, 4083, 4949, 134, 160, "Input",ExpressionUUID->"e7b1cf79-f21c-4b18-bb19-46600335e85d"],
Cell[173089, 4219, 3919, 94, 136, "Input",ExpressionUUID->"f1470e9b-3fe3-4e66-94d3-615e42f9fb46"],
Cell[177011, 4315, 8453, 195, 197, "Input",ExpressionUUID->"a04abf83-75ac-4fe3-a3fa-1dc9618af95e"],
Cell[185467, 4512, 593, 18, 23, "Input",ExpressionUUID->"8cbf734c-61e8-4a65-b32f-a9aca70998d8"],
Cell[186063, 4532, 4533, 110, 115, "Input",ExpressionUUID->"54525139-b2a2-4e5f-a1f6-fa653db5e49e"],
Cell[190599, 4644, 1892, 54, 46, "Input",ExpressionUUID->"ab3a2d95-6d51-476a-8e52-93ec3f131b36"]
}, Closed]],
Cell[CellGroupData[{
Cell[192528, 4703, 269, 4, 28, "Subsubsection",ExpressionUUID->"b3e77d08-352b-4a7f-aa6e-6655b45d73f0"],
Cell[192800, 4709, 4928, 141, 176, "Input",ExpressionUUID->"d37ec3c5-abcc-4e5d-b6a4-5e9c0d44f4b4"],
Cell[197731, 4852, 30745, 775, 1167, "Input",ExpressionUUID->"4f595269-c9d5-4b8e-9be1-753434b1bc87"],
Cell[228479, 5629, 3491, 92, 145, "Input",ExpressionUUID->"46979265-40c0-4da5-81d2-778e1f7d8218"],
Cell[231973, 5723, 1570, 42, 54, "Input",ExpressionUUID->"247d95a1-bf8f-431b-847d-f99a4a26dc9c"],
Cell[233546, 5767, 1195, 35, 39, "Input",ExpressionUUID->"3340ea2e-3efa-4880-b0e0-1592b4901db7"]
}, Closed]],
Cell[CellGroupData[{
Cell[234778, 5807, 256, 4, 28, "Subsubsection",ExpressionUUID->"c8642423-6c54-4e5b-bbfc-31fe829d8430"],
Cell[235037, 5813, 156, 3, 28, "Text",ExpressionUUID->"cab4f53f-a9ed-41c8-a8fe-51dab0829624"],
Cell[235196, 5818, 313, 8, 22, "Input",ExpressionUUID->"740095b0-2b72-4889-bdf9-861fb4f61bbe"],
Cell[235512, 5828, 28823, 601, 506, "Input",ExpressionUUID->"3f4bae56-6c1d-4a7f-acad-165d3de18001"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264372, 6434, 267, 4, 36, "Subsubsection",ExpressionUUID->"1f33cda0-a6a0-4bff-91bf-11e7d8dd3cb5"],
Cell[264642, 6440, 7973, 189, 237, "Input",ExpressionUUID->"629fd037-c3e2-4a7e-90b0-4492629474f0"],
Cell[272618, 6631, 884, 23, 39, "Input",ExpressionUUID->"f85dc0d5-82a0-43e5-9241-9d68e8519105"],
Cell[273505, 6656, 658, 18, 23, "Input",ExpressionUUID->"22e72a6a-b20a-4975-ae94-b9fee4928764"],
Cell[274166, 6676, 13074, 283, 358, "Input",ExpressionUUID->"1c6a9ee3-0ca7-4512-9668-41dbee4fa656"],
Cell[287243, 6961, 12966, 313, 500, "Input",ExpressionUUID->"6b2aa10b-6863-4d41-8279-aaa4bda5a264"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[300270, 7281, 190, 3, 58, "Section",ExpressionUUID->"65386cf6-13ec-4e69-bf3a-0864eae5c417"],
Cell[300463, 7286, 3856, 103, 160, "Input",ExpressionUUID->"ea4ba569-ecd9-46a1-8d24-6107708ff42b"],
Cell[CellGroupData[{
Cell[304344, 7393, 110, 1, 36, "Subsubsection",ExpressionUUID->"ac67c233-9311-4236-9c27-b4d81ab07561"],
Cell[304457, 7396, 608, 16, 55, "Code",ExpressionUUID->"18a79ce6-b12c-452c-abdc-dc53ee0c11c5"],
Cell[305068, 7414, 27017, 618, 701, "Code",ExpressionUUID->"b3fb577a-c068-4a25-bbbc-a165ba747849"],
Cell[332088, 8034, 149, 3, 38, "Input",ExpressionUUID->"680aeb83-633c-4391-97cc-8f5744c616e8"]
}, Closed]],
Cell[CellGroupData[{
Cell[332274, 8042, 147, 1, 30, "Subsubsection",ExpressionUUID->"40080617-38e9-4a1e-9c8d-1625a3134e05"],
Cell[332424, 8045, 1372, 34, 70, "Code",ExpressionUUID->"905b0c58-f21f-44c7-942d-4b80aab1fd81"],
Cell[333799, 8081, 44750, 986, 70, "Code",ExpressionUUID->"516d261c-68fc-436c-b4cb-6a2feb104a84"]
}, Closed]],
Cell[CellGroupData[{
Cell[378586, 9072, 147, 1, 30, "Subsubsection",ExpressionUUID->"45c87f90-eb26-4fda-b817-fed84e6974f5"],
Cell[378736, 9075, 2148, 52, 139, "Code",ExpressionUUID->"5804fa87-423d-4ed1-9961-5b40631e42e4"],
Cell[380887, 9129, 42230, 923, 1418, "Code",ExpressionUUID->"2aa113d0-4418-4f12-b1bb-136a7ea131a3"],
Cell[423120, 10054, 1810, 42, 111, "Code",ExpressionUUID->"40b41d05-2995-45c1-bd37-7b7242f5afbc"],
Cell[424933, 10098, 1870, 43, 99, "Input",ExpressionUUID->"f4f80119-4d85-4b1b-a34a-3b705a11cc14"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[426852, 10147, 75, 0, 42, "Subtitle",ExpressionUUID->"167d1afc-5ec2-47c0-a215-91af1c7d08ce"],
Cell[426930, 10149, 153, 3, 42, "Subtitle",ExpressionUUID->"eb28b657-6939-4d0b-96f9-17ecb59255e2"],
Cell[427086, 10154, 1059, 18, 193, "Text",ExpressionUUID->"bc7b4a9b-b6c4-48a6-99f0-23b0b7a120c5"]
}, Open  ]]
}
]
*)

